<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>SUID Enumeration/Exploitation - The Automated Way! :: Hello Friend — A simple theme for Hugo</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Are you also tired of finding &amp;amp;&amp;amp; enumerating possibly exploitable SUID binaries like me!? Only to miss the ones you were going to escalate your priviliges with?
Welp, I just happened to develop a solution: SUID 3NUM.
(Self promote, I will! - Yoda) What the heck is SUID ENUM!? A (not-so-cool-as-it-seems-like) standalone script supporting both python2 &amp;amp; python3 to find out all SUID binaries in a linux box and do the following:"/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/post/2019-10-23-suid-enumeration/" />








<link rel="stylesheet" href="/css/style.min.css">


<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SUID Enumeration/Exploitation - The Automated Way!"/>
<meta name="twitter:description" content="Are you also tired of finding &amp;&amp; enumerating possibly exploitable SUID binaries like me!? Only to miss the ones you were going to escalate your priviliges with?
Welp, I just happened to develop a solution: SUID 3NUM.
(Self promote, I will! - Yoda) What the heck is SUID ENUM!? A (not-so-cool-as-it-seems-like) standalone script supporting both python2 &amp; python3 to find out all SUID binaries in a linux box and do the following:"/>



<meta property="og:title" content="SUID Enumeration/Exploitation - The Automated Way!" />
<meta property="og:description" content="Are you also tired of finding &amp;&amp; enumerating possibly exploitable SUID binaries like me!? Only to miss the ones you were going to escalate your priviliges with?
Welp, I just happened to develop a solution: SUID 3NUM.
(Self promote, I will! - Yoda) What the heck is SUID ENUM!? A (not-so-cool-as-it-seems-like) standalone script supporting both python2 &amp; python3 to find out all SUID binaries in a linux box and do the following:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/2019-10-23-suid-enumeration/" />
<meta property="article:published_time" content="2019-10-23T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-10-23T00:00:00+00:00" /><meta property="og:site_name" content="Hello Friend" />






  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">hello friend</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/showcase">Showcase</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/showcase">Showcase</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title"><a href="/post/2019-10-23-suid-enumeration/">SUID Enumeration/Exploitation - The Automated Way!</a></h1>
    <div class="post-meta">
      
        <span class="post-date">
          2019-10-23
        </span>

        
          
        
      

      <span class="post-author">— Written by Syed Umar Arfeen</span>
      
    </div>

    

    

    <div class="post-content">
      
      <p>Are you also tired of <strong>finding &amp;&amp; enumerating possibly exploitable SUID binaries</strong> like me!? Only to miss the ones you were going to <em>escalate your priviliges</em> with?</p>
<p>Welp, I just happened to develop a solution: <a href="https://github.com/Anon-Exploiter/SUID3NUM">SUID 3NUM</a>.</p>
<h6 id="self-promote-i-will---yoda">(Self promote, I will! - Yoda)</h6>
<p><img src="/images/demo/screenshot_10.png" alt=""></p>
<h2 id="what-the-heck-is-suid-enum">What the heck is SUID ENUM!?</h2>
<p>A (not-so-cool-as-it-seems-like) standalone script supporting both <strong>python2</strong> &amp; <strong>python3</strong> to find out all SUID binaries in a linux box and do the following:</p>
<ul>
<li>List all Default SUID Binaries (which ship with linux/aren&rsquo;t exploitable)</li>
<li>List all Custom Binaries (which don&rsquo;t ship with packages/vanilla installation)</li>
<li>List all Custom binaries found in GTFO Bin&rsquo;s list (This is where things get interesting)</li>
<li>Try and auto-exploit found custom SUID binaries which won&rsquo;t impact any of the machine&rsquo;s binaries</li>
</ul>
<h3 id="---description-goes-here---">&lt;!&ndash; Description goes here &ndash;&gt;</h3>
<p>Many of the times while doing <strong>Vulnhub</strong>, <strong>HTB</strong> &amp;&amp; other <strong>vulnerable machines</strong>, I stumbled upon <em>SUID binaries</em> in the box, I didn&rsquo;t have any method to seperate exploitable SUID binaries from those default SUID binaries of the system.</p>
<p>Fortunately, <a href="https://github.com/rebootuser/LinEnum">LinEnum</a> seperated vulnerable binaries which were present in list of GTFO Bins and presented it nicely in a new section named <code>Interesting SUID Bins</code>.</p>
<p><img src="/images/demo/troll_gifs/awesome.gif" alt=""></p>
<h4 id="awesome-isnt-it">Awesome, isn&rsquo;t it?</h4>
<p>By this time, you&rsquo;ll be asking yourself, then why da heck I made this blog post and that script, <strong>If LinEum is so cool!?</strong></p>
<p>&ndash;</p>
<h5 id="lets-get-on-that-now">Lets get on that now:</h5>
<p><img src="/images/demo/troll_gifs/finally.gif" alt=""></p>
<p>Now,</p>
<ul>
<li>What if a binary <strong>isn&rsquo;t</strong> in GTFO&rsquo;s bins list and is still exploitable?</li>
<li>What If the sysadmin renamed the exploitable binary (like <em>cp, find, cat, vim, iftop etc.</em>) to something else?</li>
<li>What if there&rsquo;s a custom C/C++ compiled binary having SUID bit set on it?</li>
</ul>
<p>You&rsquo;ll definitely miss that one binary through which you were going to escalate yourself to the next level. We all know, when LinEnum shows interesting SUID bins list, nobody ever looks at the whole list of the SUID binaries!</p>
<p>Also, LinEnum and other enumeration scripts only print SUID binaries &amp; GTFO Binaries, they don&rsquo;t seperate default binaries from custom binaries, which lead to severe head banging in walls for 3-4 hours when you can&rsquo;t escalate priviliges :)</p>
<h5 id="solution">Solution:</h5>
<p>The above issues struck me to create a script which seperates both custom SUID bit-set binaries and default binaries, cross-match custom binaries with GTFO Bin&rsquo;s binaries list. Further, go-ahead, try and auto-exploit them (only in case, they aren&rsquo;t going to <strong>alter any files</strong> on the system!)</p>
<hr>
<h3 id="usage">Usage</h3>
<p><em><strong>Initializing Script</strong></em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">python suid3num<span style="color:#f92672">.</span>py
</code></pre></div><p><em><strong>Doing Auto Exploitation of Exploitable SUID binaries</strong></em></p>
<pre><code>python suid3num.py -e
</code></pre>
<hr>
<h3 id="screenshotsworking">Screenshots/Working</h3>
<p>Here are some screenshots describing output of the script:</p>
<!-- raw HTML omitted -->
<hr>
<h4 id="suid-enumeration-without--e">SUID Enumeration (without -e)</h4>
<!-- raw HTML omitted -->
<p>{% asciicast 273928 %}</p>
<hr>
<h4 id="auto-exploitation-of-suid-binaries-with--e">Auto-Exploitation of SUID Binaries (with -e)</h4>
<!-- raw HTML omitted -->
<p>{% asciicast 273929 %}</p>
<hr>
<h3 id="faq">FAQ</h3>
<ul>
<li>Can I run it on OSCP labs/exam machines?</li>
</ul>
<p>According to some folks, as long as you aren&rsquo;t using <code>-e</code> flag, its completely fine!</p>
<hr>
<h4 id="you-like-it-now-dont-you---ʖ-">You like it now, don&rsquo;t you? ( ͡° ͜ʖ ͡°)</h4>
<p><img src="/images/demo/troll_gifs/hello_pepe.gif" alt=""></p>
<hr>
<h3 id="future-todos">Future ToDo(s):</h3>
<ul>
<li>Get a Life ¯\<em>(ツ)</em>/¯</li>
<li>Make improvements in default SUID binaries list</li>
<li>Create scripts for <code>linux capabilities</code> and for binaries one can run with <code>sudo</code></li>
</ul>
<hr>
<h3 id="aightimmaheadout">./aightImmaHeadOut</h3>
<!-- raw HTML omitted -->

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="/post/my-first-post/">
                  <span class="button__icon">←</span>
                  <span class="button__text">My First Post</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="/post/code-testing/">
                  <span class="button__text">Python Code Testing</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    


    
      
        

      
    

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">hello friend</span>
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span>© 2020 Powered by <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span>
        <span>Theme created by <a href="https://twitter.com/panr" target="_blank" rel="noopener">panr</a></span>
      </div>
    
  </div>
</footer>





<script src="/js/menu.js"></script>
<script src="/js/theme.js"></script>
<script src="/js/prism.js"></script>


      
    </div>

    
  </body>
</html>
