<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>SUID Enumeration/Exploitation - The Automated Way! :: Umar_0x01 – Pentester | Programmer | Your average sakurity guy ( ͡~ ͜ʖ ͡°)</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="What the heck is SUID ENUM!? Are you also tired of finding &amp;amp;&amp;amp; enumerating possibly exploitable SUID binaries like me!? Only to miss the ones you were going to escalate your priviliges with?
Welp, I just happened to develop a solution: SUID 3NUM.
 (Self promote, I will! - Yoda)
 A (not-so-cool-as-it-seems-like) standalone script supporting both python2 &amp;amp; python3 to find out all SUID binaries in a linux box and do the following:"/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://umar0x01.sh/post/suid-enumeration/" />





<link rel="stylesheet" href="https://umar0x01.sh/assets/style.css">

<link rel="stylesheet" href="https://umar0x01.sh/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://umar0x01.sh/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="https://umar0x01.sh/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SUID Enumeration/Exploitation - The Automated Way!"/>
<meta name="twitter:description" content="A standalone python script which utilizes python&#39;s built-in modules to find SUID bins, separate default bins from custom bins, cross-match those with bins in GTFO Bin&#39;s repository &amp; auto-exploit those, all with colors! ( ͡ʘ ͜ʖ ͡ʘ)"/>



<meta property="og:title" content="SUID Enumeration/Exploitation - The Automated Way!" />
<meta property="og:description" content="A standalone python script which utilizes python&#39;s built-in modules to find SUID bins, separate default bins from custom bins, cross-match those with bins in GTFO Bin&#39;s repository &amp; auto-exploit those, all with colors! ( ͡ʘ ͜ʖ ͡ʘ)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://umar0x01.sh/post/suid-enumeration/" />
<meta property="article:published_time" content="2019-10-23T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-10-23T00:00:00+00:00" />







<link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">




  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">$ cd /home/umar_0x01/</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/archive">Archive</a></li>
        
      
        
          <li><a href="https://pentestlabs.gitbook.io">PentestLabs</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/archive">Archive</a></li>
      
    
      
        <li><a href="https://pentestlabs.gitbook.io">PentestLabs</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title"><a href="https://umar0x01.sh/post/suid-enumeration/">SUID Enumeration/Exploitation - The Automated Way!</a></h1>
    <div class="post-meta">
      
        <span class="post-date">
          2019-10-23
        </span>

        
          
        
      

      <span class="post-author">— Written by Umar_0x01</span>
      
        <span class="post-read-time">— 3 min read</span>
      
    </div>

    

    
      <figure class="post-cover">
        
          <img src="https://umar0x01.sh/img/screenshot_10.png" alt="SUID Enumeration/Exploitation - The Automated Way!" />
        

        
      </figure>
    

    <div class="post-content">
      
        <h2>Table of Contents</h2>
        <aside class="table-of-contents"><nav id="TableOfContents">
  <ul>
    <li><a href="#what-the-heck-is-suid-enum">What the heck is SUID ENUM!?</a>
      <ul>
        <li><a href="#---description-goes-here---">&lt;!&ndash; Description goes here &ndash;&gt;</a></li>
        <li><a href="#usage">Usage</a></li>
        <li><a href="#screenshotsworking">Screenshots/Working</a></li>
        <li><a href="#faq">FAQ</a></li>
        <li><a href="#future-todos">Future ToDo(s):</a></li>
        <li><a href="#aightimmaheadout">./aightImmaHeadOut</a></li>
      </ul>
    </li>
  </ul>
</nav></aside>
      
      <h2 id="what-the-heck-is-suid-enum">What the heck is SUID ENUM!?</h2>
<p>Are you also tired of <strong>finding &amp;&amp; enumerating possibly exploitable SUID binaries</strong> like me!? Only to miss the ones you were going to <em>escalate your priviliges</em> with?</p>
<p>Welp, I just happened to develop a solution: <a href="https://github.com/Anon-Exploiter/SUID3NUM">SUID 3NUM</a>.</p>
<blockquote>
<p>(Self promote, I will! - Yoda)</p>
</blockquote>
<p><img src="/img/screenshot_10.png" alt=""></p>
<p>A (not-so-cool-as-it-seems-like) standalone script supporting both <strong>python2</strong> &amp; <strong>python3</strong> to find out all SUID binaries in a linux box and do the following:</p>
<ul>
<li>List all Default SUID Binaries (which ship with linux/aren&rsquo;t exploitable)</li>
<li>List all Custom Binaries (which don&rsquo;t ship with packages/vanilla installation)</li>
<li>List all Custom binaries found in GTFO Bin&rsquo;s list (This is where things get interesting)</li>
<li>Try and auto-exploit found custom SUID binaries which won&rsquo;t impact any of the machine&rsquo;s binaries</li>
</ul>
<h3 id="---description-goes-here---">&lt;!&ndash; Description goes here &ndash;&gt;</h3>
<p>Many of the times while doing <strong>Vulnhub</strong>, <strong>HTB</strong> &amp;&amp; other <strong>vulnerable machines</strong>, I stumbled upon <em>SUID binaries</em> in the box, I didn&rsquo;t have any method to seperate exploitable SUID binaries from those default SUID binaries of the system.</p>
<p>Fortunately, <a href="https://github.com/rebootuser/LinEnum">LinEnum</a> seperated vulnerable binaries which were present in list of GTFO Bins and presented it nicely in a new section named <code>Interesting SUID Bins</code>.</p>
<p><img src="/img/troll_gifs/awesome.gif" alt=""></p>
<h4 id="awesome-isnt-it">Awesome, isn&rsquo;t it?</h4>
<p>By this time, you&rsquo;ll be asking yourself, then why da heck I made this blog post and that script, <strong>If LinEum is so cool!?</strong></p>
<p>&ndash;</p>
<h5 id="lets-get-on-that-now">Lets get on that now:</h5>
<p><img src="/img/troll_gifs/finally.gif" alt=""></p>
<p>Now,</p>
<ul>
<li>What if a binary <strong>isn&rsquo;t</strong> in GTFO&rsquo;s bins list and is still exploitable?</li>
<li>What If the sysadmin renamed the exploitable binary (like <em>cp, find, cat, vim, iftop etc.</em>) to something else?</li>
<li>What if there&rsquo;s a custom C/C++ compiled binary having SUID bit set on it?</li>
</ul>
<p>You&rsquo;ll definitely miss that one binary through which you were going to escalate yourself to the next level. We all know, when LinEnum shows interesting SUID bins list, nobody ever looks at the whole list of the SUID binaries!</p>
<p>Also, LinEnum and other enumeration scripts only print SUID binaries &amp; GTFO Binaries, they don&rsquo;t seperate default binaries from custom binaries, which lead to severe head banging in walls for 3-4 hours when you can&rsquo;t escalate priviliges :)</p>
<h5 id="solution">Solution:</h5>
<p>The above issues struck me to create a script which seperates both custom SUID bit-set binaries and default binaries, cross-match custom binaries with GTFO Bin&rsquo;s binaries list. Further, go-ahead, try and auto-exploit them (only in case, they aren&rsquo;t going to <strong>alter any files</strong> on the system!)</p>
<hr>
<h3 id="usage">Usage</h3>
<p><em><strong>Initializing Script</strong></em></p>
<pre><code>python suid3num.py
</code></pre>
<p><em><strong>Doing Auto Exploitation of Exploitable SUID binaries</strong></em></p>
<pre><code>python suid3num.py -e
</code></pre>
<hr>
<h3 id="screenshotsworking">Screenshots/Working</h3>
<p>Here are some screenshots describing output of the script:</p>
<!-- raw HTML omitted -->
<hr>
<h4 id="suid-enumeration-without--e">SUID Enumeration (without -e)</h4>
<p><a href="https://asciinema.org/a/273928"><img src="https://asciinema.org/a/273928.svg" alt="asciicast"></a></p>
<hr>
<h4 id="auto-exploitation-of-suid-binaries-with--e">Auto-Exploitation of SUID Binaries (with -e)</h4>
<p><a href="https://asciinema.org/a/273929"><img src="https://asciinema.org/a/273929.svg" alt="asciicast"></a></p>
<hr>
<h3 id="faq">FAQ</h3>
<ul>
<li>Can I run it on OSCP labs/exam machines?</li>
</ul>
<p>According to some folks, as long as you aren&rsquo;t using <code>-e</code> flag, its completely fine! Also, I myself used it in mine, so no probs!</p>
<hr>
<h4 id="you-like-it-now-dont-you---ʖ-">You like it now, don&rsquo;t you? ( ͡° ͜ʖ ͡°)</h4>
<p><img src="/img/troll_gifs/hello_pepe.gif" alt=""></p>
<hr>
<h3 id="future-todos">Future ToDo(s):</h3>
<ul>
<li>Get a Life ¯\<em>(ツ)</em>/¯</li>
<li>Make improvements in default SUID binaries list</li>
<li>Create scripts for <code>linux capabilities</code> and for binaries one can run with <code>sudo</code></li>
</ul>
<hr>
<h3 id="aightimmaheadout">./aightImmaHeadOut</h3>
<p>Hope, you like the script, you can find me <a href="https://twitter.com/syed__umar">@syed__umar</a> on twitter!</p>
<p>See ya, later!</p>
<p><img src="/img/troll_gifs/dissapear.gif" alt=""></p>
<!-- raw HTML omitted -->

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="https://umar0x01.sh/post/pycode-testing/">
                  <span class="button__icon">←</span>
                  <span class="button__text">PyCode Testing</span>
                </a>
              </span>
            
            
          </div>
        </div>
      
    


    
      
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "umar0x01" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-177361132-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">$ cd /home/umar_0x01/</span>
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span>© 2020 <a href="https://github.com/Anon-Exploiter" target="_blank" rel="noopener">Umar_0x01</a></span>
        <span> twitter<a href="https://twitter.com/syed__umar" target="_blank" rel="noopener">@syed__umar</a>&nbsp;</span>
        <span> <a href="https://umar0x01.sh/archive" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
      </div>
    
  </div>
</footer>
<script src="https://umar0x01.sh/assets/main.js"></script>
<script src="https://umar0x01.sh/assets/prism.js"></script>




      
    </div>

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-177361132-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
  </body>
</html>
